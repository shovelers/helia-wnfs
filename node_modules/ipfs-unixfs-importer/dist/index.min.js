(function (root, factory) {(typeof module === 'object' && module.exports) ? module.exports = factory() : root.IpfsUnixfsImporter = factory()}(typeof self !== 'undefined' ? self : this, function () {
"use strict";var IpfsUnixfsImporter=(()=>{var oi=Object.create;var Rt=Object.defineProperty;var si=Object.getOwnPropertyDescriptor;var ai=Object.getOwnPropertyNames;var ci=Object.getPrototypeOf,fi=Object.prototype.hasOwnProperty;var C=(r,t)=>()=>(t||r((t={exports:{}}).exports,t),t.exports),N=(r,t)=>{for(var e in t)Rt(r,e,{get:t[e],enumerable:!0})},ir=(r,t,e,n)=>{if(t&&typeof t=="object"||typeof t=="function")for(let i of ai(t))!fi.call(r,i)&&i!==e&&Rt(r,i,{get:()=>t[i],enumerable:!(n=si(t,i))||n.enumerable});return r};var H=(r,t,e)=>(e=r!=null?oi(ci(r)):{},ir(t||!r||!r.__esModule?Rt(e,"default",{value:r,enumerable:!0}):e,r)),ui=r=>ir(Rt({},"__esModule",{value:!0}),r);var bt=C((Es,sr)=>{"use strict";function or(r,t){for(let e in t)Object.defineProperty(r,e,{value:t[e],enumerable:!0,configurable:!0});return r}function hi(r,t,e){if(!r||typeof r=="string")throw new TypeError("Please pass an Error to err-code");e||(e={}),typeof t=="object"&&(e=t,t=""),t&&(e.code=t);try{return or(r,e)}catch{e.message=r.message,e.stack=r.stack;let i=function(){};return i.prototype=Object.create(Object.getPrototypeOf(r)),or(new i,e)}}sr.exports=hi});var zr=C((ma,Nr)=>{"use strict";Nr.exports=go;function go(r,t){for(var e=new Array(arguments.length-1),n=0,i=2,o=!0;i<arguments.length;)e[n++]=arguments[i++];return new Promise(function(f,c){e[n]=function(u){if(o)if(o=!1,u)c(u);else{for(var y=new Array(arguments.length-1),k=0;k<y.length;)y[k++]=arguments[k];f.apply(null,y)}};try{r.apply(t||null,e)}catch(h){o&&(o=!1,c(h))}})}});var Ur=C(Fr=>{"use strict";var jt=Fr;jt.length=function(t){var e=t.length;if(!e)return 0;for(var n=0;--e%4>1&&t.charAt(e)==="=";)++n;return Math.ceil(t.length*3)/4-n};var gt=new Array(64),Pr=new Array(123);for(O=0;O<64;)Pr[gt[O]=O<26?O+65:O<52?O+71:O<62?O-4:O-59|43]=O++;var O;jt.encode=function(t,e,n){for(var i=null,o=[],s=0,f=0,c;e<n;){var h=t[e++];switch(f){case 0:o[s++]=gt[h>>2],c=(h&3)<<4,f=1;break;case 1:o[s++]=gt[c|h>>4],c=(h&15)<<2,f=2;break;case 2:o[s++]=gt[c|h>>6],o[s++]=gt[h&63],f=0;break}s>8191&&((i||(i=[])).push(String.fromCharCode.apply(String,o)),s=0)}return f&&(o[s++]=gt[c],o[s++]=61,f===1&&(o[s++]=61)),i?(s&&i.push(String.fromCharCode.apply(String,o.slice(0,s))),i.join("")):String.fromCharCode.apply(String,o.slice(0,s))};var Ir="invalid encoding";jt.decode=function(t,e,n){for(var i=n,o=0,s,f=0;f<t.length;){var c=t.charCodeAt(f++);if(c===61&&o>1)break;if((c=Pr[c])===void 0)throw Error(Ir);switch(o){case 0:s=c,o=1;break;case 1:e[n++]=s<<2|(c&48)>>4,s=c,o=2;break;case 2:e[n++]=(s&15)<<4|(c&60)>>2,s=c,o=3;break;case 3:e[n++]=(s&3)<<6|c,o=0;break}}if(o===1)throw Error(Ir);return n-i};jt.test=function(t){return/^(?:[A-Za-z0-9+/]{4})*(?:[A-Za-z0-9+/]{2}==|[A-Za-z0-9+/]{3}=)?$/.test(t)}});var Hr=C((ga,Mr)=>{"use strict";Mr.exports=$t;function $t(){this._listeners={}}$t.prototype.on=function(t,e,n){return(this._listeners[t]||(this._listeners[t]=[])).push({fn:e,ctx:n||this}),this};$t.prototype.off=function(t,e){if(t===void 0)this._listeners={};else if(e===void 0)this._listeners[t]=[];else for(var n=this._listeners[t],i=0;i<n.length;)n[i].fn===e?n.splice(i,1):++i;return this};$t.prototype.emit=function(t){var e=this._listeners[t];if(e){for(var n=[],i=1;i<arguments.length;)n.push(arguments[i++]);for(i=0;i<e.length;)e[i].fn.apply(e[i++].ctx,n)}return this}});var $r=C((wa,jr)=>{"use strict";jr.exports=Or(Or);function Or(r){return typeof Float32Array<"u"?function(){var t=new Float32Array([-0]),e=new Uint8Array(t.buffer),n=e[3]===128;function i(c,h,u){t[0]=c,h[u]=e[0],h[u+1]=e[1],h[u+2]=e[2],h[u+3]=e[3]}function o(c,h,u){t[0]=c,h[u]=e[3],h[u+1]=e[2],h[u+2]=e[1],h[u+3]=e[0]}r.writeFloatLE=n?i:o,r.writeFloatBE=n?o:i;function s(c,h){return e[0]=c[h],e[1]=c[h+1],e[2]=c[h+2],e[3]=c[h+3],t[0]}function f(c,h){return e[3]=c[h],e[2]=c[h+1],e[1]=c[h+2],e[0]=c[h+3],t[0]}r.readFloatLE=n?s:f,r.readFloatBE=n?f:s}():function(){function t(n,i,o,s){var f=i<0?1:0;if(f&&(i=-i),i===0)n(1/i>0?0:2147483648,o,s);else if(isNaN(i))n(2143289344,o,s);else if(i>34028234663852886e22)n((f<<31|2139095040)>>>0,o,s);else if(i<11754943508222875e-54)n((f<<31|Math.round(i/1401298464324817e-60))>>>0,o,s);else{var c=Math.floor(Math.log(i)/Math.LN2),h=Math.round(i*Math.pow(2,-c)*8388608)&8388607;n((f<<31|c+127<<23|h)>>>0,o,s)}}r.writeFloatLE=t.bind(null,Rr),r.writeFloatBE=t.bind(null,Vr);function e(n,i,o){var s=n(i,o),f=(s>>31)*2+1,c=s>>>23&255,h=s&8388607;return c===255?h?NaN:f*(1/0):c===0?f*1401298464324817e-60*h:f*Math.pow(2,c-150)*(h+8388608)}r.readFloatLE=e.bind(null,qr),r.readFloatBE=e.bind(null,Gr)}(),typeof Float64Array<"u"?function(){var t=new Float64Array([-0]),e=new Uint8Array(t.buffer),n=e[7]===128;function i(c,h,u){t[0]=c,h[u]=e[0],h[u+1]=e[1],h[u+2]=e[2],h[u+3]=e[3],h[u+4]=e[4],h[u+5]=e[5],h[u+6]=e[6],h[u+7]=e[7]}function o(c,h,u){t[0]=c,h[u]=e[7],h[u+1]=e[6],h[u+2]=e[5],h[u+3]=e[4],h[u+4]=e[3],h[u+5]=e[2],h[u+6]=e[1],h[u+7]=e[0]}r.writeDoubleLE=n?i:o,r.writeDoubleBE=n?o:i;function s(c,h){return e[0]=c[h],e[1]=c[h+1],e[2]=c[h+2],e[3]=c[h+3],e[4]=c[h+4],e[5]=c[h+5],e[6]=c[h+6],e[7]=c[h+7],t[0]}function f(c,h){return e[7]=c[h],e[6]=c[h+1],e[5]=c[h+2],e[4]=c[h+3],e[3]=c[h+4],e[2]=c[h+5],e[1]=c[h+6],e[0]=c[h+7],t[0]}r.readDoubleLE=n?s:f,r.readDoubleBE=n?f:s}():function(){function t(n,i,o,s,f,c){var h=s<0?1:0;if(h&&(s=-s),s===0)n(0,f,c+i),n(1/s>0?0:2147483648,f,c+o);else if(isNaN(s))n(0,f,c+i),n(2146959360,f,c+o);else if(s>17976931348623157e292)n(0,f,c+i),n((h<<31|2146435072)>>>0,f,c+o);else{var u;if(s<22250738585072014e-324)u=s/5e-324,n(u>>>0,f,c+i),n((h<<31|u/4294967296)>>>0,f,c+o);else{var y=Math.floor(Math.log(s)/Math.LN2);y===1024&&(y=1023),u=s*Math.pow(2,-y),n(u*4503599627370496>>>0,f,c+i),n((h<<31|y+1023<<20|u*1048576&1048575)>>>0,f,c+o)}}}r.writeDoubleLE=t.bind(null,Rr,0,4),r.writeDoubleBE=t.bind(null,Vr,4,0);function e(n,i,o,s,f){var c=n(s,f+i),h=n(s,f+o),u=(h>>31)*2+1,y=h>>>20&2047,k=4294967296*(h&1048575)+c;return y===2047?k?NaN:u*(1/0):y===0?u*5e-324*k:u*Math.pow(2,y-1075)*(k+4503599627370496)}r.readDoubleLE=e.bind(null,qr,0,4),r.readDoubleBE=e.bind(null,Gr,4,0)}(),r}function Rr(r,t,e){t[e]=r&255,t[e+1]=r>>>8&255,t[e+2]=r>>>16&255,t[e+3]=r>>>24}function Vr(r,t,e){t[e]=r>>>24,t[e+1]=r>>>16&255,t[e+2]=r>>>8&255,t[e+3]=r&255}function qr(r,t){return(r[t]|r[t+1]<<8|r[t+2]<<16|r[t+3]<<24)>>>0}function Gr(r,t){return(r[t]<<24|r[t+1]<<16|r[t+2]<<8|r[t+3])>>>0}});var Wr=C((exports,module)=>{"use strict";module.exports=inquire;function inquire(moduleName){try{var mod=eval("quire".replace(/^/,"re"))(moduleName);if(mod&&(mod.length||Object.keys(mod).length))return mod}catch(r){}return null}});var Jr=C(Kr=>{"use strict";var we=Kr;we.length=function(t){for(var e=0,n=0,i=0;i<t.length;++i)n=t.charCodeAt(i),n<128?e+=1:n<2048?e+=2:(n&64512)===55296&&(t.charCodeAt(i+1)&64512)===56320?(++i,e+=4):e+=3;return e};we.read=function(t,e,n){var i=n-e;if(i<1)return"";for(var o=null,s=[],f=0,c;e<n;)c=t[e++],c<128?s[f++]=c:c>191&&c<224?s[f++]=(c&31)<<6|t[e++]&63:c>239&&c<365?(c=((c&7)<<18|(t[e++]&63)<<12|(t[e++]&63)<<6|t[e++]&63)-65536,s[f++]=55296+(c>>10),s[f++]=56320+(c&1023)):s[f++]=(c&15)<<12|(t[e++]&63)<<6|t[e++]&63,f>8191&&((o||(o=[])).push(String.fromCharCode.apply(String,s)),f=0);return o?(f&&o.push(String.fromCharCode.apply(String,s.slice(0,f))),o.join("")):String.fromCharCode.apply(String,s.slice(0,f))};we.write=function(t,e,n){for(var i=n,o,s,f=0;f<t.length;++f)o=t.charCodeAt(f),o<128?e[n++]=o:o<2048?(e[n++]=o>>6|192,e[n++]=o&63|128):(o&64512)===55296&&((s=t.charCodeAt(f+1))&64512)===56320?(o=65536+((o&1023)<<10)+(s&1023),++f,e[n++]=o>>18|240,e[n++]=o>>12&63|128,e[n++]=o>>6&63|128,e[n++]=o&63|128):(e[n++]=o>>12|224,e[n++]=o>>6&63|128,e[n++]=o&63|128);return n-i}});var Qr=C((xa,Xr)=>{"use strict";Xr.exports=wo;function wo(r,t,e){var n=e||8192,i=n>>>1,o=null,s=n;return function(c){if(c<1||c>i)return r(c);s+c>n&&(o=r(n),s=0);var h=t.call(o,s,s+=c);return s&7&&(s=(s|7)+1),h}}});var Yr=C((_a,Zr)=>{"use strict";Zr.exports=T;var Et=ot();function T(r,t){this.lo=r>>>0,this.hi=t>>>0}var it=T.zero=new T(0,0);it.toNumber=function(){return 0};it.zzEncode=it.zzDecode=function(){return this};it.length=function(){return 1};var bo=T.zeroHash="\0\0\0\0\0\0\0\0";T.fromNumber=function(t){if(t===0)return it;var e=t<0;e&&(t=-t);var n=t>>>0,i=(t-n)/4294967296>>>0;return e&&(i=~i>>>0,n=~n>>>0,++n>4294967295&&(n=0,++i>4294967295&&(i=0))),new T(n,i)};T.from=function(t){if(typeof t=="number")return T.fromNumber(t);if(Et.isString(t))if(Et.Long)t=Et.Long.fromString(t);else return T.fromNumber(parseInt(t,10));return t.low||t.high?new T(t.low>>>0,t.high>>>0):it};T.prototype.toNumber=function(t){if(!t&&this.hi>>>31){var e=~this.lo+1>>>0,n=~this.hi>>>0;return e||(n=n+1>>>0),-(e+n*4294967296)}return this.lo+this.hi*4294967296};T.prototype.toLong=function(t){return Et.Long?new Et.Long(this.lo|0,this.hi|0,!!t):{low:this.lo|0,high:this.hi|0,unsigned:!!t}};var Z=String.prototype.charCodeAt;T.fromHash=function(t){return t===bo?it:new T((Z.call(t,0)|Z.call(t,1)<<8|Z.call(t,2)<<16|Z.call(t,3)<<24)>>>0,(Z.call(t,4)|Z.call(t,5)<<8|Z.call(t,6)<<16|Z.call(t,7)<<24)>>>0)};T.prototype.toHash=function(){return String.fromCharCode(this.lo&255,this.lo>>>8&255,this.lo>>>16&255,this.lo>>>24,this.hi&255,this.hi>>>8&255,this.hi>>>16&255,this.hi>>>24)};T.prototype.zzEncode=function(){var t=this.hi>>31;return this.hi=((this.hi<<1|this.lo>>>31)^t)>>>0,this.lo=(this.lo<<1^t)>>>0,this};T.prototype.zzDecode=function(){var t=-(this.lo&1);return this.lo=((this.lo>>>1|this.hi<<31)^t)>>>0,this.hi=(this.hi>>>1^t)>>>0,this};T.prototype.length=function(){var t=this.lo,e=(this.lo>>>28|this.hi<<4)>>>0,n=this.hi>>>24;return n===0?e===0?t<16384?t<128?1:2:t<2097152?3:4:e<16384?e<128?5:6:e<2097152?7:8:n<128?9:10}});var ot=C(be=>{"use strict";var x=be;x.asPromise=zr();x.base64=Ur();x.EventEmitter=Hr();x.float=$r();x.inquire=Wr();x.utf8=Jr();x.pool=Qr();x.LongBits=Yr();x.isNode=!!(typeof globalThis<"u"&&globalThis&&globalThis.process&&globalThis.process.versions&&globalThis.process.versions.node);x.global=x.isNode&&globalThis||typeof window<"u"&&window||typeof self<"u"&&self||be;x.emptyArray=Object.freeze?Object.freeze([]):[];x.emptyObject=Object.freeze?Object.freeze({}):{};x.isInteger=Number.isInteger||function(t){return typeof t=="number"&&isFinite(t)&&Math.floor(t)===t};x.isString=function(t){return typeof t=="string"||t instanceof String};x.isObject=function(t){return t&&typeof t=="object"};x.isset=x.isSet=function(t,e){var n=t[e];return n!=null&&t.hasOwnProperty(e)?typeof n!="object"||(Array.isArray(n)?n.length:Object.keys(n).length)>0:!1};x.Buffer=function(){try{var r=x.inquire("buffer").Buffer;return r.prototype.utf8Write?r:null}catch{return null}}();x._Buffer_from=null;x._Buffer_allocUnsafe=null;x.newBuffer=function(t){return typeof t=="number"?x.Buffer?x._Buffer_allocUnsafe(t):new x.Array(t):x.Buffer?x._Buffer_from(t):typeof Uint8Array>"u"?t:new Uint8Array(t)};x.Array=typeof Uint8Array<"u"?Uint8Array:Array;x.Long=x.global.dcodeIO&&x.global.dcodeIO.Long||x.global.Long||x.inquire("long");x.key2Re=/^true|false|0|1$/;x.key32Re=/^-?(?:0|[1-9][0-9]*)$/;x.key64Re=/^(?:[\\x00-\\xff]{8}|-?(?:0|[1-9][0-9]*))$/;x.longToHash=function(t){return t?x.LongBits.from(t).toHash():x.LongBits.zeroHash};x.longFromHash=function(t,e){var n=x.LongBits.fromHash(t);return x.Long?x.Long.fromBits(n.lo,n.hi,e):n.toNumber(!!e)};function tn(r,t,e){for(var n=Object.keys(t),i=0;i<n.length;++i)(r[n[i]]===void 0||!e)&&(r[n[i]]=t[n[i]]);return r}x.merge=tn;x.lcFirst=function(t){return t.charAt(0).toLowerCase()+t.substring(1)};function en(r){function t(e,n){if(!(this instanceof t))return new t(e,n);Object.defineProperty(this,"message",{get:function(){return e}}),Error.captureStackTrace?Error.captureStackTrace(this,t):Object.defineProperty(this,"stack",{value:new Error().stack||""}),n&&tn(this,n)}return t.prototype=Object.create(Error.prototype,{constructor:{value:t,writable:!0,enumerable:!1,configurable:!0},name:{get:function(){return r},set:void 0,enumerable:!1,configurable:!0},toString:{value:function(){return this.name+": "+this.message},writable:!0,enumerable:!1,configurable:!0}}),t}x.newError=en;x.ProtocolError=en("ProtocolError");x.oneOfGetter=function(t){for(var e={},n=0;n<t.length;++n)e[t[n]]=1;return function(){for(var i=Object.keys(this),o=i.length-1;o>-1;--o)if(e[i[o]]===1&&this[i[o]]!==void 0&&this[i[o]]!==null)return i[o]}};x.oneOfSetter=function(t){return function(e){for(var n=0;n<t.length;++n)t[n]!==e&&delete this[t[n]]}};x.toJSONOptions={longs:String,enums:String,bytes:String,json:!0};x._configure=function(){var r=x.Buffer;if(!r){x._Buffer_from=x._Buffer_allocUnsafe=null;return}x._Buffer_from=r.from!==Uint8Array.from&&r.from||function(e,n){return new r(e,n)},x._Buffer_allocUnsafe=r.allocUnsafe||function(e){return new r(e)}}});var Be=C((va,an)=>{"use strict";an.exports=L;var R=ot(),_e,on=R.LongBits,xo=R.utf8;function V(r,t){return RangeError("index out of range: "+r.pos+" + "+(t||1)+" > "+r.len)}function L(r){this.buf=r,this.pos=0,this.len=r.length}var rn=typeof Uint8Array<"u"?function(t){if(t instanceof Uint8Array||Array.isArray(t))return new L(t);throw Error("illegal buffer")}:function(t){if(Array.isArray(t))return new L(t);throw Error("illegal buffer")},sn=function(){return R.Buffer?function(e){return(L.create=function(i){return R.Buffer.isBuffer(i)?new _e(i):rn(i)})(e)}:rn};L.create=sn();L.prototype._slice=R.Array.prototype.subarray||R.Array.prototype.slice;L.prototype.uint32=function(){var t=4294967295;return function(){if(t=(this.buf[this.pos]&127)>>>0,this.buf[this.pos++]<128||(t=(t|(this.buf[this.pos]&127)<<7)>>>0,this.buf[this.pos++]<128)||(t=(t|(this.buf[this.pos]&127)<<14)>>>0,this.buf[this.pos++]<128)||(t=(t|(this.buf[this.pos]&127)<<21)>>>0,this.buf[this.pos++]<128)||(t=(t|(this.buf[this.pos]&15)<<28)>>>0,this.buf[this.pos++]<128))return t;if((this.pos+=5)>this.len)throw this.pos=this.len,V(this,10);return t}}();L.prototype.int32=function(){return this.uint32()|0};L.prototype.sint32=function(){var t=this.uint32();return t>>>1^-(t&1)|0};function xe(){var r=new on(0,0),t=0;if(this.len-this.pos>4){for(;t<4;++t)if(r.lo=(r.lo|(this.buf[this.pos]&127)<<t*7)>>>0,this.buf[this.pos++]<128)return r;if(r.lo=(r.lo|(this.buf[this.pos]&127)<<28)>>>0,r.hi=(r.hi|(this.buf[this.pos]&127)>>4)>>>0,this.buf[this.pos++]<128)return r;t=0}else{for(;t<3;++t){if(this.pos>=this.len)throw V(this);if(r.lo=(r.lo|(this.buf[this.pos]&127)<<t*7)>>>0,this.buf[this.pos++]<128)return r}return r.lo=(r.lo|(this.buf[this.pos++]&127)<<t*7)>>>0,r}if(this.len-this.pos>4){for(;t<5;++t)if(r.hi=(r.hi|(this.buf[this.pos]&127)<<t*7+3)>>>0,this.buf[this.pos++]<128)return r}else for(;t<5;++t){if(this.pos>=this.len)throw V(this);if(r.hi=(r.hi|(this.buf[this.pos]&127)<<t*7+3)>>>0,this.buf[this.pos++]<128)return r}throw Error("invalid varint encoding")}L.prototype.bool=function(){return this.uint32()!==0};function Wt(r,t){return(r[t-4]|r[t-3]<<8|r[t-2]<<16|r[t-1]<<24)>>>0}L.prototype.fixed32=function(){if(this.pos+4>this.len)throw V(this,4);return Wt(this.buf,this.pos+=4)};L.prototype.sfixed32=function(){if(this.pos+4>this.len)throw V(this,4);return Wt(this.buf,this.pos+=4)|0};function nn(){if(this.pos+8>this.len)throw V(this,8);return new on(Wt(this.buf,this.pos+=4),Wt(this.buf,this.pos+=4))}L.prototype.float=function(){if(this.pos+4>this.len)throw V(this,4);var t=R.float.readFloatLE(this.buf,this.pos);return this.pos+=4,t};L.prototype.double=function(){if(this.pos+8>this.len)throw V(this,4);var t=R.float.readDoubleLE(this.buf,this.pos);return this.pos+=8,t};L.prototype.bytes=function(){var t=this.uint32(),e=this.pos,n=this.pos+t;if(n>this.len)throw V(this,t);if(this.pos+=t,Array.isArray(this.buf))return this.buf.slice(e,n);if(e===n){var i=R.Buffer;return i?i.alloc(0):new this.buf.constructor(0)}return this._slice.call(this.buf,e,n)};L.prototype.string=function(){var t=this.bytes();return xo.read(t,0,t.length)};L.prototype.skip=function(t){if(typeof t=="number"){if(this.pos+t>this.len)throw V(this,t);this.pos+=t}else do if(this.pos>=this.len)throw V(this);while(this.buf[this.pos++]&128);return this};L.prototype.skipType=function(r){switch(r){case 0:this.skip();break;case 1:this.skip(8);break;case 2:this.skip(this.uint32());break;case 3:for(;(r=this.uint32()&7)!==4;)this.skipType(r);break;case 5:this.skip(4);break;default:throw Error("invalid wire type "+r+" at offset "+this.pos)}return this};L._configure=function(r){_e=r,L.create=sn(),_e._configure();var t=R.Long?"toLong":"toNumber";R.merge(L.prototype,{int64:function(){return xe.call(this)[t](!1)},uint64:function(){return xe.call(this)[t](!0)},sint64:function(){return xe.call(this).zzDecode()[t](!1)},fixed64:function(){return nn.call(this)[t](!0)},sfixed64:function(){return nn.call(this)[t](!1)}})}});var hn=C((Aa,un)=>{"use strict";un.exports=st;var fn=Be();(st.prototype=Object.create(fn.prototype)).constructor=st;var cn=ot();function st(r){fn.call(this,r)}st._configure=function(){cn.Buffer&&(st.prototype._slice=cn.Buffer.prototype.slice)};st.prototype.string=function(){var t=this.uint32();return this.buf.utf8Slice?this.buf.utf8Slice(this.pos,this.pos=Math.min(this.pos+t,this.len)):this.buf.toString("utf-8",this.pos,this.pos=Math.min(this.pos+t,this.len))};st._configure()});var Ee=C((ka,mn)=>{"use strict";mn.exports=A;var M=ot(),ve,Kt=M.LongBits,ln=M.base64,dn=M.utf8;function Tt(r,t,e){this.fn=r,this.len=t,this.next=void 0,this.val=e}function ke(){}function _o(r){this.head=r.head,this.tail=r.tail,this.len=r.len,this.next=r.states}function A(){this.len=0,this.head=new Tt(ke,0,0),this.tail=this.head,this.states=null}var pn=function(){return M.Buffer?function(){return(A.create=function(){return new ve})()}:function(){return new A}};A.create=pn();A.alloc=function(t){return new M.Array(t)};M.Array!==Array&&(A.alloc=M.pool(A.alloc,M.Array.prototype.subarray));A.prototype._push=function(t,e,n){return this.tail=this.tail.next=new Tt(t,e,n),this.len+=e,this};function De(r,t,e){t[e]=r&255}function Bo(r,t,e){for(;r>127;)t[e++]=r&127|128,r>>>=7;t[e]=r}function Se(r,t){this.len=r,this.next=void 0,this.val=t}Se.prototype=Object.create(Tt.prototype);Se.prototype.fn=Bo;A.prototype.uint32=function(t){return this.len+=(this.tail=this.tail.next=new Se((t=t>>>0)<128?1:t<16384?2:t<2097152?3:t<268435456?4:5,t)).len,this};A.prototype.int32=function(t){return t<0?this._push(Le,10,Kt.fromNumber(t)):this.uint32(t)};A.prototype.sint32=function(t){return this.uint32((t<<1^t>>31)>>>0)};function Le(r,t,e){for(;r.hi;)t[e++]=r.lo&127|128,r.lo=(r.lo>>>7|r.hi<<25)>>>0,r.hi>>>=7;for(;r.lo>127;)t[e++]=r.lo&127|128,r.lo=r.lo>>>7;t[e++]=r.lo}A.prototype.uint64=function(t){var e=Kt.from(t);return this._push(Le,e.length(),e)};A.prototype.int64=A.prototype.uint64;A.prototype.sint64=function(t){var e=Kt.from(t).zzEncode();return this._push(Le,e.length(),e)};A.prototype.bool=function(t){return this._push(De,1,t?1:0)};function Ae(r,t,e){t[e]=r&255,t[e+1]=r>>>8&255,t[e+2]=r>>>16&255,t[e+3]=r>>>24}A.prototype.fixed32=function(t){return this._push(Ae,4,t>>>0)};A.prototype.sfixed32=A.prototype.fixed32;A.prototype.fixed64=function(t){var e=Kt.from(t);return this._push(Ae,4,e.lo)._push(Ae,4,e.hi)};A.prototype.sfixed64=A.prototype.fixed64;A.prototype.float=function(t){return this._push(M.float.writeFloatLE,4,t)};A.prototype.double=function(t){return this._push(M.float.writeDoubleLE,8,t)};var vo=M.Array.prototype.set?function(t,e,n){e.set(t,n)}:function(t,e,n){for(var i=0;i<t.length;++i)e[n+i]=t[i]};A.prototype.bytes=function(t){var e=t.length>>>0;if(!e)return this._push(De,1,0);if(M.isString(t)){var n=A.alloc(e=ln.length(t));ln.decode(t,n,0),t=n}return this.uint32(e)._push(vo,e,t)};A.prototype.string=function(t){var e=dn.length(t);return e?this.uint32(e)._push(dn.write,e,t):this._push(De,1,0)};A.prototype.fork=function(){return this.states=new _o(this),this.head=this.tail=new Tt(ke,0,0),this.len=0,this};A.prototype.reset=function(){return this.states?(this.head=this.states.head,this.tail=this.states.tail,this.len=this.states.len,this.states=this.states.next):(this.head=this.tail=new Tt(ke,0,0),this.len=0),this};A.prototype.ldelim=function(){var t=this.head,e=this.tail,n=this.len;return this.reset().uint32(n),n&&(this.tail.next=t.next,this.tail=e,this.len+=n),this};A.prototype.finish=function(){for(var t=this.head.next,e=this.constructor.alloc(this.len),n=0;t;)t.fn(t.val,e,n),n+=t.len,t=t.next;return e};A._configure=function(r){ve=r,A.create=pn(),ve._configure()}});var wn=C((Da,gn)=>{"use strict";gn.exports=$;var yn=Ee();($.prototype=Object.create(yn.prototype)).constructor=$;var Y=ot();function $(){yn.call(this)}$._configure=function(){$.alloc=Y._Buffer_allocUnsafe,$.writeBytesBuffer=Y.Buffer&&Y.Buffer.prototype instanceof Uint8Array&&Y.Buffer.prototype.set.name==="set"?function(t,e,n){e.set(t,n)}:function(t,e,n){if(t.copy)t.copy(e,n,0,t.length);else for(var i=0;i<t.length;)e[n++]=t[i++]}};$.prototype.bytes=function(t){Y.isString(t)&&(t=Y._Buffer_from(t,"base64"));var e=t.length>>>0;return this.uint32(e),e&&this._push($.writeBytesBuffer,e,t),this};function Ao(r,t,e){r.length<40?Y.utf8.write(r,t,e):t.utf8Write?t.utf8Write(r,e):t.write(r,e)}$.prototype.string=function(t){var e=Y.Buffer.byteLength(t);return this.uint32(e),e&&this._push(Ao,e,t),this};$._configure()});var Rn=C((Ut,Yt)=>{(function(r,t){"use strict";var e={version:"3.0.0",x86:{},x64:{},inputValidation:!0};function n(a){if(!Array.isArray(a)&&!ArrayBuffer.isView(a))return!1;for(var l=0;l<a.length;l++)if(!Number.isInteger(a[l])||a[l]<0||a[l]>255)return!1;return!0}function i(a,l){return(a&65535)*l+(((a>>>16)*l&65535)<<16)}function o(a,l){return a<<l|a>>>32-l}function s(a){return a^=a>>>16,a=i(a,2246822507),a^=a>>>13,a=i(a,3266489909),a^=a>>>16,a}function f(a,l){a=[a[0]>>>16,a[0]&65535,a[1]>>>16,a[1]&65535],l=[l[0]>>>16,l[0]&65535,l[1]>>>16,l[1]&65535];var p=[0,0,0,0];return p[3]+=a[3]+l[3],p[2]+=p[3]>>>16,p[3]&=65535,p[2]+=a[2]+l[2],p[1]+=p[2]>>>16,p[2]&=65535,p[1]+=a[1]+l[1],p[0]+=p[1]>>>16,p[1]&=65535,p[0]+=a[0]+l[0],p[0]&=65535,[p[0]<<16|p[1],p[2]<<16|p[3]]}function c(a,l){a=[a[0]>>>16,a[0]&65535,a[1]>>>16,a[1]&65535],l=[l[0]>>>16,l[0]&65535,l[1]>>>16,l[1]&65535];var p=[0,0,0,0];return p[3]+=a[3]*l[3],p[2]+=p[3]>>>16,p[3]&=65535,p[2]+=a[2]*l[3],p[1]+=p[2]>>>16,p[2]&=65535,p[2]+=a[3]*l[2],p[1]+=p[2]>>>16,p[2]&=65535,p[1]+=a[1]*l[3],p[0]+=p[1]>>>16,p[1]&=65535,p[1]+=a[2]*l[2],p[0]+=p[1]>>>16,p[1]&=65535,p[1]+=a[3]*l[1],p[0]+=p[1]>>>16,p[1]&=65535,p[0]+=a[0]*l[3]+a[1]*l[2]+a[2]*l[1]+a[3]*l[0],p[0]&=65535,[p[0]<<16|p[1],p[2]<<16|p[3]]}function h(a,l){return l%=64,l===32?[a[1],a[0]]:l<32?[a[0]<<l|a[1]>>>32-l,a[1]<<l|a[0]>>>32-l]:(l-=32,[a[1]<<l|a[0]>>>32-l,a[0]<<l|a[1]>>>32-l])}function u(a,l){return l%=64,l===0?a:l<32?[a[0]<<l|a[1]>>>32-l,a[1]<<l]:[a[1]<<l-32,0]}function y(a,l){return[a[0]^l[0],a[1]^l[1]]}function k(a){return a=y(a,[0,a[0]>>>1]),a=c(a,[4283543511,3981806797]),a=y(a,[0,a[0]>>>1]),a=c(a,[3301882366,444984403]),a=y(a,[0,a[0]>>>1]),a}e.x86.hash32=function(a,l){if(e.inputValidation&&!n(a))return t;l=l||0;for(var p=a.length%4,E=a.length-p,d=l,m=0,g=3432918353,b=461845907,_=0;_<E;_=_+4)m=a[_]|a[_+1]<<8|a[_+2]<<16|a[_+3]<<24,m=i(m,g),m=o(m,15),m=i(m,b),d^=m,d=o(d,13),d=i(d,5)+3864292196;switch(m=0,p){case 3:m^=a[_+2]<<16;case 2:m^=a[_+1]<<8;case 1:m^=a[_],m=i(m,g),m=o(m,15),m=i(m,b),d^=m}return d^=a.length,d=s(d),d>>>0},e.x86.hash128=function(a,l){if(e.inputValidation&&!n(a))return t;l=l||0;for(var p=a.length%16,E=a.length-p,d=l,m=l,g=l,b=l,_=0,B=0,w=0,D=0,K=597399067,Mt=2869860233,Ht=951274213,Ot=2716044179,v=0;v<E;v=v+16)_=a[v]|a[v+1]<<8|a[v+2]<<16|a[v+3]<<24,B=a[v+4]|a[v+5]<<8|a[v+6]<<16|a[v+7]<<24,w=a[v+8]|a[v+9]<<8|a[v+10]<<16|a[v+11]<<24,D=a[v+12]|a[v+13]<<8|a[v+14]<<16|a[v+15]<<24,_=i(_,K),_=o(_,15),_=i(_,Mt),d^=_,d=o(d,19),d+=m,d=i(d,5)+1444728091,B=i(B,Mt),B=o(B,16),B=i(B,Ht),m^=B,m=o(m,17),m+=g,m=i(m,5)+197830471,w=i(w,Ht),w=o(w,17),w=i(w,Ot),g^=w,g=o(g,15),g+=b,g=i(g,5)+2530024501,D=i(D,Ot),D=o(D,18),D=i(D,K),b^=D,b=o(b,13),b+=d,b=i(b,5)+850148119;switch(_=0,B=0,w=0,D=0,p){case 15:D^=a[v+14]<<16;case 14:D^=a[v+13]<<8;case 13:D^=a[v+12],D=i(D,Ot),D=o(D,18),D=i(D,K),b^=D;case 12:w^=a[v+11]<<24;case 11:w^=a[v+10]<<16;case 10:w^=a[v+9]<<8;case 9:w^=a[v+8],w=i(w,Ht),w=o(w,17),w=i(w,Ot),g^=w;case 8:B^=a[v+7]<<24;case 7:B^=a[v+6]<<16;case 6:B^=a[v+5]<<8;case 5:B^=a[v+4],B=i(B,Mt),B=o(B,16),B=i(B,Ht),m^=B;case 4:_^=a[v+3]<<24;case 3:_^=a[v+2]<<16;case 2:_^=a[v+1]<<8;case 1:_^=a[v],_=i(_,K),_=o(_,15),_=i(_,Mt),d^=_}return d^=a.length,m^=a.length,g^=a.length,b^=a.length,d+=m,d+=g,d+=b,m+=d,g+=d,b+=d,d=s(d),m=s(m),g=s(g),b=s(b),d+=m,d+=g,d+=b,m+=d,g+=d,b+=d,("00000000"+(d>>>0).toString(16)).slice(-8)+("00000000"+(m>>>0).toString(16)).slice(-8)+("00000000"+(g>>>0).toString(16)).slice(-8)+("00000000"+(b>>>0).toString(16)).slice(-8)},e.x64.hash128=function(a,l){if(e.inputValidation&&!n(a))return t;l=l||0;for(var p=a.length%16,E=a.length-p,d=[0,l],m=[0,l],g=[0,0],b=[0,0],_=[2277735313,289559509],B=[1291169091,658871167],w=0;w<E;w=w+16)g=[a[w+4]|a[w+5]<<8|a[w+6]<<16|a[w+7]<<24,a[w]|a[w+1]<<8|a[w+2]<<16|a[w+3]<<24],b=[a[w+12]|a[w+13]<<8|a[w+14]<<16|a[w+15]<<24,a[w+8]|a[w+9]<<8|a[w+10]<<16|a[w+11]<<24],g=c(g,_),g=h(g,31),g=c(g,B),d=y(d,g),d=h(d,27),d=f(d,m),d=f(c(d,[0,5]),[0,1390208809]),b=c(b,B),b=h(b,33),b=c(b,_),m=y(m,b),m=h(m,31),m=f(m,d),m=f(c(m,[0,5]),[0,944331445]);switch(g=[0,0],b=[0,0],p){case 15:b=y(b,u([0,a[w+14]],48));case 14:b=y(b,u([0,a[w+13]],40));case 13:b=y(b,u([0,a[w+12]],32));case 12:b=y(b,u([0,a[w+11]],24));case 11:b=y(b,u([0,a[w+10]],16));case 10:b=y(b,u([0,a[w+9]],8));case 9:b=y(b,[0,a[w+8]]),b=c(b,B),b=h(b,33),b=c(b,_),m=y(m,b);case 8:g=y(g,u([0,a[w+7]],56));case 7:g=y(g,u([0,a[w+6]],48));case 6:g=y(g,u([0,a[w+5]],40));case 5:g=y(g,u([0,a[w+4]],32));case 4:g=y(g,u([0,a[w+3]],24));case 3:g=y(g,u([0,a[w+2]],16));case 2:g=y(g,u([0,a[w+1]],8));case 1:g=y(g,[0,a[w]]),g=c(g,_),g=h(g,31),g=c(g,B),d=y(d,g)}return d=y(d,[0,a.length]),m=y(m,[0,a.length]),d=f(d,m),m=f(m,d),d=k(d),m=k(m),d=f(d,m),m=f(m,d),("00000000"+(d[0]>>>0).toString(16)).slice(-8)+("00000000"+(d[1]>>>0).toString(16)).slice(-8)+("00000000"+(m[0]>>>0).toString(16)).slice(-8)+("00000000"+(m[1]>>>0).toString(16)).slice(-8)},typeof Ut<"u"?(typeof Yt<"u"&&Yt.exports&&(Ut=Yt.exports=e),Ut.murmurHash3=e):typeof define=="function"&&define.amd?define([],function(){return e}):(e._murmurHash3=r.murmurHash3,e.noConflict=function(){return r.murmurHash3=e._murmurHash3,e._murmurHash3=t,e.noConflict=t,e},r.murmurHash3=e)})(Ut)});var qn=C((hf,Vn)=>{Vn.exports=Rn()});var Wn=C((wf,$n)=>{"use strict";$n.exports=class{constructor(){this._bitArrays=[],this._data=[],this._length=0,this._changedLength=!1,this._changedData=!1}set(t,e){let n=this._internalPositionFor(t,!1);if(e===void 0)n!==-1&&(this._unsetInternalPos(n),this._unsetBit(t),this._changedLength=!0,this._changedData=!0);else{let i=!1;n===-1?(n=this._data.length,this._setBit(t),this._changedData=!0):i=!0,this._setInternalPos(n,t,e,i),this._changedLength=!0}}unset(t){this.set(t,void 0)}get(t){this._sortData();let e=this._internalPositionFor(t,!0);if(e!==-1)return this._data[e][1]}push(t){return this.set(this.length,t),this.length}get length(){if(this._sortData(),this._changedLength){let t=this._data[this._data.length-1];this._length=t?t[0]+1:0,this._changedLength=!1}return this._length}forEach(t){let e=0;for(;e<this.length;)t(this.get(e),e,this),e++}map(t){let e=0,n=new Array(this.length);for(;e<this.length;)n[e]=t(this.get(e),e,this),e++;return n}reduce(t,e){let n=0,i=e;for(;n<this.length;){let o=this.get(n);i=t(i,o,n),n++}return i}find(t){let e=0,n,i;for(;e<this.length&&!n;)i=this.get(e),n=t(i),e++;return n?i:void 0}_internalPositionFor(t,e){let n=this._bytePosFor(t,e);if(n>=this._bitArrays.length)return-1;let i=this._bitArrays[n],o=t-n*7;if(!((i&1<<o)>0))return-1;let f=this._bitArrays.slice(0,n).reduce(fs,0),c=~(4294967295<<o+1),h=jn(i&c);return f+h-1}_bytePosFor(t,e){let n=Math.floor(t/7),i=n+1;for(;!e&&this._bitArrays.length<i;)this._bitArrays.push(0);return n}_setBit(t){let e=this._bytePosFor(t,!1);this._bitArrays[e]|=1<<t-e*7}_unsetBit(t){let e=this._bytePosFor(t,!1);this._bitArrays[e]&=~(1<<t-e*7)}_setInternalPos(t,e,n,i){let o=this._data,s=[e,n];if(i)this._sortData(),o[t]=s;else{if(o.length)if(o[o.length-1][0]>=e)o.push(s);else if(o[0][0]<=e)o.unshift(s);else{let f=Math.round(o.length/2);this._data=o.slice(0,f).concat(s).concat(o.slice(f))}else this._data.push(s);this._changedData=!0,this._changedLength=!0}}_unsetInternalPos(t){this._data.splice(t,1)}_sortData(){this._changedData&&this._data.sort(us),this._changedData=!1}bitField(){let t=[],e=8,n=0,i=0,o,s=this._bitArrays.slice();for(;s.length||n;){n===0&&(o=s.shift(),n=7);let c=Math.min(n,e),h=~(255<<c),u=o&h;i|=u<<8-e,o=o>>>c,n-=c,e-=c,(!e||!n&&!s.length)&&(t.push(i),i=0,e=8)}for(var f=t.length-1;f>0&&t[f]===0;f--)t.pop();return t}compactArray(){return this._sortData(),this._data.map(hs)}};function fs(r,t){return r+jn(t)}function jn(r){let t=r;return t=t-(t>>1&1431655765),t=(t&858993459)+(t>>2&858993459),(t+(t>>4)&252645135)*16843009>>24}function us(r,t){return r[0]-t[0]}function hs(r){return r[1]}});var Ss={};N(Ss,{importByteStream:()=>Ds,importBytes:()=>ks,importDirectory:()=>As,importFile:()=>nr,importer:()=>rr});var er=H(bt(),1);function li(r){return r[Symbol.asyncIterator]!=null}function di(r){if(li(r))return(async()=>{for await(let t of r)return t})();for(let t of r)return t}var ne=di;function pi(r){return r[Symbol.asyncIterator]!=null}function mi(r,t=1){return t=Number(t),pi(r)?async function*(){let e=[];if(t<1&&(t=1),t!==Math.round(t))throw new Error("Batch size must be an integer");for await(let n of r)for(e.push(n);e.length>=t;)yield e.slice(0,t),e=e.slice(t);for(;e.length>0;)yield e.slice(0,t),e=e.slice(t)}():function*(){let e=[];if(t<1&&(t=1),t!==Math.round(t))throw new Error("Batch size must be an integer");for(let n of r)for(e.push(n);e.length>=t;)yield e.slice(0,t),e=e.slice(t);for(;e.length>0;)yield e.slice(0,t),e=e.slice(t)}()}var xt=mi;async function*_t(r,t=1){for await(let e of xt(r,t)){let n=e.map(async i=>i().then(o=>({ok:!0,value:o}),o=>({ok:!1,err:o})));for(let i=0;i<n.length;i++){let o=await n[i];if(o.ok)yield o.value;else throw o.err}}}function et(r){return globalThis.Buffer!=null?new Uint8Array(r.buffer,r.byteOffset,r.byteLength):r}function J(r=0){return globalThis.Buffer?.alloc!=null?et(globalThis.Buffer.alloc(r)):new Uint8Array(r)}function rt(r=0){return globalThis.Buffer?.allocUnsafe!=null?et(globalThis.Buffer.allocUnsafe(r)):new Uint8Array(r)}function Bt(r,t){t==null&&(t=r.reduce((i,o)=>i+o.length,0));let e=rt(t),n=0;for(let i of r)e.set(i,n),n+=i.length;return et(e)}function ar(r,t){if(r===t)return!0;if(r.byteLength!==t.byteLength)return!1;for(let e=0;e<r.byteLength;e++)if(r[e]!==t[e])return!1;return!0}var fr=Symbol.for("@achingbrain/uint8arraylist");function cr(r,t){if(t==null||t<0)throw new RangeError("index is out of bounds");let e=0;for(let n of r){let i=e+n.byteLength;if(t<i)return{buf:n,index:t-e};e=i}throw new RangeError("index is out of bounds")}function Vt(r){return!!r?.[fr]}var ft=class r{constructor(...t){Object.defineProperty(this,fr,{value:!0}),this.bufs=[],this.length=0,t.length>0&&this.appendAll(t)}*[Symbol.iterator](){yield*this.bufs}get byteLength(){return this.length}append(...t){this.appendAll(t)}appendAll(t){let e=0;for(let n of t)if(n instanceof Uint8Array)e+=n.byteLength,this.bufs.push(n);else if(Vt(n))e+=n.byteLength,this.bufs.push(...n.bufs);else throw new Error("Could not append value, must be an Uint8Array or a Uint8ArrayList");this.length+=e}prepend(...t){this.prependAll(t)}prependAll(t){let e=0;for(let n of t.reverse())if(n instanceof Uint8Array)e+=n.byteLength,this.bufs.unshift(n);else if(Vt(n))e+=n.byteLength,this.bufs.unshift(...n.bufs);else throw new Error("Could not prepend value, must be an Uint8Array or a Uint8ArrayList");this.length+=e}get(t){let e=cr(this.bufs,t);return e.buf[e.index]}set(t,e){let n=cr(this.bufs,t);n.buf[n.index]=e}write(t,e=0){if(t instanceof Uint8Array)for(let n=0;n<t.length;n++)this.set(e+n,t[n]);else if(Vt(t))for(let n=0;n<t.length;n++)this.set(e+n,t.get(n));else throw new Error("Could not write value, must be an Uint8Array or a Uint8ArrayList")}consume(t){if(t=Math.trunc(t),!(Number.isNaN(t)||t<=0)){if(t===this.byteLength){this.bufs=[],this.length=0;return}for(;this.bufs.length>0;)if(t>=this.bufs[0].byteLength)t-=this.bufs[0].byteLength,this.length-=this.bufs[0].byteLength,this.bufs.shift();else{this.bufs[0]=this.bufs[0].subarray(t),this.length-=t;break}}}slice(t,e){let{bufs:n,length:i}=this._subList(t,e);return Bt(n,i)}subarray(t,e){let{bufs:n,length:i}=this._subList(t,e);return n.length===1?n[0]:Bt(n,i)}sublist(t,e){let{bufs:n,length:i}=this._subList(t,e),o=new r;return o.length=i,o.bufs=n,o}_subList(t,e){if(t=t??0,e=e??this.length,t<0&&(t=this.length+t),e<0&&(e=this.length+e),t<0||e>this.length)throw new RangeError("index is out of bounds");if(t===e)return{bufs:[],length:0};if(t===0&&e===this.length)return{bufs:[...this.bufs],length:this.length};let n=[],i=0;for(let o=0;o<this.bufs.length;o++){let s=this.bufs[o],f=i,c=f+s.byteLength;if(i=c,t>=c)continue;let h=t>=f&&t<c,u=e>f&&e<=c;if(h&&u){if(t===f&&e===c){n.push(s);break}let y=t-f;n.push(s.subarray(y,y+(e-t)));break}if(h){if(t===0){n.push(s);continue}n.push(s.subarray(t-f));continue}if(u){if(e===c){n.push(s);break}n.push(s.subarray(0,e-f));break}n.push(s)}return{bufs:n,length:e-t}}indexOf(t,e=0){if(!Vt(t)&&!(t instanceof Uint8Array))throw new TypeError('The "value" argument must be a Uint8ArrayList or Uint8Array');let n=t instanceof Uint8Array?t:t.subarray();if(e=Number(e??0),isNaN(e)&&(e=0),e<0&&(e=this.length+e),e<0&&(e=0),t.length===0)return e>this.length?this.length:e;let i=n.byteLength;if(i===0)throw new TypeError("search must be at least 1 byte long");let o=256,s=new Int32Array(o);for(let y=0;y<o;y++)s[y]=-1;for(let y=0;y<i;y++)s[n[y]]=y;let f=s,c=this.byteLength-n.byteLength,h=n.byteLength-1,u;for(let y=e;y<=c;y+=u){u=0;for(let k=h;k>=0;k--){let a=this.get(y+k);if(n[k]!==a){u=Math.max(1,k-f[a]);break}}if(u===0)return y}return-1}getInt8(t){let e=this.subarray(t,t+1);return new DataView(e.buffer,e.byteOffset,e.byteLength).getInt8(0)}setInt8(t,e){let n=rt(1);new DataView(n.buffer,n.byteOffset,n.byteLength).setInt8(0,e),this.write(n,t)}getInt16(t,e){let n=this.subarray(t,t+2);return new DataView(n.buffer,n.byteOffset,n.byteLength).getInt16(0,e)}setInt16(t,e,n){let i=J(2);new DataView(i.buffer,i.byteOffset,i.byteLength).setInt16(0,e,n),this.write(i,t)}getInt32(t,e){let n=this.subarray(t,t+4);return new DataView(n.buffer,n.byteOffset,n.byteLength).getInt32(0,e)}setInt32(t,e,n){let i=J(4);new DataView(i.buffer,i.byteOffset,i.byteLength).setInt32(0,e,n),this.write(i,t)}getBigInt64(t,e){let n=this.subarray(t,t+8);return new DataView(n.buffer,n.byteOffset,n.byteLength).getBigInt64(0,e)}setBigInt64(t,e,n){let i=J(8);new DataView(i.buffer,i.byteOffset,i.byteLength).setBigInt64(0,e,n),this.write(i,t)}getUint8(t){let e=this.subarray(t,t+1);return new DataView(e.buffer,e.byteOffset,e.byteLength).getUint8(0)}setUint8(t,e){let n=rt(1);new DataView(n.buffer,n.byteOffset,n.byteLength).setUint8(0,e),this.write(n,t)}getUint16(t,e){let n=this.subarray(t,t+2);return new DataView(n.buffer,n.byteOffset,n.byteLength).getUint16(0,e)}setUint16(t,e,n){let i=J(2);new DataView(i.buffer,i.byteOffset,i.byteLength).setUint16(0,e,n),this.write(i,t)}getUint32(t,e){let n=this.subarray(t,t+4);return new DataView(n.buffer,n.byteOffset,n.byteLength).getUint32(0,e)}setUint32(t,e,n){let i=J(4);new DataView(i.buffer,i.byteOffset,i.byteLength).setUint32(0,e,n),this.write(i,t)}getBigUint64(t,e){let n=this.subarray(t,t+8);return new DataView(n.buffer,n.byteOffset,n.byteLength).getBigUint64(0,e)}setBigUint64(t,e,n){let i=J(8);new DataView(i.buffer,i.byteOffset,i.byteLength).setBigUint64(0,e,n),this.write(i,t)}getFloat32(t,e){let n=this.subarray(t,t+4);return new DataView(n.buffer,n.byteOffset,n.byteLength).getFloat32(0,e)}setFloat32(t,e,n){let i=J(4);new DataView(i.buffer,i.byteOffset,i.byteLength).setFloat32(0,e,n),this.write(i,t)}getFloat64(t,e){let n=this.subarray(t,t+8);return new DataView(n.buffer,n.byteOffset,n.byteLength).getFloat64(0,e)}setFloat64(t,e,n){let i=J(8);new DataView(i.buffer,i.byteOffset,i.byteLength).setFloat64(0,e,n),this.write(i,t)}equals(t){if(t==null||!(t instanceof r)||t.bufs.length!==this.bufs.length)return!1;for(let e=0;e<this.bufs.length;e++)if(!ar(this.bufs[e],t.bufs[e]))return!1;return!0}static fromUint8Arrays(t,e){let n=new r;return n.bufs=t,e==null&&(e=t.reduce((i,o)=>i+o.byteLength,0)),n.length=e,n}};var yi=262144,ur=(r={})=>{let t=r.chunkSize??yi;return async function*(n){let i=new ft,o=0,s=!1;for await(let f of n)for(i.append(f),o+=f.length;o>=t;)if(yield i.slice(0,t),s=!0,t===i.length)i=new ft,o=0;else{let c=new ft;c.append(i.sublist(t)),i=c,o-=t}(!s||o>0)&&(yield i.subarray(0,o))}};var Lt={};N(Lt,{code:()=>mo,createLink:()=>Cr,createNode:()=>Tr,decode:()=>yo,encode:()=>F,name:()=>po,prepare:()=>P,validate:()=>ge});var gi=dr,hr=128,wi=127,bi=~wi,xi=Math.pow(2,31);function dr(r,t,e){t=t||[],e=e||0;for(var n=e;r>=xi;)t[e++]=r&255|hr,r/=128;for(;r&bi;)t[e++]=r&255|hr,r>>>=7;return t[e]=r|0,dr.bytes=e-n+1,t}var _i=ie,Bi=128,lr=127;function ie(r,n){var e=0,n=n||0,i=0,o=n,s,f=r.length;do{if(o>=f)throw ie.bytes=0,new RangeError("Could not decode varint");s=r[o++],e+=i<28?(s&lr)<<i:(s&lr)*Math.pow(2,i),i+=7}while(s>=Bi);return ie.bytes=o-n,e}var vi=Math.pow(2,7),Ai=Math.pow(2,14),ki=Math.pow(2,21),Di=Math.pow(2,28),Si=Math.pow(2,35),Li=Math.pow(2,42),Ei=Math.pow(2,49),Ti=Math.pow(2,56),Ci=Math.pow(2,63),Ni=function(r){return r<vi?1:r<Ai?2:r<ki?3:r<Di?4:r<Si?5:r<Li?6:r<Ei?7:r<Ti?8:r<Ci?9:10},zi={encode:gi,decode:_i,encodingLength:Ni},Ii=zi,vt=Ii;var At=(r,t=0)=>[vt.decode(r,t),vt.decode.bytes],ut=(r,t,e=0)=>(vt.encode(r,t,e),t),ht=r=>vt.encodingLength(r);var lt={};N(lt,{coerce:()=>U,empty:()=>pr,equals:()=>oe,fromHex:()=>Fi,fromString:()=>se,isBinary:()=>Ui,toHex:()=>Pi,toString:()=>ae});var pr=new Uint8Array(0),Pi=r=>r.reduce((t,e)=>t+e.toString(16).padStart(2,"0"),""),Fi=r=>{let t=r.match(/../g);return t?new Uint8Array(t.map(e=>parseInt(e,16))):pr},oe=(r,t)=>{if(r===t)return!0;if(r.byteLength!==t.byteLength)return!1;for(let e=0;e<r.byteLength;e++)if(r[e]!==t[e])return!1;return!0},U=r=>{if(r instanceof Uint8Array&&r.constructor.name==="Uint8Array")return r;if(r instanceof ArrayBuffer)return new Uint8Array(r);if(ArrayBuffer.isView(r))return new Uint8Array(r.buffer,r.byteOffset,r.byteLength);throw new Error("Unknown type, must be binary type")},Ui=r=>r instanceof ArrayBuffer||ArrayBuffer.isView(r),se=r=>new TextEncoder().encode(r),ae=r=>new TextDecoder().decode(r);var nt=(r,t)=>{let e=t.byteLength,n=ht(r),i=n+ht(e),o=new Uint8Array(i+e);return ut(r,o,0),ut(e,o,n),o.set(t,i),new dt(r,e,t,o)},mr=r=>{let t=U(r),[e,n]=At(t),[i,o]=At(t.subarray(n)),s=t.subarray(n+o);if(s.byteLength!==i)throw new Error("Incorrect length");return new dt(e,i,s,t)},yr=(r,t)=>{if(r===t)return!0;{let e=t;return r.code===e.code&&r.size===e.size&&e.bytes instanceof Uint8Array&&oe(r.bytes,e.bytes)}},dt=class{constructor(t,e,n,i){this.code=t,this.size=e,this.digest=n,this.bytes=i}};var le={};N(le,{base58btc:()=>j,base58flickr:()=>qi});function Mi(r,t){if(r.length>=255)throw new TypeError("Alphabet too long");for(var e=new Uint8Array(256),n=0;n<e.length;n++)e[n]=255;for(var i=0;i<r.length;i++){var o=r.charAt(i),s=o.charCodeAt(0);if(e[s]!==255)throw new TypeError(o+" is ambiguous");e[s]=i}var f=r.length,c=r.charAt(0),h=Math.log(f)/Math.log(256),u=Math.log(256)/Math.log(f);function y(l){if(l instanceof Uint8Array||(ArrayBuffer.isView(l)?l=new Uint8Array(l.buffer,l.byteOffset,l.byteLength):Array.isArray(l)&&(l=Uint8Array.from(l))),!(l instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(l.length===0)return"";for(var p=0,E=0,d=0,m=l.length;d!==m&&l[d]===0;)d++,p++;for(var g=(m-d)*u+1>>>0,b=new Uint8Array(g);d!==m;){for(var _=l[d],B=0,w=g-1;(_!==0||B<E)&&w!==-1;w--,B++)_+=256*b[w]>>>0,b[w]=_%f>>>0,_=_/f>>>0;if(_!==0)throw new Error("Non-zero carry");E=B,d++}for(var D=g-E;D!==g&&b[D]===0;)D++;for(var K=c.repeat(p);D<g;++D)K+=r.charAt(b[D]);return K}function k(l){if(typeof l!="string")throw new TypeError("Expected String");if(l.length===0)return new Uint8Array;var p=0;if(l[p]!==" "){for(var E=0,d=0;l[p]===c;)E++,p++;for(var m=(l.length-p)*h+1>>>0,g=new Uint8Array(m);l[p];){var b=e[l.charCodeAt(p)];if(b===255)return;for(var _=0,B=m-1;(b!==0||_<d)&&B!==-1;B--,_++)b+=f*g[B]>>>0,g[B]=b%256>>>0,b=b/256>>>0;if(b!==0)throw new Error("Non-zero carry");d=_,p++}if(l[p]!==" "){for(var w=m-d;w!==m&&g[w]===0;)w++;for(var D=new Uint8Array(E+(m-w)),K=E;w!==m;)D[K++]=g[w++];return D}}}function a(l){var p=k(l);if(p)return p;throw new Error(`Non-${t} character`)}return{encode:y,decodeUnsafe:k,decode:a}}var Hi=Mi,Oi=Hi,gr=Oi;var ce=class{constructor(t,e,n){this.name=t,this.prefix=e,this.baseEncode=n}encode(t){if(t instanceof Uint8Array)return`${this.prefix}${this.baseEncode(t)}`;throw Error("Unknown type, must be binary type")}},fe=class{constructor(t,e,n){if(this.name=t,this.prefix=e,e.codePointAt(0)===void 0)throw new Error("Invalid prefix character");this.prefixCodePoint=e.codePointAt(0),this.baseDecode=n}decode(t){if(typeof t=="string"){if(t.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(t)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(t.slice(this.prefix.length))}else throw Error("Can only multibase decode strings")}or(t){return wr(this,t)}},ue=class{constructor(t){this.decoders=t}or(t){return wr(this,t)}decode(t){let e=t[0],n=this.decoders[e];if(n)return n.decode(t);throw RangeError(`Unable to decode multibase string ${JSON.stringify(t)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}},wr=(r,t)=>new ue({...r.decoders||{[r.prefix]:r},...t.decoders||{[t.prefix]:t}}),he=class{constructor(t,e,n,i){this.name=t,this.prefix=e,this.baseEncode=n,this.baseDecode=i,this.encoder=new ce(t,e,n),this.decoder=new fe(t,e,i)}encode(t){return this.encoder.encode(t)}decode(t){return this.decoder.decode(t)}},pt=({name:r,prefix:t,encode:e,decode:n})=>new he(r,t,e,n),Q=({prefix:r,name:t,alphabet:e})=>{let{encode:n,decode:i}=gr(e,t);return pt({prefix:r,name:t,encode:n,decode:o=>U(i(o))})},Ri=(r,t,e,n)=>{let i={};for(let u=0;u<t.length;++u)i[t[u]]=u;let o=r.length;for(;r[o-1]==="=";)--o;let s=new Uint8Array(o*e/8|0),f=0,c=0,h=0;for(let u=0;u<o;++u){let y=i[r[u]];if(y===void 0)throw new SyntaxError(`Non-${n} character`);c=c<<e|y,f+=e,f>=8&&(f-=8,s[h++]=255&c>>f)}if(f>=e||255&c<<8-f)throw new SyntaxError("Unexpected end of data");return s},Vi=(r,t,e)=>{let n=t[t.length-1]==="=",i=(1<<e)-1,o="",s=0,f=0;for(let c=0;c<r.length;++c)for(f=f<<8|r[c],s+=8;s>e;)s-=e,o+=t[i&f>>s];if(s&&(o+=t[i&f<<e-s]),n)for(;o.length*e&7;)o+="=";return o},S=({name:r,prefix:t,bitsPerChar:e,alphabet:n})=>pt({prefix:t,name:r,encode(i){return Vi(i,n,e)},decode(i){return Ri(i,n,e,r)}});var j=Q({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),qi=Q({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"});var de={};N(de,{base32:()=>mt,base32hex:()=>Wi,base32hexpad:()=>Ji,base32hexpadupper:()=>Xi,base32hexupper:()=>Ki,base32pad:()=>ji,base32padupper:()=>$i,base32upper:()=>Gi,base32z:()=>Qi});var mt=S({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),Gi=S({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),ji=S({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),$i=S({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),Wi=S({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),Ki=S({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),Ji=S({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),Xi=S({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),Qi=S({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5});var br=(r,t)=>{let{bytes:e,version:n}=r;switch(n){case 0:return Yi(e,pe(r),t||j.encoder);default:return to(e,pe(r),t||mt.encoder)}};var xr=new WeakMap,pe=r=>{let t=xr.get(r);if(t==null){let e=new Map;return xr.set(r,e),e}return t},z=class r{constructor(t,e,n,i){this.code=e,this.version=t,this.multihash=n,this.bytes=i,this["/"]=i}get asCID(){return this}get byteOffset(){return this.bytes.byteOffset}get byteLength(){return this.bytes.byteLength}toV0(){switch(this.version){case 0:return this;case 1:{let{code:t,multihash:e}=this;if(t!==Dt)throw new Error("Cannot convert a non dag-pb CID to CIDv0");if(e.code!==eo)throw new Error("Cannot convert non sha2-256 multihash CID to CIDv0");return r.createV0(e)}default:throw Error(`Can not convert CID version ${this.version} to version 0. This is a bug please report`)}}toV1(){switch(this.version){case 0:{let{code:t,digest:e}=this.multihash,n=nt(t,e);return r.createV1(this.code,n)}case 1:return this;default:throw Error(`Can not convert CID version ${this.version} to version 1. This is a bug please report`)}}equals(t){return r.equals(this,t)}static equals(t,e){let n=e;return n&&t.code===n.code&&t.version===n.version&&yr(t.multihash,n.multihash)}toString(t){return br(this,t)}toJSON(){return{"/":br(this)}}link(){return this}get[Symbol.toStringTag](){return"CID"}[Symbol.for("nodejs.util.inspect.custom")](){return`CID(${this.toString()})`}static asCID(t){if(t==null)return null;let e=t;if(e instanceof r)return e;if(e["/"]!=null&&e["/"]===e.bytes||e.asCID===e){let{version:n,code:i,multihash:o,bytes:s}=e;return new r(n,i,o,s||_r(n,i,o.bytes))}else if(e[ro]===!0){let{version:n,multihash:i,code:o}=e,s=mr(i);return r.create(n,o,s)}else return null}static create(t,e,n){if(typeof e!="number")throw new Error("String codecs are no longer supported");if(!(n.bytes instanceof Uint8Array))throw new Error("Invalid digest");switch(t){case 0:{if(e!==Dt)throw new Error(`Version 0 CID must use dag-pb (code: ${Dt}) block encoding`);return new r(t,e,n,n.bytes)}case 1:{let i=_r(t,e,n.bytes);return new r(t,e,n,i)}default:throw new Error("Invalid version")}}static createV0(t){return r.create(0,Dt,t)}static createV1(t,e){return r.create(1,t,e)}static decode(t){let[e,n]=r.decodeFirst(t);if(n.length)throw new Error("Incorrect length");return e}static decodeFirst(t){let e=r.inspectBytes(t),n=e.size-e.multihashSize,i=U(t.subarray(n,n+e.multihashSize));if(i.byteLength!==e.multihashSize)throw new Error("Incorrect length");let o=i.subarray(e.multihashSize-e.digestSize),s=new dt(e.multihashCode,e.digestSize,o,i);return[e.version===0?r.createV0(s):r.createV1(e.codec,s),t.subarray(e.size)]}static inspectBytes(t){let e=0,n=()=>{let[y,k]=At(t.subarray(e));return e+=k,y},i=n(),o=Dt;if(i===18?(i=0,e=0):o=n(),i!==0&&i!==1)throw new RangeError(`Invalid CID version ${i}`);let s=e,f=n(),c=n(),h=e+c,u=h-s;return{version:i,codec:o,multihashCode:f,digestSize:c,multihashSize:u,size:h}}static parse(t,e){let[n,i]=Zi(t,e),o=r.decode(i);if(o.version===0&&t[0]!=="Q")throw Error("Version 0 CID string must not include multibase prefix");return pe(o).set(n,t),o}},Zi=(r,t)=>{switch(r[0]){case"Q":{let e=t||j;return[j.prefix,e.decode(`${j.prefix}${r}`)]}case j.prefix:{let e=t||j;return[j.prefix,e.decode(r)]}case mt.prefix:{let e=t||mt;return[mt.prefix,e.decode(r)]}default:{if(t==null)throw Error("To parse non base32 or base58btc encoded CID multibase decoder must be provided");return[r[0],t.decode(r)]}}},Yi=(r,t,e)=>{let{prefix:n}=e;if(n!==j.prefix)throw Error(`Cannot string encode V0 in ${e.name} encoding`);let i=t.get(n);if(i==null){let o=e.encode(r).slice(1);return t.set(n,o),o}else return i},to=(r,t,e)=>{let{prefix:n}=e,i=t.get(n);if(i==null){let o=e.encode(r);return t.set(n,o),o}else return i},Dt=112,eo=18,_r=(r,t,e)=>{let n=ht(r),i=n+ht(t),o=new Uint8Array(i+e.byteLength);return ut(r,o,0),ut(t,o,n),o.set(e,i),o},ro=Symbol.for("@ipld/js-cid/CID");var no=new TextDecoder;function me(r,t){let e=0;for(let n=0;;n+=7){if(n>=64)throw new Error("protobuf: varint overflow");if(t>=r.length)throw new Error("protobuf: unexpected end of data");let i=r[t++];if(e+=n<28?(i&127)<<n:(i&127)*2**n,i<128)break}return[e,t]}function Gt(r,t){let e;[e,t]=me(r,t);let n=t+e;if(e<0||n<0)throw new Error("protobuf: invalid length");if(n>r.length)throw new Error("protobuf: unexpected end of data");return[r.subarray(t,n),n]}function Br(r,t){let e;return[e,t]=me(r,t),[e&7,e>>3,t]}function io(r){let t={},e=r.length,n=0;for(;n<e;){let i,o;if([i,o,n]=Br(r,n),o===1){if(t.Hash)throw new Error("protobuf: (PBLink) duplicate Hash section");if(i!==2)throw new Error(`protobuf: (PBLink) wrong wireType (${i}) for Hash`);if(t.Name!==void 0)throw new Error("protobuf: (PBLink) invalid order, found Name before Hash");if(t.Tsize!==void 0)throw new Error("protobuf: (PBLink) invalid order, found Tsize before Hash");[t.Hash,n]=Gt(r,n)}else if(o===2){if(t.Name!==void 0)throw new Error("protobuf: (PBLink) duplicate Name section");if(i!==2)throw new Error(`protobuf: (PBLink) wrong wireType (${i}) for Name`);if(t.Tsize!==void 0)throw new Error("protobuf: (PBLink) invalid order, found Tsize before Name");let s;[s,n]=Gt(r,n),t.Name=no.decode(s)}else if(o===3){if(t.Tsize!==void 0)throw new Error("protobuf: (PBLink) duplicate Tsize section");if(i!==0)throw new Error(`protobuf: (PBLink) wrong wireType (${i}) for Tsize`);[t.Tsize,n]=me(r,n)}else throw new Error(`protobuf: (PBLink) invalid fieldNumber, expected 1, 2 or 3, got ${o}`)}if(n>e)throw new Error("protobuf: (PBLink) unexpected end of data");return t}function vr(r){let t=r.length,e=0,n,i=!1,o;for(;e<t;){let f,c;if([f,c,e]=Br(r,e),f!==2)throw new Error(`protobuf: (PBNode) invalid wireType, expected 2, got ${f}`);if(c===1){if(o)throw new Error("protobuf: (PBNode) duplicate Data section");[o,e]=Gt(r,e),n&&(i=!0)}else if(c===2){if(i)throw new Error("protobuf: (PBNode) duplicate Links section");n||(n=[]);let h;[h,e]=Gt(r,e),n.push(io(h))}else throw new Error(`protobuf: (PBNode) invalid fieldNumber, expected 1 or 2, got ${c}`)}if(e>t)throw new Error("protobuf: (PBNode) unexpected end of data");let s={};return o&&(s.Data=o),s.Links=n||[],s}var kr=new TextEncoder,Ar=2**32,oo=2**31;function so(r,t){let e=t.length;if(typeof r.Tsize=="number"){if(r.Tsize<0)throw new Error("Tsize cannot be negative");if(!Number.isSafeInteger(r.Tsize))throw new Error("Tsize too large for encoding");e=St(t,e,r.Tsize)-1,t[e]=24}if(typeof r.Name=="string"){let n=kr.encode(r.Name);e-=n.length,t.set(n,e),e=St(t,e,n.length)-1,t[e]=18}return r.Hash&&(e-=r.Hash.length,t.set(r.Hash,e),e=St(t,e,r.Hash.length)-1,t[e]=10),t.length-e}function Dr(r){let t=co(r),e=new Uint8Array(t),n=t;if(r.Data&&(n-=r.Data.length,e.set(r.Data,n),n=St(e,n,r.Data.length)-1,e[n]=10),r.Links)for(let i=r.Links.length-1;i>=0;i--){let o=so(r.Links[i],e.subarray(0,n));n-=o,n=St(e,n,o)-1,e[n]=18}return e}function ao(r){let t=0;if(r.Hash){let e=r.Hash.length;t+=1+e+yt(e)}if(typeof r.Name=="string"){let e=kr.encode(r.Name).length;t+=1+e+yt(e)}return typeof r.Tsize=="number"&&(t+=1+yt(r.Tsize)),t}function co(r){let t=0;if(r.Data){let e=r.Data.length;t+=1+e+yt(e)}if(r.Links)for(let e of r.Links){let n=ao(e);t+=1+n+yt(n)}return t}function St(r,t,e){t-=yt(e);let n=t;for(;e>=oo;)r[t++]=e&127|128,e/=128;for(;e>=128;)r[t++]=e&127|128,e>>>=7;return r[t]=e,n}function yt(r){return r%2===0&&r++,Math.floor((fo(r)+6)/7)}function fo(r){let t=0;return r>=Ar&&(r=Math.floor(r/Ar),t=32),r>=65536&&(r>>>=16,t+=16),r>=256&&(r>>>=8,t+=8),t+uo[r]}var uo=[0,1,2,2,3,3,3,3,4,4,4,4,4,4,4,4,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8];var ho=["Data","Links"],lo=["Hash","Name","Tsize"],ye=new TextEncoder;function Lr(r,t){if(r===t)return 0;let e=r.Name?ye.encode(r.Name):[],n=t.Name?ye.encode(t.Name):[],i=e.length,o=n.length;for(let s=0,f=Math.min(i,o);s<f;++s)if(e[s]!==n[s]){i=e[s],o=n[s];break}return i<o?-1:o<i?1:0}function Sr(r,t){return!Object.keys(r).some(e=>!t.includes(e))}function Er(r){if(typeof r.asCID=="object"){let e=z.asCID(r);if(!e)throw new TypeError("Invalid DAG-PB form");return{Hash:e}}if(typeof r!="object"||Array.isArray(r))throw new TypeError("Invalid DAG-PB form");let t={};if(r.Hash){let e=z.asCID(r.Hash);try{e||(typeof r.Hash=="string"?e=z.parse(r.Hash):r.Hash instanceof Uint8Array&&(e=z.decode(r.Hash)))}catch(n){throw new TypeError(`Invalid DAG-PB form: ${n.message}`)}e&&(t.Hash=e)}if(!t.Hash)throw new TypeError("Invalid DAG-PB form");return typeof r.Name=="string"&&(t.Name=r.Name),typeof r.Tsize=="number"&&(t.Tsize=r.Tsize),t}function P(r){if((r instanceof Uint8Array||typeof r=="string")&&(r={Data:r}),typeof r!="object"||Array.isArray(r))throw new TypeError("Invalid DAG-PB form");let t={};if(r.Data!==void 0)if(typeof r.Data=="string")t.Data=ye.encode(r.Data);else if(r.Data instanceof Uint8Array)t.Data=r.Data;else throw new TypeError("Invalid DAG-PB form");if(r.Links!==void 0)if(Array.isArray(r.Links))t.Links=r.Links.map(Er),t.Links.sort(Lr);else throw new TypeError("Invalid DAG-PB form");else t.Links=[];return t}function ge(r){if(!r||typeof r!="object"||Array.isArray(r)||r instanceof Uint8Array||r["/"]&&r["/"]===r.bytes)throw new TypeError("Invalid DAG-PB form");if(!Sr(r,ho))throw new TypeError("Invalid DAG-PB form (extraneous properties)");if(r.Data!==void 0&&!(r.Data instanceof Uint8Array))throw new TypeError("Invalid DAG-PB form (Data must be bytes)");if(!Array.isArray(r.Links))throw new TypeError("Invalid DAG-PB form (Links must be a list)");for(let t=0;t<r.Links.length;t++){let e=r.Links[t];if(!e||typeof e!="object"||Array.isArray(e)||e instanceof Uint8Array||e["/"]&&e["/"]===e.bytes)throw new TypeError("Invalid DAG-PB form (bad link)");if(!Sr(e,lo))throw new TypeError("Invalid DAG-PB form (extraneous properties on link)");if(e.Hash===void 0)throw new TypeError("Invalid DAG-PB form (link must have a Hash)");if(e.Hash==null||!e.Hash["/"]||e.Hash["/"]!==e.Hash.bytes)throw new TypeError("Invalid DAG-PB form (link Hash must be a CID)");if(e.Name!==void 0&&typeof e.Name!="string")throw new TypeError("Invalid DAG-PB form (link Name must be a string)");if(e.Tsize!==void 0){if(typeof e.Tsize!="number"||e.Tsize%1!==0)throw new TypeError("Invalid DAG-PB form (link Tsize must be an integer)");if(e.Tsize<0)throw new TypeError("Invalid DAG-PB form (link Tsize cannot be negative)")}if(t>0&&Lr(e,r.Links[t-1])===-1)throw new TypeError("Invalid DAG-PB form (links must be sorted by Name bytes)")}}function Tr(r,t=[]){return P({Data:r,Links:t})}function Cr(r,t,e){return Er({Hash:e,Name:r,Tsize:t})}var po="dag-pb",mo=112;function F(r){ge(r);let t={};return r.Links&&(t.Links=r.Links.map(e=>{let n={};return e.Hash&&(n.Hash=e.Hash.bytes),e.Name!==void 0&&(n.Name=e.Name),e.Tsize!==void 0&&(n.Tsize=e.Tsize),n})),r.Data&&(t.Data=r.Data),Dr(t)}function yo(r){let t=vr(r),e={};return t.Data&&(e.Data=t.Data),t.Links&&(e.Links=t.Links.map(n=>{let i={};try{i.Hash=z.decode(n.Hash)}catch{}if(!i.Hash)throw new Error("Invalid Hash field found in link, expected CID");return n.Name!==void 0&&(i.Name=n.Name),n.Tsize!==void 0&&(i.Tsize=n.Tsize),i})),e}var Pe=H(bt(),1);var Te=H(Be(),1),bn=H(hn(),1),xn=H(ot(),1),Ce=H(Ee(),1),_n=H(wn(),1);function ko(){xn.default._configure(),Te.default._configure(bn.default),Ce.default._configure(_n.default)}ko();var Bn=["uint64","int64","sint64","fixed64","sfixed64"];function Do(r){for(let t of Bn){if(r[t]==null)continue;let e=r[t];r[t]=function(){return BigInt(e.call(this).toString())}}return r}function Ne(r){return Do(new Te.default(r))}function So(r){for(let t of Bn){if(r[t]==null)continue;let e=r[t];r[t]=function(n){return e.call(this,n.toString())}}return r}function ze(){return So(Ce.default.create())}function Ct(r,t){let e=Ne(r instanceof Uint8Array?r:r.subarray());return t.decode(e)}function Nt(r,t){let e=ze();return t.encode(r,e,{lengthDelimited:!1}),e.finish()}var wt;(function(r){r[r.VARINT=0]="VARINT",r[r.BIT64=1]="BIT64",r[r.LENGTH_DELIMITED=2]="LENGTH_DELIMITED",r[r.START_GROUP=3]="START_GROUP",r[r.END_GROUP=4]="END_GROUP",r[r.BIT32=5]="BIT32"})(wt||(wt={}));function Jt(r,t,e,n){return{name:r,type:t,encode:e,decode:n}}function Ie(r){function t(i){if(r[i.toString()]==null)throw new Error("Invalid enum value");return r[i]}let e=function(o,s){let f=t(o);s.int32(f)},n=function(o){let s=o.int32();return t(s)};return Jt("enum",wt.VARINT,e,n)}function zt(r,t){return Jt("message",wt.LENGTH_DELIMITED,r,t)}var q;(function(r){let t;(function(i){i.Raw="Raw",i.Directory="Directory",i.File="File",i.Metadata="Metadata",i.Symlink="Symlink",i.HAMTShard="HAMTShard"})(t=r.DataType||(r.DataType={}));let e;(function(i){i[i.Raw=0]="Raw",i[i.Directory=1]="Directory",i[i.File=2]="File",i[i.Metadata=3]="Metadata",i[i.Symlink=4]="Symlink",i[i.HAMTShard=5]="HAMTShard"})(e||(e={})),function(i){i.codec=()=>Ie(e)}(t=r.DataType||(r.DataType={}));let n;r.codec=()=>(n==null&&(n=zt((i,o,s={})=>{if(s.lengthDelimited!==!1&&o.fork(),i.Type!=null&&(o.uint32(8),r.DataType.codec().encode(i.Type,o)),i.Data!=null&&(o.uint32(18),o.bytes(i.Data)),i.filesize!=null&&(o.uint32(24),o.uint64(i.filesize)),i.blocksizes!=null)for(let f of i.blocksizes)o.uint32(32),o.uint64(f);i.hashType!=null&&(o.uint32(40),o.uint64(i.hashType)),i.fanout!=null&&(o.uint32(48),o.uint64(i.fanout)),i.mode!=null&&(o.uint32(56),o.uint32(i.mode)),i.mtime!=null&&(o.uint32(66),Xt.codec().encode(i.mtime,o)),s.lengthDelimited!==!1&&o.ldelim()},(i,o)=>{let s={blocksizes:[]},f=o==null?i.len:i.pos+o;for(;i.pos<f;){let c=i.uint32();switch(c>>>3){case 1:s.Type=r.DataType.codec().decode(i);break;case 2:s.Data=i.bytes();break;case 3:s.filesize=i.uint64();break;case 4:s.blocksizes.push(i.uint64());break;case 5:s.hashType=i.uint64();break;case 6:s.fanout=i.uint64();break;case 7:s.mode=i.uint32();break;case 8:s.mtime=Xt.codec().decode(i,i.uint32());break;default:i.skipType(c&7);break}}return s})),n),r.encode=i=>Nt(i,r.codec()),r.decode=i=>Ct(i,r.codec())})(q||(q={}));var Xt;(function(r){let t;r.codec=()=>(t==null&&(t=zt((e,n,i={})=>{i.lengthDelimited!==!1&&n.fork(),e.Seconds!=null&&(n.uint32(8),n.int64(e.Seconds)),e.FractionalNanoseconds!=null&&(n.uint32(21),n.fixed32(e.FractionalNanoseconds)),i.lengthDelimited!==!1&&n.ldelim()},(e,n)=>{let i={},o=n==null?e.len:e.pos+n;for(;e.pos<o;){let s=e.uint32();switch(s>>>3){case 1:i.Seconds=e.int64();break;case 2:i.FractionalNanoseconds=e.fixed32();break;default:e.skipType(s&7);break}}return i})),t),r.encode=e=>Nt(e,r.codec()),r.decode=e=>Ct(e,r.codec())})(Xt||(Xt={}));var vn;(function(r){let t;r.codec=()=>(t==null&&(t=zt((e,n,i={})=>{i.lengthDelimited!==!1&&n.fork(),e.MimeType!=null&&(n.uint32(10),n.string(e.MimeType)),i.lengthDelimited!==!1&&n.ldelim()},(e,n)=>{let i={},o=n==null?e.len:e.pos+n;for(;e.pos<o;){let s=e.uint32();switch(s>>>3){case 1:i.MimeType=e.string();break;default:e.skipType(s&7);break}}return i})),t),r.encode=e=>Nt(e,r.codec()),r.decode=e=>Ct(e,r.codec())})(vn||(vn={}));var An={Raw:"raw",Directory:"directory",File:"file",Metadata:"metadata",Symlink:"symlink",HAMTShard:"hamt-sharded-directory"},Lo=["directory","hamt-sharded-directory"],kn=parseInt("0644",8),Dn=parseInt("0755",8),I=class r{static unmarshal(t){let e=q.decode(t),n=new r({type:An[e.Type!=null?e.Type.toString():"File"],data:e.Data,blockSizes:e.blocksizes,mode:e.mode,mtime:e.mtime!=null?{secs:e.mtime.Seconds??0n,nsecs:e.mtime.FractionalNanoseconds}:void 0,fanout:e.fanout});return n._originalMode=e.mode??0,n}type;data;blockSizes;hashType;fanout;mtime;_mode;_originalMode;constructor(t={type:"file"}){let{type:e,data:n,blockSizes:i,hashType:o,fanout:s,mtime:f,mode:c}=t;if(e!=null&&!Object.values(An).includes(e))throw(0,Pe.default)(new Error("Type: "+e+" is not valid"),"ERR_INVALID_TYPE");this.type=e??"file",this.data=n,this.hashType=o,this.fanout=s,this.blockSizes=i??[],this._originalMode=0,this.mode=c,this.mtime=f}set mode(t){t==null?this._mode=this.isDirectory()?Dn:kn:this._mode=t&4095}get mode(){return this._mode}isDirectory(){return Lo.includes(this.type)}addBlockSize(t){this.blockSizes.push(t)}removeBlockSize(t){this.blockSizes.splice(t,1)}fileSize(){if(this.isDirectory())return 0n;let t=0n;return this.blockSizes.forEach(e=>{t+=e}),this.data!=null&&(t+=BigInt(this.data.length)),t}marshal(){let t;switch(this.type){case"raw":t=q.DataType.Raw;break;case"directory":t=q.DataType.Directory;break;case"file":t=q.DataType.File;break;case"metadata":t=q.DataType.Metadata;break;case"symlink":t=q.DataType.Symlink;break;case"hamt-sharded-directory":t=q.DataType.HAMTShard;break;default:throw(0,Pe.default)(new Error(`Type: ${t} is not valid`),"ERR_INVALID_TYPE")}let e=this.data;(this.data==null||this.data.length===0)&&(e=void 0);let n;this.mode!=null&&(n=this._originalMode&4294963200|(this.mode??0),n===kn&&!this.isDirectory()&&(n=void 0),n===Dn&&this.isDirectory()&&(n=void 0));let i;return this.mtime!=null&&(i={Seconds:this.mtime.secs,FractionalNanoseconds:this.mtime.nsecs}),q.encode({Type:t,Data:e,filesize:this.isDirectory()?void 0:this.fileSize(),blocksizes:this.blockSizes,hashType:this.hashType,fanout:this.fanout,mode:n,mtime:i})}};var It={};N(It,{code:()=>Qt,decode:()=>Co,encode:()=>To,name:()=>Eo});var Eo="raw",Qt=85,To=r=>U(r),Co=r=>U(r);var X=class extends Event{constructor(t,e){super(t),this.detail=e}};var Me={};N(Me,{sha256:()=>Ue,sha512:()=>No});var at=({name:r,code:t,encode:e})=>new Fe(r,t,e),Fe=class{constructor(t,e,n){this.name=t,this.code=e,this.encode=n}digest(t){if(t instanceof Uint8Array){let e=this.encode(t);return e instanceof Uint8Array?nt(this.code,e):e.then(n=>nt(this.code,n))}else throw Error("Unknown type, must be binary type")}};var Ln=r=>async t=>new Uint8Array(await crypto.subtle.digest(r,t)),Ue=at({name:"sha2-256",code:18,encode:Ln("SHA-256")}),No=at({name:"sha2-512",code:19,encode:Ln("SHA-512")});var G=async(r,t,e)=>{e.codec==null&&(e.codec=Lt);let n=await Ue.digest(r),i=z.create(e.cidVersion,e.codec.code,n);return await t.put(i,r,e),i};function En(r){return async function*(e,n){let i=0n;for await(let o of e.content)yield async()=>{let s,f={codec:Lt,cidVersion:r.cidVersion,onProgress:r.onProgress};r.rawLeaves?(f.codec=It,f.cidVersion=1):(s=new I({type:r.leafType,data:o}),o=F({Data:s.marshal(),Links:[]}));let c=await G(o,n,f);return i+=BigInt(o.byteLength),r.onProgress?.(new X("unixfs:importer:progress:file:write",{bytesWritten:i,cid:c,path:e.path})),{cid:c,unixfs:s,size:BigInt(o.length),block:o}}}}var He=H(bt(),1);var Tn=async(r,t,e)=>{let n=new I({type:"directory",mtime:r.mtime,mode:r.mode}),i=F(P({Data:n.marshal()})),o=await G(i,t,e),s=r.path;return{cid:o,path:s,unixfs:n,size:BigInt(i.length),originalPath:r.originalPath,block:i}};async function*zo(r,t,e){let n=-1,i;for await(let o of _t(e.bufferImporter(r,t),e.blockWriteConcurrency)){if(n++,n===0){i={...o,single:!0};continue}else n===1&&i!=null&&(yield{...i,block:void 0,single:void 0},i=void 0);yield{...o,block:void 0}}i!=null&&(yield i)}function Cn(r){return r.single===!0}var Io=(r,t,e)=>async function(i){if(i.length===1&&Cn(i[0])&&e.reduceSingleLeafToSelf){let u=i[0],y=u.block;return Cn(u)&&(r.mtime!==void 0||r.mode!==void 0)&&(u.unixfs=new I({type:"file",mtime:r.mtime,mode:r.mode,data:u.block}),y={Data:u.unixfs.marshal(),Links:[]},u.block=F(P(y)),u.cid=await G(u.block,t,{...e,cidVersion:e.cidVersion}),u.size=BigInt(u.block.length)),e.onProgress?.(new X("unixfs:importer:progress:file:layout",{cid:u.cid,path:u.originalPath})),{cid:u.cid,path:r.path,unixfs:u.unixfs,size:u.size,originalPath:u.originalPath}}let o=new I({type:"file",mtime:r.mtime,mode:r.mode}),s=i.filter(u=>u.cid.code===Qt&&u.size>0||u.unixfs!=null&&u.unixfs.data==null&&u.unixfs.fileSize()>0n?!0:!!u.unixfs?.data?.length).map(u=>u.cid.code===Qt?(o.addBlockSize(u.size),{Name:"",Tsize:Number(u.size),Hash:u.cid}):(u.unixfs==null||u.unixfs.data==null?o.addBlockSize(u.unixfs?.fileSize()??0n):o.addBlockSize(BigInt(u.unixfs.data.length)),{Name:"",Tsize:Number(u.size),Hash:u.cid})),f={Data:o.marshal(),Links:s},c=F(P(f)),h=await G(c,t,e);return e.onProgress?.(new X("unixfs:importer:progress:file:layout",{cid:h,path:r.originalPath})),{cid:h,path:r.path,unixfs:o,size:BigInt(c.length+f.Links.reduce((u,y)=>u+(y.Tsize??0),0)),originalPath:r.originalPath,block:c}},Nn=async(r,t,e)=>e.layout(zo(r,t,e),Io(r,t,e));function Po(r){return Symbol.iterator in r}function Fo(r){return Symbol.asyncIterator in r}function Uo(r){try{if(r instanceof Uint8Array)return async function*(){yield r}();if(Po(r))return async function*(){yield*r}();if(Fo(r))return r}catch{throw(0,He.default)(new Error("Content was invalid"),"ERR_INVALID_CONTENT")}throw(0,He.default)(new Error("Content was invalid"),"ERR_INVALID_CONTENT")}function zn(r){return async function*(e,n){for await(let i of e){let o;if(i.path!=null&&(o=i.path,i.path=i.path.split("/").filter(s=>s!=null&&s!==".").join("/")),Mo(i)){let s={path:i.path,mtime:i.mtime,mode:i.mode,content:async function*(){let f=0n;for await(let c of r.chunker(r.chunkValidator(Uo(i.content)))){let h=BigInt(c.byteLength);f+=h,r.onProgress?.(new X("unixfs:importer:progress:file:read",{bytesRead:f,chunkSize:h,path:i.path})),yield c}}(),originalPath:o};yield async()=>Nn(s,n,r)}else if(i.path!=null){let s={path:i.path,mtime:i.mtime,mode:i.mode,originalPath:o};yield async()=>Tn(s,n,r)}else throw new Error("Import candidate must have content or path or both")}}}function Mo(r){return r.content!=null}var Qe=H(bt(),1);var Oe={};N(Oe,{identity:()=>Ho});var Ho=pt({prefix:"\0",name:"identity",encode:r=>ae(r),decode:r=>se(r)});var Re={};N(Re,{base2:()=>Oo});var Oo=S({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1});var Ve={};N(Ve,{base8:()=>Ro});var Ro=S({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3});var qe={};N(qe,{base10:()=>Vo});var Vo=Q({prefix:"9",name:"base10",alphabet:"0123456789"});var Ge={};N(Ge,{base16:()=>qo,base16upper:()=>Go});var qo=S({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),Go=S({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4});var je={};N(je,{base36:()=>jo,base36upper:()=>$o});var jo=Q({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),$o=Q({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"});var $e={};N($e,{base64:()=>Wo,base64pad:()=>Ko,base64url:()=>Jo,base64urlpad:()=>Xo});var Wo=S({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),Ko=S({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),Jo=S({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),Xo=S({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6});var We={};N(We,{base256emoji:()=>es});var In=Array.from("\u{1F680}\u{1FA90}\u2604\u{1F6F0}\u{1F30C}\u{1F311}\u{1F312}\u{1F313}\u{1F314}\u{1F315}\u{1F316}\u{1F317}\u{1F318}\u{1F30D}\u{1F30F}\u{1F30E}\u{1F409}\u2600\u{1F4BB}\u{1F5A5}\u{1F4BE}\u{1F4BF}\u{1F602}\u2764\u{1F60D}\u{1F923}\u{1F60A}\u{1F64F}\u{1F495}\u{1F62D}\u{1F618}\u{1F44D}\u{1F605}\u{1F44F}\u{1F601}\u{1F525}\u{1F970}\u{1F494}\u{1F496}\u{1F499}\u{1F622}\u{1F914}\u{1F606}\u{1F644}\u{1F4AA}\u{1F609}\u263A\u{1F44C}\u{1F917}\u{1F49C}\u{1F614}\u{1F60E}\u{1F607}\u{1F339}\u{1F926}\u{1F389}\u{1F49E}\u270C\u2728\u{1F937}\u{1F631}\u{1F60C}\u{1F338}\u{1F64C}\u{1F60B}\u{1F497}\u{1F49A}\u{1F60F}\u{1F49B}\u{1F642}\u{1F493}\u{1F929}\u{1F604}\u{1F600}\u{1F5A4}\u{1F603}\u{1F4AF}\u{1F648}\u{1F447}\u{1F3B6}\u{1F612}\u{1F92D}\u2763\u{1F61C}\u{1F48B}\u{1F440}\u{1F62A}\u{1F611}\u{1F4A5}\u{1F64B}\u{1F61E}\u{1F629}\u{1F621}\u{1F92A}\u{1F44A}\u{1F973}\u{1F625}\u{1F924}\u{1F449}\u{1F483}\u{1F633}\u270B\u{1F61A}\u{1F61D}\u{1F634}\u{1F31F}\u{1F62C}\u{1F643}\u{1F340}\u{1F337}\u{1F63B}\u{1F613}\u2B50\u2705\u{1F97A}\u{1F308}\u{1F608}\u{1F918}\u{1F4A6}\u2714\u{1F623}\u{1F3C3}\u{1F490}\u2639\u{1F38A}\u{1F498}\u{1F620}\u261D\u{1F615}\u{1F33A}\u{1F382}\u{1F33B}\u{1F610}\u{1F595}\u{1F49D}\u{1F64A}\u{1F639}\u{1F5E3}\u{1F4AB}\u{1F480}\u{1F451}\u{1F3B5}\u{1F91E}\u{1F61B}\u{1F534}\u{1F624}\u{1F33C}\u{1F62B}\u26BD\u{1F919}\u2615\u{1F3C6}\u{1F92B}\u{1F448}\u{1F62E}\u{1F646}\u{1F37B}\u{1F343}\u{1F436}\u{1F481}\u{1F632}\u{1F33F}\u{1F9E1}\u{1F381}\u26A1\u{1F31E}\u{1F388}\u274C\u270A\u{1F44B}\u{1F630}\u{1F928}\u{1F636}\u{1F91D}\u{1F6B6}\u{1F4B0}\u{1F353}\u{1F4A2}\u{1F91F}\u{1F641}\u{1F6A8}\u{1F4A8}\u{1F92C}\u2708\u{1F380}\u{1F37A}\u{1F913}\u{1F619}\u{1F49F}\u{1F331}\u{1F616}\u{1F476}\u{1F974}\u25B6\u27A1\u2753\u{1F48E}\u{1F4B8}\u2B07\u{1F628}\u{1F31A}\u{1F98B}\u{1F637}\u{1F57A}\u26A0\u{1F645}\u{1F61F}\u{1F635}\u{1F44E}\u{1F932}\u{1F920}\u{1F927}\u{1F4CC}\u{1F535}\u{1F485}\u{1F9D0}\u{1F43E}\u{1F352}\u{1F617}\u{1F911}\u{1F30A}\u{1F92F}\u{1F437}\u260E\u{1F4A7}\u{1F62F}\u{1F486}\u{1F446}\u{1F3A4}\u{1F647}\u{1F351}\u2744\u{1F334}\u{1F4A3}\u{1F438}\u{1F48C}\u{1F4CD}\u{1F940}\u{1F922}\u{1F445}\u{1F4A1}\u{1F4A9}\u{1F450}\u{1F4F8}\u{1F47B}\u{1F910}\u{1F92E}\u{1F3BC}\u{1F975}\u{1F6A9}\u{1F34E}\u{1F34A}\u{1F47C}\u{1F48D}\u{1F4E3}\u{1F942}"),Qo=In.reduce((r,t,e)=>(r[e]=t,r),[]),Zo=In.reduce((r,t,e)=>(r[t.codePointAt(0)]=e,r),[]);function Yo(r){return r.reduce((t,e)=>(t+=Qo[e],t),"")}function ts(r){let t=[];for(let e of r){let n=Zo[e.codePointAt(0)];if(n===void 0)throw new Error(`Non-base256emoji character: ${e}`);t.push(n)}return new Uint8Array(t)}var es=pt({prefix:"\u{1F680}",name:"base256emoji",encode:Yo,decode:ts});var Ke={};N(Ke,{identity:()=>is});var Pn=0,rs="identity",Fn=U,ns=r=>nt(Pn,Fn(r)),is={code:Pn,name:rs,encode:Fn,digest:ns};var Sc=new TextEncoder,Lc=new TextDecoder;var Je={...Oe,...Re,...Ve,...qe,...Ge,...de,...je,...le,...$e,...We},zc={...Me,...Ke};function Mn(r,t,e,n){return{name:r,prefix:t,encoder:{name:r,prefix:t,encode:e},decoder:{decode:n}}}var Un=Mn("utf8","u",r=>"u"+new TextDecoder("utf8").decode(r),r=>new TextEncoder().encode(r.substring(1))),Xe=Mn("ascii","a",r=>{let t="a";for(let e=0;e<r.length;e++)t+=String.fromCharCode(r[e]);return t},r=>{r=r.substring(1);let t=rt(r.length);for(let e=0;e<r.length;e++)t[e]=r.charCodeAt(e);return t}),ss={utf8:Un,"utf-8":Un,hex:Je.base16,latin1:Xe,ascii:Xe,binary:Xe,...Je},Hn=ss;function Zt(r,t="utf8"){let e=Hn[t];if(e==null)throw new Error(`Unsupported encoding "${t}"`);return(t==="utf8"||t==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?et(globalThis.Buffer.from(r,"utf-8")):e.decoder.decode(`${e.prefix}${r}`)}var On=()=>async function*(t){for await(let e of t){if(e.length===void 0)throw(0,Qe.default)(new Error("Content was invalid"),"ERR_INVALID_CONTENT");if(typeof e=="string"||e instanceof String)yield Zt(e.toString());else if(Array.isArray(e))yield Uint8Array.from(e);else if(e instanceof Uint8Array)yield e;else throw(0,Qe.default)(new Error("Content was invalid"),"ERR_INVALID_CONTENT")}};var as=174;function Ze(r){let t=r?.maxChildrenPerNode??as;return async function e(n,i){let o=[];for await(let s of xt(n,t))o.push(await i(s));return o.length>1?e(o,i):o[0]}}var W=class{options;root;dir;path;dirty;flat;parent;parentKey;unixfs;mode;mtime;cid;size;nodeSize;constructor(t,e){this.options=e??{},this.root=t.root,this.dir=t.dir,this.path=t.path,this.dirty=t.dirty,this.flat=t.flat,this.parent=t.parent,this.parentKey=t.parentKey,this.unixfs=t.unixfs,this.mode=t.mode,this.mtime=t.mtime}},Pt=z.parse("QmUNLLsPACCz1vLxQVkXqqLX5R1X345qqfHbsf67hvA3Nn"),Ft=z.parse("zdj7WbTaiJT1fgatdet9Ei9iDB5hdCxkbVyhyh8YTUnXMiwYi");var ct=class extends W{_children;constructor(t,e){super(t,e),this._children=new Map}async put(t,e){this.cid=void 0,this.size=void 0,this.nodeSize=void 0,this._children.set(t,e)}async get(t){return Promise.resolve(this._children.get(t))}childCount(){return this._children.size}directChildrenCount(){return this.childCount()}onlyChild(){return this._children.values().next().value}async*eachChildSeries(){for(let[t,e]of this._children.entries())yield{key:t,child:e}}estimateNodeSize(){if(this.nodeSize!==void 0)return this.nodeSize;this.nodeSize=0;for(let[t,e]of this._children.entries())e.size!=null&&e.cid!=null&&(this.nodeSize+=t.length+(this.options.cidVersion===1?Ft.bytes.byteLength:Pt.bytes.byteLength));return this.nodeSize}async*flush(t){let e=[];for(let[c,h]of this._children.entries()){let u=h;if(h instanceof W)for await(let y of h.flush(t))u=y,yield y;u.size!=null&&u.cid!=null&&e.push({Name:c,Tsize:Number(u.size),Hash:u.cid})}let n=new I({type:"directory",mtime:this.mtime,mode:this.mode}),i={Data:n.marshal(),Links:e},o=F(P(i)),s=await G(o,t,this.options),f=o.length+i.Links.reduce((c,h)=>c+(h.Tsize==null?0:h.Tsize),0);this.cid=s,this.size=f,yield{cid:s,unixfs:n,path:this.path,size:BigInt(f)}}};var te=H(qn(),1);function cs(r){let t=new Array(4);for(let e=0;e<4;e++)t[e]=r&255,r=r>>8;return new Uint8Array(t)}var pf=at({name:"murmur3-32",code:35,encode:r=>cs(te.default.x86.hash32(r))}),Gn=at({name:"murmur3-128",code:34,encode:r=>lt.fromHex(te.default.x64.hash128(r))}),mf=at({name:"murmur3-x64-64",code:34,encode:r=>lt.fromHex(te.default.x64.hash128(r)).subarray(0,8)});var Kn=H(Wn(),1);var tt=class r{constructor(t,e,n=0){this._options=t,this._popCount=0,this._parent=e,this._posAtParent=n,this._children=new Kn.default,this.key=null}async put(t,e){let n=await this._findNewBucketAndPos(t);await n.bucket._putAt(n,t,e)}async get(t){let e=await this._findChild(t);if(e!=null)return e.value}async del(t){let e=await this._findPlace(t),n=e.bucket._at(e.pos);n!=null&&n.key===t&&e.bucket._delAt(e.pos)}leafCount(){return this._children.compactArray().reduce((e,n)=>n instanceof r?e+n.leafCount():e+1,0)}childrenCount(){return this._children.length}onlyChild(){return this._children.get(0)}*eachLeafSeries(){let t=this._children.compactArray();for(let e of t)e instanceof r?yield*e.eachLeafSeries():yield e}serialize(t,e){let n=[];return e(this._children.reduce((i,o,s)=>(o!=null&&(o instanceof r?i.push(o.serialize(t,e)):i.push(t(o,s))),i),n))}async asyncTransform(t,e){return await Jn(this,t,e)}toJSON(){return this.serialize(ds,ps)}prettyPrint(){return JSON.stringify(this.toJSON(),null,"  ")}tableSize(){return Math.pow(2,this._options.bits)}async _findChild(t){let e=await this._findPlace(t),n=e.bucket._at(e.pos);if(!(n instanceof r)&&n!=null&&n.key===t)return n}async _findPlace(t){let e=this._options.hash(typeof t=="string"?Zt(t):t),n=await e.take(this._options.bits),i=this._children.get(n);return i instanceof r?await i._findPlace(e):{bucket:this,pos:n,hash:e,existingChild:i}}async _findNewBucketAndPos(t){let e=await this._findPlace(t);if(e.existingChild!=null&&e.existingChild.key!==t){let n=new r(this._options,e.bucket,e.pos);e.bucket._putObjectAt(e.pos,n);let i=await n._findPlace(e.existingChild.hash);return i.bucket._putAt(i,e.existingChild.key,e.existingChild.value),await n._findNewBucketAndPos(e.hash)}return e}_putAt(t,e,n){this._putObjectAt(t.pos,{key:e,value:n,hash:t.hash})}_putObjectAt(t,e){this._children.get(t)==null&&this._popCount++,this._children.set(t,e)}_delAt(t){if(t===-1)throw new Error("Invalid position");this._children.get(t)!=null&&this._popCount--,this._children.unset(t),this._level()}_level(){if(this._parent!=null&&this._popCount<=1)if(this._popCount===1){let t=this._children.find(ls);if(t!=null&&!(t instanceof r)){let e=t.hash;e.untake(this._options.bits);let n={pos:this._posAtParent,hash:e,bucket:this._parent};this._parent._putAt(n,t.key,t.value)}}else this._parent._delAt(this._posAtParent)}_at(t){return this._children.get(t)}};function ls(r){return!!r}function ds(r,t){return r.key}function ps(r){return r}async function Jn(r,t,e){let n=[];for(let i of r._children.compactArray())if(i instanceof tt)await Jn(i,t,e);else{let o=await t(i);n.push({bitField:r._children.bitField(),children:o})}return await e(n)}var ms=[255,254,252,248,240,224,192,128],ys=[1,3,7,15,31,63,127,255],ee=class{constructor(t){this._value=t,this._currentBytePos=t.length-1,this._currentBitPos=7}availableBits(){return this._currentBitPos+1+this._currentBytePos*8}totalBits(){return this._value.length*8}take(t){let e=t,n=0;for(;e>0&&this._haveBits();){let i=this._value[this._currentBytePos],o=this._currentBitPos+1,s=Math.min(o,e),f=gs(i,o-s,s);n=(n<<s)+f,e-=s,this._currentBitPos-=s,this._currentBitPos<0&&(this._currentBitPos=7,this._currentBytePos--)}return n}untake(t){for(this._currentBitPos+=t;this._currentBitPos>7;)this._currentBitPos-=8,this._currentBytePos+=1}_haveBits(){return this._currentBytePos>=0}};function gs(r,t,e){let n=ws(t,e);return(r&n)>>>t}function ws(r,t){return ms[r]&ys[Math.min(t+r-1,7)]}function Xn(r){function t(e){return e instanceof re?e:new re(e,r)}return t}var re=class{constructor(t,e){if(!(t instanceof Uint8Array))throw new Error("can only hash Uint8Arrays");this._value=t,this._hashFn=e,this._depth=-1,this._availableBits=0,this._currentBufferIndex=0,this._buffers=[]}async take(t){let e=t;for(;this._availableBits<e;)await this._produceMoreBits();let n=0;for(;e>0;){let i=this._buffers[this._currentBufferIndex],o=Math.min(i.availableBits(),e),s=i.take(o);n=(n<<o)+s,e-=o,this._availableBits-=o,i.availableBits()===0&&this._currentBufferIndex++}return n}untake(t){let e=t;for(;e>0;){let n=this._buffers[this._currentBufferIndex],i=Math.min(n.totalBits()-n.availableBits(),e);n.untake(i),e-=i,this._availableBits+=i,this._currentBufferIndex>0&&n.totalBits()===n.availableBits()&&(this._depth--,this._currentBufferIndex--)}}async _produceMoreBits(){this._depth++;let t=this._depth>0?Bt([this._value,Uint8Array.from([this._depth])]):this._value,e=await this._hashFn(t),n=new ee(e);this._buffers.push(n),this._availableBits+=n.availableBits()}};function Qn(r){if(r==null||r.hashFn==null)throw new Error("please define an options.hashFn");let t={bits:r.bits??8,hash:Xn(r.hashFn)};return new tt(t)}async function bs(r){return(await Gn.encode(r)).slice(0,8).reverse()}var Zn=BigInt(34),xs=8,Ye=class extends W{_bucket;constructor(t,e){super(t,e),this._bucket=Qn({hashFn:bs,bits:e.shardFanoutBits??xs})}async put(t,e){this.cid=void 0,this.size=void 0,this.nodeSize=void 0,await this._bucket.put(t,e)}async get(t){return this._bucket.get(t)}childCount(){return this._bucket.leafCount()}directChildrenCount(){return this._bucket.childrenCount()}onlyChild(){return this._bucket.onlyChild()}async*eachChildSeries(){for await(let{key:t,value:e}of this._bucket.eachLeafSeries())yield{key:t,child:e}}estimateNodeSize(){return this.nodeSize!==void 0?this.nodeSize:(this.nodeSize=ei(this._bucket,this,this.options),this.nodeSize)}async*flush(t){for await(let e of ti(this._bucket,t,this,this.options))yield{...e,path:this.path}}},Yn=Ye;async function*ti(r,t,e,n){let i=r._children,o=(r.tableSize()-1).toString(16).length,s=[],f=0n;for(let l=0;l<i.length;l++){let p=i.get(l);if(p==null)continue;let E=l.toString(16).toUpperCase().padStart(o,"0");if(p instanceof tt){let d;for await(let m of ti(p,t,null,n))d=m;if(d==null)throw new Error("Could not flush sharded directory, no subshard found");s.push({Name:E,Tsize:Number(d.size),Hash:d.cid}),f+=d.size}else if(_s(p.value)){let d=p.value,m;for await(let b of d.flush(t))m=b,yield m;if(m==null)throw new Error("Did not flush dir");let g=E+p.key;s.push({Name:g,Tsize:Number(m.size),Hash:m.cid}),f+=m.size}else{let d=p.value;if(d.cid==null)continue;let m=E+p.key,g=d.size;s.push({Name:m,Tsize:Number(g),Hash:d.cid}),f+=BigInt(g??0)}}let c=Uint8Array.from(i.bitField().reverse()),h=new I({type:"hamt-sharded-directory",data:c,fanout:BigInt(r.tableSize()),hashType:Zn,mtime:e?.mtime,mode:e?.mode}),u={Data:h.marshal(),Links:s},y=F(P(u)),k=await G(y,t,n),a=BigInt(y.byteLength)+f;yield{cid:k,unixfs:h,size:a}}function _s(r){return typeof r.flush=="function"}function ei(r,t,e){let n=r._children,i=(r.tableSize()-1).toString(16).length,o=[];for(let h=0;h<n.length;h++){let u=n.get(h);if(u==null)continue;let y=h.toString(16).toUpperCase().padStart(i,"0");if(u instanceof tt){let k=ei(u,null,e);o.push({Name:y,Tsize:Number(k),Hash:e.cidVersion===0?Pt:Ft})}else if(typeof u.value.flush=="function"){let a=u.value.nodeSize();o.push({Name:y+u.key,Tsize:Number(a),Hash:e.cidVersion===0?Pt:Ft})}else{let k=u.value;if(k.cid==null)continue;let a=y+u.key,l=k.size;o.push({Name:a,Tsize:Number(l),Hash:k.cid})}}let s=Uint8Array.from(n.bitField().reverse()),f=new I({type:"hamt-sharded-directory",data:s,fanout:BigInt(r.tableSize()),hashType:Zn,mtime:t?.mtime,mode:t?.mode});return F(P({Data:f.marshal(),Links:o})).length}async function tr(r,t,e,n){let i=t;t instanceof ct&&t.estimateNodeSize()>e&&(i=await Bs(t,n));let o=i.parent;if(o!=null){if(i!==t){if(r!=null&&(r.parent=i),i.parentKey==null)throw new Error("No parent key found");await o.put(i.parentKey,i)}return tr(i,o,e,n)}return i}async function Bs(r,t){let e=new Yn({root:r.root,dir:!0,parent:r.parent,parentKey:r.parentKey,path:r.path,dirty:r.dirty,flat:!1,mtime:r.mtime,mode:r.mode},t);for await(let{key:n,child:i}of r.eachChildSeries())await e.put(n,i);return e}var ri=(r="")=>r.split(/(?<!\\)\//).filter(Boolean);async function vs(r,t,e){let n=ri(r.path??""),i=n.length-1,o=t,s="";for(let f=0;f<n.length;f++){let c=n[f];s+=`${s!==""?"/":""}${c}`;let h=f===i;if(o.dirty=!0,o.cid=void 0,o.size=void 0,h)await o.put(c,r),t=await tr(null,o,e.shardSplitThresholdBytes,e);else{let u=await o.get(c);(u==null||!(u instanceof W))&&(u=new ct({root:!1,dir:!0,parent:o,parentKey:c,path:s,dirty:!0,flat:!0,mtime:u?.unixfs?.mtime,mode:u?.unixfs?.mode},e)),await o.put(c,u),o=u}}return t}async function*ni(r,t){if(!(r instanceof W)){r.unixfs?.isDirectory()===!0&&(yield r);return}yield*r.flush(t)}function ii(r){return async function*(e,n){let i=new ct({root:!0,dir:!0,path:"",dirty:!0,flat:!0},r),o,s=!1;for await(let f of e){if(f==null)continue;let c=`${f.originalPath??""}`.split("/")[0];c!=null&&c!==""&&(o==null?(o=c,s=!0):o!==c&&(s=!1)),i=await vs(f,i,r),(f.unixfs==null||!f.unixfs.isDirectory())&&(yield f)}if(r.wrapWithDirectory||s&&i.childCount()>1)yield*ni(i,n);else for await(let f of i.eachChildSeries())f!=null&&(yield*ni(f.child,n))}}async function*rr(r,t,e={}){let n;Symbol.asyncIterator in r||Symbol.iterator in r?n=r:n=[r];let i=e.wrapWithDirectory??!1,o=e.shardSplitThresholdBytes??262144,s=e.shardFanoutBits??8,f=e.cidVersion??1,c=e.rawLeaves??!0,h=e.leafType??"file",u=e.fileImportConcurrency??50,y=e.blockWriteConcurrency??10,k=e.reduceSingleLeafToSelf??!0,a=e.chunker??ur(),l=e.chunkValidator??On(),p=e.dagBuilder??zn({chunker:a,chunkValidator:l,wrapWithDirectory:i,layout:e.layout??Ze(),bufferImporter:e.bufferImporter??En({cidVersion:f,rawLeaves:c,leafType:h,onProgress:e.onProgress}),blockWriteConcurrency:y,reduceSingleLeafToSelf:k,cidVersion:f,onProgress:e.onProgress}),E=e.treeBuilder??ii({wrapWithDirectory:i,shardSplitThresholdBytes:o,shardFanoutBits:s,cidVersion:f,onProgress:e.onProgress});for await(let d of E(_t(p(n,t),u),t))yield{cid:d.cid,path:d.path,unixfs:d.unixfs,size:d.size}}async function nr(r,t,e={}){let n=await ne(rr([r],t,e));if(n==null)throw(0,er.default)(new Error("Nothing imported"),"ERR_INVALID_PARAMS");return n}async function As(r,t,e={}){let n=await ne(rr([r],t,e));if(n==null)throw(0,er.default)(new Error("Nothing imported"),"ERR_INVALID_PARAMS");return n}async function ks(r,t,e={}){return nr({content:r},t,e)}async function Ds(r,t,e={}){return nr({content:r},t,e)}return ui(Ss);})();
return IpfsUnixfsImporter}));
