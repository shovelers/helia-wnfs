(function (root, factory) {(typeof module === 'object' && module.exports) ? module.exports = factory() : root.Libp2PKeychain = factory()}(typeof self !== 'undefined' ? self : this, function () {
"use strict";var Libp2PKeychain=(()=>{var Wc=Object.create;var mn=Object.defineProperty;var Zc=Object.getOwnPropertyDescriptor;var Qc=Object.getOwnPropertyNames;var Xc=Object.getPrototypeOf,Jc=Object.prototype.hasOwnProperty;var j=(t,e)=>()=>(e||t((e={exports:{}}).exports,e),e.exports),It=(t,e)=>{for(var r in e)mn(t,r,{get:e[r],enumerable:!0})},co=(t,e,r,n)=>{if(e&&typeof e=="object"||typeof e=="function")for(let i of Qc(e))!Jc.call(t,i)&&i!==r&&mn(t,i,{get:()=>e[i],enumerable:!(n=Zc(e,i))||n.enumerable});return t};var Bt=(t,e,r)=>(r=t!=null?Wc(Xc(t)):{},co(e||!t||!t.__esModule?mn(r,"default",{value:t,enumerable:!0}):r,t)),jc=t=>co(mn({},"__esModule",{value:!0}),t);var ot=j((d1,fo)=>{fo.exports={options:{usePureJavaScript:!1}}});var lo=j((p1,ho)=>{var xi={};ho.exports=xi;var uo={};xi.encode=function(t,e,r){if(typeof e!="string")throw new TypeError('"alphabet" must be a string.');if(r!==void 0&&typeof r!="number")throw new TypeError('"maxline" must be a number.');var n="";if(!(t instanceof Uint8Array))n=tf(t,e);else{var i=0,s=e.length,a=e.charAt(0),o=[0];for(i=0;i<t.length;++i){for(var c=0,f=t[i];c<o.length;++c)f+=o[c]<<8,o[c]=f%s,f=f/s|0;for(;f>0;)o.push(f%s),f=f/s|0}for(i=0;t[i]===0&&i<t.length-1;++i)n+=a;for(i=o.length-1;i>=0;--i)n+=e[o[i]]}if(r){var u=new RegExp(".{1,"+r+"}","g");n=n.match(u).join(`\r
`)}return n};xi.decode=function(t,e){if(typeof t!="string")throw new TypeError('"input" must be a string.');if(typeof e!="string")throw new TypeError('"alphabet" must be a string.');var r=uo[e];if(!r){r=uo[e]=[];for(var n=0;n<e.length;++n)r[e.charCodeAt(n)]=n}t=t.replace(/\s/g,"");for(var i=e.length,s=e.charAt(0),a=[0],n=0;n<t.length;n++){var o=r[t.charCodeAt(n)];if(o===void 0)return;for(var c=0,f=o;c<a.length;++c)f+=a[c]*i,a[c]=f&255,f>>=8;for(;f>0;)a.push(f&255),f>>=8}for(var u=0;t[u]===s&&u<t.length-1;++u)a.push(0);return typeof Buffer<"u"?Buffer.from(a.reverse()):new Uint8Array(a.reverse())};function tf(t,e){var r=0,n=e.length,i=e.charAt(0),s=[0];for(r=0;r<t.length();++r){for(var a=0,o=t.at(r);a<s.length;++a)o+=s[a]<<8,s[a]=o%n,o=o/n|0;for(;o>0;)s.push(o%n),o=o/n|0}var c="";for(r=0;t.at(r)===0&&r<t.length()-1;++r)c+=i;for(r=s.length-1;r>=0;--r)c+=e[s[r]];return c}});var Et=j((y1,xo)=>{var po=ot(),yo=lo(),x=xo.exports=po.util=po.util||{};(function(){if(typeof process<"u"&&process.nextTick&&!process.browser){x.nextTick=process.nextTick,typeof setImmediate=="function"?x.setImmediate=setImmediate:x.setImmediate=x.nextTick;return}if(typeof setImmediate=="function"){x.setImmediate=function(){return setImmediate.apply(void 0,arguments)},x.nextTick=function(o){return setImmediate(o)};return}if(x.setImmediate=function(o){setTimeout(o,0)},typeof window<"u"&&typeof window.postMessage=="function"){let o=function(c){if(c.source===window&&c.data===t){c.stopPropagation();var f=e.slice();e.length=0,f.forEach(function(u){u()})}};var a=o,t="forge.setImmediate",e=[];x.setImmediate=function(c){e.push(c),e.length===1&&window.postMessage(t,"*")},window.addEventListener("message",o,!0)}if(typeof MutationObserver<"u"){var r=Date.now(),n=!0,i=document.createElement("div"),e=[];new MutationObserver(function(){var c=e.slice();e.length=0,c.forEach(function(f){f()})}).observe(i,{attributes:!0});var s=x.setImmediate;x.setImmediate=function(c){Date.now()-r>15?(r=Date.now(),s(c)):(e.push(c),e.length===1&&i.setAttribute("a",n=!n))}}x.nextTick=x.setImmediate})();x.isNodejs=typeof process<"u"&&process.versions&&process.versions.node;x.globalScope=function(){return x.isNodejs?globalThis:typeof self>"u"?window:self}();x.isArray=Array.isArray||function(t){return Object.prototype.toString.call(t)==="[object Array]"};x.isArrayBuffer=function(t){return typeof ArrayBuffer<"u"&&t instanceof ArrayBuffer};x.isArrayBufferView=function(t){return t&&x.isArrayBuffer(t.buffer)&&t.byteLength!==void 0};function zr(t){if(!(t===8||t===16||t===24||t===32))throw new Error("Only 8, 16, 24, or 32 bits supported: "+t)}x.ByteBuffer=mi;function mi(t){if(this.data="",this.read=0,typeof t=="string")this.data=t;else if(x.isArrayBuffer(t)||x.isArrayBufferView(t))if(typeof Buffer<"u"&&t instanceof Buffer)this.data=t.toString("binary");else{var e=new Uint8Array(t);try{this.data=String.fromCharCode.apply(null,e)}catch{for(var r=0;r<e.length;++r)this.putByte(e[r])}}else(t instanceof mi||typeof t=="object"&&typeof t.data=="string"&&typeof t.read=="number")&&(this.data=t.data,this.read=t.read);this._constructedStringLength=0}x.ByteStringBuffer=mi;var ef=4096;x.ByteStringBuffer.prototype._optimizeConstructedString=function(t){this._constructedStringLength+=t,this._constructedStringLength>ef&&(this.data.substr(0,1),this._constructedStringLength=0)};x.ByteStringBuffer.prototype.length=function(){return this.data.length-this.read};x.ByteStringBuffer.prototype.isEmpty=function(){return this.length()<=0};x.ByteStringBuffer.prototype.putByte=function(t){return this.putBytes(String.fromCharCode(t))};x.ByteStringBuffer.prototype.fillWithByte=function(t,e){t=String.fromCharCode(t);for(var r=this.data;e>0;)e&1&&(r+=t),e>>>=1,e>0&&(t+=t);return this.data=r,this._optimizeConstructedString(e),this};x.ByteStringBuffer.prototype.putBytes=function(t){return this.data+=t,this._optimizeConstructedString(t.length),this};x.ByteStringBuffer.prototype.putString=function(t){return this.putBytes(x.encodeUtf8(t))};x.ByteStringBuffer.prototype.putInt16=function(t){return this.putBytes(String.fromCharCode(t>>8&255)+String.fromCharCode(t&255))};x.ByteStringBuffer.prototype.putInt24=function(t){return this.putBytes(String.fromCharCode(t>>16&255)+String.fromCharCode(t>>8&255)+String.fromCharCode(t&255))};x.ByteStringBuffer.prototype.putInt32=function(t){return this.putBytes(String.fromCharCode(t>>24&255)+String.fromCharCode(t>>16&255)+String.fromCharCode(t>>8&255)+String.fromCharCode(t&255))};x.ByteStringBuffer.prototype.putInt16Le=function(t){return this.putBytes(String.fromCharCode(t&255)+String.fromCharCode(t>>8&255))};x.ByteStringBuffer.prototype.putInt24Le=function(t){return this.putBytes(String.fromCharCode(t&255)+String.fromCharCode(t>>8&255)+String.fromCharCode(t>>16&255))};x.ByteStringBuffer.prototype.putInt32Le=function(t){return this.putBytes(String.fromCharCode(t&255)+String.fromCharCode(t>>8&255)+String.fromCharCode(t>>16&255)+String.fromCharCode(t>>24&255))};x.ByteStringBuffer.prototype.putInt=function(t,e){zr(e);var r="";do e-=8,r+=String.fromCharCode(t>>e&255);while(e>0);return this.putBytes(r)};x.ByteStringBuffer.prototype.putSignedInt=function(t,e){return t<0&&(t+=2<<e-1),this.putInt(t,e)};x.ByteStringBuffer.prototype.putBuffer=function(t){return this.putBytes(t.getBytes())};x.ByteStringBuffer.prototype.getByte=function(){return this.data.charCodeAt(this.read++)};x.ByteStringBuffer.prototype.getInt16=function(){var t=this.data.charCodeAt(this.read)<<8^this.data.charCodeAt(this.read+1);return this.read+=2,t};x.ByteStringBuffer.prototype.getInt24=function(){var t=this.data.charCodeAt(this.read)<<16^this.data.charCodeAt(this.read+1)<<8^this.data.charCodeAt(this.read+2);return this.read+=3,t};x.ByteStringBuffer.prototype.getInt32=function(){var t=this.data.charCodeAt(this.read)<<24^this.data.charCodeAt(this.read+1)<<16^this.data.charCodeAt(this.read+2)<<8^this.data.charCodeAt(this.read+3);return this.read+=4,t};x.ByteStringBuffer.prototype.getInt16Le=function(){var t=this.data.charCodeAt(this.read)^this.data.charCodeAt(this.read+1)<<8;return this.read+=2,t};x.ByteStringBuffer.prototype.getInt24Le=function(){var t=this.data.charCodeAt(this.read)^this.data.charCodeAt(this.read+1)<<8^this.data.charCodeAt(this.read+2)<<16;return this.read+=3,t};x.ByteStringBuffer.prototype.getInt32Le=function(){var t=this.data.charCodeAt(this.read)^this.data.charCodeAt(this.read+1)<<8^this.data.charCodeAt(this.read+2)<<16^this.data.charCodeAt(this.read+3)<<24;return this.read+=4,t};x.ByteStringBuffer.prototype.getInt=function(t){zr(t);var e=0;do e=(e<<8)+this.data.charCodeAt(this.read++),t-=8;while(t>0);return e};x.ByteStringBuffer.prototype.getSignedInt=function(t){var e=this.getInt(t),r=2<<t-2;return e>=r&&(e-=r<<1),e};x.ByteStringBuffer.prototype.getBytes=function(t){var e;return t?(t=Math.min(this.length(),t),e=this.data.slice(this.read,this.read+t),this.read+=t):t===0?e="":(e=this.read===0?this.data:this.data.slice(this.read),this.clear()),e};x.ByteStringBuffer.prototype.bytes=function(t){return typeof t>"u"?this.data.slice(this.read):this.data.slice(this.read,this.read+t)};x.ByteStringBuffer.prototype.at=function(t){return this.data.charCodeAt(this.read+t)};x.ByteStringBuffer.prototype.setAt=function(t,e){return this.data=this.data.substr(0,this.read+t)+String.fromCharCode(e)+this.data.substr(this.read+t+1),this};x.ByteStringBuffer.prototype.last=function(){return this.data.charCodeAt(this.data.length-1)};x.ByteStringBuffer.prototype.copy=function(){var t=x.createBuffer(this.data);return t.read=this.read,t};x.ByteStringBuffer.prototype.compact=function(){return this.read>0&&(this.data=this.data.slice(this.read),this.read=0),this};x.ByteStringBuffer.prototype.clear=function(){return this.data="",this.read=0,this};x.ByteStringBuffer.prototype.truncate=function(t){var e=Math.max(0,this.length()-t);return this.data=this.data.substr(this.read,e),this.read=0,this};x.ByteStringBuffer.prototype.toHex=function(){for(var t="",e=this.read;e<this.data.length;++e){var r=this.data.charCodeAt(e);r<16&&(t+="0"),t+=r.toString(16)}return t};x.ByteStringBuffer.prototype.toString=function(){return x.decodeUtf8(this.bytes())};function rf(t,e){e=e||{},this.read=e.readOffset||0,this.growSize=e.growSize||1024;var r=x.isArrayBuffer(t),n=x.isArrayBufferView(t);if(r||n){r?this.data=new DataView(t):this.data=new DataView(t.buffer,t.byteOffset,t.byteLength),this.write="writeOffset"in e?e.writeOffset:this.data.byteLength;return}this.data=new DataView(new ArrayBuffer(0)),this.write=0,t!=null&&this.putBytes(t),"writeOffset"in e&&(this.write=e.writeOffset)}x.DataBuffer=rf;x.DataBuffer.prototype.length=function(){return this.write-this.read};x.DataBuffer.prototype.isEmpty=function(){return this.length()<=0};x.DataBuffer.prototype.accommodate=function(t,e){if(this.length()>=t)return this;e=Math.max(e||this.growSize,t);var r=new Uint8Array(this.data.buffer,this.data.byteOffset,this.data.byteLength),n=new Uint8Array(this.length()+e);return n.set(r),this.data=new DataView(n.buffer),this};x.DataBuffer.prototype.putByte=function(t){return this.accommodate(1),this.data.setUint8(this.write++,t),this};x.DataBuffer.prototype.fillWithByte=function(t,e){this.accommodate(e);for(var r=0;r<e;++r)this.data.setUint8(t);return this};x.DataBuffer.prototype.putBytes=function(t,e){if(x.isArrayBufferView(t)){var r=new Uint8Array(t.buffer,t.byteOffset,t.byteLength),n=r.byteLength-r.byteOffset;this.accommodate(n);var i=new Uint8Array(this.data.buffer,this.write);return i.set(r),this.write+=n,this}if(x.isArrayBuffer(t)){var r=new Uint8Array(t);this.accommodate(r.byteLength);var i=new Uint8Array(this.data.buffer);return i.set(r,this.write),this.write+=r.byteLength,this}if(t instanceof x.DataBuffer||typeof t=="object"&&typeof t.read=="number"&&typeof t.write=="number"&&x.isArrayBufferView(t.data)){var r=new Uint8Array(t.data.byteLength,t.read,t.length());this.accommodate(r.byteLength);var i=new Uint8Array(t.data.byteLength,this.write);return i.set(r),this.write+=r.byteLength,this}if(t instanceof x.ByteStringBuffer&&(t=t.data,e="binary"),e=e||"binary",typeof t=="string"){var s;if(e==="hex")return this.accommodate(Math.ceil(t.length/2)),s=new Uint8Array(this.data.buffer,this.write),this.write+=x.binary.hex.decode(t,s,this.write),this;if(e==="base64")return this.accommodate(Math.ceil(t.length/4)*3),s=new Uint8Array(this.data.buffer,this.write),this.write+=x.binary.base64.decode(t,s,this.write),this;if(e==="utf8"&&(t=x.encodeUtf8(t),e="binary"),e==="binary"||e==="raw")return this.accommodate(t.length),s=new Uint8Array(this.data.buffer,this.write),this.write+=x.binary.raw.decode(s),this;if(e==="utf16")return this.accommodate(t.length*2),s=new Uint16Array(this.data.buffer,this.write),this.write+=x.text.utf16.encode(s),this;throw new Error("Invalid encoding: "+e)}throw Error("Invalid parameter: "+t)};x.DataBuffer.prototype.putBuffer=function(t){return this.putBytes(t),t.clear(),this};x.DataBuffer.prototype.putString=function(t){return this.putBytes(t,"utf16")};x.DataBuffer.prototype.putInt16=function(t){return this.accommodate(2),this.data.setInt16(this.write,t),this.write+=2,this};x.DataBuffer.prototype.putInt24=function(t){return this.accommodate(3),this.data.setInt16(this.write,t>>8&65535),this.data.setInt8(this.write,t>>16&255),this.write+=3,this};x.DataBuffer.prototype.putInt32=function(t){return this.accommodate(4),this.data.setInt32(this.write,t),this.write+=4,this};x.DataBuffer.prototype.putInt16Le=function(t){return this.accommodate(2),this.data.setInt16(this.write,t,!0),this.write+=2,this};x.DataBuffer.prototype.putInt24Le=function(t){return this.accommodate(3),this.data.setInt8(this.write,t>>16&255),this.data.setInt16(this.write,t>>8&65535,!0),this.write+=3,this};x.DataBuffer.prototype.putInt32Le=function(t){return this.accommodate(4),this.data.setInt32(this.write,t,!0),this.write+=4,this};x.DataBuffer.prototype.putInt=function(t,e){zr(e),this.accommodate(e/8);do e-=8,this.data.setInt8(this.write++,t>>e&255);while(e>0);return this};x.DataBuffer.prototype.putSignedInt=function(t,e){return zr(e),this.accommodate(e/8),t<0&&(t+=2<<e-1),this.putInt(t,e)};x.DataBuffer.prototype.getByte=function(){return this.data.getInt8(this.read++)};x.DataBuffer.prototype.getInt16=function(){var t=this.data.getInt16(this.read);return this.read+=2,t};x.DataBuffer.prototype.getInt24=function(){var t=this.data.getInt16(this.read)<<8^this.data.getInt8(this.read+2);return this.read+=3,t};x.DataBuffer.prototype.getInt32=function(){var t=this.data.getInt32(this.read);return this.read+=4,t};x.DataBuffer.prototype.getInt16Le=function(){var t=this.data.getInt16(this.read,!0);return this.read+=2,t};x.DataBuffer.prototype.getInt24Le=function(){var t=this.data.getInt8(this.read)^this.data.getInt16(this.read+1,!0)<<8;return this.read+=3,t};x.DataBuffer.prototype.getInt32Le=function(){var t=this.data.getInt32(this.read,!0);return this.read+=4,t};x.DataBuffer.prototype.getInt=function(t){zr(t);var e=0;do e=(e<<8)+this.data.getInt8(this.read++),t-=8;while(t>0);return e};x.DataBuffer.prototype.getSignedInt=function(t){var e=this.getInt(t),r=2<<t-2;return e>=r&&(e-=r<<1),e};x.DataBuffer.prototype.getBytes=function(t){var e;return t?(t=Math.min(this.length(),t),e=this.data.slice(this.read,this.read+t),this.read+=t):t===0?e="":(e=this.read===0?this.data:this.data.slice(this.read),this.clear()),e};x.DataBuffer.prototype.bytes=function(t){return typeof t>"u"?this.data.slice(this.read):this.data.slice(this.read,this.read+t)};x.DataBuffer.prototype.at=function(t){return this.data.getUint8(this.read+t)};x.DataBuffer.prototype.setAt=function(t,e){return this.data.setUint8(t,e),this};x.DataBuffer.prototype.last=function(){return this.data.getUint8(this.write-1)};x.DataBuffer.prototype.copy=function(){return new x.DataBuffer(this)};x.DataBuffer.prototype.compact=function(){if(this.read>0){var t=new Uint8Array(this.data.buffer,this.read),e=new Uint8Array(t.byteLength);e.set(t),this.data=new DataView(e),this.write-=this.read,this.read=0}return this};x.DataBuffer.prototype.clear=function(){return this.data=new DataView(new ArrayBuffer(0)),this.read=this.write=0,this};x.DataBuffer.prototype.truncate=function(t){return this.write=Math.max(0,this.length()-t),this.read=Math.min(this.read,this.write),this};x.DataBuffer.prototype.toHex=function(){for(var t="",e=this.read;e<this.data.byteLength;++e){var r=this.data.getUint8(e);r<16&&(t+="0"),t+=r.toString(16)}return t};x.DataBuffer.prototype.toString=function(t){var e=new Uint8Array(this.data,this.read,this.length());if(t=t||"utf8",t==="binary"||t==="raw")return x.binary.raw.encode(e);if(t==="hex")return x.binary.hex.encode(e);if(t==="base64")return x.binary.base64.encode(e);if(t==="utf8")return x.text.utf8.decode(e);if(t==="utf16")return x.text.utf16.decode(e);throw new Error("Invalid encoding: "+t)};x.createBuffer=function(t,e){return e=e||"raw",t!==void 0&&e==="utf8"&&(t=x.encodeUtf8(t)),new x.ByteBuffer(t)};x.fillString=function(t,e){for(var r="";e>0;)e&1&&(r+=t),e>>>=1,e>0&&(t+=t);return r};x.xorBytes=function(t,e,r){for(var n="",i="",s="",a=0,o=0;r>0;--r,++a)i=t.charCodeAt(a)^e.charCodeAt(a),o>=10&&(n+=s,s="",o=0),s+=String.fromCharCode(i),++o;return n+=s,n};x.hexToBytes=function(t){var e="",r=0;for(t.length&!0&&(r=1,e+=String.fromCharCode(parseInt(t[0],16)));r<t.length;r+=2)e+=String.fromCharCode(parseInt(t.substr(r,2),16));return e};x.bytesToHex=function(t){return x.createBuffer(t).toHex()};x.int32ToBytes=function(t){return String.fromCharCode(t>>24&255)+String.fromCharCode(t>>16&255)+String.fromCharCode(t>>8&255)+String.fromCharCode(t&255)};var Re="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",Le=[62,-1,-1,-1,63,52,53,54,55,56,57,58,59,60,61,-1,-1,-1,64,-1,-1,-1,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,-1,-1,-1,-1,-1,-1,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51],go="123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz";x.encode64=function(t,e){for(var r="",n="",i,s,a,o=0;o<t.length;)i=t.charCodeAt(o++),s=t.charCodeAt(o++),a=t.charCodeAt(o++),r+=Re.charAt(i>>2),r+=Re.charAt((i&3)<<4|s>>4),isNaN(s)?r+="==":(r+=Re.charAt((s&15)<<2|a>>6),r+=isNaN(a)?"=":Re.charAt(a&63)),e&&r.length>e&&(n+=r.substr(0,e)+`\r
`,r=r.substr(e));return n+=r,n};x.decode64=function(t){t=t.replace(/[^A-Za-z0-9\+\/\=]/g,"");for(var e="",r,n,i,s,a=0;a<t.length;)r=Le[t.charCodeAt(a++)-43],n=Le[t.charCodeAt(a++)-43],i=Le[t.charCodeAt(a++)-43],s=Le[t.charCodeAt(a++)-43],e+=String.fromCharCode(r<<2|n>>4),i!==64&&(e+=String.fromCharCode((n&15)<<4|i>>2),s!==64&&(e+=String.fromCharCode((i&3)<<6|s)));return e};x.encodeUtf8=function(t){return unescape(encodeURIComponent(t))};x.decodeUtf8=function(t){return decodeURIComponent(escape(t))};x.binary={raw:{},hex:{},base64:{},base58:{},baseN:{encode:yo.encode,decode:yo.decode}};x.binary.raw.encode=function(t){return String.fromCharCode.apply(null,t)};x.binary.raw.decode=function(t,e,r){var n=e;n||(n=new Uint8Array(t.length)),r=r||0;for(var i=r,s=0;s<t.length;++s)n[i++]=t.charCodeAt(s);return e?i-r:n};x.binary.hex.encode=x.bytesToHex;x.binary.hex.decode=function(t,e,r){var n=e;n||(n=new Uint8Array(Math.ceil(t.length/2))),r=r||0;var i=0,s=r;for(t.length&1&&(i=1,n[s++]=parseInt(t[0],16));i<t.length;i+=2)n[s++]=parseInt(t.substr(i,2),16);return e?s-r:n};x.binary.base64.encode=function(t,e){for(var r="",n="",i,s,a,o=0;o<t.byteLength;)i=t[o++],s=t[o++],a=t[o++],r+=Re.charAt(i>>2),r+=Re.charAt((i&3)<<4|s>>4),isNaN(s)?r+="==":(r+=Re.charAt((s&15)<<2|a>>6),r+=isNaN(a)?"=":Re.charAt(a&63)),e&&r.length>e&&(n+=r.substr(0,e)+`\r
`,r=r.substr(e));return n+=r,n};x.binary.base64.decode=function(t,e,r){var n=e;n||(n=new Uint8Array(Math.ceil(t.length/4)*3)),t=t.replace(/[^A-Za-z0-9\+\/\=]/g,""),r=r||0;for(var i,s,a,o,c=0,f=r;c<t.length;)i=Le[t.charCodeAt(c++)-43],s=Le[t.charCodeAt(c++)-43],a=Le[t.charCodeAt(c++)-43],o=Le[t.charCodeAt(c++)-43],n[f++]=i<<2|s>>4,a!==64&&(n[f++]=(s&15)<<4|a>>2,o!==64&&(n[f++]=(a&3)<<6|o));return e?f-r:n.subarray(0,f)};x.binary.base58.encode=function(t,e){return x.binary.baseN.encode(t,go,e)};x.binary.base58.decode=function(t,e){return x.binary.baseN.decode(t,go,e)};x.text={utf8:{},utf16:{}};x.text.utf8.encode=function(t,e,r){t=x.encodeUtf8(t);var n=e;n||(n=new Uint8Array(t.length)),r=r||0;for(var i=r,s=0;s<t.length;++s)n[i++]=t.charCodeAt(s);return e?i-r:n};x.text.utf8.decode=function(t){return x.decodeUtf8(String.fromCharCode.apply(null,t))};x.text.utf16.encode=function(t,e,r){var n=e;n||(n=new Uint8Array(t.length*2));var i=new Uint16Array(n.buffer);r=r||0;for(var s=r,a=r,o=0;o<t.length;++o)i[a++]=t.charCodeAt(o),s+=2;return e?s-r:n};x.text.utf16.decode=function(t){return String.fromCharCode.apply(null,new Uint16Array(t.buffer))};x.deflate=function(t,e,r){if(e=x.decode64(t.deflate(x.encode64(e)).rval),r){var n=2,i=e.charCodeAt(1);i&32&&(n=6),e=e.substring(n,e.length-4)}return e};x.inflate=function(t,e,r){var n=t.inflate(x.encode64(e)).rval;return n===null?null:x.decode64(n)};var vi=function(t,e,r){if(!t)throw new Error("WebStorage not available.");var n;if(r===null?n=t.removeItem(e):(r=x.encode64(JSON.stringify(r)),n=t.setItem(e,r)),typeof n<"u"&&n.rval!==!0){var i=new Error(n.error.message);throw i.id=n.error.id,i.name=n.error.name,i}},bi=function(t,e){if(!t)throw new Error("WebStorage not available.");var r=t.getItem(e);if(t.init)if(r.rval===null){if(r.error){var n=new Error(r.error.message);throw n.id=r.error.id,n.name=r.error.name,n}r=null}else r=r.rval;return r!==null&&(r=JSON.parse(x.decode64(r))),r},nf=function(t,e,r,n){var i=bi(t,e);i===null&&(i={}),i[r]=n,vi(t,e,i)},sf=function(t,e,r){var n=bi(t,e);return n!==null&&(n=r in n?n[r]:null),n},of=function(t,e,r){var n=bi(t,e);if(n!==null&&r in n){delete n[r];var i=!0;for(var s in n){i=!1;break}i&&(n=null),vi(t,e,n)}},af=function(t,e){vi(t,e,null)},vn=function(t,e,r){var n=null;typeof r>"u"&&(r=["web","flash"]);var i,s=!1,a=null;for(var o in r){i=r[o];try{if(i==="flash"||i==="both"){if(e[0]===null)throw new Error("Flash local storage not available.");n=t.apply(this,e),s=i==="flash"}(i==="web"||i==="both")&&(e[0]=localStorage,n=t.apply(this,e),s=!0)}catch(c){a=c}if(s)break}if(!s)throw a;return n};x.setItem=function(t,e,r,n,i){vn(nf,arguments,i)};x.getItem=function(t,e,r,n){return vn(sf,arguments,n)};x.removeItem=function(t,e,r,n){vn(of,arguments,n)};x.clearItems=function(t,e,r){vn(af,arguments,r)};x.isEmpty=function(t){for(var e in t)if(t.hasOwnProperty(e))return!1;return!0};x.format=function(t){for(var e=/%./g,r,n,i=0,s=[],a=0;r=e.exec(t);){n=t.substring(a,e.lastIndex-2),n.length>0&&s.push(n),a=e.lastIndex;var o=r[0][1];switch(o){case"s":case"o":i<arguments.length?s.push(arguments[i+++1]):s.push("<?>");break;case"%":s.push("%");break;default:s.push("<%"+o+"?>")}}return s.push(t.substring(a)),s.join("")};x.formatNumber=function(t,e,r,n){var i=t,s=isNaN(e=Math.abs(e))?2:e,a=r===void 0?",":r,o=n===void 0?".":n,c=i<0?"-":"",f=parseInt(i=Math.abs(+i||0).toFixed(s),10)+"",u=f.length>3?f.length%3:0;return c+(u?f.substr(0,u)+o:"")+f.substr(u).replace(/(\d{3})(?=\d)/g,"$1"+o)+(s?a+Math.abs(i-f).toFixed(s).slice(2):"")};x.formatSize=function(t){return t>=1073741824?t=x.formatNumber(t/1073741824,2,".","")+" GiB":t>=1048576?t=x.formatNumber(t/1048576,2,".","")+" MiB":t>=1024?t=x.formatNumber(t/1024,0)+" KiB":t=x.formatNumber(t,0)+" bytes",t};x.bytesFromIP=function(t){return t.indexOf(".")!==-1?x.bytesFromIPv4(t):t.indexOf(":")!==-1?x.bytesFromIPv6(t):null};x.bytesFromIPv4=function(t){if(t=t.split("."),t.length!==4)return null;for(var e=x.createBuffer(),r=0;r<t.length;++r){var n=parseInt(t[r],10);if(isNaN(n))return null;e.putByte(n)}return e.getBytes()};x.bytesFromIPv6=function(t){var e=0;t=t.split(":").filter(function(a){return a.length===0&&++e,!0});for(var r=(8-t.length+e)*2,n=x.createBuffer(),i=0;i<8;++i){if(!t[i]||t[i].length===0){n.fillWithByte(0,r),r=0;continue}var s=x.hexToBytes(t[i]);s.length<2&&n.putByte(0),n.putBytes(s)}return n.getBytes()};x.bytesToIP=function(t){return t.length===4?x.bytesToIPv4(t):t.length===16?x.bytesToIPv6(t):null};x.bytesToIPv4=function(t){if(t.length!==4)return null;for(var e=[],r=0;r<t.length;++r)e.push(t.charCodeAt(r));return e.join(".")};x.bytesToIPv6=function(t){if(t.length!==16)return null;for(var e=[],r=[],n=0,i=0;i<t.length;i+=2){for(var s=x.bytesToHex(t[i]+t[i+1]);s[0]==="0"&&s!=="0";)s=s.substr(1);if(s==="0"){var a=r[r.length-1],o=e.length;!a||o!==a.end+1?r.push({start:o,end:o}):(a.end=o,a.end-a.start>r[n].end-r[n].start&&(n=r.length-1))}e.push(s)}if(r.length>0){var c=r[n];c.end-c.start>0&&(e.splice(c.start,c.end-c.start+1,""),c.start===0&&e.unshift(""),c.end===7&&e.push(""))}return e.join(":")};x.estimateCores=function(t,e){if(typeof t=="function"&&(e=t,t={}),t=t||{},"cores"in x&&!t.update)return e(null,x.cores);if(typeof navigator<"u"&&"hardwareConcurrency"in navigator&&navigator.hardwareConcurrency>0)return x.cores=navigator.hardwareConcurrency,e(null,x.cores);if(typeof Worker>"u")return x.cores=1,e(null,x.cores);if(typeof Blob>"u")return x.cores=2,e(null,x.cores);var r=URL.createObjectURL(new Blob(["(",function(){self.addEventListener("message",function(a){for(var o=Date.now(),c=o+4;Date.now()<c;);self.postMessage({st:o,et:c})})}.toString(),")()"],{type:"application/javascript"}));n([],5,16);function n(a,o,c){if(o===0){var f=Math.floor(a.reduce(function(u,h){return u+h},0)/a.length);return x.cores=Math.max(1,f),URL.revokeObjectURL(r),e(null,x.cores)}i(c,function(u,h){a.push(s(c,h)),n(a,o-1,c)})}function i(a,o){for(var c=[],f=[],u=0;u<a;++u){var h=new Worker(r);h.addEventListener("message",function(l){if(f.push(l.data),f.length===a){for(var g=0;g<a;++g)c[g].terminate();o(null,f)}}),c.push(h)}for(var u=0;u<a;++u)c[u].postMessage(u)}function s(a,o){for(var c=[],f=0;f<a;++f)for(var u=o[f],h=c[f]=[],l=0;l<a;++l)if(f!==l){var g=o[l];(u.st>g.st&&u.st<g.et||g.st>u.st&&g.st<u.et)&&h.push(l)}return c.reduce(function(d,p){return Math.max(d,p.length)},0)}}});var wi=j((g1,mo)=>{var Tt=ot();Et();mo.exports=Tt.cipher=Tt.cipher||{};Tt.cipher.algorithms=Tt.cipher.algorithms||{};Tt.cipher.createCipher=function(t,e){var r=t;if(typeof r=="string"&&(r=Tt.cipher.getAlgorithm(r),r&&(r=r())),!r)throw new Error("Unsupported algorithm: "+t);return new Tt.cipher.BlockCipher({algorithm:r,key:e,decrypt:!1})};Tt.cipher.createDecipher=function(t,e){var r=t;if(typeof r=="string"&&(r=Tt.cipher.getAlgorithm(r),r&&(r=r())),!r)throw new Error("Unsupported algorithm: "+t);return new Tt.cipher.BlockCipher({algorithm:r,key:e,decrypt:!0})};Tt.cipher.registerAlgorithm=function(t,e){t=t.toUpperCase(),Tt.cipher.algorithms[t]=e};Tt.cipher.getAlgorithm=function(t){return t=t.toUpperCase(),t in Tt.cipher.algorithms?Tt.cipher.algorithms[t]:null};var Ei=Tt.cipher.BlockCipher=function(t){this.algorithm=t.algorithm,this.mode=this.algorithm.mode,this.blockSize=this.mode.blockSize,this._finish=!1,this._input=null,this.output=null,this._op=t.decrypt?this.mode.decrypt:this.mode.encrypt,this._decrypt=t.decrypt,this.algorithm.initialize(t)};Ei.prototype.start=function(t){t=t||{};var e={};for(var r in t)e[r]=t[r];e.decrypt=this._decrypt,this._finish=!1,this._input=Tt.util.createBuffer(),this.output=t.output||Tt.util.createBuffer(),this.mode.start(e)};Ei.prototype.update=function(t){for(t&&this._input.putBuffer(t);!this._op.call(this.mode,this._input,this.output,this._finish)&&!this._finish;);this._input.compact()};Ei.prototype.finish=function(t){t&&(this.mode.name==="ECB"||this.mode.name==="CBC")&&(this.mode.pad=function(r){return t(this.blockSize,r,!1)},this.mode.unpad=function(r){return t(this.blockSize,r,!0)});var e={};return e.decrypt=this._decrypt,e.overflow=this._input.length()%this.blockSize,!(!this._decrypt&&this.mode.pad&&!this.mode.pad(this._input,e)||(this._finish=!0,this.update(),this._decrypt&&this.mode.unpad&&!this.mode.unpad(this.output,e))||this.mode.afterFinish&&!this.mode.afterFinish(this.output,e))}});var Bi=j((x1,vo)=>{var _t=ot();Et();_t.cipher=_t.cipher||{};var Z=vo.exports=_t.cipher.modes=_t.cipher.modes||{};Z.ecb=function(t){t=t||{},this.name="ECB",this.cipher=t.cipher,this.blockSize=t.blockSize||16,this._ints=this.blockSize/4,this._inBlock=new Array(this._ints),this._outBlock=new Array(this._ints)};Z.ecb.prototype.start=function(t){};Z.ecb.prototype.encrypt=function(t,e,r){if(t.length()<this.blockSize&&!(r&&t.length()>0))return!0;for(var n=0;n<this._ints;++n)this._inBlock[n]=t.getInt32();this.cipher.encrypt(this._inBlock,this._outBlock);for(var n=0;n<this._ints;++n)e.putInt32(this._outBlock[n])};Z.ecb.prototype.decrypt=function(t,e,r){if(t.length()<this.blockSize&&!(r&&t.length()>0))return!0;for(var n=0;n<this._ints;++n)this._inBlock[n]=t.getInt32();this.cipher.decrypt(this._inBlock,this._outBlock);for(var n=0;n<this._ints;++n)e.putInt32(this._outBlock[n])};Z.ecb.prototype.pad=function(t,e){var r=t.length()===this.blockSize?this.blockSize:this.blockSize-t.length();return t.fillWithByte(r,r),!0};Z.ecb.prototype.unpad=function(t,e){if(e.overflow>0)return!1;var r=t.length(),n=t.at(r-1);return n>this.blockSize<<2?!1:(t.truncate(n),!0)};Z.cbc=function(t){t=t||{},this.name="CBC",this.cipher=t.cipher,this.blockSize=t.blockSize||16,this._ints=this.blockSize/4,this._inBlock=new Array(this._ints),this._outBlock=new Array(this._ints)};Z.cbc.prototype.start=function(t){if(t.iv===null){if(!this._prev)throw new Error("Invalid IV parameter.");this._iv=this._prev.slice(0)}else if("iv"in t)this._iv=bn(t.iv,this.blockSize),this._prev=this._iv.slice(0);else throw new Error("Invalid IV parameter.")};Z.cbc.prototype.encrypt=function(t,e,r){if(t.length()<this.blockSize&&!(r&&t.length()>0))return!0;for(var n=0;n<this._ints;++n)this._inBlock[n]=this._prev[n]^t.getInt32();this.cipher.encrypt(this._inBlock,this._outBlock);for(var n=0;n<this._ints;++n)e.putInt32(this._outBlock[n]);this._prev=this._outBlock};Z.cbc.prototype.decrypt=function(t,e,r){if(t.length()<this.blockSize&&!(r&&t.length()>0))return!0;for(var n=0;n<this._ints;++n)this._inBlock[n]=t.getInt32();this.cipher.decrypt(this._inBlock,this._outBlock);for(var n=0;n<this._ints;++n)e.putInt32(this._prev[n]^this._outBlock[n]);this._prev=this._inBlock.slice(0)};Z.cbc.prototype.pad=function(t,e){var r=t.length()===this.blockSize?this.blockSize:this.blockSize-t.length();return t.fillWithByte(r,r),!0};Z.cbc.prototype.unpad=function(t,e){if(e.overflow>0)return!1;var r=t.length(),n=t.at(r-1);return n>this.blockSize<<2?!1:(t.truncate(n),!0)};Z.cfb=function(t){t=t||{},this.name="CFB",this.cipher=t.cipher,this.blockSize=t.blockSize||16,this._ints=this.blockSize/4,this._inBlock=null,this._outBlock=new Array(this._ints),this._partialBlock=new Array(this._ints),this._partialOutput=_t.util.createBuffer(),this._partialBytes=0};Z.cfb.prototype.start=function(t){if(!("iv"in t))throw new Error("Invalid IV parameter.");this._iv=bn(t.iv,this.blockSize),this._inBlock=this._iv.slice(0),this._partialBytes=0};Z.cfb.prototype.encrypt=function(t,e,r){var n=t.length();if(n===0)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),this._partialBytes===0&&n>=this.blockSize){for(var i=0;i<this._ints;++i)this._inBlock[i]=t.getInt32()^this._outBlock[i],e.putInt32(this._inBlock[i]);return}var s=(this.blockSize-n)%this.blockSize;s>0&&(s=this.blockSize-s),this._partialOutput.clear();for(var i=0;i<this._ints;++i)this._partialBlock[i]=t.getInt32()^this._outBlock[i],this._partialOutput.putInt32(this._partialBlock[i]);if(s>0)t.read-=this.blockSize;else for(var i=0;i<this._ints;++i)this._inBlock[i]=this._partialBlock[i];if(this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),s>0&&!r)return e.putBytes(this._partialOutput.getBytes(s-this._partialBytes)),this._partialBytes=s,!0;e.putBytes(this._partialOutput.getBytes(n-this._partialBytes)),this._partialBytes=0};Z.cfb.prototype.decrypt=function(t,e,r){var n=t.length();if(n===0)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),this._partialBytes===0&&n>=this.blockSize){for(var i=0;i<this._ints;++i)this._inBlock[i]=t.getInt32(),e.putInt32(this._inBlock[i]^this._outBlock[i]);return}var s=(this.blockSize-n)%this.blockSize;s>0&&(s=this.blockSize-s),this._partialOutput.clear();for(var i=0;i<this._ints;++i)this._partialBlock[i]=t.getInt32(),this._partialOutput.putInt32(this._partialBlock[i]^this._outBlock[i]);if(s>0)t.read-=this.blockSize;else for(var i=0;i<this._ints;++i)this._inBlock[i]=this._partialBlock[i];if(this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),s>0&&!r)return e.putBytes(this._partialOutput.getBytes(s-this._partialBytes)),this._partialBytes=s,!0;e.putBytes(this._partialOutput.getBytes(n-this._partialBytes)),this._partialBytes=0};Z.ofb=function(t){t=t||{},this.name="OFB",this.cipher=t.cipher,this.blockSize=t.blockSize||16,this._ints=this.blockSize/4,this._inBlock=null,this._outBlock=new Array(this._ints),this._partialOutput=_t.util.createBuffer(),this._partialBytes=0};Z.ofb.prototype.start=function(t){if(!("iv"in t))throw new Error("Invalid IV parameter.");this._iv=bn(t.iv,this.blockSize),this._inBlock=this._iv.slice(0),this._partialBytes=0};Z.ofb.prototype.encrypt=function(t,e,r){var n=t.length();if(t.length()===0)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),this._partialBytes===0&&n>=this.blockSize){for(var i=0;i<this._ints;++i)e.putInt32(t.getInt32()^this._outBlock[i]),this._inBlock[i]=this._outBlock[i];return}var s=(this.blockSize-n)%this.blockSize;s>0&&(s=this.blockSize-s),this._partialOutput.clear();for(var i=0;i<this._ints;++i)this._partialOutput.putInt32(t.getInt32()^this._outBlock[i]);if(s>0)t.read-=this.blockSize;else for(var i=0;i<this._ints;++i)this._inBlock[i]=this._outBlock[i];if(this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),s>0&&!r)return e.putBytes(this._partialOutput.getBytes(s-this._partialBytes)),this._partialBytes=s,!0;e.putBytes(this._partialOutput.getBytes(n-this._partialBytes)),this._partialBytes=0};Z.ofb.prototype.decrypt=Z.ofb.prototype.encrypt;Z.ctr=function(t){t=t||{},this.name="CTR",this.cipher=t.cipher,this.blockSize=t.blockSize||16,this._ints=this.blockSize/4,this._inBlock=null,this._outBlock=new Array(this._ints),this._partialOutput=_t.util.createBuffer(),this._partialBytes=0};Z.ctr.prototype.start=function(t){if(!("iv"in t))throw new Error("Invalid IV parameter.");this._iv=bn(t.iv,this.blockSize),this._inBlock=this._iv.slice(0),this._partialBytes=0};Z.ctr.prototype.encrypt=function(t,e,r){var n=t.length();if(n===0)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),this._partialBytes===0&&n>=this.blockSize)for(var i=0;i<this._ints;++i)e.putInt32(t.getInt32()^this._outBlock[i]);else{var s=(this.blockSize-n)%this.blockSize;s>0&&(s=this.blockSize-s),this._partialOutput.clear();for(var i=0;i<this._ints;++i)this._partialOutput.putInt32(t.getInt32()^this._outBlock[i]);if(s>0&&(t.read-=this.blockSize),this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),s>0&&!r)return e.putBytes(this._partialOutput.getBytes(s-this._partialBytes)),this._partialBytes=s,!0;e.putBytes(this._partialOutput.getBytes(n-this._partialBytes)),this._partialBytes=0}En(this._inBlock)};Z.ctr.prototype.decrypt=Z.ctr.prototype.encrypt;Z.gcm=function(t){t=t||{},this.name="GCM",this.cipher=t.cipher,this.blockSize=t.blockSize||16,this._ints=this.blockSize/4,this._inBlock=new Array(this._ints),this._outBlock=new Array(this._ints),this._partialOutput=_t.util.createBuffer(),this._partialBytes=0,this._R=3774873600};Z.gcm.prototype.start=function(t){if(!("iv"in t))throw new Error("Invalid IV parameter.");var e=_t.util.createBuffer(t.iv);this._cipherLength=0;var r;if("additionalData"in t?r=_t.util.createBuffer(t.additionalData):r=_t.util.createBuffer(),"tagLength"in t?this._tagLength=t.tagLength:this._tagLength=128,this._tag=null,t.decrypt&&(this._tag=_t.util.createBuffer(t.tag).getBytes(),this._tag.length!==this._tagLength/8))throw new Error("Authentication tag does not match tag length.");this._hashBlock=new Array(this._ints),this.tag=null,this._hashSubkey=new Array(this._ints),this.cipher.encrypt([0,0,0,0],this._hashSubkey),this.componentBits=4,this._m=this.generateHashTable(this._hashSubkey,this.componentBits);var n=e.length();if(n===12)this._j0=[e.getInt32(),e.getInt32(),e.getInt32(),1];else{for(this._j0=[0,0,0,0];e.length()>0;)this._j0=this.ghash(this._hashSubkey,this._j0,[e.getInt32(),e.getInt32(),e.getInt32(),e.getInt32()]);this._j0=this.ghash(this._hashSubkey,this._j0,[0,0].concat(Si(n*8)))}this._inBlock=this._j0.slice(0),En(this._inBlock),this._partialBytes=0,r=_t.util.createBuffer(r),this._aDataLength=Si(r.length()*8);var i=r.length()%this.blockSize;for(i&&r.fillWithByte(0,this.blockSize-i),this._s=[0,0,0,0];r.length()>0;)this._s=this.ghash(this._hashSubkey,this._s,[r.getInt32(),r.getInt32(),r.getInt32(),r.getInt32()])};Z.gcm.prototype.encrypt=function(t,e,r){var n=t.length();if(n===0)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),this._partialBytes===0&&n>=this.blockSize){for(var i=0;i<this._ints;++i)e.putInt32(this._outBlock[i]^=t.getInt32());this._cipherLength+=this.blockSize}else{var s=(this.blockSize-n)%this.blockSize;s>0&&(s=this.blockSize-s),this._partialOutput.clear();for(var i=0;i<this._ints;++i)this._partialOutput.putInt32(t.getInt32()^this._outBlock[i]);if(s<=0||r){if(r){var a=n%this.blockSize;this._cipherLength+=a,this._partialOutput.truncate(this.blockSize-a)}else this._cipherLength+=this.blockSize;for(var i=0;i<this._ints;++i)this._outBlock[i]=this._partialOutput.getInt32();this._partialOutput.read-=this.blockSize}if(this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),s>0&&!r)return t.read-=this.blockSize,e.putBytes(this._partialOutput.getBytes(s-this._partialBytes)),this._partialBytes=s,!0;e.putBytes(this._partialOutput.getBytes(n-this._partialBytes)),this._partialBytes=0}this._s=this.ghash(this._hashSubkey,this._s,this._outBlock),En(this._inBlock)};Z.gcm.prototype.decrypt=function(t,e,r){var n=t.length();if(n<this.blockSize&&!(r&&n>0))return!0;this.cipher.encrypt(this._inBlock,this._outBlock),En(this._inBlock),this._hashBlock[0]=t.getInt32(),this._hashBlock[1]=t.getInt32(),this._hashBlock[2]=t.getInt32(),this._hashBlock[3]=t.getInt32(),this._s=this.ghash(this._hashSubkey,this._s,this._hashBlock);for(var i=0;i<this._ints;++i)e.putInt32(this._outBlock[i]^this._hashBlock[i]);n<this.blockSize?this._cipherLength+=n%this.blockSize:this._cipherLength+=this.blockSize};Z.gcm.prototype.afterFinish=function(t,e){var r=!0;e.decrypt&&e.overflow&&t.truncate(this.blockSize-e.overflow),this.tag=_t.util.createBuffer();var n=this._aDataLength.concat(Si(this._cipherLength*8));this._s=this.ghash(this._hashSubkey,this._s,n);var i=[];this.cipher.encrypt(this._j0,i);for(var s=0;s<this._ints;++s)this.tag.putInt32(this._s[s]^i[s]);return this.tag.truncate(this.tag.length()%(this._tagLength/8)),e.decrypt&&this.tag.bytes()!==this._tag&&(r=!1),r};Z.gcm.prototype.multiply=function(t,e){for(var r=[0,0,0,0],n=e.slice(0),i=0;i<128;++i){var s=t[i/32|0]&1<<31-i%32;s&&(r[0]^=n[0],r[1]^=n[1],r[2]^=n[2],r[3]^=n[3]),this.pow(n,n)}return r};Z.gcm.prototype.pow=function(t,e){for(var r=t[3]&1,n=3;n>0;--n)e[n]=t[n]>>>1|(t[n-1]&1)<<31;e[0]=t[0]>>>1,r&&(e[0]^=this._R)};Z.gcm.prototype.tableMultiply=function(t){for(var e=[0,0,0,0],r=0;r<32;++r){var n=r/8|0,i=t[n]>>>(7-r%8)*4&15,s=this._m[r][i];e[0]^=s[0],e[1]^=s[1],e[2]^=s[2],e[3]^=s[3]}return e};Z.gcm.prototype.ghash=function(t,e,r){return e[0]^=r[0],e[1]^=r[1],e[2]^=r[2],e[3]^=r[3],this.tableMultiply(e)};Z.gcm.prototype.generateHashTable=function(t,e){for(var r=8/e,n=4*r,i=16*r,s=new Array(i),a=0;a<i;++a){var o=[0,0,0,0],c=a/n|0,f=(n-1-a%n)*e;o[c]=1<<e-1<<f,s[a]=this.generateSubHashTable(this.multiply(o,t),e)}return s};Z.gcm.prototype.generateSubHashTable=function(t,e){var r=1<<e,n=r>>>1,i=new Array(r);i[n]=t.slice(0);for(var s=n>>>1;s>0;)this.pow(i[2*s],i[s]=[]),s>>=1;for(s=2;s<n;){for(var a=1;a<s;++a){var o=i[s],c=i[a];i[s+a]=[o[0]^c[0],o[1]^c[1],o[2]^c[2],o[3]^c[3]]}s*=2}for(i[0]=[0,0,0,0],s=n+1;s<r;++s){var f=i[s^n];i[s]=[t[0]^f[0],t[1]^f[1],t[2]^f[2],t[3]^f[3]]}return i};function bn(t,e){if(typeof t=="string"&&(t=_t.util.createBuffer(t)),_t.util.isArray(t)&&t.length>4){var r=t;t=_t.util.createBuffer();for(var n=0;n<r.length;++n)t.putByte(r[n])}if(t.length()<e)throw new Error("Invalid IV length; got "+t.length()+" bytes and expected "+e+" bytes.");if(!_t.util.isArray(t)){for(var i=[],s=e/4,n=0;n<s;++n)i.push(t.getInt32());t=i}return t}function En(t){t[t.length-1]=t[t.length-1]+1&4294967295}function Si(t){return[t/4294967296|0,t&4294967295]}});var Sn=j((m1,So)=>{var ht=ot();wi();Bi();Et();So.exports=ht.aes=ht.aes||{};ht.aes.startEncrypting=function(t,e,r,n){var i=wn({key:t,output:r,decrypt:!1,mode:n});return i.start(e),i};ht.aes.createEncryptionCipher=function(t,e){return wn({key:t,output:null,decrypt:!1,mode:e})};ht.aes.startDecrypting=function(t,e,r,n){var i=wn({key:t,output:r,decrypt:!0,mode:n});return i.start(e),i};ht.aes.createDecryptionCipher=function(t,e){return wn({key:t,output:null,decrypt:!0,mode:e})};ht.aes.Algorithm=function(t,e){Ii||Eo();var r=this;r.name=t,r.mode=new e({blockSize:16,cipher:{encrypt:function(n,i){return Ci(r._w,n,i,!1)},decrypt:function(n,i){return Ci(r._w,n,i,!0)}}}),r._init=!1};ht.aes.Algorithm.prototype.initialize=function(t){if(!this._init){var e=t.key,r;if(typeof e=="string"&&(e.length===16||e.length===24||e.length===32))e=ht.util.createBuffer(e);else if(ht.util.isArray(e)&&(e.length===16||e.length===24||e.length===32)){r=e,e=ht.util.createBuffer();for(var n=0;n<r.length;++n)e.putByte(r[n])}if(!ht.util.isArray(e)){r=e,e=[];var i=r.length();if(i===16||i===24||i===32){i=i>>>2;for(var n=0;n<i;++n)e.push(r.getInt32())}}if(!ht.util.isArray(e)||!(e.length===4||e.length===6||e.length===8))throw new Error("Invalid key parameter.");var s=this.mode.name,a=["CFB","OFB","CTR","GCM"].indexOf(s)!==-1;this._w=wo(e,t.decrypt&&!a),this._init=!0}};ht.aes._expandKey=function(t,e){return Ii||Eo(),wo(t,e)};ht.aes._updateBlock=Ci;pr("AES-ECB",ht.cipher.modes.ecb);pr("AES-CBC",ht.cipher.modes.cbc);pr("AES-CFB",ht.cipher.modes.cfb);pr("AES-OFB",ht.cipher.modes.ofb);pr("AES-CTR",ht.cipher.modes.ctr);pr("AES-GCM",ht.cipher.modes.gcm);function pr(t,e){var r=function(){return new ht.aes.Algorithm(t,e)};ht.cipher.registerAlgorithm(t,r)}var Ii=!1,dr=4,Ot,Ai,bo,Ye,Xt;function Eo(){Ii=!0,bo=[0,1,2,4,8,16,32,64,128,27,54];for(var t=new Array(256),e=0;e<128;++e)t[e]=e<<1,t[e+128]=e+128<<1^283;Ot=new Array(256),Ai=new Array(256),Ye=new Array(4),Xt=new Array(4);for(var e=0;e<4;++e)Ye[e]=new Array(256),Xt[e]=new Array(256);for(var r=0,n=0,i,s,a,o,c,f,u,e=0;e<256;++e){o=n^n<<1^n<<2^n<<3^n<<4,o=o>>8^o&255^99,Ot[r]=o,Ai[o]=r,c=t[o],i=t[r],s=t[i],a=t[s],f=c<<24^o<<16^o<<8^(o^c),u=(i^s^a)<<24^(r^a)<<16^(r^s^a)<<8^(r^i^a);for(var h=0;h<4;++h)Ye[h][r]=f,Xt[h][o]=u,f=f<<24|f>>>8,u=u<<24|u>>>8;r===0?r=n=1:(r=i^t[t[t[i^a]]],n^=t[t[n]])}}function wo(t,e){for(var r=t.slice(0),n,i=1,s=r.length,a=s+6+1,o=dr*a,c=s;c<o;++c)n=r[c-1],c%s===0?(n=Ot[n>>>16&255]<<24^Ot[n>>>8&255]<<16^Ot[n&255]<<8^Ot[n>>>24]^bo[i]<<24,i++):s>6&&c%s===4&&(n=Ot[n>>>24]<<24^Ot[n>>>16&255]<<16^Ot[n>>>8&255]<<8^Ot[n&255]),r[c]=r[c-s]^n;if(e){var f,u=Xt[0],h=Xt[1],l=Xt[2],g=Xt[3],d=r.slice(0);o=r.length;for(var c=0,p=o-dr;c<o;c+=dr,p-=dr)if(c===0||c===o-dr)d[c]=r[p],d[c+1]=r[p+3],d[c+2]=r[p+2],d[c+3]=r[p+1];else for(var y=0;y<dr;++y)f=r[p+y],d[c+(3&-y)]=u[Ot[f>>>24]]^h[Ot[f>>>16&255]]^l[Ot[f>>>8&255]]^g[Ot[f&255]];r=d}return r}function Ci(t,e,r,n){var i=t.length/4-1,s,a,o,c,f;n?(s=Xt[0],a=Xt[1],o=Xt[2],c=Xt[3],f=Ai):(s=Ye[0],a=Ye[1],o=Ye[2],c=Ye[3],f=Ot);var u,h,l,g,d,p,y;u=e[0]^t[0],h=e[n?3:1]^t[1],l=e[2]^t[2],g=e[n?1:3]^t[3];for(var m=3,E=1;E<i;++E)d=s[u>>>24]^a[h>>>16&255]^o[l>>>8&255]^c[g&255]^t[++m],p=s[h>>>24]^a[l>>>16&255]^o[g>>>8&255]^c[u&255]^t[++m],y=s[l>>>24]^a[g>>>16&255]^o[u>>>8&255]^c[h&255]^t[++m],g=s[g>>>24]^a[u>>>16&255]^o[h>>>8&255]^c[l&255]^t[++m],u=d,h=p,l=y;r[0]=f[u>>>24]<<24^f[h>>>16&255]<<16^f[l>>>8&255]<<8^f[g&255]^t[++m],r[n?3:1]=f[h>>>24]<<24^f[l>>>16&255]<<16^f[g>>>8&255]<<8^f[u&255]^t[++m],r[2]=f[l>>>24]<<24^f[g>>>16&255]<<16^f[u>>>8&255]<<8^f[h&255]^t[++m],r[n?1:3]=f[g>>>24]<<24^f[u>>>16&255]<<16^f[h>>>8&255]<<8^f[l&255]^t[++m]}function wn(t){t=t||{};var e=(t.mode||"CBC").toUpperCase(),r="AES-"+e,n;t.decrypt?n=ht.cipher.createDecipher(r,t.key):n=ht.cipher.createCipher(r,t.key);var i=n.start;return n.start=function(s,a){var o=null;a instanceof ht.util.ByteBuffer&&(o=a,a={}),a=a||{},a.output=o,a.iv=s,i.call(n,a)},n}});var Cn=j((Sy,Go)=>{var Zr=ot();Zr.pki=Zr.pki||{};var Zi=Go.exports=Zr.pki.oids=Zr.oids=Zr.oids||{};function T(t,e){Zi[t]=e,Zi[e]=t}function it(t,e){Zi[t]=e}T("1.2.840.113549.1.1.1","rsaEncryption");T("1.2.840.113549.1.1.4","md5WithRSAEncryption");T("1.2.840.113549.1.1.5","sha1WithRSAEncryption");T("1.2.840.113549.1.1.7","RSAES-OAEP");T("1.2.840.113549.1.1.8","mgf1");T("1.2.840.113549.1.1.9","pSpecified");T("1.2.840.113549.1.1.10","RSASSA-PSS");T("1.2.840.113549.1.1.11","sha256WithRSAEncryption");T("1.2.840.113549.1.1.12","sha384WithRSAEncryption");T("1.2.840.113549.1.1.13","sha512WithRSAEncryption");T("1.3.101.112","EdDSA25519");T("1.2.840.10040.4.3","dsa-with-sha1");T("1.3.14.3.2.7","desCBC");T("1.3.14.3.2.26","sha1");T("1.3.14.3.2.29","sha1WithRSASignature");T("2.16.840.1.101.3.4.2.1","sha256");T("2.16.840.1.101.3.4.2.2","sha384");T("2.16.840.1.101.3.4.2.3","sha512");T("2.16.840.1.101.3.4.2.4","sha224");T("2.16.840.1.101.3.4.2.5","sha512-224");T("2.16.840.1.101.3.4.2.6","sha512-256");T("1.2.840.113549.2.2","md2");T("1.2.840.113549.2.5","md5");T("1.2.840.113549.1.7.1","data");T("1.2.840.113549.1.7.2","signedData");T("1.2.840.113549.1.7.3","envelopedData");T("1.2.840.113549.1.7.4","signedAndEnvelopedData");T("1.2.840.113549.1.7.5","digestedData");T("1.2.840.113549.1.7.6","encryptedData");T("1.2.840.113549.1.9.1","emailAddress");T("1.2.840.113549.1.9.2","unstructuredName");T("1.2.840.113549.1.9.3","contentType");T("1.2.840.113549.1.9.4","messageDigest");T("1.2.840.113549.1.9.5","signingTime");T("1.2.840.113549.1.9.6","counterSignature");T("1.2.840.113549.1.9.7","challengePassword");T("1.2.840.113549.1.9.8","unstructuredAddress");T("1.2.840.113549.1.9.14","extensionRequest");T("1.2.840.113549.1.9.20","friendlyName");T("1.2.840.113549.1.9.21","localKeyId");T("1.2.840.113549.1.9.22.1","x509Certificate");T("1.2.840.113549.1.12.10.1.1","keyBag");T("1.2.840.113549.1.12.10.1.2","pkcs8ShroudedKeyBag");T("1.2.840.113549.1.12.10.1.3","certBag");T("1.2.840.113549.1.12.10.1.4","crlBag");T("1.2.840.113549.1.12.10.1.5","secretBag");T("1.2.840.113549.1.12.10.1.6","safeContentsBag");T("1.2.840.113549.1.5.13","pkcs5PBES2");T("1.2.840.113549.1.5.12","pkcs5PBKDF2");T("1.2.840.113549.1.12.1.1","pbeWithSHAAnd128BitRC4");T("1.2.840.113549.1.12.1.2","pbeWithSHAAnd40BitRC4");T("1.2.840.113549.1.12.1.3","pbeWithSHAAnd3-KeyTripleDES-CBC");T("1.2.840.113549.1.12.1.4","pbeWithSHAAnd2-KeyTripleDES-CBC");T("1.2.840.113549.1.12.1.5","pbeWithSHAAnd128BitRC2-CBC");T("1.2.840.113549.1.12.1.6","pbewithSHAAnd40BitRC2-CBC");T("1.2.840.113549.2.7","hmacWithSHA1");T("1.2.840.113549.2.8","hmacWithSHA224");T("1.2.840.113549.2.9","hmacWithSHA256");T("1.2.840.113549.2.10","hmacWithSHA384");T("1.2.840.113549.2.11","hmacWithSHA512");T("1.2.840.113549.3.7","des-EDE3-CBC");T("2.16.840.1.101.3.4.1.2","aes128-CBC");T("2.16.840.1.101.3.4.1.22","aes192-CBC");T("2.16.840.1.101.3.4.1.42","aes256-CBC");T("2.5.4.3","commonName");T("2.5.4.4","surname");T("2.5.4.5","serialNumber");T("2.5.4.6","countryName");T("2.5.4.7","localityName");T("2.5.4.8","stateOrProvinceName");T("2.5.4.9","streetAddress");T("2.5.4.10","organizationName");T("2.5.4.11","organizationalUnitName");T("2.5.4.12","title");T("2.5.4.13","description");T("2.5.4.15","businessCategory");T("2.5.4.17","postalCode");T("2.5.4.42","givenName");T("1.3.6.1.4.1.311.60.2.1.2","jurisdictionOfIncorporationStateOrProvinceName");T("1.3.6.1.4.1.311.60.2.1.3","jurisdictionOfIncorporationCountryName");T("2.16.840.1.113730.1.1","nsCertType");T("2.16.840.1.113730.1.13","nsComment");it("2.5.29.1","authorityKeyIdentifier");it("2.5.29.2","keyAttributes");it("2.5.29.3","certificatePolicies");it("2.5.29.4","keyUsageRestriction");it("2.5.29.5","policyMapping");it("2.5.29.6","subtreesConstraint");it("2.5.29.7","subjectAltName");it("2.5.29.8","issuerAltName");it("2.5.29.9","subjectDirectoryAttributes");it("2.5.29.10","basicConstraints");it("2.5.29.11","nameConstraints");it("2.5.29.12","policyConstraints");it("2.5.29.13","basicConstraints");T("2.5.29.14","subjectKeyIdentifier");T("2.5.29.15","keyUsage");it("2.5.29.16","privateKeyUsagePeriod");T("2.5.29.17","subjectAltName");T("2.5.29.18","issuerAltName");T("2.5.29.19","basicConstraints");it("2.5.29.20","cRLNumber");it("2.5.29.21","cRLReason");it("2.5.29.22","expirationDate");it("2.5.29.23","instructionCode");it("2.5.29.24","invalidityDate");it("2.5.29.25","cRLDistributionPoints");it("2.5.29.26","issuingDistributionPoint");it("2.5.29.27","deltaCRLIndicator");it("2.5.29.28","issuingDistributionPoint");it("2.5.29.29","certificateIssuer");it("2.5.29.30","nameConstraints");T("2.5.29.31","cRLDistributionPoints");T("2.5.29.32","certificatePolicies");it("2.5.29.33","policyMappings");it("2.5.29.34","policyConstraints");T("2.5.29.35","authorityKeyIdentifier");it("2.5.29.36","policyConstraints");T("2.5.29.37","extKeyUsage");it("2.5.29.46","freshestCRL");it("2.5.29.54","inhibitAnyPolicy");T("1.3.6.1.4.1.11129.2.4.2","timestampList");T("1.3.6.1.5.5.7.1.1","authorityInfoAccess");T("1.3.6.1.5.5.7.3.1","serverAuth");T("1.3.6.1.5.5.7.3.2","clientAuth");T("1.3.6.1.5.5.7.3.3","codeSigning");T("1.3.6.1.5.5.7.3.4","emailProtection");T("1.3.6.1.5.5.7.3.8","timeStamping")});var Xr=j((By,$o)=>{var lt=ot();Et();Cn();var P=$o.exports=lt.asn1=lt.asn1||{};P.Class={UNIVERSAL:0,APPLICATION:64,CONTEXT_SPECIFIC:128,PRIVATE:192};P.Type={NONE:0,BOOLEAN:1,INTEGER:2,BITSTRING:3,OCTETSTRING:4,NULL:5,OID:6,ODESC:7,EXTERNAL:8,REAL:9,ENUMERATED:10,EMBEDDED:11,UTF8:12,ROID:13,SEQUENCE:16,SET:17,PRINTABLESTRING:19,IA5STRING:22,UTCTIME:23,GENERALIZEDTIME:24,BMPSTRING:30};P.create=function(t,e,r,n,i){if(lt.util.isArray(n)){for(var s=[],a=0;a<n.length;++a)n[a]!==void 0&&s.push(n[a]);n=s}var o={tagClass:t,type:e,constructed:r,composed:r||lt.util.isArray(n),value:n};return i&&"bitStringContents"in i&&(o.bitStringContents=i.bitStringContents,o.original=P.copy(o)),o};P.copy=function(t,e){var r;if(lt.util.isArray(t)){r=[];for(var n=0;n<t.length;++n)r.push(P.copy(t[n],e));return r}return typeof t=="string"?t:(r={tagClass:t.tagClass,type:t.type,constructed:t.constructed,composed:t.composed,value:P.copy(t.value,e)},e&&!e.excludeBitStringContents&&(r.bitStringContents=t.bitStringContents),r)};P.equals=function(t,e,r){if(lt.util.isArray(t)){if(!lt.util.isArray(e)||t.length!==e.length)return!1;for(var n=0;n<t.length;++n)if(!P.equals(t[n],e[n]))return!1;return!0}if(typeof t!=typeof e)return!1;if(typeof t=="string")return t===e;var i=t.tagClass===e.tagClass&&t.type===e.type&&t.constructed===e.constructed&&t.composed===e.composed&&P.equals(t.value,e.value);return r&&r.includeBitStringContents&&(i=i&&t.bitStringContents===e.bitStringContents),i};P.getBerValueLength=function(t){var e=t.getByte();if(e!==128){var r,n=e&128;return n?r=t.getInt((e&127)<<3):r=e,r}};function Qr(t,e,r){if(r>e){var n=new Error("Too few bytes to parse DER.");throw n.available=t.length(),n.remaining=e,n.requested=r,n}}var gu=function(t,e){var r=t.getByte();if(e--,r!==128){var n,i=r&128;if(!i)n=r;else{var s=r&127;Qr(t,e,s),n=t.getInt(s<<3)}if(n<0)throw new Error("Negative length: "+n);return n}};P.fromDer=function(t,e){e===void 0&&(e={strict:!0,parseAllBytes:!0,decodeBitStrings:!0}),typeof e=="boolean"&&(e={strict:e,parseAllBytes:!0,decodeBitStrings:!0}),"strict"in e||(e.strict=!0),"parseAllBytes"in e||(e.parseAllBytes=!0),"decodeBitStrings"in e||(e.decodeBitStrings=!0),typeof t=="string"&&(t=lt.util.createBuffer(t));var r=t.length(),n=In(t,t.length(),0,e);if(e.parseAllBytes&&t.length()!==0){var i=new Error("Unparsed DER bytes remain after ASN.1 parsing.");throw i.byteCount=r,i.remaining=t.length(),i}return n};function In(t,e,r,n){var i;Qr(t,e,2);var s=t.getByte();e--;var a=s&192,o=s&31;i=t.length();var c=gu(t,e);if(e-=i-t.length(),c!==void 0&&c>e){if(n.strict){var f=new Error("Too few bytes to read ASN.1 value.");throw f.available=t.length(),f.remaining=e,f.requested=c,f}c=e}var u,h,l=(s&32)===32;if(l)if(u=[],c===void 0)for(;;){if(Qr(t,e,2),t.bytes(2)===String.fromCharCode(0,0)){t.getBytes(2),e-=2;break}i=t.length(),u.push(In(t,e,r+1,n)),e-=i-t.length()}else for(;c>0;)i=t.length(),u.push(In(t,c,r+1,n)),e-=i-t.length(),c-=i-t.length();if(u===void 0&&a===P.Class.UNIVERSAL&&o===P.Type.BITSTRING&&(h=t.bytes(c)),u===void 0&&n.decodeBitStrings&&a===P.Class.UNIVERSAL&&o===P.Type.BITSTRING&&c>1){var g=t.read,d=e,p=0;if(o===P.Type.BITSTRING&&(Qr(t,e,1),p=t.getByte(),e--),p===0)try{i=t.length();var y={strict:!0,decodeBitStrings:!0},m=In(t,e,r+1,y),E=i-t.length();e-=E,o==P.Type.BITSTRING&&E++;var b=m.tagClass;E===c&&(b===P.Class.UNIVERSAL||b===P.Class.CONTEXT_SPECIFIC)&&(u=[m])}catch{}u===void 0&&(t.read=g,e=d)}if(u===void 0){if(c===void 0){if(n.strict)throw new Error("Non-constructed ASN.1 object of indefinite length.");c=e}if(o===P.Type.BMPSTRING)for(u="";c>0;c-=2)Qr(t,e,2),u+=String.fromCharCode(t.getInt16()),e-=2;else u=t.getBytes(c),e-=c}var _=h===void 0?null:{bitStringContents:h};return P.create(a,o,l,u,_)}P.toDer=function(t){var e=lt.util.createBuffer(),r=t.tagClass|t.type,n=lt.util.createBuffer(),i=!1;if("bitStringContents"in t&&(i=!0,t.original&&(i=P.equals(t,t.original))),i)n.putBytes(t.bitStringContents);else if(t.composed){t.constructed?r|=32:n.putByte(0);for(var s=0;s<t.value.length;++s)t.value[s]!==void 0&&n.putBuffer(P.toDer(t.value[s]))}else if(t.type===P.Type.BMPSTRING)for(var s=0;s<t.value.length;++s)n.putInt16(t.value.charCodeAt(s));else t.type===P.Type.INTEGER&&t.value.length>1&&(t.value.charCodeAt(0)===0&&!(t.value.charCodeAt(1)&128)||t.value.charCodeAt(0)===255&&(t.value.charCodeAt(1)&128)===128)?n.putBytes(t.value.substr(1)):n.putBytes(t.value);if(e.putByte(r),n.length()<=127)e.putByte(n.length()&127);else{var a=n.length(),o="";do o+=String.fromCharCode(a&255),a=a>>>8;while(a>0);e.putByte(o.length|128);for(var s=o.length-1;s>=0;--s)e.putByte(o.charCodeAt(s))}return e.putBuffer(n),e};P.oidToDer=function(t){var e=t.split("."),r=lt.util.createBuffer();r.putByte(40*parseInt(e[0],10)+parseInt(e[1],10));for(var n,i,s,a,o=2;o<e.length;++o){n=!0,i=[],s=parseInt(e[o],10);do a=s&127,s=s>>>7,n||(a|=128),i.push(a),n=!1;while(s>0);for(var c=i.length-1;c>=0;--c)r.putByte(i[c])}return r};P.derToOid=function(t){var e;typeof t=="string"&&(t=lt.util.createBuffer(t));var r=t.getByte();e=Math.floor(r/40)+"."+r%40;for(var n=0;t.length()>0;)r=t.getByte(),n=n<<7,r&128?n+=r&127:(e+="."+(n+r),n=0);return e};P.utcTimeToDate=function(t){var e=new Date,r=parseInt(t.substr(0,2),10);r=r>=50?1900+r:2e3+r;var n=parseInt(t.substr(2,2),10)-1,i=parseInt(t.substr(4,2),10),s=parseInt(t.substr(6,2),10),a=parseInt(t.substr(8,2),10),o=0;if(t.length>11){var c=t.charAt(10),f=10;c!=="+"&&c!=="-"&&(o=parseInt(t.substr(10,2),10),f+=2)}if(e.setUTCFullYear(r,n,i),e.setUTCHours(s,a,o,0),f&&(c=t.charAt(f),c==="+"||c==="-")){var u=parseInt(t.substr(f+1,2),10),h=parseInt(t.substr(f+4,2),10),l=u*60+h;l*=6e4,c==="+"?e.setTime(+e-l):e.setTime(+e+l)}return e};P.generalizedTimeToDate=function(t){var e=new Date,r=parseInt(t.substr(0,4),10),n=parseInt(t.substr(4,2),10)-1,i=parseInt(t.substr(6,2),10),s=parseInt(t.substr(8,2),10),a=parseInt(t.substr(10,2),10),o=parseInt(t.substr(12,2),10),c=0,f=0,u=!1;t.charAt(t.length-1)==="Z"&&(u=!0);var h=t.length-5,l=t.charAt(h);if(l==="+"||l==="-"){var g=parseInt(t.substr(h+1,2),10),d=parseInt(t.substr(h+4,2),10);f=g*60+d,f*=6e4,l==="+"&&(f*=-1),u=!0}return t.charAt(14)==="."&&(c=parseFloat(t.substr(14),10)*1e3),u?(e.setUTCFullYear(r,n,i),e.setUTCHours(s,a,o,c),e.setTime(+e+f)):(e.setFullYear(r,n,i),e.setHours(s,a,o,c)),e};P.dateToUtcTime=function(t){if(typeof t=="string")return t;var e="",r=[];r.push((""+t.getUTCFullYear()).substr(2)),r.push(""+(t.getUTCMonth()+1)),r.push(""+t.getUTCDate()),r.push(""+t.getUTCHours()),r.push(""+t.getUTCMinutes()),r.push(""+t.getUTCSeconds());for(var n=0;n<r.length;++n)r[n].length<2&&(e+="0"),e+=r[n];return e+="Z",e};P.dateToGeneralizedTime=function(t){if(typeof t=="string")return t;var e="",r=[];r.push(""+t.getUTCFullYear()),r.push(""+(t.getUTCMonth()+1)),r.push(""+t.getUTCDate()),r.push(""+t.getUTCHours()),r.push(""+t.getUTCMinutes()),r.push(""+t.getUTCSeconds());for(var n=0;n<r.length;++n)r[n].length<2&&(e+="0"),e+=r[n];return e+="Z",e};P.integerToDer=function(t){var e=lt.util.createBuffer();if(t>=-128&&t<128)return e.putSignedInt(t,8);if(t>=-32768&&t<32768)return e.putSignedInt(t,16);if(t>=-8388608&&t<8388608)return e.putSignedInt(t,24);if(t>=-2147483648&&t<2147483648)return e.putSignedInt(t,32);var r=new Error("Integer too large; max is 32-bits.");throw r.integer=t,r};P.derToInteger=function(t){typeof t=="string"&&(t=lt.util.createBuffer(t));var e=t.length()*8;if(e>32)throw new Error("Integer too large; max is 32-bits.");return t.getSignedInt(e)};P.validate=function(t,e,r,n){var i=!1;if((t.tagClass===e.tagClass||typeof e.tagClass>"u")&&(t.type===e.type||typeof e.type>"u"))if(t.constructed===e.constructed||typeof e.constructed>"u"){if(i=!0,e.value&&lt.util.isArray(e.value))for(var s=0,a=0;i&&a<e.value.length;++a)i=e.value[a].optional||!1,t.value[s]&&(i=P.validate(t.value[s],e.value[a],r,n),i?++s:e.value[a].optional&&(i=!0)),!i&&n&&n.push("["+e.name+'] Tag class "'+e.tagClass+'", type "'+e.type+'" expected value length "'+e.value.length+'", got "'+t.value.length+'"');if(i&&r&&(e.capture&&(r[e.capture]=t.value),e.captureAsn1&&(r[e.captureAsn1]=t),e.captureBitStringContents&&"bitStringContents"in t&&(r[e.captureBitStringContents]=t.bitStringContents),e.captureBitStringValue&&"bitStringContents"in t)){var o;if(t.bitStringContents.length<2)r[e.captureBitStringValue]="";else{var c=t.bitStringContents.charCodeAt(0);if(c!==0)throw new Error("captureBitStringValue only supported for zero unused bits");r[e.captureBitStringValue]=t.bitStringContents.slice(1)}}}else n&&n.push("["+e.name+'] Expected constructed "'+e.constructed+'", got "'+t.constructed+'"');else n&&(t.tagClass!==e.tagClass&&n.push("["+e.name+'] Expected tag class "'+e.tagClass+'", got "'+t.tagClass+'"'),t.type!==e.type&&n.push("["+e.name+'] Expected type "'+e.type+'", got "'+t.type+'"'));return i};var Yo=/[^\\u0000-\\u00ff]/;P.prettyPrint=function(t,e,r){var n="";e=e||0,r=r||2,e>0&&(n+=`
`);for(var i="",s=0;s<e*r;++s)i+=" ";switch(n+=i+"Tag: ",t.tagClass){case P.Class.UNIVERSAL:n+="Universal:";break;case P.Class.APPLICATION:n+="Application:";break;case P.Class.CONTEXT_SPECIFIC:n+="Context-Specific:";break;case P.Class.PRIVATE:n+="Private:";break}if(t.tagClass===P.Class.UNIVERSAL)switch(n+=t.type,t.type){case P.Type.NONE:n+=" (None)";break;case P.Type.BOOLEAN:n+=" (Boolean)";break;case P.Type.INTEGER:n+=" (Integer)";break;case P.Type.BITSTRING:n+=" (Bit string)";break;case P.Type.OCTETSTRING:n+=" (Octet string)";break;case P.Type.NULL:n+=" (Null)";break;case P.Type.OID:n+=" (Object Identifier)";break;case P.Type.ODESC:n+=" (Object Descriptor)";break;case P.Type.EXTERNAL:n+=" (External or Instance of)";break;case P.Type.REAL:n+=" (Real)";break;case P.Type.ENUMERATED:n+=" (Enumerated)";break;case P.Type.EMBEDDED:n+=" (Embedded PDV)";break;case P.Type.UTF8:n+=" (UTF8)";break;case P.Type.ROID:n+=" (Relative Object Identifier)";break;case P.Type.SEQUENCE:n+=" (Sequence)";break;case P.Type.SET:n+=" (Set)";break;case P.Type.PRINTABLESTRING:n+=" (Printable String)";break;case P.Type.IA5String:n+=" (IA5String (ASCII))";break;case P.Type.UTCTIME:n+=" (UTC time)";break;case P.Type.GENERALIZEDTIME:n+=" (Generalized time)";break;case P.Type.BMPSTRING:n+=" (BMP String)";break}else n+=t.type;if(n+=`
`,n+=i+"Constructed: "+t.constructed+`
`,t.composed){for(var a=0,o="",s=0;s<t.value.length;++s)t.value[s]!==void 0&&(a+=1,o+=P.prettyPrint(t.value[s],e+1,r),s+1<t.value.length&&(o+=","));n+=i+"Sub values: "+a+o}else{if(n+=i+"Value: ",t.type===P.Type.OID){var c=P.derToOid(t.value);n+=c,lt.pki&&lt.pki.oids&&c in lt.pki.oids&&(n+=" ("+lt.pki.oids[c]+") ")}if(t.type===P.Type.INTEGER)try{n+=P.derToInteger(t.value)}catch{n+="0x"+lt.util.bytesToHex(t.value)}else if(t.type===P.Type.BITSTRING){if(t.value.length>1?n+="0x"+lt.util.bytesToHex(t.value.slice(1)):n+="(none)",t.value.length>0){var f=t.value.charCodeAt(0);f==1?n+=" (1 unused bit shown)":f>1&&(n+=" ("+f+" unused bits shown)")}}else if(t.type===P.Type.OCTETSTRING)Yo.test(t.value)||(n+="("+t.value+") "),n+="0x"+lt.util.bytesToHex(t.value);else if(t.type===P.Type.UTF8)try{n+=lt.util.decodeUtf8(t.value)}catch(u){if(u.message==="URI malformed")n+="0x"+lt.util.bytesToHex(t.value)+" (malformed UTF8)";else throw u}else t.type===P.Type.PRINTABLESTRING||t.type===P.Type.IA5String?n+=t.value:Yo.test(t.value)?n+="0x"+lt.util.bytesToHex(t.value):t.value.length===0?n+="[null]":n+=t.value}return n}});var Qo=j((Ay,Zo)=>{var yt=ot();wi();Bi();Et();Zo.exports=yt.des=yt.des||{};yt.des.startEncrypting=function(t,e,r,n){var i=Tn({key:t,output:r,decrypt:!1,mode:n||(e===null?"ECB":"CBC")});return i.start(e),i};yt.des.createEncryptionCipher=function(t,e){return Tn({key:t,output:null,decrypt:!1,mode:e})};yt.des.startDecrypting=function(t,e,r,n){var i=Tn({key:t,output:r,decrypt:!0,mode:n||(e===null?"ECB":"CBC")});return i.start(e),i};yt.des.createDecryptionCipher=function(t,e){return Tn({key:t,output:null,decrypt:!0,mode:e})};yt.des.Algorithm=function(t,e){var r=this;r.name=t,r.mode=new e({blockSize:8,cipher:{encrypt:function(n,i){return Wo(r._keys,n,i,!1)},decrypt:function(n,i){return Wo(r._keys,n,i,!0)}}}),r._init=!1};yt.des.Algorithm.prototype.initialize=function(t){if(!this._init){var e=yt.util.createBuffer(t.key);if(this.name.indexOf("3DES")===0&&e.length()!==24)throw new Error("Invalid Triple-DES key size: "+e.length()*8);this._keys=Au(e),this._init=!0}};ie("DES-ECB",yt.cipher.modes.ecb);ie("DES-CBC",yt.cipher.modes.cbc);ie("DES-CFB",yt.cipher.modes.cfb);ie("DES-OFB",yt.cipher.modes.ofb);ie("DES-CTR",yt.cipher.modes.ctr);ie("3DES-ECB",yt.cipher.modes.ecb);ie("3DES-CBC",yt.cipher.modes.cbc);ie("3DES-CFB",yt.cipher.modes.cfb);ie("3DES-OFB",yt.cipher.modes.ofb);ie("3DES-CTR",yt.cipher.modes.ctr);function ie(t,e){var r=function(){return new yt.des.Algorithm(t,e)};yt.cipher.registerAlgorithm(t,r)}var xu=[16843776,0,65536,16843780,16842756,66564,4,65536,1024,16843776,16843780,1024,16778244,16842756,16777216,4,1028,16778240,16778240,66560,66560,16842752,16842752,16778244,65540,16777220,16777220,65540,0,1028,66564,16777216,65536,16843780,4,16842752,16843776,16777216,16777216,1024,16842756,65536,66560,16777220,1024,4,16778244,66564,16843780,65540,16842752,16778244,16777220,1028,66564,16843776,1028,16778240,16778240,0,65540,66560,0,16842756],mu=[-2146402272,-2147450880,32768,1081376,1048576,32,-2146435040,-2147450848,-2147483616,-2146402272,-2146402304,-2147483648,-2147450880,1048576,32,-2146435040,1081344,1048608,-2147450848,0,-2147483648,32768,1081376,-2146435072,1048608,-2147483616,0,1081344,32800,-2146402304,-2146435072,32800,0,1081376,-2146435040,1048576,-2147450848,-2146435072,-2146402304,32768,-2146435072,-2147450880,32,-2146402272,1081376,32,32768,-2147483648,32800,-2146402304,1048576,-2147483616,1048608,-2147450848,-2147483616,1048608,1081344,0,-2147450880,32800,-2147483648,-2146435040,-2146402272,1081344],vu=[520,134349312,0,134348808,134218240,0,131592,134218240,131080,134217736,134217736,131072,134349320,131080,134348800,520,134217728,8,134349312,512,131584,134348800,134348808,131592,134218248,131584,131072,134218248,8,134349320,512,134217728,134349312,134217728,131080,520,131072,134349312,134218240,0,512,131080,134349320,134218240,134217736,512,0,134348808,134218248,131072,134217728,134349320,8,131592,131584,134217736,134348800,134218248,520,134348800,131592,8,134348808,131584],bu=[8396801,8321,8321,128,8396928,8388737,8388609,8193,0,8396800,8396800,8396929,129,0,8388736,8388609,1,8192,8388608,8396801,128,8388608,8193,8320,8388737,1,8320,8388736,8192,8396928,8396929,129,8388736,8388609,8396800,8396929,129,0,0,8396800,8320,8388736,8388737,1,8396801,8321,8321,128,8396929,129,1,8192,8388609,8193,8396928,8388737,8193,8320,8388608,8396801,128,8388608,8192,8396928],Eu=[256,34078976,34078720,1107296512,524288,256,1073741824,34078720,1074266368,524288,33554688,1074266368,1107296512,1107820544,524544,1073741824,33554432,1074266112,1074266112,0,1073742080,1107820800,1107820800,33554688,1107820544,1073742080,0,1107296256,34078976,33554432,1107296256,524544,524288,1107296512,256,33554432,1073741824,34078720,1107296512,1074266368,33554688,1073741824,1107820544,34078976,1074266368,256,33554432,1107820544,1107820800,524544,1107296256,1107820800,34078720,0,1074266112,1107296256,524544,33554688,1073742080,524288,0,1074266112,34078976,1073742080],wu=[536870928,541065216,16384,541081616,541065216,16,541081616,4194304,536887296,4210704,4194304,536870928,4194320,536887296,536870912,16400,0,4194320,536887312,16384,4210688,536887312,16,541065232,541065232,0,4210704,541081600,16400,4210688,541081600,536870912,536887296,16,541065232,4210688,541081616,4194304,16400,536870928,4194304,536887296,536870912,16400,536870928,541081616,4210688,541065216,4210704,541081600,0,541065232,16,16384,541065216,4210704,16384,4194320,536887312,0,541081600,536870912,4194320,536887312],Su=[2097152,69206018,67110914,0,2048,67110914,2099202,69208064,69208066,2097152,0,67108866,2,67108864,69206018,2050,67110912,2099202,2097154,67110912,67108866,69206016,69208064,2097154,69206016,2048,2050,69208066,2099200,2,67108864,2099200,67108864,2099200,2097152,67110914,67110914,69206018,69206018,2,2097154,67108864,67110912,2097152,69208064,2050,2099202,69208064,2050,67108866,69208066,69206016,2099200,0,2,69208066,0,2099202,69206016,2048,67108866,67110912,2048,2097154],Bu=[268439616,4096,262144,268701760,268435456,268439616,64,268435456,262208,268697600,268701760,266240,268701696,266304,4096,64,268697600,268435520,268439552,4160,266240,262208,268697664,268701696,4160,0,0,268697664,268435520,268439552,266304,262144,266304,262144,268701696,4096,64,268697664,4096,266304,268439552,64,268435520,268697600,268697664,268435456,262144,268439616,0,268701760,262208,268435520,268697600,268439552,268439616,0,268701760,266240,266240,4160,4160,262208,268435456,268701696];function Au(t){for(var e=[0,4,536870912,536870916,65536,65540,536936448,536936452,512,516,536871424,536871428,66048,66052,536936960,536936964],r=[0,1,1048576,1048577,67108864,67108865,68157440,68157441,256,257,1048832,1048833,67109120,67109121,68157696,68157697],n=[0,8,2048,2056,16777216,16777224,16779264,16779272,0,8,2048,2056,16777216,16777224,16779264,16779272],i=[0,2097152,134217728,136314880,8192,2105344,134225920,136323072,131072,2228224,134348800,136445952,139264,2236416,134356992,136454144],s=[0,262144,16,262160,0,262144,16,262160,4096,266240,4112,266256,4096,266240,4112,266256],a=[0,1024,32,1056,0,1024,32,1056,33554432,33555456,33554464,33555488,33554432,33555456,33554464,33555488],o=[0,268435456,524288,268959744,2,268435458,524290,268959746,0,268435456,524288,268959744,2,268435458,524290,268959746],c=[0,65536,2048,67584,536870912,536936448,536872960,536938496,131072,196608,133120,198656,537001984,537067520,537004032,537069568],f=[0,262144,0,262144,2,262146,2,262146,33554432,33816576,33554432,33816576,33554434,33816578,33554434,33816578],u=[0,268435456,8,268435464,0,268435456,8,268435464,1024,268436480,1032,268436488,1024,268436480,1032,268436488],h=[0,32,0,32,1048576,1048608,1048576,1048608,8192,8224,8192,8224,1056768,1056800,1056768,1056800],l=[0,16777216,512,16777728,2097152,18874368,2097664,18874880,67108864,83886080,67109376,83886592,69206016,85983232,69206528,85983744],g=[0,4096,134217728,134221824,524288,528384,134742016,134746112,16,4112,134217744,134221840,524304,528400,134742032,134746128],d=[0,4,256,260,0,4,256,260,1,5,257,261,1,5,257,261],p=t.length()>8?3:1,y=[],m=[0,0,1,1,1,1,1,1,0,1,1,1,1,1,1,0],E=0,b,_=0;_<p;_++){var w=t.getInt32(),S=t.getInt32();b=(w>>>4^S)&252645135,S^=b,w^=b<<4,b=(S>>>-16^w)&65535,w^=b,S^=b<<-16,b=(w>>>2^S)&858993459,S^=b,w^=b<<2,b=(S>>>-16^w)&65535,w^=b,S^=b<<-16,b=(w>>>1^S)&1431655765,S^=b,w^=b<<1,b=(S>>>8^w)&16711935,w^=b,S^=b<<8,b=(w>>>1^S)&1431655765,S^=b,w^=b<<1,b=w<<8|S>>>20&240,w=S<<24|S<<8&16711680|S>>>8&65280|S>>>24&240,S=b;for(var L=0;L<m.length;++L){m[L]?(w=w<<2|w>>>26,S=S<<2|S>>>26):(w=w<<1|w>>>27,S=S<<1|S>>>27),w&=-15,S&=-15;var N=e[w>>>28]|r[w>>>24&15]|n[w>>>20&15]|i[w>>>16&15]|s[w>>>12&15]|a[w>>>8&15]|o[w>>>4&15],H=c[S>>>28]|f[S>>>24&15]|u[S>>>20&15]|h[S>>>16&15]|l[S>>>12&15]|g[S>>>8&15]|d[S>>>4&15];b=(H>>>16^N)&65535,y[E++]=N^b,y[E++]=H^b<<16}}return y}function Wo(t,e,r,n){var i=t.length===32?3:9,s;i===3?s=n?[30,-2,-2]:[0,32,2]:s=n?[94,62,-2,32,64,2,30,-2,-2]:[0,32,2,62,30,-2,64,96,2];var a,o=e[0],c=e[1];a=(o>>>4^c)&252645135,c^=a,o^=a<<4,a=(o>>>16^c)&65535,c^=a,o^=a<<16,a=(c>>>2^o)&858993459,o^=a,c^=a<<2,a=(c>>>8^o)&16711935,o^=a,c^=a<<8,a=(o>>>1^c)&1431655765,c^=a,o^=a<<1,o=o<<1|o>>>31,c=c<<1|c>>>31;for(var f=0;f<i;f+=3){for(var u=s[f+1],h=s[f+2],l=s[f];l!=u;l+=h){var g=c^t[l],d=(c>>>4|c<<28)^t[l+1];a=o,o=c,c=a^(mu[g>>>24&63]|bu[g>>>16&63]|wu[g>>>8&63]|Bu[g&63]|xu[d>>>24&63]|vu[d>>>16&63]|Eu[d>>>8&63]|Su[d&63])}a=o,o=c,c=a}o=o>>>1|o<<31,c=c>>>1|c<<31,a=(o>>>1^c)&1431655765,c^=a,o^=a<<1,a=(c>>>8^o)&16711935,o^=a,c^=a<<8,a=(c>>>2^o)&858993459,o^=a,c^=a<<2,a=(o>>>16^c)&65535,c^=a,o^=a<<16,a=(o>>>4^c)&252645135,c^=a,o^=a<<4,r[0]=o,r[1]=c}function Tn(t){t=t||{};var e=(t.mode||"CBC").toUpperCase(),r="DES-"+e,n;t.decrypt?n=yt.cipher.createDecipher(r,t.key):n=yt.cipher.createCipher(r,t.key);var i=n.start;return n.start=function(s,a){var o=null;a instanceof yt.util.ByteBuffer&&(o=a,a={}),a=a||{},a.output=o,a.iv=s,i.call(n,a)},n}});var Ze=j((Cy,Xo)=>{var _n=ot();Xo.exports=_n.md=_n.md||{};_n.md.algorithms=_n.md.algorithms||{}});var jo=j((Iy,Jo)=>{var ge=ot();Ze();Et();var Cu=Jo.exports=ge.hmac=ge.hmac||{};Cu.create=function(){var t=null,e=null,r=null,n=null,i={};return i.start=function(s,a){if(s!==null)if(typeof s=="string")if(s=s.toLowerCase(),s in ge.md.algorithms)e=ge.md.algorithms[s].create();else throw new Error('Unknown hash algorithm "'+s+'"');else e=s;if(a===null)a=t;else{if(typeof a=="string")a=ge.util.createBuffer(a);else if(ge.util.isArray(a)){var o=a;a=ge.util.createBuffer();for(var c=0;c<o.length;++c)a.putByte(o[c])}var f=a.length();f>e.blockLength&&(e.start(),e.update(a.bytes()),a=e.digest()),r=ge.util.createBuffer(),n=ge.util.createBuffer(),f=a.length();for(var c=0;c<f;++c){var o=a.at(c);r.putByte(54^o),n.putByte(92^o)}if(f<e.blockLength)for(var o=e.blockLength-f,c=0;c<o;++c)r.putByte(54),n.putByte(92);t=a,r=r.bytes(),n=n.bytes()}e.start(),e.update(r)},i.update=function(s){e.update(s)},i.getMac=function(){var s=e.digest().bytes();return e.start(),e.update(n),e.update(s),e.digest()},i.digest=i.getMac,i}});var Rn=j(()=>{});var Qi=j((Ry,ta)=>{var Mt=ot();jo();Ze();Et();var Iu=Mt.pkcs5=Mt.pkcs5||{},xe;Mt.util.isNodejs&&!Mt.options.usePureJavaScript&&(xe=Rn());ta.exports=Mt.pbkdf2=Iu.pbkdf2=function(t,e,r,n,i,s){if(typeof i=="function"&&(s=i,i=null),Mt.util.isNodejs&&!Mt.options.usePureJavaScript&&xe.pbkdf2&&(i===null||typeof i!="object")&&(xe.pbkdf2Sync.length>4||!i||i==="sha1"))return typeof i!="string"&&(i="sha1"),t=Buffer.from(t,"binary"),e=Buffer.from(e,"binary"),s?xe.pbkdf2Sync.length===4?xe.pbkdf2(t,e,r,n,function(b,_){if(b)return s(b);s(null,_.toString("binary"))}):xe.pbkdf2(t,e,r,n,i,function(b,_){if(b)return s(b);s(null,_.toString("binary"))}):xe.pbkdf2Sync.length===4?xe.pbkdf2Sync(t,e,r,n).toString("binary"):xe.pbkdf2Sync(t,e,r,n,i).toString("binary");if((typeof i>"u"||i===null)&&(i="sha1"),typeof i=="string"){if(!(i in Mt.md.algorithms))throw new Error("Unknown hash algorithm: "+i);i=Mt.md[i].create()}var a=i.digestLength;if(n>4294967295*a){var o=new Error("Derived key is too long.");if(s)return s(o);throw o}var c=Math.ceil(n/a),f=n-(c-1)*a,u=Mt.hmac.create();u.start(i,t);var h="",l,g,d;if(!s){for(var p=1;p<=c;++p){u.start(null,null),u.update(e),u.update(Mt.util.int32ToBytes(p)),l=d=u.digest().getBytes();for(var y=2;y<=r;++y)u.start(null,null),u.update(d),g=u.digest().getBytes(),l=Mt.util.xorBytes(l,g,a),d=g;h+=p<c?l:l.substr(0,f)}return h}var p=1,y;function m(){if(p>c)return s(null,h);u.start(null,null),u.update(e),u.update(Mt.util.int32ToBytes(p)),l=d=u.digest().getBytes(),y=2,E()}function E(){if(y<=r)return u.start(null,null),u.update(d),g=u.digest().getBytes(),l=Mt.util.xorBytes(l,g,a),d=g,++y,Mt.util.setImmediate(E);h+=p<c?l:l.substr(0,f),++p,m()}m()}});var na=j((Ly,ra)=>{var Nn=ot();Et();var ea=ra.exports=Nn.pem=Nn.pem||{};ea.encode=function(t,e){e=e||{};var r="-----BEGIN "+t.type+`-----\r
`,n;if(t.procType&&(n={name:"Proc-Type",values:[String(t.procType.version),t.procType.type]},r+=Ln(n)),t.contentDomain&&(n={name:"Content-Domain",values:[t.contentDomain]},r+=Ln(n)),t.dekInfo&&(n={name:"DEK-Info",values:[t.dekInfo.algorithm]},t.dekInfo.parameters&&n.values.push(t.dekInfo.parameters),r+=Ln(n)),t.headers)for(var i=0;i<t.headers.length;++i)r+=Ln(t.headers[i]);return t.procType&&(r+=`\r
`),r+=Nn.util.encode64(t.body,e.maxline||64)+`\r
`,r+="-----END "+t.type+`-----\r
`,r};ea.decode=function(t){for(var e=[],r=/\s*-----BEGIN ([A-Z0-9- ]+)-----\r?\n?([\x21-\x7e\s]+?(?:\r?\n\r?\n))?([:A-Za-z0-9+\/=\s]+?)-----END \1-----/g,n=/([\x21-\x7e]+):\s*([\x21-\x7e\s^:]+)/,i=/\r?\n/,s;s=r.exec(t),!!s;){var a=s[1];a==="NEW CERTIFICATE REQUEST"&&(a="CERTIFICATE REQUEST");var o={type:a,procType:null,contentDomain:null,dekInfo:null,headers:[],body:Nn.util.decode64(s[3])};if(e.push(o),!!s[2]){for(var c=s[2].split(i),f=0;s&&f<c.length;){for(var u=c[f].replace(/\s+$/,""),h=f+1;h<c.length;++h){var l=c[h];if(!/\s/.test(l[0]))break;u+=l,f=h}if(s=u.match(n),s){for(var g={name:s[1],values:[]},d=s[2].split(","),p=0;p<d.length;++p)g.values.push(Tu(d[p]));if(o.procType)if(!o.contentDomain&&g.name==="Content-Domain")o.contentDomain=d[0]||"";else if(!o.dekInfo&&g.name==="DEK-Info"){if(g.values.length===0)throw new Error('Invalid PEM formatted message. The "DEK-Info" header must have at least one subfield.');o.dekInfo={algorithm:d[0],parameters:d[1]||null}}else o.headers.push(g);else{if(g.name!=="Proc-Type")throw new Error('Invalid PEM formatted message. The first encapsulated header must be "Proc-Type".');if(g.values.length!==2)throw new Error('Invalid PEM formatted message. The "Proc-Type" header must have two subfields.');o.procType={version:d[0],type:d[1]}}}++f}if(o.procType==="ENCRYPTED"&&!o.dekInfo)throw new Error('Invalid PEM formatted message. The "DEK-Info" header must be present if "Proc-Type" is "ENCRYPTED".')}}if(e.length===0)throw new Error("Invalid PEM formatted message.");return e};function Ln(t){for(var e=t.name+": ",r=[],n=function(c,f){return" "+f},i=0;i<t.values.length;++i)r.push(t.values[i].replace(/^(\S+\r\n)/,n));e+=r.join(",")+`\r
`;for(var s=0,a=-1,i=0;i<e.length;++i,++s)if(s>65&&a!==-1){var o=e[a];o===","?(++a,e=e.substr(0,a)+`\r
 `+e.substr(a)):e=e.substr(0,a)+`\r
`+o+e.substr(a+1),s=i-a-1,a=-1,++i}else(e[i]===" "||e[i]==="	"||e[i]===",")&&(a=i);return e}function Tu(t){return t.replace(/^\s+/,"")}});var fa=j((Ny,ca)=>{var se=ot();Ze();Et();var sa=ca.exports=se.sha256=se.sha256||{};se.md.sha256=se.md.algorithms.sha256=sa;sa.create=function(){oa||_u();var t=null,e=se.util.createBuffer(),r=new Array(64),n={algorithm:"sha256",blockLength:64,digestLength:32,messageLength:0,fullMessageLength:null,messageLengthSize:8};return n.start=function(){n.messageLength=0,n.fullMessageLength=n.messageLength64=[];for(var i=n.messageLengthSize/4,s=0;s<i;++s)n.fullMessageLength.push(0);return e=se.util.createBuffer(),t={h0:1779033703,h1:3144134277,h2:1013904242,h3:2773480762,h4:1359893119,h5:2600822924,h6:528734635,h7:1541459225},n},n.start(),n.update=function(i,s){s==="utf8"&&(i=se.util.encodeUtf8(i));var a=i.length;n.messageLength+=a,a=[a/4294967296>>>0,a>>>0];for(var o=n.fullMessageLength.length-1;o>=0;--o)n.fullMessageLength[o]+=a[1],a[1]=a[0]+(n.fullMessageLength[o]/4294967296>>>0),n.fullMessageLength[o]=n.fullMessageLength[o]>>>0,a[0]=a[1]/4294967296>>>0;return e.putBytes(i),ia(t,r,e),(e.read>2048||e.length()===0)&&e.compact(),n},n.digest=function(){var i=se.util.createBuffer();i.putBytes(e.bytes());var s=n.fullMessageLength[n.fullMessageLength.length-1]+n.messageLengthSize,a=s&n.blockLength-1;i.putBytes(Xi.substr(0,n.blockLength-a));for(var o,c,f=n.fullMessageLength[0]*8,u=0;u<n.fullMessageLength.length-1;++u)o=n.fullMessageLength[u+1]*8,c=o/4294967296>>>0,f+=c,i.putInt32(f>>>0),f=o>>>0;i.putInt32(f);var h={h0:t.h0,h1:t.h1,h2:t.h2,h3:t.h3,h4:t.h4,h5:t.h5,h6:t.h6,h7:t.h7};ia(h,r,i);var l=se.util.createBuffer();return l.putInt32(h.h0),l.putInt32(h.h1),l.putInt32(h.h2),l.putInt32(h.h3),l.putInt32(h.h4),l.putInt32(h.h5),l.putInt32(h.h6),l.putInt32(h.h7),l},n};var Xi=null,oa=!1,aa=null;function _u(){Xi=String.fromCharCode(128),Xi+=se.util.fillString(String.fromCharCode(0),64),aa=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298],oa=!0}function ia(t,e,r){for(var n,i,s,a,o,c,f,u,h,l,g,d,p,y,m,E=r.length();E>=64;){for(f=0;f<16;++f)e[f]=r.getInt32();for(;f<64;++f)n=e[f-2],n=(n>>>17|n<<15)^(n>>>19|n<<13)^n>>>10,i=e[f-15],i=(i>>>7|i<<25)^(i>>>18|i<<14)^i>>>3,e[f]=n+e[f-7]+i+e[f-16]|0;for(u=t.h0,h=t.h1,l=t.h2,g=t.h3,d=t.h4,p=t.h5,y=t.h6,m=t.h7,f=0;f<64;++f)a=(d>>>6|d<<26)^(d>>>11|d<<21)^(d>>>25|d<<7),o=y^d&(p^y),s=(u>>>2|u<<30)^(u>>>13|u<<19)^(u>>>22|u<<10),c=u&h|l&(u^h),n=m+a+o+aa[f]+e[f],i=s+c,m=y,y=p,p=d,d=g+n>>>0,g=l,l=h,h=u,u=n+i>>>0;t.h0=t.h0+u|0,t.h1=t.h1+h|0,t.h2=t.h2+l|0,t.h3=t.h3+g|0,t.h4=t.h4+d|0,t.h5=t.h5+p|0,t.h6=t.h6+y|0,t.h7=t.h7+m|0,E-=64}}});var ha=j((Dy,ua)=>{var oe=ot();Et();var Dn=null;oe.util.isNodejs&&!oe.options.usePureJavaScript&&!process.versions["node-webkit"]&&(Dn=Rn());var Ru=ua.exports=oe.prng=oe.prng||{};Ru.create=function(t){for(var e={plugin:t,key:null,seed:null,time:null,reseeds:0,generated:0,keyBytes:""},r=t.md,n=new Array(32),i=0;i<32;++i)n[i]=r.create();e.pools=n,e.pool=0,e.generate=function(f,u){if(!u)return e.generateSync(f);var h=e.plugin.cipher,l=e.plugin.increment,g=e.plugin.formatKey,d=e.plugin.formatSeed,p=oe.util.createBuffer();e.key=null,y();function y(m){if(m)return u(m);if(p.length()>=f)return u(null,p.getBytes(f));if(e.generated>1048575&&(e.key=null),e.key===null)return oe.util.nextTick(function(){s(y)});var E=h(e.key,e.seed);e.generated+=E.length,p.putBytes(E),e.key=g(h(e.key,l(e.seed))),e.seed=d(h(e.key,e.seed)),oe.util.setImmediate(y)}},e.generateSync=function(f){var u=e.plugin.cipher,h=e.plugin.increment,l=e.plugin.formatKey,g=e.plugin.formatSeed;e.key=null;for(var d=oe.util.createBuffer();d.length()<f;){e.generated>1048575&&(e.key=null),e.key===null&&a();var p=u(e.key,e.seed);e.generated+=p.length,d.putBytes(p),e.key=l(u(e.key,h(e.seed))),e.seed=g(u(e.key,e.seed))}return d.getBytes(f)};function s(f){if(e.pools[0].messageLength>=32)return o(),f();var u=32-e.pools[0].messageLength<<5;e.seedFile(u,function(h,l){if(h)return f(h);e.collect(l),o(),f()})}function a(){if(e.pools[0].messageLength>=32)return o();var f=32-e.pools[0].messageLength<<5;e.collect(e.seedFileSync(f)),o()}function o(){e.reseeds=e.reseeds===4294967295?0:e.reseeds+1;var f=e.plugin.md.create();f.update(e.keyBytes);for(var u=1,h=0;h<32;++h)e.reseeds%u===0&&(f.update(e.pools[h].digest().getBytes()),e.pools[h].start()),u=u<<1;e.keyBytes=f.digest().getBytes(),f.start(),f.update(e.keyBytes);var l=f.digest().getBytes();e.key=e.plugin.formatKey(e.keyBytes),e.seed=e.plugin.formatSeed(l),e.generated=0}function c(f){var u=null,h=oe.util.globalScope,l=h.crypto||h.msCrypto;l&&l.getRandomValues&&(u=function(w){return l.getRandomValues(w)});var g=oe.util.createBuffer();if(u)for(;g.length()<f;){var d=Math.max(1,Math.min(f-g.length(),65536)/4),p=new Uint32Array(Math.floor(d));try{u(p);for(var y=0;y<p.length;++y)g.putInt32(p[y])}catch(w){if(!(typeof QuotaExceededError<"u"&&w instanceof QuotaExceededError))throw w}}if(g.length()<f)for(var m,E,b,_=Math.floor(Math.random()*65536);g.length()<f;){E=16807*(_&65535),m=16807*(_>>16),E+=(m&32767)<<16,E+=m>>15,E=(E&2147483647)+(E>>31),_=E&4294967295;for(var y=0;y<3;++y)b=_>>>(y<<3),b^=Math.floor(Math.random()*256),g.putByte(b&255)}return g.getBytes(f)}return Dn?(e.seedFile=function(f,u){Dn.randomBytes(f,function(h,l){if(h)return u(h);u(null,l.toString())})},e.seedFileSync=function(f){return Dn.randomBytes(f).toString()}):(e.seedFile=function(f,u){try{u(null,c(f))}catch(h){u(h)}},e.seedFileSync=c),e.collect=function(f){for(var u=f.length,h=0;h<u;++h)e.pools[e.pool].update(f.substr(h,1)),e.pool=e.pool===31?0:e.pool+1},e.collectInt=function(f,u){for(var h="",l=0;l<u;l+=8)h+=String.fromCharCode(f>>l&255);e.collect(h)},e.registerWorker=function(f){if(f===self)e.seedFile=function(h,l){function g(d){var p=d.data;p.forge&&p.forge.prng&&(self.removeEventListener("message",g),l(p.forge.prng.err,p.forge.prng.bytes))}self.addEventListener("message",g),self.postMessage({forge:{prng:{needed:h}}})};else{var u=function(h){var l=h.data;l.forge&&l.forge.prng&&e.seedFile(l.forge.prng.needed,function(g,d){f.postMessage({forge:{prng:{err:g,bytes:d}}})})};f.addEventListener("message",u)}},e}});var Jr=j((ky,Ji)=>{var Rt=ot();Sn();fa();ha();Et();(function(){if(Rt.random&&Rt.random.getBytes){Ji.exports=Rt.random;return}(function(t){var e={},r=new Array(4),n=Rt.util.createBuffer();e.formatKey=function(h){var l=Rt.util.createBuffer(h);return h=new Array(4),h[0]=l.getInt32(),h[1]=l.getInt32(),h[2]=l.getInt32(),h[3]=l.getInt32(),Rt.aes._expandKey(h,!1)},e.formatSeed=function(h){var l=Rt.util.createBuffer(h);return h=new Array(4),h[0]=l.getInt32(),h[1]=l.getInt32(),h[2]=l.getInt32(),h[3]=l.getInt32(),h},e.cipher=function(h,l){return Rt.aes._updateBlock(h,l,r,!1),n.putInt32(r[0]),n.putInt32(r[1]),n.putInt32(r[2]),n.putInt32(r[3]),n.getBytes()},e.increment=function(h){return++h[3],h},e.md=Rt.md.sha256;function i(){var h=Rt.prng.create(e);return h.getBytes=function(l,g){return h.generate(l,g)},h.getBytesSync=function(l){return h.generate(l)},h}var s=i(),a=null,o=Rt.util.globalScope,c=o.crypto||o.msCrypto;if(c&&c.getRandomValues&&(a=function(h){return c.getRandomValues(h)}),Rt.options.usePureJavaScript||!Rt.util.isNodejs&&!a){if(typeof window>"u"||window.document,s.collectInt(+new Date,32),typeof navigator<"u"){var f="";for(var u in navigator)try{typeof navigator[u]=="string"&&(f+=navigator[u])}catch{}s.collect(f),f=null}t&&(t().mousemove(function(h){s.collectInt(h.clientX,16),s.collectInt(h.clientY,16)}),t().keypress(function(h){s.collectInt(h.charCode,8)}))}if(!Rt.random)Rt.random=s;else for(var u in s)Rt.random[u]=s[u];Rt.random.createInstance=i,Ji.exports=Rt.random})(typeof jQuery<"u"?jQuery:null)})()});var ya=j((Py,pa)=>{var Vt=ot();Et();var ji=[217,120,249,196,25,221,181,237,40,233,253,121,74,160,216,157,198,126,55,131,43,118,83,142,98,76,100,136,68,139,251,162,23,154,89,245,135,179,79,19,97,69,109,141,9,129,125,50,189,143,64,235,134,183,123,11,240,149,33,34,92,107,78,130,84,214,101,147,206,96,178,28,115,86,192,20,167,140,241,220,18,117,202,31,59,190,228,209,66,61,212,48,163,60,182,38,111,191,14,218,70,105,7,87,39,242,29,155,188,148,67,3,248,17,199,246,144,239,62,231,6,195,213,47,200,102,30,215,8,232,234,222,128,82,238,247,132,170,114,172,53,77,106,42,150,26,210,113,90,21,73,116,75,159,208,94,4,24,164,236,194,224,65,110,15,81,203,204,36,145,175,80,161,244,112,57,153,124,58,133,35,184,180,122,252,2,54,91,37,85,151,49,45,93,250,152,227,138,146,174,5,223,41,16,103,108,186,201,211,0,230,207,225,158,168,44,99,22,1,63,88,226,137,169,13,56,52,27,171,51,255,176,187,72,12,95,185,177,205,46,197,243,219,71,229,165,156,119,10,166,32,104,254,127,193,173],la=[1,2,3,5],Lu=function(t,e){return t<<e&65535|(t&65535)>>16-e},Nu=function(t,e){return(t&65535)>>e|t<<16-e&65535};pa.exports=Vt.rc2=Vt.rc2||{};Vt.rc2.expandKey=function(t,e){typeof t=="string"&&(t=Vt.util.createBuffer(t)),e=e||128;var r=t,n=t.length(),i=e,s=Math.ceil(i/8),a=255>>(i&7),o;for(o=n;o<128;o++)r.putByte(ji[r.at(o-1)+r.at(o-n)&255]);for(r.setAt(128-s,ji[r.at(128-s)&a]),o=127-s;o>=0;o--)r.setAt(o,ji[r.at(o+1)^r.at(o+s)]);return r};var da=function(t,e,r){var n=!1,i=null,s=null,a=null,o,c,f,u,h=[];for(t=Vt.rc2.expandKey(t,e),f=0;f<64;f++)h.push(t.getInt16Le());r?(o=function(d){for(f=0;f<4;f++)d[f]+=h[u]+(d[(f+3)%4]&d[(f+2)%4])+(~d[(f+3)%4]&d[(f+1)%4]),d[f]=Lu(d[f],la[f]),u++},c=function(d){for(f=0;f<4;f++)d[f]+=h[d[(f+3)%4]&63]}):(o=function(d){for(f=3;f>=0;f--)d[f]=Nu(d[f],la[f]),d[f]-=h[u]+(d[(f+3)%4]&d[(f+2)%4])+(~d[(f+3)%4]&d[(f+1)%4]),u--},c=function(d){for(f=3;f>=0;f--)d[f]-=h[d[(f+3)%4]&63]});var l=function(d){var p=[];for(f=0;f<4;f++){var y=i.getInt16Le();a!==null&&(r?y^=a.getInt16Le():a.putInt16Le(y)),p.push(y&65535)}u=r?0:63;for(var m=0;m<d.length;m++)for(var E=0;E<d[m][0];E++)d[m][1](p);for(f=0;f<4;f++)a!==null&&(r?a.putInt16Le(p[f]):p[f]^=a.getInt16Le()),s.putInt16Le(p[f])},g=null;return g={start:function(d,p){d&&typeof d=="string"&&(d=Vt.util.createBuffer(d)),n=!1,i=Vt.util.createBuffer(),s=p||new Vt.util.createBuffer,a=d,g.output=s},update:function(d){for(n||i.putBuffer(d);i.length()>=8;)l([[5,o],[1,c],[6,o],[1,c],[5,o]])},finish:function(d){var p=!0;if(r)if(d)p=d(8,i,!r);else{var y=i.length()===8?8:8-i.length();i.fillWithByte(y,y)}if(p&&(n=!0,g.update()),!r&&(p=i.length()===0,p))if(d)p=d(8,s,!r);else{var m=s.length(),E=s.at(m-1);E>m?p=!1:s.truncate(E)}return p}},g};Vt.rc2.startEncrypting=function(t,e,r){var n=Vt.rc2.createEncryptionCipher(t,128);return n.start(e,r),n};Vt.rc2.createEncryptionCipher=function(t,e){return da(t,e,!0)};Vt.rc2.startDecrypting=function(t,e,r){var n=Vt.rc2.createDecryptionCipher(t,128);return n.start(e,r),n};Vt.rc2.createDecryptionCipher=function(t,e){return da(t,e,!1)}});var Kn=j((Ky,Sa)=>{var ts=ot();Sa.exports=ts.jsbn=ts.jsbn||{};var me,Du=0xdeadbeefcafe,ga=(Du&16777215)==15715070;function C(t,e,r){this.data=[],t!=null&&(typeof t=="number"?this.fromNumber(t,e,r):e==null&&typeof t!="string"?this.fromString(t,256):this.fromString(t,e))}ts.jsbn.BigInteger=C;function rt(){return new C(null)}function ku(t,e,r,n,i,s){for(;--s>=0;){var a=e*this.data[t++]+r.data[n]+i;i=Math.floor(a/67108864),r.data[n++]=a&67108863}return i}function Pu(t,e,r,n,i,s){for(var a=e&32767,o=e>>15;--s>=0;){var c=this.data[t]&32767,f=this.data[t++]>>15,u=o*c+f*a;c=a*c+((u&32767)<<15)+r.data[n]+(i&1073741823),i=(c>>>30)+(u>>>15)+o*f+(i>>>30),r.data[n++]=c&1073741823}return i}function xa(t,e,r,n,i,s){for(var a=e&16383,o=e>>14;--s>=0;){var c=this.data[t]&16383,f=this.data[t++]>>14,u=o*c+f*a;c=a*c+((u&16383)<<14)+r.data[n]+i,i=(c>>28)+(u>>14)+o*f,r.data[n++]=c&268435455}return i}typeof navigator>"u"?(C.prototype.am=xa,me=28):ga&&navigator.appName=="Microsoft Internet Explorer"?(C.prototype.am=Pu,me=30):ga&&navigator.appName!="Netscape"?(C.prototype.am=ku,me=26):(C.prototype.am=xa,me=28);C.prototype.DB=me;C.prototype.DM=(1<<me)-1;C.prototype.DV=1<<me;var es=52;C.prototype.FV=Math.pow(2,es);C.prototype.F1=es-me;C.prototype.F2=2*me-es;var Ku="0123456789abcdefghijklmnopqrstuvwxyz",kn=new Array,wr,Wt;wr="0".charCodeAt(0);for(Wt=0;Wt<=9;++Wt)kn[wr++]=Wt;wr="a".charCodeAt(0);for(Wt=10;Wt<36;++Wt)kn[wr++]=Wt;wr="A".charCodeAt(0);for(Wt=10;Wt<36;++Wt)kn[wr++]=Wt;function ma(t){return Ku.charAt(t)}function va(t,e){var r=kn[t.charCodeAt(e)];return r??-1}function Uu(t){for(var e=this.t-1;e>=0;--e)t.data[e]=this.data[e];t.t=this.t,t.s=this.s}function Ou(t){this.t=1,this.s=t<0?-1:0,t>0?this.data[0]=t:t<-1?this.data[0]=t+this.DV:this.t=0}function Pe(t){var e=rt();return e.fromInt(t),e}function Mu(t,e){var r;if(e==16)r=4;else if(e==8)r=3;else if(e==256)r=8;else if(e==2)r=1;else if(e==32)r=5;else if(e==4)r=2;else{this.fromRadix(t,e);return}this.t=0,this.s=0;for(var n=t.length,i=!1,s=0;--n>=0;){var a=r==8?t[n]&255:va(t,n);if(a<0){t.charAt(n)=="-"&&(i=!0);continue}i=!1,s==0?this.data[this.t++]=a:s+r>this.DB?(this.data[this.t-1]|=(a&(1<<this.DB-s)-1)<<s,this.data[this.t++]=a>>this.DB-s):this.data[this.t-1]|=a<<s,s+=r,s>=this.DB&&(s-=this.DB)}r==8&&t[0]&128&&(this.s=-1,s>0&&(this.data[this.t-1]|=(1<<this.DB-s)-1<<s)),this.clamp(),i&&C.ZERO.subTo(this,this)}function Fu(){for(var t=this.s&this.DM;this.t>0&&this.data[this.t-1]==t;)--this.t}function Vu(t){if(this.s<0)return"-"+this.negate().toString(t);var e;if(t==16)e=4;else if(t==8)e=3;else if(t==2)e=1;else if(t==32)e=5;else if(t==4)e=2;else return this.toRadix(t);var r=(1<<e)-1,n,i=!1,s="",a=this.t,o=this.DB-a*this.DB%e;if(a-- >0)for(o<this.DB&&(n=this.data[a]>>o)>0&&(i=!0,s=ma(n));a>=0;)o<e?(n=(this.data[a]&(1<<o)-1)<<e-o,n|=this.data[--a]>>(o+=this.DB-e)):(n=this.data[a]>>(o-=e)&r,o<=0&&(o+=this.DB,--a)),n>0&&(i=!0),i&&(s+=ma(n));return i?s:"0"}function qu(){var t=rt();return C.ZERO.subTo(this,t),t}function Hu(){return this.s<0?this.negate():this}function zu(t){var e=this.s-t.s;if(e!=0)return e;var r=this.t;if(e=r-t.t,e!=0)return this.s<0?-e:e;for(;--r>=0;)if((e=this.data[r]-t.data[r])!=0)return e;return 0}function Pn(t){var e=1,r;return(r=t>>>16)!=0&&(t=r,e+=16),(r=t>>8)!=0&&(t=r,e+=8),(r=t>>4)!=0&&(t=r,e+=4),(r=t>>2)!=0&&(t=r,e+=2),(r=t>>1)!=0&&(t=r,e+=1),e}function Gu(){return this.t<=0?0:this.DB*(this.t-1)+Pn(this.data[this.t-1]^this.s&this.DM)}function Yu(t,e){var r;for(r=this.t-1;r>=0;--r)e.data[r+t]=this.data[r];for(r=t-1;r>=0;--r)e.data[r]=0;e.t=this.t+t,e.s=this.s}function $u(t,e){for(var r=t;r<this.t;++r)e.data[r-t]=this.data[r];e.t=Math.max(this.t-t,0),e.s=this.s}function Wu(t,e){var r=t%this.DB,n=this.DB-r,i=(1<<n)-1,s=Math.floor(t/this.DB),a=this.s<<r&this.DM,o;for(o=this.t-1;o>=0;--o)e.data[o+s+1]=this.data[o]>>n|a,a=(this.data[o]&i)<<r;for(o=s-1;o>=0;--o)e.data[o]=0;e.data[s]=a,e.t=this.t+s+1,e.s=this.s,e.clamp()}function Zu(t,e){e.s=this.s;var r=Math.floor(t/this.DB);if(r>=this.t){e.t=0;return}var n=t%this.DB,i=this.DB-n,s=(1<<n)-1;e.data[0]=this.data[r]>>n;for(var a=r+1;a<this.t;++a)e.data[a-r-1]|=(this.data[a]&s)<<i,e.data[a-r]=this.data[a]>>n;n>0&&(e.data[this.t-r-1]|=(this.s&s)<<i),e.t=this.t-r,e.clamp()}function Qu(t,e){for(var r=0,n=0,i=Math.min(t.t,this.t);r<i;)n+=this.data[r]-t.data[r],e.data[r++]=n&this.DM,n>>=this.DB;if(t.t<this.t){for(n-=t.s;r<this.t;)n+=this.data[r],e.data[r++]=n&this.DM,n>>=this.DB;n+=this.s}else{for(n+=this.s;r<t.t;)n-=t.data[r],e.data[r++]=n&this.DM,n>>=this.DB;n-=t.s}e.s=n<0?-1:0,n<-1?e.data[r++]=this.DV+n:n>0&&(e.data[r++]=n),e.t=r,e.clamp()}function Xu(t,e){var r=this.abs(),n=t.abs(),i=r.t;for(e.t=i+n.t;--i>=0;)e.data[i]=0;for(i=0;i<n.t;++i)e.data[i+r.t]=r.am(0,n.data[i],e,i,0,r.t);e.s=0,e.clamp(),this.s!=t.s&&C.ZERO.subTo(e,e)}function Ju(t){for(var e=this.abs(),r=t.t=2*e.t;--r>=0;)t.data[r]=0;for(r=0;r<e.t-1;++r){var n=e.am(r,e.data[r],t,2*r,0,1);(t.data[r+e.t]+=e.am(r+1,2*e.data[r],t,2*r+1,n,e.t-r-1))>=e.DV&&(t.data[r+e.t]-=e.DV,t.data[r+e.t+1]=1)}t.t>0&&(t.data[t.t-1]+=e.am(r,e.data[r],t,2*r,0,1)),t.s=0,t.clamp()}function ju(t,e,r){var n=t.abs();if(!(n.t<=0)){var i=this.abs();if(i.t<n.t){e?.fromInt(0),r!=null&&this.copyTo(r);return}r==null&&(r=rt());var s=rt(),a=this.s,o=t.s,c=this.DB-Pn(n.data[n.t-1]);c>0?(n.lShiftTo(c,s),i.lShiftTo(c,r)):(n.copyTo(s),i.copyTo(r));var f=s.t,u=s.data[f-1];if(u!=0){var h=u*(1<<this.F1)+(f>1?s.data[f-2]>>this.F2:0),l=this.FV/h,g=(1<<this.F1)/h,d=1<<this.F2,p=r.t,y=p-f,m=e??rt();for(s.dlShiftTo(y,m),r.compareTo(m)>=0&&(r.data[r.t++]=1,r.subTo(m,r)),C.ONE.dlShiftTo(f,m),m.subTo(s,s);s.t<f;)s.data[s.t++]=0;for(;--y>=0;){var E=r.data[--p]==u?this.DM:Math.floor(r.data[p]*l+(r.data[p-1]+d)*g);if((r.data[p]+=s.am(0,E,r,y,0,f))<E)for(s.dlShiftTo(y,m),r.subTo(m,r);r.data[p]<--E;)r.subTo(m,r)}e!=null&&(r.drShiftTo(f,e),a!=o&&C.ZERO.subTo(e,e)),r.t=f,r.clamp(),c>0&&r.rShiftTo(c,r),a<0&&C.ZERO.subTo(r,r)}}}function th(t){var e=rt();return this.abs().divRemTo(t,null,e),this.s<0&&e.compareTo(C.ZERO)>0&&t.subTo(e,e),e}function Qe(t){this.m=t}function eh(t){return t.s<0||t.compareTo(this.m)>=0?t.mod(this.m):t}function rh(t){return t}function nh(t){t.divRemTo(this.m,null,t)}function ih(t,e,r){t.multiplyTo(e,r),this.reduce(r)}function sh(t,e){t.squareTo(e),this.reduce(e)}Qe.prototype.convert=eh;Qe.prototype.revert=rh;Qe.prototype.reduce=nh;Qe.prototype.mulTo=ih;Qe.prototype.sqrTo=sh;function oh(){if(this.t<1)return 0;var t=this.data[0];if(!(t&1))return 0;var e=t&3;return e=e*(2-(t&15)*e)&15,e=e*(2-(t&255)*e)&255,e=e*(2-((t&65535)*e&65535))&65535,e=e*(2-t*e%this.DV)%this.DV,e>0?this.DV-e:-e}function Xe(t){this.m=t,this.mp=t.invDigit(),this.mpl=this.mp&32767,this.mph=this.mp>>15,this.um=(1<<t.DB-15)-1,this.mt2=2*t.t}function ah(t){var e=rt();return t.abs().dlShiftTo(this.m.t,e),e.divRemTo(this.m,null,e),t.s<0&&e.compareTo(C.ZERO)>0&&this.m.subTo(e,e),e}function ch(t){var e=rt();return t.copyTo(e),this.reduce(e),e}function fh(t){for(;t.t<=this.mt2;)t.data[t.t++]=0;for(var e=0;e<this.m.t;++e){var r=t.data[e]&32767,n=r*this.mpl+((r*this.mph+(t.data[e]>>15)*this.mpl&this.um)<<15)&t.DM;for(r=e+this.m.t,t.data[r]+=this.m.am(0,n,t,e,0,this.m.t);t.data[r]>=t.DV;)t.data[r]-=t.DV,t.data[++r]++}t.clamp(),t.drShiftTo(this.m.t,t),t.compareTo(this.m)>=0&&t.subTo(this.m,t)}function uh(t,e){t.squareTo(e),this.reduce(e)}function hh(t,e,r){t.multiplyTo(e,r),this.reduce(r)}Xe.prototype.convert=ah;Xe.prototype.revert=ch;Xe.prototype.reduce=fh;Xe.prototype.mulTo=hh;Xe.prototype.sqrTo=uh;function lh(){return(this.t>0?this.data[0]&1:this.s)==0}function dh(t,e){if(t>4294967295||t<1)return C.ONE;var r=rt(),n=rt(),i=e.convert(this),s=Pn(t)-1;for(i.copyTo(r);--s>=0;)if(e.sqrTo(r,n),(t&1<<s)>0)e.mulTo(n,i,r);else{var a=r;r=n,n=a}return e.revert(r)}function ph(t,e){var r;return t<256||e.isEven()?r=new Qe(e):r=new Xe(e),this.exp(t,r)}C.prototype.copyTo=Uu;C.prototype.fromInt=Ou;C.prototype.fromString=Mu;C.prototype.clamp=Fu;C.prototype.dlShiftTo=Yu;C.prototype.drShiftTo=$u;C.prototype.lShiftTo=Wu;C.prototype.rShiftTo=Zu;C.prototype.subTo=Qu;C.prototype.multiplyTo=Xu;C.prototype.squareTo=Ju;C.prototype.divRemTo=ju;C.prototype.invDigit=oh;C.prototype.isEven=lh;C.prototype.exp=dh;C.prototype.toString=Vu;C.prototype.negate=qu;C.prototype.abs=Hu;C.prototype.compareTo=zu;C.prototype.bitLength=Gu;C.prototype.mod=th;C.prototype.modPowInt=ph;C.ZERO=Pe(0);C.ONE=Pe(1);function yh(){var t=rt();return this.copyTo(t),t}function gh(){if(this.s<0){if(this.t==1)return this.data[0]-this.DV;if(this.t==0)return-1}else{if(this.t==1)return this.data[0];if(this.t==0)return 0}return(this.data[1]&(1<<32-this.DB)-1)<<this.DB|this.data[0]}function xh(){return this.t==0?this.s:this.data[0]<<24>>24}function mh(){return this.t==0?this.s:this.data[0]<<16>>16}function vh(t){return Math.floor(Math.LN2*this.DB/Math.log(t))}function bh(){return this.s<0?-1:this.t<=0||this.t==1&&this.data[0]<=0?0:1}function Eh(t){if(t==null&&(t=10),this.signum()==0||t<2||t>36)return"0";var e=this.chunkSize(t),r=Math.pow(t,e),n=Pe(r),i=rt(),s=rt(),a="";for(this.divRemTo(n,i,s);i.signum()>0;)a=(r+s.intValue()).toString(t).substr(1)+a,i.divRemTo(n,i,s);return s.intValue().toString(t)+a}function wh(t,e){this.fromInt(0),e==null&&(e=10);for(var r=this.chunkSize(e),n=Math.pow(e,r),i=!1,s=0,a=0,o=0;o<t.length;++o){var c=va(t,o);if(c<0){t.charAt(o)=="-"&&this.signum()==0&&(i=!0);continue}a=e*a+c,++s>=r&&(this.dMultiply(n),this.dAddOffset(a,0),s=0,a=0)}s>0&&(this.dMultiply(Math.pow(e,s)),this.dAddOffset(a,0)),i&&C.ZERO.subTo(this,this)}function Sh(t,e,r){if(typeof e=="number")if(t<2)this.fromInt(1);else for(this.fromNumber(t,r),this.testBit(t-1)||this.bitwiseTo(C.ONE.shiftLeft(t-1),rs,this),this.isEven()&&this.dAddOffset(1,0);!this.isProbablePrime(e);)this.dAddOffset(2,0),this.bitLength()>t&&this.subTo(C.ONE.shiftLeft(t-1),this);else{var n=new Array,i=t&7;n.length=(t>>3)+1,e.nextBytes(n),i>0?n[0]&=(1<<i)-1:n[0]=0,this.fromString(n,256)}}function Bh(){var t=this.t,e=new Array;e[0]=this.s;var r=this.DB-t*this.DB%8,n,i=0;if(t-- >0)for(r<this.DB&&(n=this.data[t]>>r)!=(this.s&this.DM)>>r&&(e[i++]=n|this.s<<this.DB-r);t>=0;)r<8?(n=(this.data[t]&(1<<r)-1)<<8-r,n|=this.data[--t]>>(r+=this.DB-8)):(n=this.data[t]>>(r-=8)&255,r<=0&&(r+=this.DB,--t)),n&128&&(n|=-256),i==0&&(this.s&128)!=(n&128)&&++i,(i>0||n!=this.s)&&(e[i++]=n);return e}function Ah(t){return this.compareTo(t)==0}function Ch(t){return this.compareTo(t)<0?this:t}function Ih(t){return this.compareTo(t)>0?this:t}function Th(t,e,r){var n,i,s=Math.min(t.t,this.t);for(n=0;n<s;++n)r.data[n]=e(this.data[n],t.data[n]);if(t.t<this.t){for(i=t.s&this.DM,n=s;n<this.t;++n)r.data[n]=e(this.data[n],i);r.t=this.t}else{for(i=this.s&this.DM,n=s;n<t.t;++n)r.data[n]=e(i,t.data[n]);r.t=t.t}r.s=e(this.s,t.s),r.clamp()}function _h(t,e){return t&e}function Rh(t){var e=rt();return this.bitwiseTo(t,_h,e),e}function rs(t,e){return t|e}function Lh(t){var e=rt();return this.bitwiseTo(t,rs,e),e}function ba(t,e){return t^e}function Nh(t){var e=rt();return this.bitwiseTo(t,ba,e),e}function Ea(t,e){return t&~e}function Dh(t){var e=rt();return this.bitwiseTo(t,Ea,e),e}function kh(){for(var t=rt(),e=0;e<this.t;++e)t.data[e]=this.DM&~this.data[e];return t.t=this.t,t.s=~this.s,t}function Ph(t){var e=rt();return t<0?this.rShiftTo(-t,e):this.lShiftTo(t,e),e}function Kh(t){var e=rt();return t<0?this.lShiftTo(-t,e):this.rShiftTo(t,e),e}function Uh(t){if(t==0)return-1;var e=0;return t&65535||(t>>=16,e+=16),t&255||(t>>=8,e+=8),t&15||(t>>=4,e+=4),t&3||(t>>=2,e+=2),t&1||++e,e}function Oh(){for(var t=0;t<this.t;++t)if(this.data[t]!=0)return t*this.DB+Uh(this.data[t]);return this.s<0?this.t*this.DB:-1}function Mh(t){for(var e=0;t!=0;)t&=t-1,++e;return e}function Fh(){for(var t=0,e=this.s&this.DM,r=0;r<this.t;++r)t+=Mh(this.data[r]^e);return t}function Vh(t){var e=Math.floor(t/this.DB);return e>=this.t?this.s!=0:(this.data[e]&1<<t%this.DB)!=0}function qh(t,e){var r=C.ONE.shiftLeft(t);return this.bitwiseTo(r,e,r),r}function Hh(t){return this.changeBit(t,rs)}function zh(t){return this.changeBit(t,Ea)}function Gh(t){return this.changeBit(t,ba)}function Yh(t,e){for(var r=0,n=0,i=Math.min(t.t,this.t);r<i;)n+=this.data[r]+t.data[r],e.data[r++]=n&this.DM,n>>=this.DB;if(t.t<this.t){for(n+=t.s;r<this.t;)n+=this.data[r],e.data[r++]=n&this.DM,n>>=this.DB;n+=this.s}else{for(n+=this.s;r<t.t;)n+=t.data[r],e.data[r++]=n&this.DM,n>>=this.DB;n+=t.s}e.s=n<0?-1:0,n>0?e.data[r++]=n:n<-1&&(e.data[r++]=this.DV+n),e.t=r,e.clamp()}function $h(t){var e=rt();return this.addTo(t,e),e}function Wh(t){var e=rt();return this.subTo(t,e),e}function Zh(t){var e=rt();return this.multiplyTo(t,e),e}function Qh(t){var e=rt();return this.divRemTo(t,e,null),e}function Xh(t){var e=rt();return this.divRemTo(t,null,e),e}function Jh(t){var e=rt(),r=rt();return this.divRemTo(t,e,r),new Array(e,r)}function jh(t){this.data[this.t]=this.am(0,t-1,this,0,0,this.t),++this.t,this.clamp()}function tl(t,e){if(t!=0){for(;this.t<=e;)this.data[this.t++]=0;for(this.data[e]+=t;this.data[e]>=this.DV;)this.data[e]-=this.DV,++e>=this.t&&(this.data[this.t++]=0),++this.data[e]}}function jr(){}function wa(t){return t}function el(t,e,r){t.multiplyTo(e,r)}function rl(t,e){t.squareTo(e)}jr.prototype.convert=wa;jr.prototype.revert=wa;jr.prototype.mulTo=el;jr.prototype.sqrTo=rl;function nl(t){return this.exp(t,new jr)}function il(t,e,r){var n=Math.min(this.t+t.t,e);for(r.s=0,r.t=n;n>0;)r.data[--n]=0;var i;for(i=r.t-this.t;n<i;++n)r.data[n+this.t]=this.am(0,t.data[n],r,n,0,this.t);for(i=Math.min(t.t,e);n<i;++n)this.am(0,t.data[n],r,n,0,e-n);r.clamp()}function sl(t,e,r){--e;var n=r.t=this.t+t.t-e;for(r.s=0;--n>=0;)r.data[n]=0;for(n=Math.max(e-this.t,0);n<t.t;++n)r.data[this.t+n-e]=this.am(e-n,t.data[n],r,0,0,this.t+n-e);r.clamp(),r.drShiftTo(1,r)}function Sr(t){this.r2=rt(),this.q3=rt(),C.ONE.dlShiftTo(2*t.t,this.r2),this.mu=this.r2.divide(t),this.m=t}function ol(t){if(t.s<0||t.t>2*this.m.t)return t.mod(this.m);if(t.compareTo(this.m)<0)return t;var e=rt();return t.copyTo(e),this.reduce(e),e}function al(t){return t}function cl(t){for(t.drShiftTo(this.m.t-1,this.r2),t.t>this.m.t+1&&(t.t=this.m.t+1,t.clamp()),this.mu.multiplyUpperTo(this.r2,this.m.t+1,this.q3),this.m.multiplyLowerTo(this.q3,this.m.t+1,this.r2);t.compareTo(this.r2)<0;)t.dAddOffset(1,this.m.t+1);for(t.subTo(this.r2,t);t.compareTo(this.m)>=0;)t.subTo(this.m,t)}function fl(t,e){t.squareTo(e),this.reduce(e)}function ul(t,e,r){t.multiplyTo(e,r),this.reduce(r)}Sr.prototype.convert=ol;Sr.prototype.revert=al;Sr.prototype.reduce=cl;Sr.prototype.mulTo=ul;Sr.prototype.sqrTo=fl;function hl(t,e){var r=t.bitLength(),n,i=Pe(1),s;if(r<=0)return i;r<18?n=1:r<48?n=3:r<144?n=4:r<768?n=5:n=6,r<8?s=new Qe(e):e.isEven()?s=new Sr(e):s=new Xe(e);var a=new Array,o=3,c=n-1,f=(1<<n)-1;if(a[1]=s.convert(this),n>1){var u=rt();for(s.sqrTo(a[1],u);o<=f;)a[o]=rt(),s.mulTo(u,a[o-2],a[o]),o+=2}var h=t.t-1,l,g=!0,d=rt(),p;for(r=Pn(t.data[h])-1;h>=0;){for(r>=c?l=t.data[h]>>r-c&f:(l=(t.data[h]&(1<<r+1)-1)<<c-r,h>0&&(l|=t.data[h-1]>>this.DB+r-c)),o=n;!(l&1);)l>>=1,--o;if((r-=o)<0&&(r+=this.DB,--h),g)a[l].copyTo(i),g=!1;else{for(;o>1;)s.sqrTo(i,d),s.sqrTo(d,i),o-=2;o>0?s.sqrTo(i,d):(p=i,i=d,d=p),s.mulTo(d,a[l],i)}for(;h>=0&&!(t.data[h]&1<<r);)s.sqrTo(i,d),p=i,i=d,d=p,--r<0&&(r=this.DB-1,--h)}return s.revert(i)}function ll(t){var e=this.s<0?this.negate():this.clone(),r=t.s<0?t.negate():t.clone();if(e.compareTo(r)<0){var n=e;e=r,r=n}var i=e.getLowestSetBit(),s=r.getLowestSetBit();if(s<0)return e;for(i<s&&(s=i),s>0&&(e.rShiftTo(s,e),r.rShiftTo(s,r));e.signum()>0;)(i=e.getLowestSetBit())>0&&e.rShiftTo(i,e),(i=r.getLowestSetBit())>0&&r.rShiftTo(i,r),e.compareTo(r)>=0?(e.subTo(r,e),e.rShiftTo(1,e)):(r.subTo(e,r),r.rShiftTo(1,r));return s>0&&r.lShiftTo(s,r),r}function dl(t){if(t<=0)return 0;var e=this.DV%t,r=this.s<0?t-1:0;if(this.t>0)if(e==0)r=this.data[0]%t;else for(var n=this.t-1;n>=0;--n)r=(e*r+this.data[n])%t;return r}function pl(t){var e=t.isEven();if(this.isEven()&&e||t.signum()==0)return C.ZERO;for(var r=t.clone(),n=this.clone(),i=Pe(1),s=Pe(0),a=Pe(0),o=Pe(1);r.signum()!=0;){for(;r.isEven();)r.rShiftTo(1,r),e?((!i.isEven()||!s.isEven())&&(i.addTo(this,i),s.subTo(t,s)),i.rShiftTo(1,i)):s.isEven()||s.subTo(t,s),s.rShiftTo(1,s);for(;n.isEven();)n.rShiftTo(1,n),e?((!a.isEven()||!o.isEven())&&(a.addTo(this,a),o.subTo(t,o)),a.rShiftTo(1,a)):o.isEven()||o.subTo(t,o),o.rShiftTo(1,o);r.compareTo(n)>=0?(r.subTo(n,r),e&&i.subTo(a,i),s.subTo(o,s)):(n.subTo(r,n),e&&a.subTo(i,a),o.subTo(s,o))}if(n.compareTo(C.ONE)!=0)return C.ZERO;if(o.compareTo(t)>=0)return o.subtract(t);if(o.signum()<0)o.addTo(t,o);else return o;return o.signum()<0?o.add(t):o}var Jt=[2,3,5,7,11,13,17,19,23,29,31,37,41,43,47,53,59,61,67,71,73,79,83,89,97,101,103,107,109,113,127,131,137,139,149,151,157,163,167,173,179,181,191,193,197,199,211,223,227,229,233,239,241,251,257,263,269,271,277,281,283,293,307,311,313,317,331,337,347,349,353,359,367,373,379,383,389,397,401,409,419,421,431,433,439,443,449,457,461,463,467,479,487,491,499,503,509],yl=(1<<26)/Jt[Jt.length-1];function gl(t){var e,r=this.abs();if(r.t==1&&r.data[0]<=Jt[Jt.length-1]){for(e=0;e<Jt.length;++e)if(r.data[0]==Jt[e])return!0;return!1}if(r.isEven())return!1;for(e=1;e<Jt.length;){for(var n=Jt[e],i=e+1;i<Jt.length&&n<yl;)n*=Jt[i++];for(n=r.modInt(n);e<i;)if(n%Jt[e++]==0)return!1}return r.millerRabin(t)}function xl(t){var e=this.subtract(C.ONE),r=e.getLowestSetBit();if(r<=0)return!1;for(var n=e.shiftRight(r),i=ml(),s,a=0;a<t;++a){do s=new C(this.bitLength(),i);while(s.compareTo(C.ONE)<=0||s.compareTo(e)>=0);var o=s.modPow(n,this);if(o.compareTo(C.ONE)!=0&&o.compareTo(e)!=0){for(var c=1;c++<r&&o.compareTo(e)!=0;)if(o=o.modPowInt(2,this),o.compareTo(C.ONE)==0)return!1;if(o.compareTo(e)!=0)return!1}}return!0}function ml(){return{nextBytes:function(t){for(var e=0;e<t.length;++e)t[e]=Math.floor(Math.random()*256)}}}C.prototype.chunkSize=vh;C.prototype.toRadix=Eh;C.prototype.fromRadix=wh;C.prototype.fromNumber=Sh;C.prototype.bitwiseTo=Th;C.prototype.changeBit=qh;C.prototype.addTo=Yh;C.prototype.dMultiply=jh;C.prototype.dAddOffset=tl;C.prototype.multiplyLowerTo=il;C.prototype.multiplyUpperTo=sl;C.prototype.modInt=dl;C.prototype.millerRabin=xl;C.prototype.clone=yh;C.prototype.intValue=gh;C.prototype.byteValue=xh;C.prototype.shortValue=mh;C.prototype.signum=bh;C.prototype.toByteArray=Bh;C.prototype.equals=Ah;C.prototype.min=Ch;C.prototype.max=Ih;C.prototype.and=Rh;C.prototype.or=Lh;C.prototype.xor=Nh;C.prototype.andNot=Dh;C.prototype.not=kh;C.prototype.shiftLeft=Ph;C.prototype.shiftRight=Kh;C.prototype.getLowestSetBit=Oh;C.prototype.bitCount=Fh;C.prototype.testBit=Vh;C.prototype.setBit=Hh;C.prototype.clearBit=zh;C.prototype.flipBit=Gh;C.prototype.add=$h;C.prototype.subtract=Wh;C.prototype.multiply=Zh;C.prototype.divide=Qh;C.prototype.remainder=Xh;C.prototype.divideAndRemainder=Jh;C.prototype.modPow=hl;C.prototype.modInverse=pl;C.prototype.pow=nl;C.prototype.gcd=ll;C.prototype.isProbablePrime=gl});var Ta=j((Uy,Ia)=>{var ae=ot();Ze();Et();var Aa=Ia.exports=ae.sha1=ae.sha1||{};ae.md.sha1=ae.md.algorithms.sha1=Aa;Aa.create=function(){Ca||vl();var t=null,e=ae.util.createBuffer(),r=new Array(80),n={algorithm:"sha1",blockLength:64,digestLength:20,messageLength:0,fullMessageLength:null,messageLengthSize:8};return n.start=function(){n.messageLength=0,n.fullMessageLength=n.messageLength64=[];for(var i=n.messageLengthSize/4,s=0;s<i;++s)n.fullMessageLength.push(0);return e=ae.util.createBuffer(),t={h0:1732584193,h1:4023233417,h2:2562383102,h3:271733878,h4:3285377520},n},n.start(),n.update=function(i,s){s==="utf8"&&(i=ae.util.encodeUtf8(i));var a=i.length;n.messageLength+=a,a=[a/4294967296>>>0,a>>>0];for(var o=n.fullMessageLength.length-1;o>=0;--o)n.fullMessageLength[o]+=a[1],a[1]=a[0]+(n.fullMessageLength[o]/4294967296>>>0),n.fullMessageLength[o]=n.fullMessageLength[o]>>>0,a[0]=a[1]/4294967296>>>0;return e.putBytes(i),Ba(t,r,e),(e.read>2048||e.length()===0)&&e.compact(),n},n.digest=function(){var i=ae.util.createBuffer();i.putBytes(e.bytes());var s=n.fullMessageLength[n.fullMessageLength.length-1]+n.messageLengthSize,a=s&n.blockLength-1;i.putBytes(ns.substr(0,n.blockLength-a));for(var o,c,f=n.fullMessageLength[0]*8,u=0;u<n.fullMessageLength.length-1;++u)o=n.fullMessageLength[u+1]*8,c=o/4294967296>>>0,f+=c,i.putInt32(f>>>0),f=o>>>0;i.putInt32(f);var h={h0:t.h0,h1:t.h1,h2:t.h2,h3:t.h3,h4:t.h4};Ba(h,r,i);var l=ae.util.createBuffer();return l.putInt32(h.h0),l.putInt32(h.h1),l.putInt32(h.h2),l.putInt32(h.h3),l.putInt32(h.h4),l},n};var ns=null,Ca=!1;function vl(){ns=String.fromCharCode(128),ns+=ae.util.fillString(String.fromCharCode(0),64),Ca=!0}function Ba(t,e,r){for(var n,i,s,a,o,c,f,u,h=r.length();h>=64;){for(i=t.h0,s=t.h1,a=t.h2,o=t.h3,c=t.h4,u=0;u<16;++u)n=r.getInt32(),e[u]=n,f=o^s&(a^o),n=(i<<5|i>>>27)+f+c+1518500249+n,c=o,o=a,a=(s<<30|s>>>2)>>>0,s=i,i=n;for(;u<20;++u)n=e[u-3]^e[u-8]^e[u-14]^e[u-16],n=n<<1|n>>>31,e[u]=n,f=o^s&(a^o),n=(i<<5|i>>>27)+f+c+1518500249+n,c=o,o=a,a=(s<<30|s>>>2)>>>0,s=i,i=n;for(;u<32;++u)n=e[u-3]^e[u-8]^e[u-14]^e[u-16],n=n<<1|n>>>31,e[u]=n,f=s^a^o,n=(i<<5|i>>>27)+f+c+1859775393+n,c=o,o=a,a=(s<<30|s>>>2)>>>0,s=i,i=n;for(;u<40;++u)n=e[u-6]^e[u-16]^e[u-28]^e[u-32],n=n<<2|n>>>30,e[u]=n,f=s^a^o,n=(i<<5|i>>>27)+f+c+1859775393+n,c=o,o=a,a=(s<<30|s>>>2)>>>0,s=i,i=n;for(;u<60;++u)n=e[u-6]^e[u-16]^e[u-28]^e[u-32],n=n<<2|n>>>30,e[u]=n,f=s&a|o&(s^a),n=(i<<5|i>>>27)+f+c+2400959708+n,c=o,o=a,a=(s<<30|s>>>2)>>>0,s=i,i=n;for(;u<80;++u)n=e[u-6]^e[u-16]^e[u-28]^e[u-32],n=n<<2|n>>>30,e[u]=n,f=s^a^o,n=(i<<5|i>>>27)+f+c+3395469782+n,c=o,o=a,a=(s<<30|s>>>2)>>>0,s=i,i=n;t.h0=t.h0+i|0,t.h1=t.h1+s|0,t.h2=t.h2+a|0,t.h3=t.h3+o|0,t.h4=t.h4+c|0,h-=64}}});var La=j((Oy,Ra)=>{var ce=ot();Et();Jr();Ta();var _a=Ra.exports=ce.pkcs1=ce.pkcs1||{};_a.encode_rsa_oaep=function(t,e,r){var n,i,s,a;typeof r=="string"?(n=r,i=arguments[3]||void 0,s=arguments[4]||void 0):r&&(n=r.label||void 0,i=r.seed||void 0,s=r.md||void 0,r.mgf1&&r.mgf1.md&&(a=r.mgf1.md)),s?s.start():s=ce.md.sha1.create(),a||(a=s);var o=Math.ceil(t.n.bitLength()/8),c=o-2*s.digestLength-2;if(e.length>c){var f=new Error("RSAES-OAEP input message length is too long.");throw f.length=e.length,f.maxLength=c,f}n||(n=""),s.update(n,"raw");for(var u=s.digest(),h="",l=c-e.length,g=0;g<l;g++)h+="\0";var d=u.getBytes()+h+""+e;if(!i)i=ce.random.getBytes(s.digestLength);else if(i.length!==s.digestLength){var f=new Error("Invalid RSAES-OAEP seed. The seed length must match the digest length.");throw f.seedLength=i.length,f.digestLength=s.digestLength,f}var p=Un(i,o-s.digestLength-1,a),y=ce.util.xorBytes(d,p,d.length),m=Un(y,s.digestLength,a),E=ce.util.xorBytes(i,m,i.length);return"\0"+E+y};_a.decode_rsa_oaep=function(t,e,r){var n,i,s;typeof r=="string"?(n=r,i=arguments[3]||void 0):r&&(n=r.label||void 0,i=r.md||void 0,r.mgf1&&r.mgf1.md&&(s=r.mgf1.md));var a=Math.ceil(t.n.bitLength()/8);if(e.length!==a){var y=new Error("RSAES-OAEP encoded message length is invalid.");throw y.length=e.length,y.expectedLength=a,y}if(i===void 0?i=ce.md.sha1.create():i.start(),s||(s=i),a<2*i.digestLength+2)throw new Error("RSAES-OAEP key is too short for the hash function.");n||(n=""),i.update(n,"raw");for(var o=i.digest().getBytes(),c=e.charAt(0),f=e.substring(1,i.digestLength+1),u=e.substring(1+i.digestLength),h=Un(u,i.digestLength,s),l=ce.util.xorBytes(f,h,f.length),g=Un(l,a-i.digestLength-1,s),d=ce.util.xorBytes(u,g,u.length),p=d.substring(0,i.digestLength),y=c!=="\0",m=0;m<i.digestLength;++m)y|=o.charAt(m)!==p.charAt(m);for(var E=1,b=i.digestLength,_=i.digestLength;_<d.length;_++){var w=d.charCodeAt(_),S=w&1^1,L=E?65534:0;y|=w&L,E=E&S,b+=E}if(y||d.charCodeAt(b)!==1)throw new Error("Invalid RSAES-OAEP padding.");return d.substring(b+1)};function Un(t,e,r){r||(r=ce.md.sha1.create());for(var n="",i=Math.ceil(e/r.digestLength),s=0;s<i;++s){var a=String.fromCharCode(s>>24&255,s>>16&255,s>>8&255,s&255);r.start(),r.update(t+a),n+=r.digest().getBytes()}return n.substring(0,e)}});var Na=j((My,is)=>{var Ke=ot();Et();Kn();Jr();(function(){if(Ke.prime){is.exports=Ke.prime;return}var t=is.exports=Ke.prime=Ke.prime||{},e=Ke.jsbn.BigInteger,r=[6,4,2,4,2,4,6,2],n=new e(null);n.fromInt(30);var i=function(h,l){return h|l};t.generateProbablePrime=function(h,l,g){typeof l=="function"&&(g=l,l={}),l=l||{};var d=l.algorithm||"PRIMEINC";typeof d=="string"&&(d={name:d}),d.options=d.options||{};var p=l.prng||Ke.random,y={nextBytes:function(m){for(var E=p.getBytesSync(m.length),b=0;b<m.length;++b)m[b]=E.charCodeAt(b)}};if(d.name==="PRIMEINC")return s(h,y,d.options,g);throw new Error("Invalid prime generation algorithm: "+d.name)};function s(h,l,g,d){return"workers"in g?c(h,l,g,d):a(h,l,g,d)}function a(h,l,g,d){var p=f(h,l),y=0,m=u(p.bitLength());"millerRabinTests"in g&&(m=g.millerRabinTests);var E=10;"maxBlockTime"in g&&(E=g.maxBlockTime),o(p,h,l,y,m,E,d)}function o(h,l,g,d,p,y,m){var E=+new Date;do{if(h.bitLength()>l&&(h=f(l,g)),h.isProbablePrime(p))return m(null,h);h.dAddOffset(r[d++%8],0)}while(y<0||+new Date-E<y);Ke.util.setImmediate(function(){o(h,l,g,d,p,y,m)})}function c(h,l,g,d){if(typeof Worker>"u")return a(h,l,g,d);var p=f(h,l),y=g.workers,m=g.workLoad||100,E=m*30/8,b=g.workerScript||"forge/prime.worker.js";if(y===-1)return Ke.util.estimateCores(function(w,S){w&&(S=2),y=S-1,_()});_();function _(){y=Math.max(1,y);for(var w=[],S=0;S<y;++S)w[S]=new Worker(b);for(var L=y,S=0;S<y;++S)w[S].addEventListener("message",H);var N=!1;function H(z){if(!N){--L;var V=z.data;if(V.found){for(var Q=0;Q<w.length;++Q)w[Q].terminate();return N=!0,d(null,new e(V.prime,16))}p.bitLength()>h&&(p=f(h,l));var ct=p.toString(16);z.target.postMessage({hex:ct,workLoad:m}),p.dAddOffset(E,0)}}}}function f(h,l){var g=new e(h,l),d=h-1;return g.testBit(d)||g.bitwiseTo(e.ONE.shiftLeft(d),i,g),g.dAddOffset(31-g.mod(n).byteValue(),0),g}function u(h){return h<=100?27:h<=150?18:h<=200?15:h<=250?12:h<=300?9:h<=350?8:h<=400?7:h<=500?6:h<=600?5:h<=800?4:h<=1250?3:2}})()});var Mn=j((Fy,Ma)=>{var F=ot();Xr();Kn();Cn();La();Na();Jr();Et();typeof tt>"u"&&(tt=F.jsbn.BigInteger);var tt,ss=F.util.isNodejs?Rn():null,v=F.asn1,Zt=F.util;F.pki=F.pki||{};Ma.exports=F.pki.rsa=F.rsa=F.rsa||{};var G=F.pki,bl=[6,4,2,4,2,4,6,2],El={name:"PrivateKeyInfo",tagClass:v.Class.UNIVERSAL,type:v.Type.SEQUENCE,constructed:!0,value:[{name:"PrivateKeyInfo.version",tagClass:v.Class.UNIVERSAL,type:v.Type.INTEGER,constructed:!1,capture:"privateKeyVersion"},{name:"PrivateKeyInfo.privateKeyAlgorithm",tagClass:v.Class.UNIVERSAL,type:v.Type.SEQUENCE,constructed:!0,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:v.Class.UNIVERSAL,type:v.Type.OID,constructed:!1,capture:"privateKeyOid"}]},{name:"PrivateKeyInfo",tagClass:v.Class.UNIVERSAL,type:v.Type.OCTETSTRING,constructed:!1,capture:"privateKey"}]},wl={name:"RSAPrivateKey",tagClass:v.Class.UNIVERSAL,type:v.Type.SEQUENCE,constructed:!0,value:[{name:"RSAPrivateKey.version",tagClass:v.Class.UNIVERSAL,type:v.Type.INTEGER,constructed:!1,capture:"privateKeyVersion"},{name:"RSAPrivateKey.modulus",tagClass:v.Class.UNIVERSAL,type:v.Type.INTEGER,constructed:!1,capture:"privateKeyModulus"},{name:"RSAPrivateKey.publicExponent",tagClass:v.Class.UNIVERSAL,type:v.Type.INTEGER,constructed:!1,capture:"privateKeyPublicExponent"},{name:"RSAPrivateKey.privateExponent",tagClass:v.Class.UNIVERSAL,type:v.Type.INTEGER,constructed:!1,capture:"privateKeyPrivateExponent"},{name:"RSAPrivateKey.prime1",tagClass:v.Class.UNIVERSAL,type:v.Type.INTEGER,constructed:!1,capture:"privateKeyPrime1"},{name:"RSAPrivateKey.prime2",tagClass:v.Class.UNIVERSAL,type:v.Type.INTEGER,constructed:!1,capture:"privateKeyPrime2"},{name:"RSAPrivateKey.exponent1",tagClass:v.Class.UNIVERSAL,type:v.Type.INTEGER,constructed:!1,capture:"privateKeyExponent1"},{name:"RSAPrivateKey.exponent2",tagClass:v.Class.UNIVERSAL,type:v.Type.INTEGER,constructed:!1,capture:"privateKeyExponent2"},{name:"RSAPrivateKey.coefficient",tagClass:v.Class.UNIVERSAL,type:v.Type.INTEGER,constructed:!1,capture:"privateKeyCoefficient"}]},Sl={name:"RSAPublicKey",tagClass:v.Class.UNIVERSAL,type:v.Type.SEQUENCE,constructed:!0,value:[{name:"RSAPublicKey.modulus",tagClass:v.Class.UNIVERSAL,type:v.Type.INTEGER,constructed:!1,capture:"publicKeyModulus"},{name:"RSAPublicKey.exponent",tagClass:v.Class.UNIVERSAL,type:v.Type.INTEGER,constructed:!1,capture:"publicKeyExponent"}]},Bl=F.pki.rsa.publicKeyValidator={name:"SubjectPublicKeyInfo",tagClass:v.Class.UNIVERSAL,type:v.Type.SEQUENCE,constructed:!0,captureAsn1:"subjectPublicKeyInfo",value:[{name:"SubjectPublicKeyInfo.AlgorithmIdentifier",tagClass:v.Class.UNIVERSAL,type:v.Type.SEQUENCE,constructed:!0,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:v.Class.UNIVERSAL,type:v.Type.OID,constructed:!1,capture:"publicKeyOid"}]},{name:"SubjectPublicKeyInfo.subjectPublicKey",tagClass:v.Class.UNIVERSAL,type:v.Type.BITSTRING,constructed:!1,value:[{name:"SubjectPublicKeyInfo.subjectPublicKey.RSAPublicKey",tagClass:v.Class.UNIVERSAL,type:v.Type.SEQUENCE,constructed:!0,optional:!0,captureAsn1:"rsaPublicKey"}]}]},Al={name:"DigestInfo",tagClass:v.Class.UNIVERSAL,type:v.Type.SEQUENCE,constructed:!0,value:[{name:"DigestInfo.DigestAlgorithm",tagClass:v.Class.UNIVERSAL,type:v.Type.SEQUENCE,constructed:!0,value:[{name:"DigestInfo.DigestAlgorithm.algorithmIdentifier",tagClass:v.Class.UNIVERSAL,type:v.Type.OID,constructed:!1,capture:"algorithmIdentifier"},{name:"DigestInfo.DigestAlgorithm.parameters",tagClass:v.Class.UNIVERSAL,type:v.Type.NULL,capture:"parameters",optional:!0,constructed:!1}]},{name:"DigestInfo.digest",tagClass:v.Class.UNIVERSAL,type:v.Type.OCTETSTRING,constructed:!1,capture:"digest"}]},Cl=function(t){var e;if(t.algorithm in G.oids)e=G.oids[t.algorithm];else{var r=new Error("Unknown message digest algorithm.");throw r.algorithm=t.algorithm,r}var n=v.oidToDer(e).getBytes(),i=v.create(v.Class.UNIVERSAL,v.Type.SEQUENCE,!0,[]),s=v.create(v.Class.UNIVERSAL,v.Type.SEQUENCE,!0,[]);s.value.push(v.create(v.Class.UNIVERSAL,v.Type.OID,!1,n)),s.value.push(v.create(v.Class.UNIVERSAL,v.Type.NULL,!1,""));var a=v.create(v.Class.UNIVERSAL,v.Type.OCTETSTRING,!1,t.digest().getBytes());return i.value.push(s),i.value.push(a),v.toDer(i).getBytes()},Ua=function(t,e,r){if(r)return t.modPow(e.e,e.n);if(!e.p||!e.q)return t.modPow(e.d,e.n);e.dP||(e.dP=e.d.mod(e.p.subtract(tt.ONE))),e.dQ||(e.dQ=e.d.mod(e.q.subtract(tt.ONE))),e.qInv||(e.qInv=e.q.modInverse(e.p));var n;do n=new tt(F.util.bytesToHex(F.random.getBytes(e.n.bitLength()/8)),16);while(n.compareTo(e.n)>=0||!n.gcd(e.n).equals(tt.ONE));t=t.multiply(n.modPow(e.e,e.n)).mod(e.n);for(var i=t.mod(e.p).modPow(e.dP,e.p),s=t.mod(e.q).modPow(e.dQ,e.q);i.compareTo(s)<0;)i=i.add(e.p);var a=i.subtract(s).multiply(e.qInv).mod(e.p).multiply(e.q).add(s);return a=a.multiply(n.modInverse(e.n)).mod(e.n),a};G.rsa.encrypt=function(t,e,r){var n=r,i,s=Math.ceil(e.n.bitLength()/8);r!==!1&&r!==!0?(n=r===2,i=Oa(t,e,r)):(i=F.util.createBuffer(),i.putBytes(t));for(var a=new tt(i.toHex(),16),o=Ua(a,e,n),c=o.toString(16),f=F.util.createBuffer(),u=s-Math.ceil(c.length/2);u>0;)f.putByte(0),--u;return f.putBytes(F.util.hexToBytes(c)),f.getBytes()};G.rsa.decrypt=function(t,e,r,n){var i=Math.ceil(e.n.bitLength()/8);if(t.length!==i){var s=new Error("Encrypted message length is invalid.");throw s.length=t.length,s.expected=i,s}var a=new tt(F.util.createBuffer(t).toHex(),16);if(a.compareTo(e.n)>=0)throw new Error("Encrypted message is invalid.");for(var o=Ua(a,e,r),c=o.toString(16),f=F.util.createBuffer(),u=i-Math.ceil(c.length/2);u>0;)f.putByte(0),--u;return f.putBytes(F.util.hexToBytes(c)),n!==!1?On(f.getBytes(),e,r):f.getBytes()};G.rsa.createKeyPairGenerationState=function(t,e,r){typeof t=="string"&&(t=parseInt(t,10)),t=t||2048,r=r||{};var n=r.prng||F.random,i={nextBytes:function(o){for(var c=n.getBytesSync(o.length),f=0;f<o.length;++f)o[f]=c.charCodeAt(f)}},s=r.algorithm||"PRIMEINC",a;if(s==="PRIMEINC")a={algorithm:s,state:0,bits:t,rng:i,eInt:e||65537,e:new tt(null),p:null,q:null,qBits:t>>1,pBits:t-(t>>1),pqState:0,num:null,keys:null},a.e.fromInt(a.eInt);else throw new Error("Invalid key generation algorithm: "+s);return a};G.rsa.stepKeyPairGenerationState=function(t,e){"algorithm"in t||(t.algorithm="PRIMEINC");var r=new tt(null);r.fromInt(30);for(var n=0,i=function(h,l){return h|l},s=+new Date,a,o=0;t.keys===null&&(e<=0||o<e);){if(t.state===0){var c=t.p===null?t.pBits:t.qBits,f=c-1;t.pqState===0?(t.num=new tt(c,t.rng),t.num.testBit(f)||t.num.bitwiseTo(tt.ONE.shiftLeft(f),i,t.num),t.num.dAddOffset(31-t.num.mod(r).byteValue(),0),n=0,++t.pqState):t.pqState===1?t.num.bitLength()>c?t.pqState=0:t.num.isProbablePrime(Tl(t.num.bitLength()))?++t.pqState:t.num.dAddOffset(bl[n++%8],0):t.pqState===2?t.pqState=t.num.subtract(tt.ONE).gcd(t.e).compareTo(tt.ONE)===0?3:0:t.pqState===3&&(t.pqState=0,t.p===null?t.p=t.num:t.q=t.num,t.p!==null&&t.q!==null&&++t.state,t.num=null)}else if(t.state===1)t.p.compareTo(t.q)<0&&(t.num=t.p,t.p=t.q,t.q=t.num),++t.state;else if(t.state===2)t.p1=t.p.subtract(tt.ONE),t.q1=t.q.subtract(tt.ONE),t.phi=t.p1.multiply(t.q1),++t.state;else if(t.state===3)t.phi.gcd(t.e).compareTo(tt.ONE)===0?++t.state:(t.p=null,t.q=null,t.state=0);else if(t.state===4)t.n=t.p.multiply(t.q),t.n.bitLength()===t.bits?++t.state:(t.q=null,t.state=0);else if(t.state===5){var u=t.e.modInverse(t.phi);t.keys={privateKey:G.rsa.setPrivateKey(t.n,t.e,u,t.p,t.q,u.mod(t.p1),u.mod(t.q1),t.q.modInverse(t.p)),publicKey:G.rsa.setPublicKey(t.n,t.e)}}a=+new Date,o+=a-s,s=a}return t.keys!==null};G.rsa.generateKeyPair=function(t,e,r,n){if(arguments.length===1?typeof t=="object"?(r=t,t=void 0):typeof t=="function"&&(n=t,t=void 0):arguments.length===2?typeof t=="number"?typeof e=="function"?(n=e,e=void 0):typeof e!="number"&&(r=e,e=void 0):(r=t,n=e,t=void 0,e=void 0):arguments.length===3&&(typeof e=="number"?typeof r=="function"&&(n=r,r=void 0):(n=r,r=e,e=void 0)),r=r||{},t===void 0&&(t=r.bits||2048),e===void 0&&(e=r.e||65537),!F.options.usePureJavaScript&&!r.prng&&t>=256&&t<=16384&&(e===65537||e===3)){if(n){if(Da("generateKeyPair"))return ss.generateKeyPair("rsa",{modulusLength:t,publicExponent:e,publicKeyEncoding:{type:"spki",format:"pem"},privateKeyEncoding:{type:"pkcs8",format:"pem"}},function(o,c,f){if(o)return n(o);n(null,{privateKey:G.privateKeyFromPem(f),publicKey:G.publicKeyFromPem(c)})});if(ka("generateKey")&&ka("exportKey"))return Zt.globalScope.crypto.subtle.generateKey({name:"RSASSA-PKCS1-v1_5",modulusLength:t,publicExponent:Ka(e),hash:{name:"SHA-256"}},!0,["sign","verify"]).then(function(o){return Zt.globalScope.crypto.subtle.exportKey("pkcs8",o.privateKey)}).then(void 0,function(o){n(o)}).then(function(o){if(o){var c=G.privateKeyFromAsn1(v.fromDer(F.util.createBuffer(o)));n(null,{privateKey:c,publicKey:G.setRsaPublicKey(c.n,c.e)})}});if(Pa("generateKey")&&Pa("exportKey")){var i=Zt.globalScope.msCrypto.subtle.generateKey({name:"RSASSA-PKCS1-v1_5",modulusLength:t,publicExponent:Ka(e),hash:{name:"SHA-256"}},!0,["sign","verify"]);i.oncomplete=function(o){var c=o.target.result,f=Zt.globalScope.msCrypto.subtle.exportKey("pkcs8",c.privateKey);f.oncomplete=function(u){var h=u.target.result,l=G.privateKeyFromAsn1(v.fromDer(F.util.createBuffer(h)));n(null,{privateKey:l,publicKey:G.setRsaPublicKey(l.n,l.e)})},f.onerror=function(u){n(u)}},i.onerror=function(o){n(o)};return}}else if(Da("generateKeyPairSync")){var s=ss.generateKeyPairSync("rsa",{modulusLength:t,publicExponent:e,publicKeyEncoding:{type:"spki",format:"pem"},privateKeyEncoding:{type:"pkcs8",format:"pem"}});return{privateKey:G.privateKeyFromPem(s.privateKey),publicKey:G.publicKeyFromPem(s.publicKey)}}}var a=G.rsa.createKeyPairGenerationState(t,e,r);if(!n)return G.rsa.stepKeyPairGenerationState(a,0),a.keys;Il(a,r,n)};G.setRsaPublicKey=G.rsa.setPublicKey=function(t,e){var r={n:t,e};return r.encrypt=function(n,i,s){if(typeof i=="string"?i=i.toUpperCase():i===void 0&&(i="RSAES-PKCS1-V1_5"),i==="RSAES-PKCS1-V1_5")i={encode:function(o,c,f){return Oa(o,c,2).getBytes()}};else if(i==="RSA-OAEP"||i==="RSAES-OAEP")i={encode:function(o,c){return F.pkcs1.encode_rsa_oaep(c,o,s)}};else if(["RAW","NONE","NULL",null].indexOf(i)!==-1)i={encode:function(o){return o}};else if(typeof i=="string")throw new Error('Unsupported encryption scheme: "'+i+'".');var a=i.encode(n,r,!0);return G.rsa.encrypt(a,r,!0)},r.verify=function(n,i,s,a){typeof s=="string"?s=s.toUpperCase():s===void 0&&(s="RSASSA-PKCS1-V1_5"),a===void 0&&(a={_parseAllDigestBytes:!0}),"_parseAllDigestBytes"in a||(a._parseAllDigestBytes=!0),s==="RSASSA-PKCS1-V1_5"?s={verify:function(c,f){f=On(f,r,!0);var u=v.fromDer(f,{parseAllBytes:a._parseAllDigestBytes}),h={},l=[];if(!v.validate(u,Al,h,l)){var g=new Error("ASN.1 object does not contain a valid RSASSA-PKCS1-v1_5 DigestInfo value.");throw g.errors=l,g}var d=v.derToOid(h.algorithmIdentifier);if(!(d===F.oids.md2||d===F.oids.md5||d===F.oids.sha1||d===F.oids.sha224||d===F.oids.sha256||d===F.oids.sha384||d===F.oids.sha512||d===F.oids["sha512-224"]||d===F.oids["sha512-256"])){var g=new Error("Unknown RSASSA-PKCS1-v1_5 DigestAlgorithm identifier.");throw g.oid=d,g}if((d===F.oids.md2||d===F.oids.md5)&&!("parameters"in h))throw new Error("ASN.1 object does not contain a valid RSASSA-PKCS1-v1_5 DigestInfo value. Missing algorithm identifer NULL parameters.");return c===h.digest}}:(s==="NONE"||s==="NULL"||s===null)&&(s={verify:function(c,f){return f=On(f,r,!0),c===f}});var o=G.rsa.decrypt(i,r,!0,!1);return s.verify(n,o,r.n.bitLength())},r};G.setRsaPrivateKey=G.rsa.setPrivateKey=function(t,e,r,n,i,s,a,o){var c={n:t,e,d:r,p:n,q:i,dP:s,dQ:a,qInv:o};return c.decrypt=function(f,u,h){typeof u=="string"?u=u.toUpperCase():u===void 0&&(u="RSAES-PKCS1-V1_5");var l=G.rsa.decrypt(f,c,!1,!1);if(u==="RSAES-PKCS1-V1_5")u={decode:On};else if(u==="RSA-OAEP"||u==="RSAES-OAEP")u={decode:function(g,d){return F.pkcs1.decode_rsa_oaep(d,g,h)}};else if(["RAW","NONE","NULL",null].indexOf(u)!==-1)u={decode:function(g){return g}};else throw new Error('Unsupported encryption scheme: "'+u+'".');return u.decode(l,c,!1)},c.sign=function(f,u){var h=!1;typeof u=="string"&&(u=u.toUpperCase()),u===void 0||u==="RSASSA-PKCS1-V1_5"?(u={encode:Cl},h=1):(u==="NONE"||u==="NULL"||u===null)&&(u={encode:function(){return f}},h=1);var l=u.encode(f,c.n.bitLength());return G.rsa.encrypt(l,c,h)},c};G.wrapRsaPrivateKey=function(t){return v.create(v.Class.UNIVERSAL,v.Type.SEQUENCE,!0,[v.create(v.Class.UNIVERSAL,v.Type.INTEGER,!1,v.integerToDer(0).getBytes()),v.create(v.Class.UNIVERSAL,v.Type.SEQUENCE,!0,[v.create(v.Class.UNIVERSAL,v.Type.OID,!1,v.oidToDer(G.oids.rsaEncryption).getBytes()),v.create(v.Class.UNIVERSAL,v.Type.NULL,!1,"")]),v.create(v.Class.UNIVERSAL,v.Type.OCTETSTRING,!1,v.toDer(t).getBytes())])};G.privateKeyFromAsn1=function(t){var e={},r=[];if(v.validate(t,El,e,r)&&(t=v.fromDer(F.util.createBuffer(e.privateKey))),e={},r=[],!v.validate(t,wl,e,r)){var n=new Error("Cannot read private key. ASN.1 object does not contain an RSAPrivateKey.");throw n.errors=r,n}var i,s,a,o,c,f,u,h;return i=F.util.createBuffer(e.privateKeyModulus).toHex(),s=F.util.createBuffer(e.privateKeyPublicExponent).toHex(),a=F.util.createBuffer(e.privateKeyPrivateExponent).toHex(),o=F.util.createBuffer(e.privateKeyPrime1).toHex(),c=F.util.createBuffer(e.privateKeyPrime2).toHex(),f=F.util.createBuffer(e.privateKeyExponent1).toHex(),u=F.util.createBuffer(e.privateKeyExponent2).toHex(),h=F.util.createBuffer(e.privateKeyCoefficient).toHex(),G.setRsaPrivateKey(new tt(i,16),new tt(s,16),new tt(a,16),new tt(o,16),new tt(c,16),new tt(f,16),new tt(u,16),new tt(h,16))};G.privateKeyToAsn1=G.privateKeyToRSAPrivateKey=function(t){return v.create(v.Class.UNIVERSAL,v.Type.SEQUENCE,!0,[v.create(v.Class.UNIVERSAL,v.Type.INTEGER,!1,v.integerToDer(0).getBytes()),v.create(v.Class.UNIVERSAL,v.Type.INTEGER,!1,fe(t.n)),v.create(v.Class.UNIVERSAL,v.Type.INTEGER,!1,fe(t.e)),v.create(v.Class.UNIVERSAL,v.Type.INTEGER,!1,fe(t.d)),v.create(v.Class.UNIVERSAL,v.Type.INTEGER,!1,fe(t.p)),v.create(v.Class.UNIVERSAL,v.Type.INTEGER,!1,fe(t.q)),v.create(v.Class.UNIVERSAL,v.Type.INTEGER,!1,fe(t.dP)),v.create(v.Class.UNIVERSAL,v.Type.INTEGER,!1,fe(t.dQ)),v.create(v.Class.UNIVERSAL,v.Type.INTEGER,!1,fe(t.qInv))])};G.publicKeyFromAsn1=function(t){var e={},r=[];if(v.validate(t,Bl,e,r)){var n=v.derToOid(e.publicKeyOid);if(n!==G.oids.rsaEncryption){var i=new Error("Cannot read public key. Unknown OID.");throw i.oid=n,i}t=e.rsaPublicKey}if(r=[],!v.validate(t,Sl,e,r)){var i=new Error("Cannot read public key. ASN.1 object does not contain an RSAPublicKey.");throw i.errors=r,i}var s=F.util.createBuffer(e.publicKeyModulus).toHex(),a=F.util.createBuffer(e.publicKeyExponent).toHex();return G.setRsaPublicKey(new tt(s,16),new tt(a,16))};G.publicKeyToAsn1=G.publicKeyToSubjectPublicKeyInfo=function(t){return v.create(v.Class.UNIVERSAL,v.Type.SEQUENCE,!0,[v.create(v.Class.UNIVERSAL,v.Type.SEQUENCE,!0,[v.create(v.Class.UNIVERSAL,v.Type.OID,!1,v.oidToDer(G.oids.rsaEncryption).getBytes()),v.create(v.Class.UNIVERSAL,v.Type.NULL,!1,"")]),v.create(v.Class.UNIVERSAL,v.Type.BITSTRING,!1,[G.publicKeyToRSAPublicKey(t)])])};G.publicKeyToRSAPublicKey=function(t){return v.create(v.Class.UNIVERSAL,v.Type.SEQUENCE,!0,[v.create(v.Class.UNIVERSAL,v.Type.INTEGER,!1,fe(t.n)),v.create(v.Class.UNIVERSAL,v.Type.INTEGER,!1,fe(t.e))])};function Oa(t,e,r){var n=F.util.createBuffer(),i=Math.ceil(e.n.bitLength()/8);if(t.length>i-11){var s=new Error("Message is too long for PKCS#1 v1.5 padding.");throw s.length=t.length,s.max=i-11,s}n.putByte(0),n.putByte(r);var a=i-3-t.length,o;if(r===0||r===1){o=r===0?0:255;for(var c=0;c<a;++c)n.putByte(o)}else for(;a>0;){for(var f=0,u=F.random.getBytes(a),c=0;c<a;++c)o=u.charCodeAt(c),o===0?++f:n.putByte(o);a=f}return n.putByte(0),n.putBytes(t),n}function On(t,e,r,n){var i=Math.ceil(e.n.bitLength()/8),s=F.util.createBuffer(t),a=s.getByte(),o=s.getByte();if(a!==0||r&&o!==0&&o!==1||!r&&o!=2||r&&o===0&&typeof n>"u")throw new Error("Encryption block is invalid.");var c=0;if(o===0){c=i-3-n;for(var f=0;f<c;++f)if(s.getByte()!==0)throw new Error("Encryption block is invalid.")}else if(o===1)for(c=0;s.length()>1;){if(s.getByte()!==255){--s.read;break}++c}else if(o===2)for(c=0;s.length()>1;){if(s.getByte()===0){--s.read;break}++c}var u=s.getByte();if(u!==0||c!==i-3-s.length())throw new Error("Encryption block is invalid.");return s.getBytes()}function Il(t,e,r){typeof e=="function"&&(r=e,e={}),e=e||{};var n={algorithm:{name:e.algorithm||"PRIMEINC",options:{workers:e.workers||2,workLoad:e.workLoad||100,workerScript:e.workerScript}}};"prng"in e&&(n.prng=e.prng),i();function i(){s(t.pBits,function(o,c){if(o)return r(o);if(t.p=c,t.q!==null)return a(o,t.q);s(t.qBits,a)})}function s(o,c){F.prime.generateProbablePrime(o,n,c)}function a(o,c){if(o)return r(o);if(t.q=c,t.p.compareTo(t.q)<0){var f=t.p;t.p=t.q,t.q=f}if(t.p.subtract(tt.ONE).gcd(t.e).compareTo(tt.ONE)!==0){t.p=null,i();return}if(t.q.subtract(tt.ONE).gcd(t.e).compareTo(tt.ONE)!==0){t.q=null,s(t.qBits,a);return}if(t.p1=t.p.subtract(tt.ONE),t.q1=t.q.subtract(tt.ONE),t.phi=t.p1.multiply(t.q1),t.phi.gcd(t.e).compareTo(tt.ONE)!==0){t.p=t.q=null,i();return}if(t.n=t.p.multiply(t.q),t.n.bitLength()!==t.bits){t.q=null,s(t.qBits,a);return}var u=t.e.modInverse(t.phi);t.keys={privateKey:G.rsa.setPrivateKey(t.n,t.e,u,t.p,t.q,u.mod(t.p1),u.mod(t.q1),t.q.modInverse(t.p)),publicKey:G.rsa.setPublicKey(t.n,t.e)},r(null,t.keys)}}function fe(t){var e=t.toString(16);e[0]>="8"&&(e="00"+e);var r=F.util.hexToBytes(e);return r.length>1&&(r.charCodeAt(0)===0&&!(r.charCodeAt(1)&128)||r.charCodeAt(0)===255&&(r.charCodeAt(1)&128)===128)?r.substr(1):r}function Tl(t){return t<=100?27:t<=150?18:t<=200?15:t<=250?12:t<=300?9:t<=350?8:t<=400?7:t<=500?6:t<=600?5:t<=800?4:t<=1250?3:2}function Da(t){return F.util.isNodejs&&typeof ss[t]=="function"}function ka(t){return typeof Zt.globalScope<"u"&&typeof Zt.globalScope.crypto=="object"&&typeof Zt.globalScope.crypto.subtle=="object"&&typeof Zt.globalScope.crypto.subtle[t]=="function"}function Pa(t){return typeof Zt.globalScope<"u"&&typeof Zt.globalScope.msCrypto=="object"&&typeof Zt.globalScope.msCrypto.subtle=="object"&&typeof Zt.globalScope.msCrypto.subtle[t]=="function"}function Ka(t){for(var e=F.util.hexToBytes(t.toString(16)),r=new Uint8Array(e.length),n=0;n<e.length;++n)r[n]=e.charCodeAt(n);return r}});var Ga=j((Vy,za)=>{var U=ot();Sn();Xr();Qo();Ze();Cn();Qi();na();Jr();ya();Mn();Et();typeof Fa>"u"&&(Fa=U.jsbn.BigInteger);var Fa,B=U.asn1,Y=U.pki=U.pki||{};za.exports=Y.pbe=U.pbe=U.pbe||{};var Je=Y.oids,_l={name:"EncryptedPrivateKeyInfo",tagClass:B.Class.UNIVERSAL,type:B.Type.SEQUENCE,constructed:!0,value:[{name:"EncryptedPrivateKeyInfo.encryptionAlgorithm",tagClass:B.Class.UNIVERSAL,type:B.Type.SEQUENCE,constructed:!0,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:B.Class.UNIVERSAL,type:B.Type.OID,constructed:!1,capture:"encryptionOid"},{name:"AlgorithmIdentifier.parameters",tagClass:B.Class.UNIVERSAL,type:B.Type.SEQUENCE,constructed:!0,captureAsn1:"encryptionParams"}]},{name:"EncryptedPrivateKeyInfo.encryptedData",tagClass:B.Class.UNIVERSAL,type:B.Type.OCTETSTRING,constructed:!1,capture:"encryptedData"}]},Rl={name:"PBES2Algorithms",tagClass:B.Class.UNIVERSAL,type:B.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.keyDerivationFunc",tagClass:B.Class.UNIVERSAL,type:B.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.keyDerivationFunc.oid",tagClass:B.Class.UNIVERSAL,type:B.Type.OID,constructed:!1,capture:"kdfOid"},{name:"PBES2Algorithms.params",tagClass:B.Class.UNIVERSAL,type:B.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.params.salt",tagClass:B.Class.UNIVERSAL,type:B.Type.OCTETSTRING,constructed:!1,capture:"kdfSalt"},{name:"PBES2Algorithms.params.iterationCount",tagClass:B.Class.UNIVERSAL,type:B.Type.INTEGER,constructed:!1,capture:"kdfIterationCount"},{name:"PBES2Algorithms.params.keyLength",tagClass:B.Class.UNIVERSAL,type:B.Type.INTEGER,constructed:!1,optional:!0,capture:"keyLength"},{name:"PBES2Algorithms.params.prf",tagClass:B.Class.UNIVERSAL,type:B.Type.SEQUENCE,constructed:!0,optional:!0,value:[{name:"PBES2Algorithms.params.prf.algorithm",tagClass:B.Class.UNIVERSAL,type:B.Type.OID,constructed:!1,capture:"prfOid"}]}]}]},{name:"PBES2Algorithms.encryptionScheme",tagClass:B.Class.UNIVERSAL,type:B.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.encryptionScheme.oid",tagClass:B.Class.UNIVERSAL,type:B.Type.OID,constructed:!1,capture:"encOid"},{name:"PBES2Algorithms.encryptionScheme.iv",tagClass:B.Class.UNIVERSAL,type:B.Type.OCTETSTRING,constructed:!1,capture:"encIv"}]}]},Ll={name:"pkcs-12PbeParams",tagClass:B.Class.UNIVERSAL,type:B.Type.SEQUENCE,constructed:!0,value:[{name:"pkcs-12PbeParams.salt",tagClass:B.Class.UNIVERSAL,type:B.Type.OCTETSTRING,constructed:!1,capture:"salt"},{name:"pkcs-12PbeParams.iterations",tagClass:B.Class.UNIVERSAL,type:B.Type.INTEGER,constructed:!1,capture:"iterations"}]};Y.encryptPrivateKeyInfo=function(t,e,r){r=r||{},r.saltSize=r.saltSize||8,r.count=r.count||2048,r.algorithm=r.algorithm||"aes128",r.prfAlgorithm=r.prfAlgorithm||"sha1";var n=U.random.getBytesSync(r.saltSize),i=r.count,s=B.integerToDer(i),a,o,c;if(r.algorithm.indexOf("aes")===0||r.algorithm==="des"){var f,u,h;switch(r.algorithm){case"aes128":a=16,f=16,u=Je["aes128-CBC"],h=U.aes.createEncryptionCipher;break;case"aes192":a=24,f=16,u=Je["aes192-CBC"],h=U.aes.createEncryptionCipher;break;case"aes256":a=32,f=16,u=Je["aes256-CBC"],h=U.aes.createEncryptionCipher;break;case"des":a=8,f=8,u=Je.desCBC,h=U.des.createEncryptionCipher;break;default:var l=new Error("Cannot encrypt private key. Unknown encryption algorithm.");throw l.algorithm=r.algorithm,l}var g="hmacWith"+r.prfAlgorithm.toUpperCase(),d=Ha(g),p=U.pkcs5.pbkdf2(e,n,i,a,d),y=U.random.getBytesSync(f),m=h(p);m.start(y),m.update(B.toDer(t)),m.finish(),c=m.output.getBytes();var E=Nl(n,s,a,g);o=B.create(B.Class.UNIVERSAL,B.Type.SEQUENCE,!0,[B.create(B.Class.UNIVERSAL,B.Type.OID,!1,B.oidToDer(Je.pkcs5PBES2).getBytes()),B.create(B.Class.UNIVERSAL,B.Type.SEQUENCE,!0,[B.create(B.Class.UNIVERSAL,B.Type.SEQUENCE,!0,[B.create(B.Class.UNIVERSAL,B.Type.OID,!1,B.oidToDer(Je.pkcs5PBKDF2).getBytes()),E]),B.create(B.Class.UNIVERSAL,B.Type.SEQUENCE,!0,[B.create(B.Class.UNIVERSAL,B.Type.OID,!1,B.oidToDer(u).getBytes()),B.create(B.Class.UNIVERSAL,B.Type.OCTETSTRING,!1,y)])])])}else if(r.algorithm==="3des"){a=24;var b=new U.util.ByteBuffer(n),p=Y.pbe.generatePkcs12Key(e,b,1,i,a),y=Y.pbe.generatePkcs12Key(e,b,2,i,a),m=U.des.createEncryptionCipher(p);m.start(y),m.update(B.toDer(t)),m.finish(),c=m.output.getBytes(),o=B.create(B.Class.UNIVERSAL,B.Type.SEQUENCE,!0,[B.create(B.Class.UNIVERSAL,B.Type.OID,!1,B.oidToDer(Je["pbeWithSHAAnd3-KeyTripleDES-CBC"]).getBytes()),B.create(B.Class.UNIVERSAL,B.Type.SEQUENCE,!0,[B.create(B.Class.UNIVERSAL,B.Type.OCTETSTRING,!1,n),B.create(B.Class.UNIVERSAL,B.Type.INTEGER,!1,s.getBytes())])])}else{var l=new Error("Cannot encrypt private key. Unknown encryption algorithm.");throw l.algorithm=r.algorithm,l}var _=B.create(B.Class.UNIVERSAL,B.Type.SEQUENCE,!0,[o,B.create(B.Class.UNIVERSAL,B.Type.OCTETSTRING,!1,c)]);return _};Y.decryptPrivateKeyInfo=function(t,e){var r=null,n={},i=[];if(!B.validate(t,_l,n,i)){var s=new Error("Cannot read encrypted private key. ASN.1 object is not a supported EncryptedPrivateKeyInfo.");throw s.errors=i,s}var a=B.derToOid(n.encryptionOid),o=Y.pbe.getCipher(a,n.encryptionParams,e),c=U.util.createBuffer(n.encryptedData);return o.update(c),o.finish()&&(r=B.fromDer(o.output)),r};Y.encryptedPrivateKeyToPem=function(t,e){var r={type:"ENCRYPTED PRIVATE KEY",body:B.toDer(t).getBytes()};return U.pem.encode(r,{maxline:e})};Y.encryptedPrivateKeyFromPem=function(t){var e=U.pem.decode(t)[0];if(e.type!=="ENCRYPTED PRIVATE KEY"){var r=new Error('Could not convert encrypted private key from PEM; PEM header type is "ENCRYPTED PRIVATE KEY".');throw r.headerType=e.type,r}if(e.procType&&e.procType.type==="ENCRYPTED")throw new Error("Could not convert encrypted private key from PEM; PEM is encrypted.");return B.fromDer(e.body)};Y.encryptRsaPrivateKey=function(t,e,r){if(r=r||{},!r.legacy){var n=Y.wrapRsaPrivateKey(Y.privateKeyToAsn1(t));return n=Y.encryptPrivateKeyInfo(n,e,r),Y.encryptedPrivateKeyToPem(n)}var i,s,a,o;switch(r.algorithm){case"aes128":i="AES-128-CBC",a=16,s=U.random.getBytesSync(16),o=U.aes.createEncryptionCipher;break;case"aes192":i="AES-192-CBC",a=24,s=U.random.getBytesSync(16),o=U.aes.createEncryptionCipher;break;case"aes256":i="AES-256-CBC",a=32,s=U.random.getBytesSync(16),o=U.aes.createEncryptionCipher;break;case"3des":i="DES-EDE3-CBC",a=24,s=U.random.getBytesSync(8),o=U.des.createEncryptionCipher;break;case"des":i="DES-CBC",a=8,s=U.random.getBytesSync(8),o=U.des.createEncryptionCipher;break;default:var c=new Error('Could not encrypt RSA private key; unsupported encryption algorithm "'+r.algorithm+'".');throw c.algorithm=r.algorithm,c}var f=U.pbe.opensslDeriveBytes(e,s.substr(0,8),a),u=o(f);u.start(s),u.update(B.toDer(Y.privateKeyToAsn1(t))),u.finish();var h={type:"RSA PRIVATE KEY",procType:{version:"4",type:"ENCRYPTED"},dekInfo:{algorithm:i,parameters:U.util.bytesToHex(s).toUpperCase()},body:u.output.getBytes()};return U.pem.encode(h)};Y.decryptRsaPrivateKey=function(t,e){var r=null,n=U.pem.decode(t)[0];if(n.type!=="ENCRYPTED PRIVATE KEY"&&n.type!=="PRIVATE KEY"&&n.type!=="RSA PRIVATE KEY"){var i=new Error('Could not convert private key from PEM; PEM header type is not "ENCRYPTED PRIVATE KEY", "PRIVATE KEY", or "RSA PRIVATE KEY".');throw i.headerType=i,i}if(n.procType&&n.procType.type==="ENCRYPTED"){var s,a;switch(n.dekInfo.algorithm){case"DES-CBC":s=8,a=U.des.createDecryptionCipher;break;case"DES-EDE3-CBC":s=24,a=U.des.createDecryptionCipher;break;case"AES-128-CBC":s=16,a=U.aes.createDecryptionCipher;break;case"AES-192-CBC":s=24,a=U.aes.createDecryptionCipher;break;case"AES-256-CBC":s=32,a=U.aes.createDecryptionCipher;break;case"RC2-40-CBC":s=5,a=function(h){return U.rc2.createDecryptionCipher(h,40)};break;case"RC2-64-CBC":s=8,a=function(h){return U.rc2.createDecryptionCipher(h,64)};break;case"RC2-128-CBC":s=16,a=function(h){return U.rc2.createDecryptionCipher(h,128)};break;default:var i=new Error('Could not decrypt private key; unsupported encryption algorithm "'+n.dekInfo.algorithm+'".');throw i.algorithm=n.dekInfo.algorithm,i}var o=U.util.hexToBytes(n.dekInfo.parameters),c=U.pbe.opensslDeriveBytes(e,o.substr(0,8),s),f=a(c);if(f.start(o),f.update(U.util.createBuffer(n.body)),f.finish())r=f.output.getBytes();else return r}else r=n.body;return n.type==="ENCRYPTED PRIVATE KEY"?r=Y.decryptPrivateKeyInfo(B.fromDer(r),e):r=B.fromDer(r),r!==null&&(r=Y.privateKeyFromAsn1(r)),r};Y.pbe.generatePkcs12Key=function(t,e,r,n,i,s){var a,o;if(typeof s>"u"||s===null){if(!("sha1"in U.md))throw new Error('"sha1" hash algorithm unavailable.');s=U.md.sha1.create()}var c=s.digestLength,f=s.blockLength,u=new U.util.ByteBuffer,h=new U.util.ByteBuffer;if(t!=null){for(o=0;o<t.length;o++)h.putInt16(t.charCodeAt(o));h.putInt16(0)}var l=h.length(),g=e.length(),d=new U.util.ByteBuffer;d.fillWithByte(r,f);var p=f*Math.ceil(g/f),y=new U.util.ByteBuffer;for(o=0;o<p;o++)y.putByte(e.at(o%g));var m=f*Math.ceil(l/f),E=new U.util.ByteBuffer;for(o=0;o<m;o++)E.putByte(h.at(o%l));var b=y;b.putBuffer(E);for(var _=Math.ceil(i/c),w=1;w<=_;w++){var S=new U.util.ByteBuffer;S.putBytes(d.bytes()),S.putBytes(b.bytes());for(var L=0;L<n;L++)s.start(),s.update(S.getBytes()),S=s.digest();var N=new U.util.ByteBuffer;for(o=0;o<f;o++)N.putByte(S.at(o%c));var H=Math.ceil(g/f)+Math.ceil(l/f),z=new U.util.ByteBuffer;for(a=0;a<H;a++){var V=new U.util.ByteBuffer(b.getBytes(f)),Q=511;for(o=N.length()-1;o>=0;o--)Q=Q>>8,Q+=N.at(o)+V.at(o),V.setAt(o,Q&255);z.putBuffer(V)}b=z,u.putBuffer(S)}return u.truncate(u.length()-i),u};Y.pbe.getCipher=function(t,e,r){switch(t){case Y.oids.pkcs5PBES2:return Y.pbe.getCipherForPBES2(t,e,r);case Y.oids["pbeWithSHAAnd3-KeyTripleDES-CBC"]:case Y.oids["pbewithSHAAnd40BitRC2-CBC"]:return Y.pbe.getCipherForPKCS12PBE(t,e,r);default:var n=new Error("Cannot read encrypted PBE data block. Unsupported OID.");throw n.oid=t,n.supportedOids=["pkcs5PBES2","pbeWithSHAAnd3-KeyTripleDES-CBC","pbewithSHAAnd40BitRC2-CBC"],n}};Y.pbe.getCipherForPBES2=function(t,e,r){var n={},i=[];if(!B.validate(e,Rl,n,i)){var s=new Error("Cannot read password-based-encryption algorithm parameters. ASN.1 object is not a supported EncryptedPrivateKeyInfo.");throw s.errors=i,s}if(t=B.derToOid(n.kdfOid),t!==Y.oids.pkcs5PBKDF2){var s=new Error("Cannot read encrypted private key. Unsupported key derivation function OID.");throw s.oid=t,s.supportedOids=["pkcs5PBKDF2"],s}if(t=B.derToOid(n.encOid),t!==Y.oids["aes128-CBC"]&&t!==Y.oids["aes192-CBC"]&&t!==Y.oids["aes256-CBC"]&&t!==Y.oids["des-EDE3-CBC"]&&t!==Y.oids.desCBC){var s=new Error("Cannot read encrypted private key. Unsupported encryption scheme OID.");throw s.oid=t,s.supportedOids=["aes128-CBC","aes192-CBC","aes256-CBC","des-EDE3-CBC","desCBC"],s}var a=n.kdfSalt,o=U.util.createBuffer(n.kdfIterationCount);o=o.getInt(o.length()<<3);var c,f;switch(Y.oids[t]){case"aes128-CBC":c=16,f=U.aes.createDecryptionCipher;break;case"aes192-CBC":c=24,f=U.aes.createDecryptionCipher;break;case"aes256-CBC":c=32,f=U.aes.createDecryptionCipher;break;case"des-EDE3-CBC":c=24,f=U.des.createDecryptionCipher;break;case"desCBC":c=8,f=U.des.createDecryptionCipher;break}var u=qa(n.prfOid),h=U.pkcs5.pbkdf2(r,a,o,c,u),l=n.encIv,g=f(h);return g.start(l),g};Y.pbe.getCipherForPKCS12PBE=function(t,e,r){var n={},i=[];if(!B.validate(e,Ll,n,i)){var s=new Error("Cannot read password-based-encryption algorithm parameters. ASN.1 object is not a supported EncryptedPrivateKeyInfo.");throw s.errors=i,s}var a=U.util.createBuffer(n.salt),o=U.util.createBuffer(n.iterations);o=o.getInt(o.length()<<3);var c,f,u;switch(t){case Y.oids["pbeWithSHAAnd3-KeyTripleDES-CBC"]:c=24,f=8,u=U.des.startDecrypting;break;case Y.oids["pbewithSHAAnd40BitRC2-CBC"]:c=5,f=8,u=function(p,y){var m=U.rc2.createDecryptionCipher(p,40);return m.start(y,null),m};break;default:var s=new Error("Cannot read PKCS #12 PBE data block. Unsupported OID.");throw s.oid=t,s}var h=qa(n.prfOid),l=Y.pbe.generatePkcs12Key(r,a,1,o,c,h);h.start();var g=Y.pbe.generatePkcs12Key(r,a,2,o,f,h);return u(l,g)};Y.pbe.opensslDeriveBytes=function(t,e,r,n){if(typeof n>"u"||n===null){if(!("md5"in U.md))throw new Error('"md5" hash algorithm unavailable.');n=U.md.md5.create()}e===null&&(e="");for(var i=[Va(n,t+e)],s=16,a=1;s<r;++a,s+=16)i.push(Va(n,i[a-1]+t+e));return i.join("").substr(0,r)};function Va(t,e){return t.start().update(e).digest().getBytes()}function qa(t){var e;if(!t)e="hmacWithSHA1";else if(e=Y.oids[B.derToOid(t)],!e){var r=new Error("Unsupported PRF OID.");throw r.oid=t,r.supported=["hmacWithSHA1","hmacWithSHA224","hmacWithSHA256","hmacWithSHA384","hmacWithSHA512"],r}return Ha(e)}function Ha(t){var e=U.md;switch(t){case"hmacWithSHA224":e=U.md.sha512;case"hmacWithSHA1":case"hmacWithSHA256":case"hmacWithSHA384":case"hmacWithSHA512":t=t.substr(8).toLowerCase();break;default:var r=new Error("Unsupported PRF algorithm.");throw r.algorithm=t,r.supported=["hmacWithSHA1","hmacWithSHA224","hmacWithSHA256","hmacWithSHA384","hmacWithSHA512"],r}if(!e||!(t in e))throw new Error("Unknown hash algorithm: "+t);return e[t].create()}function Nl(t,e,r,n){var i=B.create(B.Class.UNIVERSAL,B.Type.SEQUENCE,!0,[B.create(B.Class.UNIVERSAL,B.Type.OCTETSTRING,!1,t),B.create(B.Class.UNIVERSAL,B.Type.INTEGER,!1,e.getBytes())]);return n!=="hmacWithSHA1"&&i.value.push(B.create(B.Class.UNIVERSAL,B.Type.INTEGER,!1,U.util.hexToBytes(r.toString(16))),B.create(B.Class.UNIVERSAL,B.Type.SEQUENCE,!0,[B.create(B.Class.UNIVERSAL,B.Type.OID,!1,B.oidToDer(Y.oids[n]).getBytes()),B.create(B.Class.UNIVERSAL,B.Type.NULL,!1,"")])),i}});var N0=j((Hg,L0)=>{var dt=ot();Ze();Et();var cn=L0.exports=dt.sha512=dt.sha512||{};dt.md.sha512=dt.md.algorithms.sha512=cn;var _0=dt.sha384=dt.sha512.sha384=dt.sha512.sha384||{};_0.create=function(){return cn.create("SHA-384")};dt.md.sha384=dt.md.algorithms.sha384=_0;dt.sha512.sha256=dt.sha512.sha256||{create:function(){return cn.create("SHA-512/256")}};dt.md["sha512/256"]=dt.md.algorithms["sha512/256"]=dt.sha512.sha256;dt.sha512.sha224=dt.sha512.sha224||{create:function(){return cn.create("SHA-512/224")}};dt.md["sha512/224"]=dt.md.algorithms["sha512/224"]=dt.sha512.sha224;cn.create=function(t){if(R0||Qd(),typeof t>"u"&&(t="SHA-512"),!(t in or))throw new Error("Invalid SHA-512 algorithm: "+t);for(var e=or[t],r=null,n=dt.util.createBuffer(),i=new Array(80),s=0;s<80;++s)i[s]=new Array(2);var a=64;switch(t){case"SHA-384":a=48;break;case"SHA-512/256":a=32;break;case"SHA-512/224":a=28;break}var o={algorithm:t.replace("-","").toLowerCase(),blockLength:128,digestLength:a,messageLength:0,fullMessageLength:null,messageLengthSize:16};return o.start=function(){o.messageLength=0,o.fullMessageLength=o.messageLength128=[];for(var c=o.messageLengthSize/4,f=0;f<c;++f)o.fullMessageLength.push(0);n=dt.util.createBuffer(),r=new Array(e.length);for(var f=0;f<e.length;++f)r[f]=e[f].slice(0);return o},o.start(),o.update=function(c,f){f==="utf8"&&(c=dt.util.encodeUtf8(c));var u=c.length;o.messageLength+=u,u=[u/4294967296>>>0,u>>>0];for(var h=o.fullMessageLength.length-1;h>=0;--h)o.fullMessageLength[h]+=u[1],u[1]=u[0]+(o.fullMessageLength[h]/4294967296>>>0),o.fullMessageLength[h]=o.fullMessageLength[h]>>>0,u[0]=u[1]/4294967296>>>0;return n.putBytes(c),T0(r,i,n),(n.read>2048||n.length()===0)&&n.compact(),o},o.digest=function(){var c=dt.util.createBuffer();c.putBytes(n.bytes());var f=o.fullMessageLength[o.fullMessageLength.length-1]+o.messageLengthSize,u=f&o.blockLength-1;c.putBytes(Us.substr(0,o.blockLength-u));for(var h,l,g=o.fullMessageLength[0]*8,d=0;d<o.fullMessageLength.length-1;++d)h=o.fullMessageLength[d+1]*8,l=h/4294967296>>>0,g+=l,c.putInt32(g>>>0),g=h>>>0;c.putInt32(g);for(var p=new Array(r.length),d=0;d<r.length;++d)p[d]=r[d].slice(0);T0(p,i,c);var y=dt.util.createBuffer(),m;t==="SHA-512"?m=p.length:t==="SHA-384"?m=p.length-2:m=p.length-4;for(var d=0;d<m;++d)y.putInt32(p[d][0]),(d!==m-1||t!=="SHA-512/224")&&y.putInt32(p[d][1]);return y},o};var Us=null,R0=!1,Os=null,or=null;function Qd(){Us=String.fromCharCode(128),Us+=dt.util.fillString(String.fromCharCode(0),128),Os=[[1116352408,3609767458],[1899447441,602891725],[3049323471,3964484399],[3921009573,2173295548],[961987163,4081628472],[1508970993,3053834265],[2453635748,2937671579],[2870763221,3664609560],[3624381080,2734883394],[310598401,1164996542],[607225278,1323610764],[1426881987,3590304994],[1925078388,4068182383],[2162078206,991336113],[2614888103,633803317],[3248222580,3479774868],[3835390401,2666613458],[4022224774,944711139],[264347078,2341262773],[604807628,2007800933],[770255983,1495990901],[1249150122,1856431235],[1555081692,3175218132],[1996064986,2198950837],[2554220882,3999719339],[2821834349,766784016],[2952996808,2566594879],[3210313671,3203337956],[3336571891,1034457026],[3584528711,2466948901],[113926993,3758326383],[338241895,168717936],[666307205,1188179964],[773529912,1546045734],[1294757372,1522805485],[1396182291,2643833823],[1695183700,2343527390],[1986661051,1014477480],[2177026350,1206759142],[2456956037,344077627],[2730485921,1290863460],[2820302411,3158454273],[3259730800,3505952657],[3345764771,106217008],[3516065817,3606008344],[3600352804,1432725776],[4094571909,1467031594],[275423344,851169720],[430227734,3100823752],[506948616,1363258195],[659060556,3750685593],[883997877,3785050280],[958139571,3318307427],[1322822218,3812723403],[1537002063,2003034995],[1747873779,3602036899],[1955562222,1575990012],[2024104815,1125592928],[2227730452,2716904306],[2361852424,442776044],[2428436474,593698344],[2756734187,3733110249],[3204031479,2999351573],[3329325298,3815920427],[3391569614,3928383900],[3515267271,566280711],[3940187606,3454069534],[4118630271,4000239992],[116418474,1914138554],[174292421,2731055270],[289380356,3203993006],[460393269,320620315],[685471733,587496836],[852142971,1086792851],[1017036298,365543100],[1126000580,2618297676],[1288033470,3409855158],[1501505948,4234509866],[1607167915,987167468],[1816402316,1246189591]],or={},or["SHA-512"]=[[1779033703,4089235720],[3144134277,2227873595],[1013904242,4271175723],[2773480762,1595750129],[1359893119,2917565137],[2600822924,725511199],[528734635,4215389547],[1541459225,327033209]],or["SHA-384"]=[[3418070365,3238371032],[1654270250,914150663],[2438529370,812702999],[355462360,4144912697],[1731405415,4290775857],[2394180231,1750603025],[3675008525,1694076839],[1203062813,3204075428]],or["SHA-512/256"]=[[573645204,4230739756],[2673172387,3360449730],[596883563,1867755857],[2520282905,1497426621],[2519219938,2827943907],[3193839141,1401305490],[721525244,746961066],[246885852,2177182882]],or["SHA-512/224"]=[[2352822216,424955298],[1944164710,2312950998],[502970286,855612546],[1738396948,1479516111],[258812777,2077511080],[2011393907,79989058],[1067287976,1780299464],[286451373,2446758561]],R0=!0}function T0(t,e,r){for(var n,i,s,a,o,c,f,u,h,l,g,d,p,y,m,E,b,_,w,S,L,N,H,z,V,Q,ct,Lt,I,k,R,D,A,O,M,q=r.length();q>=128;){for(I=0;I<16;++I)e[I][0]=r.getInt32()>>>0,e[I][1]=r.getInt32()>>>0;for(;I<80;++I)D=e[I-2],k=D[0],R=D[1],n=((k>>>19|R<<13)^(R>>>29|k<<3)^k>>>6)>>>0,i=((k<<13|R>>>19)^(R<<3|k>>>29)^(k<<26|R>>>6))>>>0,O=e[I-15],k=O[0],R=O[1],s=((k>>>1|R<<31)^(k>>>8|R<<24)^k>>>7)>>>0,a=((k<<31|R>>>1)^(k<<24|R>>>8)^(k<<25|R>>>7))>>>0,A=e[I-7],M=e[I-16],R=i+A[1]+a+M[1],e[I][0]=n+A[0]+s+M[0]+(R/4294967296>>>0)>>>0,e[I][1]=R>>>0;for(p=t[0][0],y=t[0][1],m=t[1][0],E=t[1][1],b=t[2][0],_=t[2][1],w=t[3][0],S=t[3][1],L=t[4][0],N=t[4][1],H=t[5][0],z=t[5][1],V=t[6][0],Q=t[6][1],ct=t[7][0],Lt=t[7][1],I=0;I<80;++I)f=((L>>>14|N<<18)^(L>>>18|N<<14)^(N>>>9|L<<23))>>>0,u=((L<<18|N>>>14)^(L<<14|N>>>18)^(N<<23|L>>>9))>>>0,h=(V^L&(H^V))>>>0,l=(Q^N&(z^Q))>>>0,o=((p>>>28|y<<4)^(y>>>2|p<<30)^(y>>>7|p<<25))>>>0,c=((p<<4|y>>>28)^(y<<30|p>>>2)^(y<<25|p>>>7))>>>0,g=(p&m|b&(p^m))>>>0,d=(y&E|_&(y^E))>>>0,R=Lt+u+l+Os[I][1]+e[I][1],n=ct+f+h+Os[I][0]+e[I][0]+(R/4294967296>>>0)>>>0,i=R>>>0,R=c+d,s=o+g+(R/4294967296>>>0)>>>0,a=R>>>0,ct=V,Lt=Q,V=H,Q=z,H=L,z=N,R=S+i,L=w+n+(R/4294967296>>>0)>>>0,N=R>>>0,w=b,S=_,b=m,_=E,m=p,E=y,R=i+a,p=n+s+(R/4294967296>>>0)>>>0,y=R>>>0;R=t[0][1]+y,t[0][0]=t[0][0]+p+(R/4294967296>>>0)>>>0,t[0][1]=R>>>0,R=t[1][1]+E,t[1][0]=t[1][0]+m+(R/4294967296>>>0)>>>0,t[1][1]=R>>>0,R=t[2][1]+_,t[2][0]=t[2][0]+b+(R/4294967296>>>0)>>>0,t[2][1]=R>>>0,R=t[3][1]+S,t[3][0]=t[3][0]+w+(R/4294967296>>>0)>>>0,t[3][1]=R>>>0,R=t[4][1]+N,t[4][0]=t[4][0]+L+(R/4294967296>>>0)>>>0,t[4][1]=R>>>0,R=t[5][1]+z,t[5][0]=t[5][0]+H+(R/4294967296>>>0)>>>0,t[5][1]=R>>>0,R=t[6][1]+Q,t[6][0]=t[6][0]+V+(R/4294967296>>>0)>>>0,t[6][1]=R>>>0,R=t[7][1]+Lt,t[7][0]=t[7][0]+ct+(R/4294967296>>>0)>>>0,t[7][1]=R>>>0,q-=128}}});var cc=j((im,ac)=>{var Pr=1e3,Kr=Pr*60,Ur=Kr*60,ur=Ur*24,Bp=ur*7,Ap=ur*365.25;ac.exports=function(t,e){e=e||{};var r=typeof t;if(r==="string"&&t.length>0)return Cp(t);if(r==="number"&&isFinite(t))return e.long?Tp(t):Ip(t);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(t))};function Cp(t){if(t=String(t),!(t.length>100)){var e=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(t);if(e){var r=parseFloat(e[1]),n=(e[2]||"ms").toLowerCase();switch(n){case"years":case"year":case"yrs":case"yr":case"y":return r*Ap;case"weeks":case"week":case"w":return r*Bp;case"days":case"day":case"d":return r*ur;case"hours":case"hour":case"hrs":case"hr":case"h":return r*Ur;case"minutes":case"minute":case"mins":case"min":case"m":return r*Kr;case"seconds":case"second":case"secs":case"sec":case"s":return r*Pr;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return r;default:return}}}}function Ip(t){var e=Math.abs(t);return e>=ur?Math.round(t/ur)+"d":e>=Ur?Math.round(t/Ur)+"h":e>=Kr?Math.round(t/Kr)+"m":e>=Pr?Math.round(t/Pr)+"s":t+"ms"}function Tp(t){var e=Math.abs(t);return e>=ur?ui(t,e,ur,"day"):e>=Ur?ui(t,e,Ur,"hour"):e>=Kr?ui(t,e,Kr,"minute"):e>=Pr?ui(t,e,Pr,"second"):t+" ms"}function ui(t,e,r,n){var i=e>=r*1.5;return Math.round(t/r)+" "+n+(i?"s":"")}});var uc=j((sm,fc)=>{function _p(t){r.debug=r,r.default=r,r.coerce=c,r.disable=s,r.enable=i,r.enabled=a,r.humanize=cc(),r.destroy=f,Object.keys(t).forEach(u=>{r[u]=t[u]}),r.names=[],r.skips=[],r.formatters={};function e(u){let h=0;for(let l=0;l<u.length;l++)h=(h<<5)-h+u.charCodeAt(l),h|=0;return r.colors[Math.abs(h)%r.colors.length]}r.selectColor=e;function r(u){let h,l=null,g,d;function p(...y){if(!p.enabled)return;let m=p,E=Number(new Date),b=E-(h||E);m.diff=b,m.prev=h,m.curr=E,h=E,y[0]=r.coerce(y[0]),typeof y[0]!="string"&&y.unshift("%O");let _=0;y[0]=y[0].replace(/%([a-zA-Z%])/g,(S,L)=>{if(S==="%%")return"%";_++;let N=r.formatters[L];if(typeof N=="function"){let H=y[_];S=N.call(m,H),y.splice(_,1),_--}return S}),r.formatArgs.call(m,y),(m.log||r.log).apply(m,y)}return p.namespace=u,p.useColors=r.useColors(),p.color=r.selectColor(u),p.extend=n,p.destroy=r.destroy,Object.defineProperty(p,"enabled",{enumerable:!0,configurable:!1,get:()=>l!==null?l:(g!==r.namespaces&&(g=r.namespaces,d=r.enabled(u)),d),set:y=>{l=y}}),typeof r.init=="function"&&r.init(p),p}function n(u,h){let l=r(this.namespace+(typeof h>"u"?":":h)+u);return l.log=this.log,l}function i(u){r.save(u),r.namespaces=u,r.names=[],r.skips=[];let h,l=(typeof u=="string"?u:"").split(/[\s,]+/),g=l.length;for(h=0;h<g;h++)l[h]&&(u=l[h].replace(/\*/g,".*?"),u[0]==="-"?r.skips.push(new RegExp("^"+u.slice(1)+"$")):r.names.push(new RegExp("^"+u+"$")))}function s(){let u=[...r.names.map(o),...r.skips.map(o).map(h=>"-"+h)].join(",");return r.enable(""),u}function a(u){if(u[u.length-1]==="*")return!0;let h,l;for(h=0,l=r.skips.length;h<l;h++)if(r.skips[h].test(u))return!1;for(h=0,l=r.names.length;h<l;h++)if(r.names[h].test(u))return!0;return!1}function o(u){return u.toString().substring(2,u.toString().length-2).replace(/\.\*\?$/,"*")}function c(u){return u instanceof Error?u.stack||u.message:u}function f(){console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.")}return r.enable(r.load()),r}fc.exports=_p});var hc=j((Yt,hi)=>{Yt.formatArgs=Lp;Yt.save=Np;Yt.load=Dp;Yt.useColors=Rp;Yt.storage=kp();Yt.destroy=(()=>{let t=!1;return()=>{t||(t=!0,console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."))}})();Yt.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"];function Rp(){return typeof window<"u"&&window.process&&(window.process.type==="renderer"||window.process.__nwjs)?!0:typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/)?!1:typeof document<"u"&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||typeof window<"u"&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)}function Lp(t){if(t[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+t[0]+(this.useColors?"%c ":" ")+"+"+hi.exports.humanize(this.diff),!this.useColors)return;let e="color: "+this.color;t.splice(1,0,e,"color: inherit");let r=0,n=0;t[0].replace(/%[a-zA-Z%]/g,i=>{i!=="%%"&&(r++,i==="%c"&&(n=r))}),t.splice(n,0,e)}Yt.log=console.debug||console.log||(()=>{});function Np(t){try{t?Yt.storage.setItem("debug",t):Yt.storage.removeItem("debug")}catch{}}function Dp(){let t;try{t=Yt.storage.getItem("debug")}catch{}return!t&&typeof process<"u"&&"env"in process&&(t=process.env.DEBUG),t}function kp(){try{return localStorage}catch{}}hi.exports=uc()(Yt);var{formatters:Pp}=hi.exports;Pp.j=function(t){try{return JSON.stringify(t)}catch(e){return"[UnexpectedJSONParseError]: "+e.message}}});var bc=j((Tm,vc)=>{"use strict";vc.exports=t=>{if(Object.prototype.toString.call(t)!=="[object Object]")return!1;let e=Object.getPrototypeOf(t);return e===null||e===Object.prototype}});var Cc=j((Bc,Ac)=>{"use strict";var di=bc(),{hasOwnProperty:wc}=Object.prototype,{propertyIsEnumerable:zp}=Object,Vr=(t,e,r)=>Object.defineProperty(t,e,{value:r,writable:!0,enumerable:!0,configurable:!0}),Gp=Bc,Ec={concatArrays:!1,ignoreUndefined:!1},pi=t=>{let e=[];for(let r in t)wc.call(t,r)&&e.push(r);if(Object.getOwnPropertySymbols){let r=Object.getOwnPropertySymbols(t);for(let n of r)zp.call(t,n)&&e.push(n)}return e};function qr(t){return Array.isArray(t)?Yp(t):di(t)?$p(t):t}function Yp(t){let e=t.slice(0,0);return pi(t).forEach(r=>{Vr(e,r,qr(t[r]))}),e}function $p(t){let e=Object.getPrototypeOf(t)===null?Object.create(null):{};return pi(t).forEach(r=>{Vr(e,r,qr(t[r]))}),e}var Sc=(t,e,r,n)=>(r.forEach(i=>{typeof e[i]>"u"&&n.ignoreUndefined||(i in t&&t[i]!==Object.getPrototypeOf(t)?Vr(t,i,Xs(t[i],e[i],n)):Vr(t,i,qr(e[i])))}),t),Wp=(t,e,r)=>{let n=t.slice(0,0),i=0;return[t,e].forEach(s=>{let a=[];for(let o=0;o<s.length;o++)wc.call(s,o)&&(a.push(String(o)),s===t?Vr(n,i++,s[o]):Vr(n,i++,qr(s[o])));n=Sc(n,s,pi(s).filter(o=>!a.includes(o)),r)}),n};function Xs(t,e,r){return r.concatArrays&&Array.isArray(t)&&Array.isArray(e)?Wp(t,e,r):!di(e)||!di(t)?qr(e):Sc(t,e,pi(e),r)}Ac.exports=function(...t){let e=Xs(qr(Ec),this!==Gp&&this||{},Ec),r={_:{}};for(let n of t)if(n!==void 0){if(!di(n))throw new TypeError("`"+n+"` is not an Option Object");r=Xs(r,{_:n},e)}return r._}});var Rc=j((Rm,_c)=>{"use strict";function Zp(t){return t>=55296&&t<=56319}function Qp(t){return t>=56320&&t<=57343}_c.exports=function(e,r,n){if(typeof r!="string")throw new Error("Input must be string");for(var i=r.length,s=0,a,o,c=0;c<i;c+=1){if(a=r.charCodeAt(c),o=r[c],Zp(a)&&Qp(r.charCodeAt(c+1))&&(c+=1,o+=r[c]),s+=e(o),s===n)return r.slice(0,c+1);if(s>n)return r.slice(0,c-o.length+1)}return r}});var Nc=j((Lm,Lc)=>{"use strict";function Xp(t){return t>=55296&&t<=56319}function Jp(t){return t>=56320&&t<=57343}Lc.exports=function(e){if(typeof e!="string")throw new Error("Input must be string");for(var r=e.length,n=0,i=null,s=null,a=0;a<r;a++)i=e.charCodeAt(a),Jp(i)?s!=null&&Xp(s)?n+=1:n+=3:i<=127?n+=1:i>=128&&i<=2047?n+=2:i>=2048&&i<=65535&&(n+=3),s=i;return n}});var kc=j((Nm,Dc)=>{"use strict";var jp=Rc(),t1=Nc();Dc.exports=jp.bind(null,t1)});var Uc=j((Dm,Kc)=>{"use strict";var e1=kc(),r1=/[\/\?<>\\:\*\|"]/g,n1=/[\x00-\x1f\x80-\x9f]/g,i1=/^\.+$/,s1=/^(con|prn|aux|nul|com[0-9]|lpt[0-9])(\..*)?$/i,o1=/[\. ]+$/;function Pc(t,e){if(typeof t!="string")throw new Error("Input must be string");var r=t.replace(r1,e).replace(n1,e).replace(i1,e).replace(s1,e).replace(o1,e);return e1(r,255)}Kc.exports=function(t,e){var r=e&&e.replacement||"",n=Pc(t,r);return r===""?n:Pc(n,"")}});var c1={};It(c1,{DefaultKeyChain:()=>js});var K=class extends Error{code;props;constructor(e,r,n){super(e),this.code=r,this.name=n?.name??"CodeError",this.props=n??{}}};var hy=Bt(Sn(),1),du=Bt(ot(),1);function yr(t){return globalThis.Buffer!=null?new Uint8Array(t.buffer,t.byteOffset,t.byteLength):t}var Ni={};It(Ni,{base10:()=>df});function cf(t,e){if(t.length>=255)throw new TypeError("Alphabet too long");for(var r=new Uint8Array(256),n=0;n<r.length;n++)r[n]=255;for(var i=0;i<t.length;i++){var s=t.charAt(i),a=s.charCodeAt(0);if(r[a]!==255)throw new TypeError(s+" is ambiguous");r[a]=i}var o=t.length,c=t.charAt(0),f=Math.log(o)/Math.log(256),u=Math.log(256)/Math.log(o);function h(d){if(d instanceof Uint8Array||(ArrayBuffer.isView(d)?d=new Uint8Array(d.buffer,d.byteOffset,d.byteLength):Array.isArray(d)&&(d=Uint8Array.from(d))),!(d instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(d.length===0)return"";for(var p=0,y=0,m=0,E=d.length;m!==E&&d[m]===0;)m++,p++;for(var b=(E-m)*u+1>>>0,_=new Uint8Array(b);m!==E;){for(var w=d[m],S=0,L=b-1;(w!==0||S<y)&&L!==-1;L--,S++)w+=256*_[L]>>>0,_[L]=w%o>>>0,w=w/o>>>0;if(w!==0)throw new Error("Non-zero carry");y=S,m++}for(var N=b-y;N!==b&&_[N]===0;)N++;for(var H=c.repeat(p);N<b;++N)H+=t.charAt(_[N]);return H}function l(d){if(typeof d!="string")throw new TypeError("Expected String");if(d.length===0)return new Uint8Array;var p=0;if(d[p]!==" "){for(var y=0,m=0;d[p]===c;)y++,p++;for(var E=(d.length-p)*f+1>>>0,b=new Uint8Array(E);d[p];){var _=r[d.charCodeAt(p)];if(_===255)return;for(var w=0,S=E-1;(_!==0||w<m)&&S!==-1;S--,w++)_+=o*b[S]>>>0,b[S]=_%256>>>0,_=_/256>>>0;if(_!==0)throw new Error("Non-zero carry");m=w,p++}if(d[p]!==" "){for(var L=E-m;L!==E&&b[L]===0;)L++;for(var N=new Uint8Array(y+(E-L)),H=y;L!==E;)N[H++]=b[L++];return N}}}function g(d){var p=l(d);if(p)return p;throw new Error(`Non-${e} character`)}return{encode:h,decodeUnsafe:l,decode:g}}var ff=cf,uf=ff,Bo=uf;var E1=new Uint8Array(0);var Ao=(t,e)=>{if(t===e)return!0;if(t.byteLength!==e.byteLength)return!1;for(let r=0;r<t.byteLength;r++)if(t[r]!==e[r])return!1;return!0},pe=t=>{if(t instanceof Uint8Array&&t.constructor.name==="Uint8Array")return t;if(t instanceof ArrayBuffer)return new Uint8Array(t);if(ArrayBuffer.isView(t))return new Uint8Array(t.buffer,t.byteOffset,t.byteLength);throw new Error("Unknown type, must be binary type")};var Co=t=>new TextEncoder().encode(t),Io=t=>new TextDecoder().decode(t);var Ti=class{constructor(e,r,n){this.name=e,this.prefix=r,this.baseEncode=n}encode(e){if(e instanceof Uint8Array)return`${this.prefix}${this.baseEncode(e)}`;throw Error("Unknown type, must be binary type")}},_i=class{constructor(e,r,n){if(this.name=e,this.prefix=r,r.codePointAt(0)===void 0)throw new Error("Invalid prefix character");this.prefixCodePoint=r.codePointAt(0),this.baseDecode=n}decode(e){if(typeof e=="string"){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(e)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(e.slice(this.prefix.length))}else throw Error("Can only multibase decode strings")}or(e){return _o(this,e)}},Ri=class{constructor(e){this.decoders=e}or(e){return _o(this,e)}decode(e){let r=e[0],n=this.decoders[r];if(n)return n.decode(e);throw RangeError(`Unable to decode multibase string ${JSON.stringify(e)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}},_o=(t,e)=>new Ri({...t.decoders||{[t.prefix]:t},...e.decoders||{[e.prefix]:e}}),Li=class{constructor(e,r,n,i){this.name=e,this.prefix=r,this.baseEncode=n,this.baseDecode=i,this.encoder=new Ti(e,r,n),this.decoder=new _i(e,r,i)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}},gr=({name:t,prefix:e,encode:r,decode:n})=>new Li(t,e,r,n),Ne=({prefix:t,name:e,alphabet:r})=>{let{encode:n,decode:i}=Bo(r,e);return gr({prefix:t,name:e,encode:n,decode:s=>pe(i(s))})},hf=(t,e,r,n)=>{let i={};for(let u=0;u<e.length;++u)i[e[u]]=u;let s=t.length;for(;t[s-1]==="=";)--s;let a=new Uint8Array(s*r/8|0),o=0,c=0,f=0;for(let u=0;u<s;++u){let h=i[t[u]];if(h===void 0)throw new SyntaxError(`Non-${n} character`);c=c<<r|h,o+=r,o>=8&&(o-=8,a[f++]=255&c>>o)}if(o>=r||255&c<<8-o)throw new SyntaxError("Unexpected end of data");return a},lf=(t,e,r)=>{let n=e[e.length-1]==="=",i=(1<<r)-1,s="",a=0,o=0;for(let c=0;c<t.length;++c)for(o=o<<8|t[c],a+=8;a>r;)a-=r,s+=e[i&o>>a];if(a&&(s+=e[i&o<<r-a]),n)for(;s.length*r&7;)s+="=";return s},vt=({name:t,prefix:e,bitsPerChar:r,alphabet:n})=>gr({prefix:e,name:t,encode(i){return lf(i,n,r)},decode(i){return hf(i,n,r,t)}});var df=Ne({prefix:"9",name:"base10",alphabet:"0123456789"});var Di={};It(Di,{base16:()=>pf,base16upper:()=>yf});var pf=vt({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),yf=vt({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4});var ki={};It(ki,{base2:()=>gf});var gf=vt({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1});var Pi={};It(Pi,{base256emoji:()=>Ef});var Ro=Array.from("\u{1F680}\u{1FA90}\u2604\u{1F6F0}\u{1F30C}\u{1F311}\u{1F312}\u{1F313}\u{1F314}\u{1F315}\u{1F316}\u{1F317}\u{1F318}\u{1F30D}\u{1F30F}\u{1F30E}\u{1F409}\u2600\u{1F4BB}\u{1F5A5}\u{1F4BE}\u{1F4BF}\u{1F602}\u2764\u{1F60D}\u{1F923}\u{1F60A}\u{1F64F}\u{1F495}\u{1F62D}\u{1F618}\u{1F44D}\u{1F605}\u{1F44F}\u{1F601}\u{1F525}\u{1F970}\u{1F494}\u{1F496}\u{1F499}\u{1F622}\u{1F914}\u{1F606}\u{1F644}\u{1F4AA}\u{1F609}\u263A\u{1F44C}\u{1F917}\u{1F49C}\u{1F614}\u{1F60E}\u{1F607}\u{1F339}\u{1F926}\u{1F389}\u{1F49E}\u270C\u2728\u{1F937}\u{1F631}\u{1F60C}\u{1F338}\u{1F64C}\u{1F60B}\u{1F497}\u{1F49A}\u{1F60F}\u{1F49B}\u{1F642}\u{1F493}\u{1F929}\u{1F604}\u{1F600}\u{1F5A4}\u{1F603}\u{1F4AF}\u{1F648}\u{1F447}\u{1F3B6}\u{1F612}\u{1F92D}\u2763\u{1F61C}\u{1F48B}\u{1F440}\u{1F62A}\u{1F611}\u{1F4A5}\u{1F64B}\u{1F61E}\u{1F629}\u{1F621}\u{1F92A}\u{1F44A}\u{1F973}\u{1F625}\u{1F924}\u{1F449}\u{1F483}\u{1F633}\u270B\u{1F61A}\u{1F61D}\u{1F634}\u{1F31F}\u{1F62C}\u{1F643}\u{1F340}\u{1F337}\u{1F63B}\u{1F613}\u2B50\u2705\u{1F97A}\u{1F308}\u{1F608}\u{1F918}\u{1F4A6}\u2714\u{1F623}\u{1F3C3}\u{1F490}\u2639\u{1F38A}\u{1F498}\u{1F620}\u261D\u{1F615}\u{1F33A}\u{1F382}\u{1F33B}\u{1F610}\u{1F595}\u{1F49D}\u{1F64A}\u{1F639}\u{1F5E3}\u{1F4AB}\u{1F480}\u{1F451}\u{1F3B5}\u{1F91E}\u{1F61B}\u{1F534}\u{1F624}\u{1F33C}\u{1F62B}\u26BD\u{1F919}\u2615\u{1F3C6}\u{1F92B}\u{1F448}\u{1F62E}\u{1F646}\u{1F37B}\u{1F343}\u{1F436}\u{1F481}\u{1F632}\u{1F33F}\u{1F9E1}\u{1F381}\u26A1\u{1F31E}\u{1F388}\u274C\u270A\u{1F44B}\u{1F630}\u{1F928}\u{1F636}\u{1F91D}\u{1F6B6}\u{1F4B0}\u{1F353}\u{1F4A2}\u{1F91F}\u{1F641}\u{1F6A8}\u{1F4A8}\u{1F92C}\u2708\u{1F380}\u{1F37A}\u{1F913}\u{1F619}\u{1F49F}\u{1F331}\u{1F616}\u{1F476}\u{1F974}\u25B6\u27A1\u2753\u{1F48E}\u{1F4B8}\u2B07\u{1F628}\u{1F31A}\u{1F98B}\u{1F637}\u{1F57A}\u26A0\u{1F645}\u{1F61F}\u{1F635}\u{1F44E}\u{1F932}\u{1F920}\u{1F927}\u{1F4CC}\u{1F535}\u{1F485}\u{1F9D0}\u{1F43E}\u{1F352}\u{1F617}\u{1F911}\u{1F30A}\u{1F92F}\u{1F437}\u260E\u{1F4A7}\u{1F62F}\u{1F486}\u{1F446}\u{1F3A4}\u{1F647}\u{1F351}\u2744\u{1F334}\u{1F4A3}\u{1F438}\u{1F48C}\u{1F4CD}\u{1F940}\u{1F922}\u{1F445}\u{1F4A1}\u{1F4A9}\u{1F450}\u{1F4F8}\u{1F47B}\u{1F910}\u{1F92E}\u{1F3BC}\u{1F975}\u{1F6A9}\u{1F34E}\u{1F34A}\u{1F47C}\u{1F48D}\u{1F4E3}\u{1F942}"),xf=Ro.reduce((t,e,r)=>(t[r]=e,t),[]),mf=Ro.reduce((t,e,r)=>(t[e.codePointAt(0)]=r,t),[]);function vf(t){return t.reduce((e,r)=>(e+=xf[r],e),"")}function bf(t){let e=[];for(let r of t){let n=mf[r.codePointAt(0)];if(n===void 0)throw new Error(`Non-base256emoji character: ${r}`);e.push(n)}return new Uint8Array(e)}var Ef=gr({prefix:"\u{1F680}",name:"base256emoji",encode:vf,decode:bf});var Ki={};It(Ki,{base32:()=>De,base32hex:()=>Af,base32hexpad:()=>If,base32hexpadupper:()=>Tf,base32hexupper:()=>Cf,base32pad:()=>Sf,base32padupper:()=>Bf,base32upper:()=>wf,base32z:()=>_f});var De=vt({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),wf=vt({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),Sf=vt({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),Bf=vt({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),Af=vt({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),Cf=vt({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),If=vt({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),Tf=vt({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),_f=vt({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5});var Ui={};It(Ui,{base36:()=>Rf,base36upper:()=>Lf});var Rf=Ne({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),Lf=Ne({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"});var Oi={};It(Oi,{base58btc:()=>kt,base58flickr:()=>Nf});var kt=Ne({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),Nf=Ne({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"});var Mi={};It(Mi,{base64:()=>$e,base64pad:()=>Df,base64url:()=>kf,base64urlpad:()=>Pf});var $e=vt({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),Df=vt({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),kf=vt({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),Pf=vt({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6});var Fi={};It(Fi,{base8:()=>Kf});var Kf=vt({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3});var Vi={};It(Vi,{identity:()=>Uf});var Uf=gr({prefix:"\0",name:"identity",encode:t=>Io(t),decode:t=>Co(t)});var K1=new TextEncoder,U1=new TextDecoder;var Hi={};It(Hi,{identity:()=>ke});var Ff=Do,Lo=128,Vf=127,qf=~Vf,Hf=Math.pow(2,31);function Do(t,e,r){e=e||[],r=r||0;for(var n=r;t>=Hf;)e[r++]=t&255|Lo,t/=128;for(;t&qf;)e[r++]=t&255|Lo,t>>>=7;return e[r]=t|0,Do.bytes=r-n+1,e}var zf=qi,Gf=128,No=127;function qi(t,n){var r=0,n=n||0,i=0,s=n,a,o=t.length;do{if(s>=o)throw qi.bytes=0,new RangeError("Could not decode varint");a=t[s++],r+=i<28?(a&No)<<i:(a&No)*Math.pow(2,i),i+=7}while(a>=Gf);return qi.bytes=s-n,r}var Yf=Math.pow(2,7),$f=Math.pow(2,14),Wf=Math.pow(2,21),Zf=Math.pow(2,28),Qf=Math.pow(2,35),Xf=Math.pow(2,42),Jf=Math.pow(2,49),jf=Math.pow(2,56),tu=Math.pow(2,63),eu=function(t){return t<Yf?1:t<$f?2:t<Wf?3:t<Zf?4:t<Qf?5:t<Xf?6:t<Jf?7:t<jf?8:t<tu?9:10},ru={encode:Ff,decode:zf,encodingLength:eu},nu=ru,Gr=nu;var Yr=(t,e=0)=>[Gr.decode(t,e),Gr.decode.bytes],xr=(t,e,r=0)=>(Gr.encode(t,e,r),e),mr=t=>Gr.encodingLength(t);var ne=(t,e)=>{let r=e.byteLength,n=mr(t),i=n+mr(r),s=new Uint8Array(i+r);return xr(t,s,0),xr(r,s,n),s.set(e,i),new vr(t,r,e,s)},$r=t=>{let e=pe(t),[r,n]=Yr(e),[i,s]=Yr(e.subarray(n)),a=e.subarray(n+s);if(a.byteLength!==i)throw new Error("Incorrect length");return new vr(r,i,a,e)},ko=(t,e)=>{if(t===e)return!0;{let r=e;return t.code===r.code&&t.size===r.size&&r.bytes instanceof Uint8Array&&Ao(t.bytes,r.bytes)}},vr=class{constructor(e,r,n,i){this.code=e,this.size=r,this.digest=n,this.bytes=i}};var Po=0,iu="identity",Ko=pe,su=t=>ne(Po,Ko(t)),ke={code:Po,name:iu,encode:Ko,digest:su};var Yi={};It(Yi,{sha256:()=>Pt,sha512:()=>ou});var Gi=({name:t,code:e,encode:r})=>new zi(t,e,r),zi=class{constructor(e,r,n){this.name=e,this.code=r,this.encode=n}digest(e){if(e instanceof Uint8Array){let r=this.encode(e);return r instanceof Uint8Array?ne(this.code,r):r.then(n=>ne(this.code,n))}else throw Error("Unknown type, must be binary type")}};var Oo=t=>async e=>new Uint8Array(await crypto.subtle.digest(t,e)),Pt=Gi({name:"sha2-256",code:18,encode:Oo("SHA-256")}),ou=Gi({name:"sha2-512",code:19,encode:Oo("SHA-512")});var Mo=(t,e)=>{let{bytes:r,version:n}=t;switch(n){case 0:return cu(r,$i(t),e||kt.encoder);default:return fu(r,$i(t),e||De.encoder)}};var Fo=new WeakMap,$i=t=>{let e=Fo.get(t);if(e==null){let r=new Map;return Fo.set(t,r),r}return e},We=class t{constructor(e,r,n,i){this.code=r,this.version=e,this.multihash=n,this.bytes=i,this["/"]=i}get asCID(){return this}get byteOffset(){return this.bytes.byteOffset}get byteLength(){return this.bytes.byteLength}toV0(){switch(this.version){case 0:return this;case 1:{let{code:e,multihash:r}=this;if(e!==Wr)throw new Error("Cannot convert a non dag-pb CID to CIDv0");if(r.code!==uu)throw new Error("Cannot convert non sha2-256 multihash CID to CIDv0");return t.createV0(r)}default:throw Error(`Can not convert CID version ${this.version} to version 0. This is a bug please report`)}}toV1(){switch(this.version){case 0:{let{code:e,digest:r}=this.multihash,n=ne(e,r);return t.createV1(this.code,n)}case 1:return this;default:throw Error(`Can not convert CID version ${this.version} to version 1. This is a bug please report`)}}equals(e){return t.equals(this,e)}static equals(e,r){let n=r;return n&&e.code===n.code&&e.version===n.version&&ko(e.multihash,n.multihash)}toString(e){return Mo(this,e)}toJSON(){return{"/":Mo(this)}}link(){return this}get[Symbol.toStringTag](){return"CID"}[Symbol.for("nodejs.util.inspect.custom")](){return`CID(${this.toString()})`}static asCID(e){if(e==null)return null;let r=e;if(r instanceof t)return r;if(r["/"]!=null&&r["/"]===r.bytes||r.asCID===r){let{version:n,code:i,multihash:s,bytes:a}=r;return new t(n,i,s,a||Vo(n,i,s.bytes))}else if(r[hu]===!0){let{version:n,multihash:i,code:s}=r,a=$r(i);return t.create(n,s,a)}else return null}static create(e,r,n){if(typeof r!="number")throw new Error("String codecs are no longer supported");if(!(n.bytes instanceof Uint8Array))throw new Error("Invalid digest");switch(e){case 0:{if(r!==Wr)throw new Error(`Version 0 CID must use dag-pb (code: ${Wr}) block encoding`);return new t(e,r,n,n.bytes)}case 1:{let i=Vo(e,r,n.bytes);return new t(e,r,n,i)}default:throw new Error("Invalid version")}}static createV0(e){return t.create(0,Wr,e)}static createV1(e,r){return t.create(1,e,r)}static decode(e){let[r,n]=t.decodeFirst(e);if(n.length)throw new Error("Incorrect length");return r}static decodeFirst(e){let r=t.inspectBytes(e),n=r.size-r.multihashSize,i=pe(e.subarray(n,n+r.multihashSize));if(i.byteLength!==r.multihashSize)throw new Error("Incorrect length");let s=i.subarray(r.multihashSize-r.digestSize),a=new vr(r.multihashCode,r.digestSize,s,i);return[r.version===0?t.createV0(a):t.createV1(r.codec,a),e.subarray(r.size)]}static inspectBytes(e){let r=0,n=()=>{let[h,l]=Yr(e.subarray(r));return r+=l,h},i=n(),s=Wr;if(i===18?(i=0,r=0):s=n(),i!==0&&i!==1)throw new RangeError(`Invalid CID version ${i}`);let a=r,o=n(),c=n(),f=r+c,u=f-a;return{version:i,codec:s,multihashCode:o,digestSize:c,multihashSize:u,size:f}}static parse(e,r){let[n,i]=au(e,r),s=t.decode(i);if(s.version===0&&e[0]!=="Q")throw Error("Version 0 CID string must not include multibase prefix");return $i(s).set(n,e),s}},au=(t,e)=>{switch(t[0]){case"Q":{let r=e||kt;return[kt.prefix,r.decode(`${kt.prefix}${t}`)]}case kt.prefix:{let r=e||kt;return[kt.prefix,r.decode(t)]}case De.prefix:{let r=e||De;return[De.prefix,r.decode(t)]}default:{if(e==null)throw Error("To parse non base32 or base58btc encoded CID multibase decoder must be provided");return[t[0],e.decode(t)]}}},cu=(t,e,r)=>{let{prefix:n}=r;if(n!==kt.prefix)throw Error(`Cannot string encode V0 in ${r.name} encoding`);let i=e.get(n);if(i==null){let s=r.encode(t).slice(1);return e.set(n,s),s}else return i},fu=(t,e,r)=>{let{prefix:n}=r,i=e.get(n);if(i==null){let s=r.encode(t);return e.set(n,s),s}else return i},Wr=112,uu=18,Vo=(t,e,r)=>{let n=mr(t),i=n+mr(e),s=new Uint8Array(i+r.byteLength);return xr(t,s,0),xr(e,s,n),s.set(r,i),s},hu=Symbol.for("@ipld/js-cid/CID");var Er={...Vi,...ki,...Fi,...Ni,...Di,...Ki,...Ui,...Oi,...Mi,...Pi},j1={...Yi,...Hi};function ye(t=0){return globalThis.Buffer?.allocUnsafe!=null?yr(globalThis.Buffer.allocUnsafe(t)):new Uint8Array(t)}function Ho(t,e,r,n){return{name:t,prefix:e,encoder:{name:t,prefix:e,encode:r},decoder:{decode:n}}}var qo=Ho("utf8","u",t=>"u"+new TextDecoder("utf8").decode(t),t=>new TextEncoder().encode(t.substring(1))),Wi=Ho("ascii","a",t=>{let e="a";for(let r=0;r<t.length;r++)e+=String.fromCharCode(t[r]);return e},t=>{t=t.substring(1);let e=ye(t.length);for(let r=0;r<t.length;r++)e[r]=t.charCodeAt(r);return e}),lu={utf8:qo,"utf-8":qo,hex:Er.base16,latin1:Wi,ascii:Wi,binary:Wi,...Er},An=lu;function at(t,e="utf8"){let r=An[e];if(r==null)throw new Error(`Unsupported encoding "${e}"`);return(e==="utf8"||e==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?yr(globalThis.Buffer.from(t,"utf-8")):r.decoder.decode(`${r.prefix}${t}`)}function pt(t,e="utf8"){let r=An[e];if(r==null)throw new Error(`Unsupported encoding "${e}"`);return(e==="utf8"||e==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?globalThis.Buffer.from(t.buffer,t.byteOffset,t.byteLength).toString("utf8"):r.encoder.encode(t).substring(1)}var Ft={get(t=globalThis){let e=t.crypto;if(e==null||e.subtle==null)throw Object.assign(new Error("Missing Web Crypto API. The most likely cause of this error is that this page is being accessed from an insecure context (i.e. not HTTPS). For more information and possible resolutions see https://github.com/libp2p/js-libp2p-crypto/blob/master/README.md#web-crypto-api"),{code:"ERR_MISSING_WEB_CRYPTO"});return e}};var Yx=Bt(Xr(),1),$x=Bt(Ga(),1);var fi=Bt(ot(),1);var Ks={};It(Ks,{Ed25519PrivateKey:()=>sr,Ed25519PublicKey:()=>an,generateKeyPair:()=>$d,generateKeyPairFromSeed:()=>B0,unmarshalEd25519PrivateKey:()=>Gd,unmarshalEd25519PublicKey:()=>Yd});function Ht(t,e){if(t===e)return!0;if(t.byteLength!==e.byteLength)return!1;for(let r=0;r<t.byteLength;r++)if(t[r]!==e[r])return!1;return!0}function Ya(t){if(!Number.isSafeInteger(t)||t<0)throw new Error(`Wrong positive integer: ${t}`)}function os(t,...e){if(!(t instanceof Uint8Array))throw new Error("Expected Uint8Array");if(e.length>0&&!e.includes(t.length))throw new Error(`Expected Uint8Array of length ${e}, not of length=${t.length}`)}function $a(t){if(typeof t!="function"||typeof t.create!="function")throw new Error("Hash should be wrapped by utils.wrapConstructor");Ya(t.outputLen),Ya(t.blockLen)}function Br(t,e=!0){if(t.destroyed)throw new Error("Hash instance has been destroyed");if(e&&t.finished)throw new Error("Hash#digest() has already been called")}function Wa(t,e){os(t);let r=e.outputLen;if(t.length<r)throw new Error(`digestInto() expects output buffer of length at least ${r}`)}var Fn=typeof globalThis=="object"&&"crypto"in globalThis?globalThis.crypto:void 0;var Za=t=>t instanceof Uint8Array;var Vn=t=>new DataView(t.buffer,t.byteOffset,t.byteLength),jt=(t,e)=>t<<32-e|t>>>e,Dl=new Uint8Array(new Uint32Array([287454020]).buffer)[0]===68;if(!Dl)throw new Error("Non little-endian hardware is not supported");function as(t){if(typeof t!="string")throw new Error(`utf8ToBytes expected string, got ${typeof t}`);return new Uint8Array(new TextEncoder().encode(t))}function tn(t){if(typeof t=="string"&&(t=as(t)),!Za(t))throw new Error(`expected Uint8Array, got ${typeof t}`);return t}function qn(...t){let e=new Uint8Array(t.reduce((n,i)=>n+i.length,0)),r=0;return t.forEach(n=>{if(!Za(n))throw new Error("Uint8Array expected");e.set(n,r),r+=n.length}),e}var Ar=class{clone(){return this._cloneInto()}},Yy={}.toString;function Hn(t){let e=n=>t().update(tn(n)).digest(),r=t();return e.outputLen=r.outputLen,e.blockLen=r.blockLen,e.create=()=>t(),e}function Cr(t=32){if(Fn&&typeof Fn.getRandomValues=="function")return Fn.getRandomValues(new Uint8Array(t));throw new Error("crypto.getRandomValues must be defined")}function kl(t,e,r,n){if(typeof t.setBigUint64=="function")return t.setBigUint64(e,r,n);let i=BigInt(32),s=BigInt(4294967295),a=Number(r>>i&s),o=Number(r&s),c=n?4:0,f=n?0:4;t.setUint32(e+c,a,n),t.setUint32(e+f,o,n)}var Ir=class extends Ar{constructor(e,r,n,i){super(),this.blockLen=e,this.outputLen=r,this.padOffset=n,this.isLE=i,this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.buffer=new Uint8Array(e),this.view=Vn(this.buffer)}update(e){Br(this);let{view:r,buffer:n,blockLen:i}=this;e=tn(e);let s=e.length;for(let a=0;a<s;){let o=Math.min(i-this.pos,s-a);if(o===i){let c=Vn(e);for(;i<=s-a;a+=i)this.process(c,a);continue}n.set(e.subarray(a,a+o),this.pos),this.pos+=o,a+=o,this.pos===i&&(this.process(r,0),this.pos=0)}return this.length+=e.length,this.roundClean(),this}digestInto(e){Br(this),Wa(e,this),this.finished=!0;let{buffer:r,view:n,blockLen:i,isLE:s}=this,{pos:a}=this;r[a++]=128,this.buffer.subarray(a).fill(0),this.padOffset>i-a&&(this.process(n,0),a=0);for(let h=a;h<i;h++)r[h]=0;kl(n,i-8,BigInt(this.length*8),s),this.process(n,0);let o=Vn(e),c=this.outputLen;if(c%4)throw new Error("_sha2: outputLen should be aligned to 32bit");let f=c/4,u=this.get();if(f>u.length)throw new Error("_sha2: outputLen bigger than state");for(let h=0;h<f;h++)o.setUint32(4*h,u[h],s)}digest(){let{buffer:e,outputLen:r}=this;this.digestInto(e);let n=e.slice(0,r);return this.destroy(),n}_cloneInto(e){e||(e=new this.constructor),e.set(...this.get());let{blockLen:r,buffer:n,length:i,finished:s,destroyed:a,pos:o}=this;return e.length=i,e.pos=o,e.finished=s,e.destroyed=a,i%r&&e.buffer.set(n),e}};var zn=BigInt(4294967295),cs=BigInt(32);function Qa(t,e=!1){return e?{h:Number(t&zn),l:Number(t>>cs&zn)}:{h:Number(t>>cs&zn)|0,l:Number(t&zn)|0}}function Pl(t,e=!1){let r=new Uint32Array(t.length),n=new Uint32Array(t.length);for(let i=0;i<t.length;i++){let{h:s,l:a}=Qa(t[i],e);[r[i],n[i]]=[s,a]}return[r,n]}var Kl=(t,e)=>BigInt(t>>>0)<<cs|BigInt(e>>>0),Ul=(t,e,r)=>t>>>r,Ol=(t,e,r)=>t<<32-r|e>>>r,Ml=(t,e,r)=>t>>>r|e<<32-r,Fl=(t,e,r)=>t<<32-r|e>>>r,Vl=(t,e,r)=>t<<64-r|e>>>r-32,ql=(t,e,r)=>t>>>r-32|e<<64-r,Hl=(t,e)=>e,zl=(t,e)=>t,Gl=(t,e,r)=>t<<r|e>>>32-r,Yl=(t,e,r)=>e<<r|t>>>32-r,$l=(t,e,r)=>e<<r-32|t>>>64-r,Wl=(t,e,r)=>t<<r-32|e>>>64-r;function Zl(t,e,r,n){let i=(e>>>0)+(n>>>0);return{h:t+r+(i/2**32|0)|0,l:i|0}}var Ql=(t,e,r)=>(t>>>0)+(e>>>0)+(r>>>0),Xl=(t,e,r,n)=>e+r+n+(t/2**32|0)|0,Jl=(t,e,r,n)=>(t>>>0)+(e>>>0)+(r>>>0)+(n>>>0),jl=(t,e,r,n,i)=>e+r+n+i+(t/2**32|0)|0,td=(t,e,r,n,i)=>(t>>>0)+(e>>>0)+(r>>>0)+(n>>>0)+(i>>>0),ed=(t,e,r,n,i,s)=>e+r+n+i+s+(t/2**32|0)|0;var rd={fromBig:Qa,split:Pl,toBig:Kl,shrSH:Ul,shrSL:Ol,rotrSH:Ml,rotrSL:Fl,rotrBH:Vl,rotrBL:ql,rotr32H:Hl,rotr32L:zl,rotlSH:Gl,rotlSL:Yl,rotlBH:$l,rotlBL:Wl,add:Zl,add3L:Ql,add3H:Xl,add4L:Jl,add4H:jl,add5H:ed,add5L:td},$=rd;var[nd,id]=(()=>$.split(["0x428a2f98d728ae22","0x7137449123ef65cd","0xb5c0fbcfec4d3b2f","0xe9b5dba58189dbbc","0x3956c25bf348b538","0x59f111f1b605d019","0x923f82a4af194f9b","0xab1c5ed5da6d8118","0xd807aa98a3030242","0x12835b0145706fbe","0x243185be4ee4b28c","0x550c7dc3d5ffb4e2","0x72be5d74f27b896f","0x80deb1fe3b1696b1","0x9bdc06a725c71235","0xc19bf174cf692694","0xe49b69c19ef14ad2","0xefbe4786384f25e3","0x0fc19dc68b8cd5b5","0x240ca1cc77ac9c65","0x2de92c6f592b0275","0x4a7484aa6ea6e483","0x5cb0a9dcbd41fbd4","0x76f988da831153b5","0x983e5152ee66dfab","0xa831c66d2db43210","0xb00327c898fb213f","0xbf597fc7beef0ee4","0xc6e00bf33da88fc2","0xd5a79147930aa725","0x06ca6351e003826f","0x142929670a0e6e70","0x27b70a8546d22ffc","0x2e1b21385c26c926","0x4d2c6dfc5ac42aed","0x53380d139d95b3df","0x650a73548baf63de","0x766a0abb3c77b2a8","0x81c2c92e47edaee6","0x92722c851482353b","0xa2bfe8a14cf10364","0xa81a664bbc423001","0xc24b8b70d0f89791","0xc76c51a30654be30","0xd192e819d6ef5218","0xd69906245565a910","0xf40e35855771202a","0x106aa07032bbd1b8","0x19a4c116b8d2d0c8","0x1e376c085141ab53","0x2748774cdf8eeb99","0x34b0bcb5e19b48a8","0x391c0cb3c5c95a63","0x4ed8aa4ae3418acb","0x5b9cca4f7763e373","0x682e6ff3d6b2b8a3","0x748f82ee5defb2fc","0x78a5636f43172f60","0x84c87814a1f0ab72","0x8cc702081a6439ec","0x90befffa23631e28","0xa4506cebde82bde9","0xbef9a3f7b2c67915","0xc67178f2e372532b","0xca273eceea26619c","0xd186b8c721c0c207","0xeada7dd6cde0eb1e","0xf57d4f7fee6ed178","0x06f067aa72176fba","0x0a637dc5a2c898a6","0x113f9804bef90dae","0x1b710b35131c471b","0x28db77f523047d84","0x32caab7b40c72493","0x3c9ebe0a15c9bebc","0x431d67c49c100d4c","0x4cc5d4becb3e42b6","0x597f299cfc657e2a","0x5fcb6fab3ad6faec","0x6c44198c4a475817"].map(t=>BigInt(t))))(),Ue=new Uint32Array(80),Oe=new Uint32Array(80),fs=class extends Ir{constructor(){super(128,64,16,!1),this.Ah=1779033703,this.Al=-205731576,this.Bh=-1150833019,this.Bl=-2067093701,this.Ch=1013904242,this.Cl=-23791573,this.Dh=-1521486534,this.Dl=1595750129,this.Eh=1359893119,this.El=-1377402159,this.Fh=-1694144372,this.Fl=725511199,this.Gh=528734635,this.Gl=-79577749,this.Hh=1541459225,this.Hl=327033209}get(){let{Ah:e,Al:r,Bh:n,Bl:i,Ch:s,Cl:a,Dh:o,Dl:c,Eh:f,El:u,Fh:h,Fl:l,Gh:g,Gl:d,Hh:p,Hl:y}=this;return[e,r,n,i,s,a,o,c,f,u,h,l,g,d,p,y]}set(e,r,n,i,s,a,o,c,f,u,h,l,g,d,p,y){this.Ah=e|0,this.Al=r|0,this.Bh=n|0,this.Bl=i|0,this.Ch=s|0,this.Cl=a|0,this.Dh=o|0,this.Dl=c|0,this.Eh=f|0,this.El=u|0,this.Fh=h|0,this.Fl=l|0,this.Gh=g|0,this.Gl=d|0,this.Hh=p|0,this.Hl=y|0}process(e,r){for(let b=0;b<16;b++,r+=4)Ue[b]=e.getUint32(r),Oe[b]=e.getUint32(r+=4);for(let b=16;b<80;b++){let _=Ue[b-15]|0,w=Oe[b-15]|0,S=$.rotrSH(_,w,1)^$.rotrSH(_,w,8)^$.shrSH(_,w,7),L=$.rotrSL(_,w,1)^$.rotrSL(_,w,8)^$.shrSL(_,w,7),N=Ue[b-2]|0,H=Oe[b-2]|0,z=$.rotrSH(N,H,19)^$.rotrBH(N,H,61)^$.shrSH(N,H,6),V=$.rotrSL(N,H,19)^$.rotrBL(N,H,61)^$.shrSL(N,H,6),Q=$.add4L(L,V,Oe[b-7],Oe[b-16]),ct=$.add4H(Q,S,z,Ue[b-7],Ue[b-16]);Ue[b]=ct|0,Oe[b]=Q|0}let{Ah:n,Al:i,Bh:s,Bl:a,Ch:o,Cl:c,Dh:f,Dl:u,Eh:h,El:l,Fh:g,Fl:d,Gh:p,Gl:y,Hh:m,Hl:E}=this;for(let b=0;b<80;b++){let _=$.rotrSH(h,l,14)^$.rotrSH(h,l,18)^$.rotrBH(h,l,41),w=$.rotrSL(h,l,14)^$.rotrSL(h,l,18)^$.rotrBL(h,l,41),S=h&g^~h&p,L=l&d^~l&y,N=$.add5L(E,w,L,id[b],Oe[b]),H=$.add5H(N,m,_,S,nd[b],Ue[b]),z=N|0,V=$.rotrSH(n,i,28)^$.rotrBH(n,i,34)^$.rotrBH(n,i,39),Q=$.rotrSL(n,i,28)^$.rotrBL(n,i,34)^$.rotrBL(n,i,39),ct=n&s^n&o^s&o,Lt=i&a^i&c^a&c;m=p|0,E=y|0,p=g|0,y=d|0,g=h|0,d=l|0,{h,l}=$.add(f|0,u|0,H|0,z|0),f=o|0,u=c|0,o=s|0,c=a|0,s=n|0,a=i|0;let I=$.add3L(z,Q,Lt);n=$.add3H(I,H,V,ct),i=I|0}({h:n,l:i}=$.add(this.Ah|0,this.Al|0,n|0,i|0)),{h:s,l:a}=$.add(this.Bh|0,this.Bl|0,s|0,a|0),{h:o,l:c}=$.add(this.Ch|0,this.Cl|0,o|0,c|0),{h:f,l:u}=$.add(this.Dh|0,this.Dl|0,f|0,u|0),{h,l}=$.add(this.Eh|0,this.El|0,h|0,l|0),{h:g,l:d}=$.add(this.Fh|0,this.Fl|0,g|0,d|0),{h:p,l:y}=$.add(this.Gh|0,this.Gl|0,p|0,y|0),{h:m,l:E}=$.add(this.Hh|0,this.Hl|0,m|0,E|0),this.set(n,i,s,a,o,c,f,u,h,l,g,d,p,y,m,E)}roundClean(){Ue.fill(0),Oe.fill(0)}destroy(){this.buffer.fill(0),this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)}};var us=Hn(()=>new fs);var $n={};It($n,{bitGet:()=>hd,bitLen:()=>ud,bitMask:()=>en,bitSet:()=>ld,bytesToHex:()=>ve,bytesToNumberBE:()=>be,bytesToNumberLE:()=>Me,concatBytes:()=>Ee,createHmacDrbg:()=>ds,ensureBytes:()=>bt,equalBytes:()=>cd,hexToBytes:()=>je,hexToNumber:()=>ls,numberToBytesBE:()=>Fe,numberToBytesLE:()=>tr,numberToHexUnpadded:()=>ja,numberToVarBytesBE:()=>ad,utf8ToBytes:()=>fd,validateObject:()=>ue});var Ja=BigInt(0),Gn=BigInt(1),sd=BigInt(2),Yn=t=>t instanceof Uint8Array,od=Array.from({length:256},(t,e)=>e.toString(16).padStart(2,"0"));function ve(t){if(!Yn(t))throw new Error("Uint8Array expected");let e="";for(let r=0;r<t.length;r++)e+=od[t[r]];return e}function ja(t){let e=t.toString(16);return e.length&1?`0${e}`:e}function ls(t){if(typeof t!="string")throw new Error("hex string expected, got "+typeof t);return BigInt(t===""?"0":`0x${t}`)}function je(t){if(typeof t!="string")throw new Error("hex string expected, got "+typeof t);let e=t.length;if(e%2)throw new Error("padded hex string expected, got unpadded hex of length "+e);let r=new Uint8Array(e/2);for(let n=0;n<r.length;n++){let i=n*2,s=t.slice(i,i+2),a=Number.parseInt(s,16);if(Number.isNaN(a)||a<0)throw new Error("Invalid byte sequence");r[n]=a}return r}function be(t){return ls(ve(t))}function Me(t){if(!Yn(t))throw new Error("Uint8Array expected");return ls(ve(Uint8Array.from(t).reverse()))}function Fe(t,e){return je(t.toString(16).padStart(e*2,"0"))}function tr(t,e){return Fe(t,e).reverse()}function ad(t){return je(ja(t))}function bt(t,e,r){let n;if(typeof e=="string")try{n=je(e)}catch(s){throw new Error(`${t} must be valid hex string, got "${e}". Cause: ${s}`)}else if(Yn(e))n=Uint8Array.from(e);else throw new Error(`${t} must be hex string or Uint8Array`);let i=n.length;if(typeof r=="number"&&i!==r)throw new Error(`${t} expected ${r} bytes, got ${i}`);return n}function Ee(...t){let e=new Uint8Array(t.reduce((n,i)=>n+i.length,0)),r=0;return t.forEach(n=>{if(!Yn(n))throw new Error("Uint8Array expected");e.set(n,r),r+=n.length}),e}function cd(t,e){if(t.length!==e.length)return!1;for(let r=0;r<t.length;r++)if(t[r]!==e[r])return!1;return!0}function fd(t){if(typeof t!="string")throw new Error(`utf8ToBytes expected string, got ${typeof t}`);return new Uint8Array(new TextEncoder().encode(t))}function ud(t){let e;for(e=0;t>Ja;t>>=Gn,e+=1);return e}function hd(t,e){return t>>BigInt(e)&Gn}var ld=(t,e,r)=>t|(r?Gn:Ja)<<BigInt(e),en=t=>(sd<<BigInt(t-1))-Gn,hs=t=>new Uint8Array(t),Xa=t=>Uint8Array.from(t);function ds(t,e,r){if(typeof t!="number"||t<2)throw new Error("hashLen must be a number");if(typeof e!="number"||e<2)throw new Error("qByteLen must be a number");if(typeof r!="function")throw new Error("hmacFn must be a function");let n=hs(t),i=hs(t),s=0,a=()=>{n.fill(1),i.fill(0),s=0},o=(...h)=>r(i,n,...h),c=(h=hs())=>{i=o(Xa([0]),h),n=o(),h.length!==0&&(i=o(Xa([1]),h),n=o())},f=()=>{if(s++>=1e3)throw new Error("drbg: tried 1000 values");let h=0,l=[];for(;h<e;){n=o();let g=n.slice();l.push(g),h+=n.length}return Ee(...l)};return(h,l)=>{a(),c(h);let g;for(;!(g=l(f()));)c();return a(),g}}var dd={bigint:t=>typeof t=="bigint",function:t=>typeof t=="function",boolean:t=>typeof t=="boolean",string:t=>typeof t=="string",stringOrUint8Array:t=>typeof t=="string"||t instanceof Uint8Array,isSafeInteger:t=>Number.isSafeInteger(t),array:t=>Array.isArray(t),field:(t,e)=>e.Fp.isValid(t),hash:t=>typeof t=="function"&&Number.isSafeInteger(t.outputLen)};function ue(t,e,r={}){let n=(i,s,a)=>{let o=dd[s];if(typeof o!="function")throw new Error(`Invalid validator "${s}", expected function`);let c=t[i];if(!(a&&c===void 0)&&!o(c,t))throw new Error(`Invalid param ${String(i)}=${c} (${typeof c}), expected ${s}`)};for(let[i,s]of Object.entries(e))n(i,s,!1);for(let[i,s]of Object.entries(r))n(i,s,!0);return t}var Ct=BigInt(0),gt=BigInt(1),er=BigInt(2),pd=BigInt(3),ps=BigInt(4),t0=BigInt(5),e0=BigInt(8),yd=BigInt(9),gd=BigInt(16);function ft(t,e){let r=t%e;return r>=Ct?r:e+r}function xd(t,e,r){if(r<=Ct||e<Ct)throw new Error("Expected power/modulo > 0");if(r===gt)return Ct;let n=gt;for(;e>Ct;)e&gt&&(n=n*t%r),t=t*t%r,e>>=gt;return n}function xt(t,e,r){let n=t;for(;e-- >Ct;)n*=n,n%=r;return n}function Wn(t,e){if(t===Ct||e<=Ct)throw new Error(`invert: expected positive integers, got n=${t} mod=${e}`);let r=ft(t,e),n=e,i=Ct,s=gt,a=gt,o=Ct;for(;r!==Ct;){let f=n/r,u=n%r,h=i-a*f,l=s-o*f;n=r,r=u,i=a,s=o,a=h,o=l}if(n!==gt)throw new Error("invert: does not exist");return ft(i,e)}function md(t){let e=(t-gt)/er,r,n,i;for(r=t-gt,n=0;r%er===Ct;r/=er,n++);for(i=er;i<t&&xd(i,e,t)!==t-gt;i++);if(n===1){let a=(t+gt)/ps;return function(c,f){let u=c.pow(f,a);if(!c.eql(c.sqr(u),f))throw new Error("Cannot find square root");return u}}let s=(r+gt)/er;return function(o,c){if(o.pow(c,e)===o.neg(o.ONE))throw new Error("Cannot find square root");let f=n,u=o.pow(o.mul(o.ONE,i),r),h=o.pow(c,s),l=o.pow(c,r);for(;!o.eql(l,o.ONE);){if(o.eql(l,o.ZERO))return o.ZERO;let g=1;for(let p=o.sqr(l);g<f&&!o.eql(p,o.ONE);g++)p=o.sqr(p);let d=o.pow(u,gt<<BigInt(f-g-1));u=o.sqr(d),h=o.mul(h,d),l=o.mul(l,u),f=g}return h}}function vd(t){if(t%ps===pd){let e=(t+gt)/ps;return function(n,i){let s=n.pow(i,e);if(!n.eql(n.sqr(s),i))throw new Error("Cannot find square root");return s}}if(t%e0===t0){let e=(t-t0)/e0;return function(n,i){let s=n.mul(i,er),a=n.pow(s,e),o=n.mul(i,a),c=n.mul(n.mul(o,er),a),f=n.mul(o,n.sub(c,n.ONE));if(!n.eql(n.sqr(f),i))throw new Error("Cannot find square root");return f}}return t%gd,md(t)}var r0=(t,e)=>(ft(t,e)&gt)===gt,bd=["create","isValid","is0","neg","inv","sqrt","sqr","eql","add","sub","mul","pow","div","addN","subN","mulN","sqrN"];function ys(t){let e={ORDER:"bigint",MASK:"bigint",BYTES:"isSafeInteger",BITS:"isSafeInteger"},r=bd.reduce((n,i)=>(n[i]="function",n),e);return ue(t,r)}function Ed(t,e,r){if(r<Ct)throw new Error("Expected power > 0");if(r===Ct)return t.ONE;if(r===gt)return e;let n=t.ONE,i=e;for(;r>Ct;)r&gt&&(n=t.mul(n,i)),i=t.sqr(i),r>>=gt;return n}function wd(t,e){let r=new Array(e.length),n=e.reduce((s,a,o)=>t.is0(a)?s:(r[o]=s,t.mul(s,a)),t.ONE),i=t.inv(n);return e.reduceRight((s,a,o)=>t.is0(a)?s:(r[o]=t.mul(s,r[o]),t.mul(s,a)),i),r}function gs(t,e){let r=e!==void 0?e:t.toString(2).length,n=Math.ceil(r/8);return{nBitLength:r,nByteLength:n}}function Zn(t,e,r=!1,n={}){if(t<=Ct)throw new Error(`Expected Field ORDER > 0, got ${t}`);let{nBitLength:i,nByteLength:s}=gs(t,e);if(s>2048)throw new Error("Field lengths over 2048 bytes are not supported");let a=vd(t),o=Object.freeze({ORDER:t,BITS:i,BYTES:s,MASK:en(i),ZERO:Ct,ONE:gt,create:c=>ft(c,t),isValid:c=>{if(typeof c!="bigint")throw new Error(`Invalid field element: expected bigint, got ${typeof c}`);return Ct<=c&&c<t},is0:c=>c===Ct,isOdd:c=>(c&gt)===gt,neg:c=>ft(-c,t),eql:(c,f)=>c===f,sqr:c=>ft(c*c,t),add:(c,f)=>ft(c+f,t),sub:(c,f)=>ft(c-f,t),mul:(c,f)=>ft(c*f,t),pow:(c,f)=>Ed(o,c,f),div:(c,f)=>ft(c*Wn(f,t),t),sqrN:c=>c*c,addN:(c,f)=>c+f,subN:(c,f)=>c-f,mulN:(c,f)=>c*f,inv:c=>Wn(c,t),sqrt:n.sqrt||(c=>a(o,c)),invertBatch:c=>wd(o,c),cmov:(c,f,u)=>u?f:c,toBytes:c=>r?tr(c,s):Fe(c,s),fromBytes:c=>{if(c.length!==s)throw new Error(`Fp.fromBytes: expected ${s}, got ${c.length}`);return r?Me(c):be(c)}});return Object.freeze(o)}function n0(t,e){if(!t.isOdd)throw new Error("Field doesn't have isOdd");let r=t.sqrt(e);return t.isOdd(r)?t.neg(r):r}function i0(t){if(typeof t!="bigint")throw new Error("field order must be bigint");let e=t.toString(2).length;return Math.ceil(e/8)}function xs(t){let e=i0(t);return e+Math.ceil(e/2)}function s0(t,e,r=!1){let n=t.length,i=i0(e),s=xs(e);if(n<16||n<s||n>1024)throw new Error(`expected ${s}-1024 bytes of input, got ${n}`);let a=r?be(t):Me(t),o=ft(a,e-gt)+gt;return r?tr(o,i):Fe(o,i)}var Bd=BigInt(0),ms=BigInt(1);function Qn(t,e){let r=(i,s)=>{let a=s.negate();return i?a:s},n=i=>{let s=Math.ceil(e/i)+1,a=2**(i-1);return{windows:s,windowSize:a}};return{constTimeNegate:r,unsafeLadder(i,s){let a=t.ZERO,o=i;for(;s>Bd;)s&ms&&(a=a.add(o)),o=o.double(),s>>=ms;return a},precomputeWindow(i,s){let{windows:a,windowSize:o}=n(s),c=[],f=i,u=f;for(let h=0;h<a;h++){u=f,c.push(u);for(let l=1;l<o;l++)u=u.add(f),c.push(u);f=u.double()}return c},wNAF(i,s,a){let{windows:o,windowSize:c}=n(i),f=t.ZERO,u=t.BASE,h=BigInt(2**i-1),l=2**i,g=BigInt(i);for(let d=0;d<o;d++){let p=d*c,y=Number(a&h);a>>=g,y>c&&(y-=l,a+=ms);let m=p,E=p+Math.abs(y)-1,b=d%2!==0,_=y<0;y===0?u=u.add(r(b,s[m])):f=f.add(r(_,s[E]))}return{p:f,f:u}},wNAFCached(i,s,a,o){let c=i._WINDOW_SIZE||1,f=s.get(i);return f||(f=this.precomputeWindow(i,c),c!==1&&s.set(i,o(f))),this.wNAF(c,f,a)}}}function rn(t){return ys(t.Fp),ue(t,{n:"bigint",h:"bigint",Gx:"field",Gy:"field"},{nBitLength:"isSafeInteger",nByteLength:"isSafeInteger"}),Object.freeze({...gs(t.n,t.nBitLength),...t,p:t.Fp.ORDER})}var te=BigInt(0),zt=BigInt(1),Xn=BigInt(2),Ad=BigInt(8),Cd={zip215:!0};function Id(t){let e=rn(t);return ue(t,{hash:"function",a:"bigint",d:"bigint",randomBytes:"function"},{adjustScalarBytes:"function",domain:"function",uvRatio:"function",mapToCurve:"function"}),Object.freeze({...e})}function Jn(t){let e=Id(t),{Fp:r,n,prehash:i,hash:s,randomBytes:a,nByteLength:o,h:c}=e,f=Xn<<BigInt(o*8)-zt,u=r.create,h=e.uvRatio||((D,A)=>{try{return{isValid:!0,value:r.sqrt(D*r.inv(A))}}catch{return{isValid:!1,value:te}}}),l=e.adjustScalarBytes||(D=>D),g=e.domain||((D,A,O)=>{if(A.length||O)throw new Error("Contexts/pre-hash are not supported");return D}),d=D=>typeof D=="bigint"&&te<D,p=(D,A)=>d(D)&&d(A)&&D<A,y=D=>D===te||p(D,f);function m(D,A){if(p(D,A))return D;throw new Error(`Expected valid scalar < ${A}, got ${typeof D} ${D}`)}function E(D){return D===te?D:m(D,n)}let b=new Map;function _(D){if(!(D instanceof w))throw new Error("ExtendedPoint expected")}class w{constructor(A,O,M,q){if(this.ex=A,this.ey=O,this.ez=M,this.et=q,!y(A))throw new Error("x required");if(!y(O))throw new Error("y required");if(!y(M))throw new Error("z required");if(!y(q))throw new Error("t required")}get x(){return this.toAffine().x}get y(){return this.toAffine().y}static fromAffine(A){if(A instanceof w)throw new Error("extended point not allowed");let{x:O,y:M}=A||{};if(!y(O)||!y(M))throw new Error("invalid affine point");return new w(O,M,zt,u(O*M))}static normalizeZ(A){let O=r.invertBatch(A.map(M=>M.ez));return A.map((M,q)=>M.toAffine(O[q])).map(w.fromAffine)}_setWindowSize(A){this._WINDOW_SIZE=A,b.delete(this)}assertValidity(){let{a:A,d:O}=e;if(this.is0())throw new Error("bad point: ZERO");let{ex:M,ey:q,ez:W,et:X}=this,st=u(M*M),J=u(q*q),nt=u(W*W),St=u(nt*nt),mt=u(st*A),Nt=u(nt*u(mt+J)),Dt=u(St+u(O*u(st*J)));if(Nt!==Dt)throw new Error("bad point: equation left != right (1)");let At=u(M*q),Kt=u(W*X);if(At!==Kt)throw new Error("bad point: equation left != right (2)")}equals(A){_(A);let{ex:O,ey:M,ez:q}=this,{ex:W,ey:X,ez:st}=A,J=u(O*st),nt=u(W*q),St=u(M*st),mt=u(X*q);return J===nt&&St===mt}is0(){return this.equals(w.ZERO)}negate(){return new w(u(-this.ex),this.ey,this.ez,u(-this.et))}double(){let{a:A}=e,{ex:O,ey:M,ez:q}=this,W=u(O*O),X=u(M*M),st=u(Xn*u(q*q)),J=u(A*W),nt=O+M,St=u(u(nt*nt)-W-X),mt=J+X,Nt=mt-st,Dt=J-X,At=u(St*Nt),Kt=u(mt*Dt),de=u(St*Dt),Ge=u(Nt*mt);return new w(At,Kt,Ge,de)}add(A){_(A);let{a:O,d:M}=e,{ex:q,ey:W,ez:X,et:st}=this,{ex:J,ey:nt,ez:St,et:mt}=A;if(O===BigInt(-1)){let eo=u((W-q)*(nt+J)),ro=u((W+q)*(nt-J)),gi=u(ro-eo);if(gi===te)return this.double();let no=u(X*Xn*mt),io=u(st*Xn*St),so=io+no,oo=ro+eo,ao=io-no,zc=u(so*gi),Gc=u(oo*ao),Yc=u(so*ao),$c=u(gi*oo);return new w(zc,Gc,$c,Yc)}let Nt=u(q*J),Dt=u(W*nt),At=u(st*M*mt),Kt=u(X*St),de=u((q+W)*(J+nt)-Nt-Dt),Ge=Kt-At,Hr=Kt+At,to=u(Dt-O*Nt),Fc=u(de*Ge),Vc=u(Hr*to),qc=u(de*to),Hc=u(Ge*Hr);return new w(Fc,Vc,Hc,qc)}subtract(A){return this.add(A.negate())}wNAF(A){return N.wNAFCached(this,b,A,w.normalizeZ)}multiply(A){let{p:O,f:M}=this.wNAF(m(A,n));return w.normalizeZ([O,M])[0]}multiplyUnsafe(A){let O=E(A);return O===te?L:this.equals(L)||O===zt?this:this.equals(S)?this.wNAF(O).p:N.unsafeLadder(this,O)}isSmallOrder(){return this.multiplyUnsafe(c).is0()}isTorsionFree(){return N.unsafeLadder(this,n).is0()}toAffine(A){let{ex:O,ey:M,ez:q}=this,W=this.is0();A==null&&(A=W?Ad:r.inv(q));let X=u(O*A),st=u(M*A),J=u(q*A);if(W)return{x:te,y:zt};if(J!==zt)throw new Error("invZ was invalid");return{x:X,y:st}}clearCofactor(){let{h:A}=e;return A===zt?this:this.multiplyUnsafe(A)}static fromHex(A,O=!1){let{d:M,a:q}=e,W=r.BYTES;A=bt("pointHex",A,W);let X=A.slice(),st=A[W-1];X[W-1]=st&-129;let J=Me(X);J===te||(O?m(J,f):m(J,r.ORDER));let nt=u(J*J),St=u(nt-zt),mt=u(M*nt-q),{isValid:Nt,value:Dt}=h(St,mt);if(!Nt)throw new Error("Point.fromHex: invalid y coordinate");let At=(Dt&zt)===zt,Kt=(st&128)!==0;if(!O&&Dt===te&&Kt)throw new Error("Point.fromHex: x=0 and x_0=1");return Kt!==At&&(Dt=u(-Dt)),w.fromAffine({x:Dt,y:J})}static fromPrivateKey(A){return V(A).point}toRawBytes(){let{x:A,y:O}=this.toAffine(),M=tr(O,r.BYTES);return M[M.length-1]|=A&zt?128:0,M}toHex(){return ve(this.toRawBytes())}}w.BASE=new w(e.Gx,e.Gy,zt,u(e.Gx*e.Gy)),w.ZERO=new w(te,zt,zt,te);let{BASE:S,ZERO:L}=w,N=Qn(w,o*8);function H(D){return ft(D,n)}function z(D){return H(Me(D))}function V(D){let A=o;D=bt("private key",D,A);let O=bt("hashed private key",s(D),2*A),M=l(O.slice(0,A)),q=O.slice(A,2*A),W=z(M),X=S.multiply(W),st=X.toRawBytes();return{head:M,prefix:q,scalar:W,point:X,pointBytes:st}}function Q(D){return V(D).pointBytes}function ct(D=new Uint8Array,...A){let O=Ee(...A);return z(s(g(O,bt("context",D),!!i)))}function Lt(D,A,O={}){D=bt("message",D),i&&(D=i(D));let{prefix:M,scalar:q,pointBytes:W}=V(A),X=ct(O.context,M,D),st=S.multiply(X).toRawBytes(),J=ct(O.context,st,W,D),nt=H(X+J*q);E(nt);let St=Ee(st,tr(nt,r.BYTES));return bt("result",St,o*2)}let I=Cd;function k(D,A,O,M=I){let{context:q,zip215:W}=M,X=r.BYTES;D=bt("signature",D,2*X),A=bt("message",A),i&&(A=i(A));let st=Me(D.slice(X,2*X)),J,nt,St;try{J=w.fromHex(O,W),nt=w.fromHex(D.slice(0,X),W),St=S.multiplyUnsafe(st)}catch{return!1}if(!W&&J.isSmallOrder())return!1;let mt=ct(q,nt.toRawBytes(),J.toRawBytes(),A);return nt.add(J.multiplyUnsafe(mt)).subtract(St).clearCofactor().equals(w.ZERO)}return S._setWindowSize(8),{CURVE:e,getPublicKey:Q,sign:Lt,verify:k,ExtendedPoint:w,utils:{getExtendedPublicKey:V,randomPrivateKey:()=>a(r.BYTES),precompute(D=8,A=w.BASE){return A._setWindowSize(D),A.multiply(BigInt(3)),A}}}}var bs=BigInt("57896044618658097711785492504343953926634992332820282019728792003956564819949"),o0=BigInt("19681161376707505956807079304988542015446066515923890162744021073123829784752"),p2=BigInt(0),Td=BigInt(1),vs=BigInt(2),_d=BigInt(5),a0=BigInt(10),Rd=BigInt(20),Ld=BigInt(40),c0=BigInt(80);function Nd(t){let e=bs,n=t*t%e*t%e,i=xt(n,vs,e)*n%e,s=xt(i,Td,e)*t%e,a=xt(s,_d,e)*s%e,o=xt(a,a0,e)*a%e,c=xt(o,Rd,e)*o%e,f=xt(c,Ld,e)*c%e,u=xt(f,c0,e)*f%e,h=xt(u,c0,e)*f%e,l=xt(h,a0,e)*a%e;return{pow_p_5_8:xt(l,vs,e)*t%e,b2:n}}function Dd(t){return t[0]&=248,t[31]&=127,t[31]|=64,t}function kd(t,e){let r=bs,n=ft(e*e*e,r),i=ft(n*n*e,r),s=Nd(t*i).pow_p_5_8,a=ft(t*n*s,r),o=ft(e*a*a,r),c=a,f=ft(a*o0,r),u=o===t,h=o===ft(-t,r),l=o===ft(-t*o0,r);return u&&(a=c),(h||l)&&(a=f),r0(a,r)&&(a=ft(-a,r)),{isValid:u||h,value:a}}var we=Zn(bs,void 0,!0),Es={a:BigInt(-1),d:BigInt("37095705934669439343138083508754565189542113879843219016388785533085940283555"),Fp:we,n:BigInt("7237005577332262213973186563042994240857116359379907606001950938285454250989"),h:BigInt(8),Gx:BigInt("15112221349535400772501151409588531511454012693041857206046113283949847762202"),Gy:BigInt("46316835694926478169428394003475163141307993866256225615783033603165251855960"),hash:us,randomBytes:Cr,adjustScalarBytes:Dd,uvRatio:kd},Tr=Jn(Es);function f0(t,e,r){if(e.length>255)throw new Error("Context is too big");return qn(as("SigEd25519 no Ed25519 collisions"),new Uint8Array([r?1:0,e.length]),e,t)}var y2=Jn({...Es,domain:f0}),g2=Jn({...Es,domain:f0,prehash:us});var Pd=(we.ORDER+BigInt(3))/BigInt(8),x2=we.pow(vs,Pd),m2=we.sqrt(we.neg(we.ONE)),v2=(we.ORDER-BigInt(5))/BigInt(8),b2=BigInt(486662);var E2=n0(we,we.neg(BigInt(486664)));var w2=BigInt("25063068953384623474111414158702152701244531502492656460079210482610430750235"),S2=BigInt("54469307008909316920995813868745141605393597292927456921205312896311721017578"),B2=BigInt("1159843021668779879193775521855586647937357759715417654439879720876111806838"),A2=BigInt("40440834346308536858101042469323190826248399146238708352240133220865137265952");var C2=BigInt("0x7fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff");var _r=32,Se=64,jn=32;async function u0(){let t=Tr.utils.randomPrivateKey(),e=Tr.getPublicKey(t);return{privateKey:p0(t,e),publicKey:e}}async function h0(t){if(t.length!==jn)throw new TypeError('"seed" must be 32 bytes in length.');if(!(t instanceof Uint8Array))throw new TypeError('"seed" must be a node.js Buffer, or Uint8Array.');let e=t,r=Tr.getPublicKey(e);return{privateKey:p0(e,r),publicKey:r}}async function l0(t,e){let r=t.subarray(0,jn);return Tr.sign(e,r)}async function d0(t,e,r){return Tr.verify(e,r,t)}function p0(t,e){let r=new Uint8Array(Se);for(let n=0;n<jn;n++)r[n]=t[n],r[jn+n]=e[n];return r}function rr(t,e){e==null&&(e=t.reduce((i,s)=>i+s.length,0));let r=ye(e),n=0;for(let i of t)r.set(i,n),n+=i.length;return yr(r)}var ws={alg:"A128GCM",ext:!0,k:"scm9jmO_4BJAgdwWGVulLg",key_ops:["encrypt","decrypt"],kty:"oct"};function ti(t){let e=t?.algorithm??"AES-GCM",r=t?.keyLength??16,n=t?.nonceLength??12,i=t?.digest??"SHA-256",s=t?.saltLength??16,a=t?.iterations??32767,o=Ft.get();r*=8;async function c(h,l){let g=o.getRandomValues(new Uint8Array(s)),d=o.getRandomValues(new Uint8Array(n)),p={name:e,iv:d};typeof l=="string"&&(l=at(l));let y;if(l.length===0){y=await o.subtle.importKey("jwk",ws,{name:"AES-GCM"},!0,["encrypt"]);try{let E={name:"PBKDF2",salt:g,iterations:a,hash:{name:i}},b=await o.subtle.importKey("raw",l,{name:"PBKDF2"},!1,["deriveKey"]);y=await o.subtle.deriveKey(E,b,{name:e,length:r},!0,["encrypt"])}catch{y=await o.subtle.importKey("jwk",ws,{name:"AES-GCM"},!0,["encrypt"])}}else{let E={name:"PBKDF2",salt:g,iterations:a,hash:{name:i}},b=await o.subtle.importKey("raw",l,{name:"PBKDF2"},!1,["deriveKey"]);y=await o.subtle.deriveKey(E,b,{name:e,length:r},!0,["encrypt"])}let m=await o.subtle.encrypt(p,y,h);return rr([g,p.iv,new Uint8Array(m)])}async function f(h,l){let g=h.subarray(0,s),d=h.subarray(s,s+n),p=h.subarray(s+n),y={name:e,iv:d};typeof l=="string"&&(l=at(l));let m;if(l.length===0)try{let b={name:"PBKDF2",salt:g,iterations:a,hash:{name:i}},_=await o.subtle.importKey("raw",l,{name:"PBKDF2"},!1,["deriveKey"]);m=await o.subtle.deriveKey(b,_,{name:e,length:r},!0,["decrypt"])}catch{m=await o.subtle.importKey("jwk",ws,{name:"AES-GCM"},!0,["decrypt"])}else{let b={name:"PBKDF2",salt:g,iterations:a,hash:{name:i}},_=await o.subtle.importKey("raw",l,{name:"PBKDF2"},!1,["deriveKey"]);m=await o.subtle.deriveKey(b,_,{name:e,length:r},!0,["decrypt"])}let E=await o.subtle.decrypt(y,m,p);return new Uint8Array(E)}return{encrypt:c,decrypt:f}}async function Rr(t,e){let n=await ti().encrypt(t,e);return $e.encode(n)}var Ss=new Float32Array([-0]),Ve=new Uint8Array(Ss.buffer);function g0(t,e,r){Ss[0]=t,e[r]=Ve[0],e[r+1]=Ve[1],e[r+2]=Ve[2],e[r+3]=Ve[3]}function x0(t,e){return Ve[0]=t[e],Ve[1]=t[e+1],Ve[2]=t[e+2],Ve[3]=t[e+3],Ss[0]}var Bs=new Float64Array([-0]),Ut=new Uint8Array(Bs.buffer);function m0(t,e,r){Bs[0]=t,e[r]=Ut[0],e[r+1]=Ut[1],e[r+2]=Ut[2],e[r+3]=Ut[3],e[r+4]=Ut[4],e[r+5]=Ut[5],e[r+6]=Ut[6],e[r+7]=Ut[7]}function v0(t,e){return Ut[0]=t[e],Ut[1]=t[e+1],Ut[2]=t[e+2],Ut[3]=t[e+3],Ut[4]=t[e+4],Ut[5]=t[e+5],Ut[6]=t[e+6],Ut[7]=t[e+7],Bs[0]}var Ud=BigInt(Number.MAX_SAFE_INTEGER),Od=BigInt(Number.MIN_SAFE_INTEGER),qt=class t{lo;hi;constructor(e,r){this.lo=e|0,this.hi=r|0}toNumber(e=!1){if(!e&&this.hi>>>31>0){let r=~this.lo+1>>>0,n=~this.hi>>>0;return r===0&&(n=n+1>>>0),-(r+n*4294967296)}return this.lo+this.hi*4294967296}toBigInt(e=!1){if(e)return BigInt(this.lo>>>0)+(BigInt(this.hi>>>0)<<32n);if(this.hi>>>31){let r=~this.lo+1>>>0,n=~this.hi>>>0;return r===0&&(n=n+1>>>0),-(BigInt(r)+(BigInt(n)<<32n))}return BigInt(this.lo>>>0)+(BigInt(this.hi>>>0)<<32n)}toString(e=!1){return this.toBigInt(e).toString()}zzEncode(){let e=this.hi>>31;return this.hi=((this.hi<<1|this.lo>>>31)^e)>>>0,this.lo=(this.lo<<1^e)>>>0,this}zzDecode(){let e=-(this.lo&1);return this.lo=((this.lo>>>1|this.hi<<31)^e)>>>0,this.hi=(this.hi>>>1^e)>>>0,this}length(){let e=this.lo,r=(this.lo>>>28|this.hi<<4)>>>0,n=this.hi>>>24;return n===0?r===0?e<16384?e<128?1:2:e<2097152?3:4:r<16384?r<128?5:6:r<2097152?7:8:n<128?9:10}static fromBigInt(e){if(e===0n)return nr;if(e<Ud&&e>Od)return this.fromNumber(Number(e));let r=e<0n;r&&(e=-e);let n=e>>32n,i=e-(n<<32n);return r&&(n=~n|0n,i=~i|0n,++i>b0&&(i=0n,++n>b0&&(n=0n))),new t(Number(i),Number(n))}static fromNumber(e){if(e===0)return nr;let r=e<0;r&&(e=-e);let n=e>>>0,i=(e-n)/4294967296>>>0;return r&&(i=~i>>>0,n=~n>>>0,++n>4294967295&&(n=0,++i>4294967295&&(i=0))),new t(n,i)}static from(e){return typeof e=="number"?t.fromNumber(e):typeof e=="bigint"?t.fromBigInt(e):typeof e=="string"?t.fromBigInt(BigInt(e)):e.low!=null||e.high!=null?new t(e.low>>>0,e.high>>>0):nr}},nr=new qt(0,0);nr.toBigInt=function(){return 0n};nr.zzEncode=nr.zzDecode=function(){return this};nr.length=function(){return 1};var b0=4294967296n;function E0(t){let e=0,r=0;for(let n=0;n<t.length;++n)r=t.charCodeAt(n),r<128?e+=1:r<2048?e+=2:(r&64512)===55296&&(t.charCodeAt(n+1)&64512)===56320?(++n,e+=4):e+=3;return e}function w0(t,e,r){if(r-e<1)return"";let i,s=[],a=0,o;for(;e<r;)o=t[e++],o<128?s[a++]=o:o>191&&o<224?s[a++]=(o&31)<<6|t[e++]&63:o>239&&o<365?(o=((o&7)<<18|(t[e++]&63)<<12|(t[e++]&63)<<6|t[e++]&63)-65536,s[a++]=55296+(o>>10),s[a++]=56320+(o&1023)):s[a++]=(o&15)<<12|(t[e++]&63)<<6|t[e++]&63,a>8191&&((i??(i=[])).push(String.fromCharCode.apply(String,s)),a=0);return i!=null?(a>0&&i.push(String.fromCharCode.apply(String,s.slice(0,a))),i.join("")):String.fromCharCode.apply(String,s.slice(0,a))}function As(t,e,r){let n=r,i,s;for(let a=0;a<t.length;++a)i=t.charCodeAt(a),i<128?e[r++]=i:i<2048?(e[r++]=i>>6|192,e[r++]=i&63|128):(i&64512)===55296&&((s=t.charCodeAt(a+1))&64512)===56320?(i=65536+((i&1023)<<10)+(s&1023),++a,e[r++]=i>>18|240,e[r++]=i>>12&63|128,e[r++]=i>>6&63|128,e[r++]=i&63|128):(e[r++]=i>>12|224,e[r++]=i>>6&63|128,e[r++]=i&63|128);return r-n}function ee(t,e){return RangeError(`index out of range: ${t.pos} + ${e??1} > ${t.len}`)}function ei(t,e){return(t[e-4]|t[e-3]<<8|t[e-2]<<16|t[e-1]<<24)>>>0}var Cs=class{buf;pos;len;_slice=Uint8Array.prototype.subarray;constructor(e){this.buf=e,this.pos=0,this.len=e.length}uint32(){let e=4294967295;if(e=(this.buf[this.pos]&127)>>>0,this.buf[this.pos++]<128||(e=(e|(this.buf[this.pos]&127)<<7)>>>0,this.buf[this.pos++]<128)||(e=(e|(this.buf[this.pos]&127)<<14)>>>0,this.buf[this.pos++]<128)||(e=(e|(this.buf[this.pos]&127)<<21)>>>0,this.buf[this.pos++]<128)||(e=(e|(this.buf[this.pos]&15)<<28)>>>0,this.buf[this.pos++]<128))return e;if((this.pos+=5)>this.len)throw this.pos=this.len,ee(this,10);return e}int32(){return this.uint32()|0}sint32(){let e=this.uint32();return e>>>1^-(e&1)|0}bool(){return this.uint32()!==0}fixed32(){if(this.pos+4>this.len)throw ee(this,4);return ei(this.buf,this.pos+=4)}sfixed32(){if(this.pos+4>this.len)throw ee(this,4);return ei(this.buf,this.pos+=4)|0}float(){if(this.pos+4>this.len)throw ee(this,4);let e=x0(this.buf,this.pos);return this.pos+=4,e}double(){if(this.pos+8>this.len)throw ee(this,4);let e=v0(this.buf,this.pos);return this.pos+=8,e}bytes(){let e=this.uint32(),r=this.pos,n=this.pos+e;if(n>this.len)throw ee(this,e);return this.pos+=e,r===n?new Uint8Array(0):this.buf.subarray(r,n)}string(){let e=this.bytes();return w0(e,0,e.length)}skip(e){if(typeof e=="number"){if(this.pos+e>this.len)throw ee(this,e);this.pos+=e}else do if(this.pos>=this.len)throw ee(this);while(this.buf[this.pos++]&128);return this}skipType(e){switch(e){case 0:this.skip();break;case 1:this.skip(8);break;case 2:this.skip(this.uint32());break;case 3:for(;(e=this.uint32()&7)!==4;)this.skipType(e);break;case 5:this.skip(4);break;default:throw Error(`invalid wire type ${e} at offset ${this.pos}`)}return this}readLongVarint(){let e=new qt(0,0),r=0;if(this.len-this.pos>4){for(;r<4;++r)if(e.lo=(e.lo|(this.buf[this.pos]&127)<<r*7)>>>0,this.buf[this.pos++]<128)return e;if(e.lo=(e.lo|(this.buf[this.pos]&127)<<28)>>>0,e.hi=(e.hi|(this.buf[this.pos]&127)>>4)>>>0,this.buf[this.pos++]<128)return e;r=0}else{for(;r<3;++r){if(this.pos>=this.len)throw ee(this);if(e.lo=(e.lo|(this.buf[this.pos]&127)<<r*7)>>>0,this.buf[this.pos++]<128)return e}return e.lo=(e.lo|(this.buf[this.pos++]&127)<<r*7)>>>0,e}if(this.len-this.pos>4){for(;r<5;++r)if(e.hi=(e.hi|(this.buf[this.pos]&127)<<r*7+3)>>>0,this.buf[this.pos++]<128)return e}else for(;r<5;++r){if(this.pos>=this.len)throw ee(this);if(e.hi=(e.hi|(this.buf[this.pos]&127)<<r*7+3)>>>0,this.buf[this.pos++]<128)return e}throw Error("invalid varint encoding")}readFixed64(){if(this.pos+8>this.len)throw ee(this,8);let e=ei(this.buf,this.pos+=4),r=ei(this.buf,this.pos+=4);return new qt(e,r)}int64(){return this.readLongVarint().toBigInt()}int64Number(){return this.readLongVarint().toNumber()}int64String(){return this.readLongVarint().toString()}uint64(){return this.readLongVarint().toBigInt(!0)}uint64Number(){return this.readLongVarint().toNumber(!0)}uint64String(){return this.readLongVarint().toString(!0)}sint64(){return this.readLongVarint().zzDecode().toBigInt()}sint64Number(){return this.readLongVarint().zzDecode().toNumber()}sint64String(){return this.readLongVarint().zzDecode().toString()}fixed64(){return this.readFixed64().toBigInt()}fixed64Number(){return this.readFixed64().toNumber()}fixed64String(){return this.readFixed64().toString()}sfixed64(){return this.readFixed64().toBigInt()}sfixed64Number(){return this.readFixed64().toNumber()}sfixed64String(){return this.readFixed64().toString()}};function Is(t){return new Cs(t instanceof Uint8Array?t:t.subarray())}function ri(t,e){let r=Is(t);return e.decode(r)}function Ts(t){let e=t??8192,r=e>>>1,n,i=e;return function(a){if(a<1||a>r)return ye(a);i+a>e&&(n=ye(e),i=0);let o=n.subarray(i,i+=a);return i&7&&(i=(i|7)+1),o}}var ir=class{fn;len;next;val;constructor(e,r,n){this.fn=e,this.len=r,this.next=void 0,this.val=n}};function _s(){}var Ls=class{head;tail;len;next;constructor(e){this.head=e.head,this.tail=e.tail,this.len=e.len,this.next=e.states}},Md=Ts();function Fd(t){return globalThis.Buffer!=null?ye(t):Md(t)}var on=class{len;head;tail;states;constructor(){this.len=0,this.head=new ir(_s,0,0),this.tail=this.head,this.states=null}_push(e,r,n){return this.tail=this.tail.next=new ir(e,r,n),this.len+=r,this}uint32(e){return this.len+=(this.tail=this.tail.next=new Ns((e=e>>>0)<128?1:e<16384?2:e<2097152?3:e<268435456?4:5,e)).len,this}int32(e){return e<0?this._push(nn,10,qt.fromNumber(e)):this.uint32(e)}sint32(e){return this.uint32((e<<1^e>>31)>>>0)}uint64(e){let r=qt.fromBigInt(e);return this._push(nn,r.length(),r)}uint64Number(e){let r=qt.fromNumber(e);return this._push(nn,r.length(),r)}uint64String(e){return this.uint64(BigInt(e))}int64(e){return this.uint64(e)}int64Number(e){return this.uint64Number(e)}int64String(e){return this.uint64String(e)}sint64(e){let r=qt.fromBigInt(e).zzEncode();return this._push(nn,r.length(),r)}sint64Number(e){let r=qt.fromNumber(e).zzEncode();return this._push(nn,r.length(),r)}sint64String(e){return this.sint64(BigInt(e))}bool(e){return this._push(Rs,1,e?1:0)}fixed32(e){return this._push(sn,4,e>>>0)}sfixed32(e){return this.fixed32(e)}fixed64(e){let r=qt.fromBigInt(e);return this._push(sn,4,r.lo)._push(sn,4,r.hi)}fixed64Number(e){let r=qt.fromNumber(e);return this._push(sn,4,r.lo)._push(sn,4,r.hi)}fixed64String(e){return this.fixed64(BigInt(e))}sfixed64(e){return this.fixed64(e)}sfixed64Number(e){return this.fixed64Number(e)}sfixed64String(e){return this.fixed64String(e)}float(e){return this._push(g0,4,e)}double(e){return this._push(m0,8,e)}bytes(e){let r=e.length>>>0;return r===0?this._push(Rs,1,0):this.uint32(r)._push(qd,r,e)}string(e){let r=E0(e);return r!==0?this.uint32(r)._push(As,r,e):this._push(Rs,1,0)}fork(){return this.states=new Ls(this),this.head=this.tail=new ir(_s,0,0),this.len=0,this}reset(){return this.states!=null?(this.head=this.states.head,this.tail=this.states.tail,this.len=this.states.len,this.states=this.states.next):(this.head=this.tail=new ir(_s,0,0),this.len=0),this}ldelim(){let e=this.head,r=this.tail,n=this.len;return this.reset().uint32(n),n!==0&&(this.tail.next=e.next,this.tail=r,this.len+=n),this}finish(){let e=this.head.next,r=Fd(this.len),n=0;for(;e!=null;)e.fn(e.val,r,n),n+=e.len,e=e.next;return r}};function Rs(t,e,r){e[r]=t&255}function Vd(t,e,r){for(;t>127;)e[r++]=t&127|128,t>>>=7;e[r]=t}var Ns=class extends ir{next;constructor(e,r){super(Vd,e,r),this.next=void 0}};function nn(t,e,r){for(;t.hi!==0;)e[r++]=t.lo&127|128,t.lo=(t.lo>>>7|t.hi<<25)>>>0,t.hi>>>=7;for(;t.lo>127;)e[r++]=t.lo&127|128,t.lo=t.lo>>>7;e[r++]=t.lo}function sn(t,e,r){e[r]=t&255,e[r+1]=t>>>8&255,e[r+2]=t>>>16&255,e[r+3]=t>>>24}function qd(t,e,r){e.set(t,r)}globalThis.Buffer!=null&&(on.prototype.bytes=function(t){let e=t.length>>>0;return this.uint32(e),e>0&&this._push(Hd,e,t),this},on.prototype.string=function(t){let e=globalThis.Buffer.byteLength(t);return this.uint32(e),e>0&&this._push(zd,e,t),this});function Hd(t,e,r){e.set(t,r)}function zd(t,e,r){t.length<40?As(t,e,r):e.utf8Write!=null?e.utf8Write(t,r):e.set(at(t),r)}function Ds(){return new on}function ni(t,e){let r=Ds();return e.encode(t,r,{lengthDelimited:!1}),r.finish()}var Lr;(function(t){t[t.VARINT=0]="VARINT",t[t.BIT64=1]="BIT64",t[t.LENGTH_DELIMITED=2]="LENGTH_DELIMITED",t[t.START_GROUP=3]="START_GROUP",t[t.END_GROUP=4]="END_GROUP",t[t.BIT32=5]="BIT32"})(Lr||(Lr={}));function ii(t,e,r,n){return{name:t,type:e,encode:r,decode:n}}function ks(t){function e(i){if(t[i.toString()]==null)throw new Error("Invalid enum value");return t[i]}let r=function(s,a){let o=e(s);a.int32(o)},n=function(s){let a=s.int32();return e(a)};return ii("enum",Lr.VARINT,r,n)}function si(t,e){return ii("message",Lr.LENGTH_DELIMITED,t,e)}var wt;(function(t){t.RSA="RSA",t.Ed25519="Ed25519",t.Secp256k1="Secp256k1"})(wt||(wt={}));var Ps;(function(t){t[t.RSA=0]="RSA",t[t.Ed25519=1]="Ed25519",t[t.Secp256k1=2]="Secp256k1"})(Ps||(Ps={}));(function(t){t.codec=()=>ks(Ps)})(wt||(wt={}));var Be;(function(t){let e;t.codec=()=>(e==null&&(e=si((r,n,i={})=>{i.lengthDelimited!==!1&&n.fork(),r.Type!=null&&(n.uint32(8),wt.codec().encode(r.Type,n)),r.Data!=null&&(n.uint32(18),n.bytes(r.Data)),i.lengthDelimited!==!1&&n.ldelim()},(r,n)=>{let i={},s=n==null?r.len:r.pos+n;for(;r.pos<s;){let a=r.uint32();switch(a>>>3){case 1:i.Type=wt.codec().decode(r);break;case 2:i.Data=r.bytes();break;default:r.skipType(a&7);break}}return i})),e),t.encode=r=>ni(r,t.codec()),t.decode=r=>ri(r,t.codec())})(Be||(Be={}));var he;(function(t){let e;t.codec=()=>(e==null&&(e=si((r,n,i={})=>{i.lengthDelimited!==!1&&n.fork(),r.Type!=null&&(n.uint32(8),wt.codec().encode(r.Type,n)),r.Data!=null&&(n.uint32(18),n.bytes(r.Data)),i.lengthDelimited!==!1&&n.ldelim()},(r,n)=>{let i={},s=n==null?r.len:r.pos+n;for(;r.pos<s;){let a=r.uint32();switch(a>>>3){case 1:i.Type=wt.codec().decode(r);break;case 2:i.Data=r.bytes();break;default:r.skipType(a&7);break}}return i})),e),t.encode=r=>ni(r,t.codec()),t.decode=r=>ri(r,t.codec())})(he||(he={}));var an=class{_key;constructor(e){this._key=Nr(e,_r)}async verify(e,r){return d0(this._key,r,e)}marshal(){return this._key}get bytes(){return Be.encode({Type:wt.Ed25519,Data:this.marshal()}).subarray()}equals(e){return Ht(this.bytes,e.bytes)}async hash(){let{bytes:e}=await Pt.digest(this.bytes);return e}},sr=class{_key;_publicKey;constructor(e,r){this._key=Nr(e,Se),this._publicKey=Nr(r,_r)}async sign(e){return l0(this._key,e)}get public(){return new an(this._publicKey)}marshal(){return this._key}get bytes(){return he.encode({Type:wt.Ed25519,Data:this.marshal()}).subarray()}equals(e){return Ht(this.bytes,e.bytes)}async hash(){let{bytes:e}=await Pt.digest(this.bytes);return e}async id(){let e=ke.digest(this.public.bytes);return kt.encode(e.bytes).substring(1)}async export(e,r="libp2p-key"){if(r==="libp2p-key")return Rr(this.bytes,e);throw new K(`export format '${r}' is not supported`,"ERR_INVALID_EXPORT_FORMAT")}};function Gd(t){if(t.length>Se){t=Nr(t,Se+_r);let n=t.subarray(0,Se),i=t.subarray(Se,t.length);return new sr(n,i)}t=Nr(t,Se);let e=t.subarray(0,Se),r=t.subarray(_r);return new sr(e,r)}function Yd(t){return t=Nr(t,_r),new an(t)}async function $d(){let{privateKey:t,publicKey:e}=await u0();return new sr(t,e)}async function B0(t){let{privateKey:e,publicKey:r}=await h0(t);return new sr(e,r)}function Nr(t,e){if(t=Uint8Array.from(t??[]),t.length!==e)throw new K(`Key must be a Uint8Array of length ${e}, got ${t.length}`,"ERR_INVALID_KEY_TYPE");return t}var vg=Bt(Et(),1),bg=Bt(Kn(),1),A0=Bt(ot(),1);function re(t,e){let r=Uint8Array.from(t.abs().toByteArray());if(r=r[0]===0?r.subarray(1):r,e!=null){if(r.length>e)throw new Error("byte array longer than desired length");r=rr([new Uint8Array(e-r.length),r])}return pt(r,"base64url")}function Gt(t){let e=C0(t);return new A0.default.jsbn.BigInteger(pt(e,"base16"),16)}function C0(t,e){let r=at(t,"base64urlpad");if(e!=null){if(r.length>e)throw new Error("byte array longer than desired length");r=rr([new Uint8Array(e-r.length),r])}return r}var Wd={"P-256":256,"P-384":384,"P-521":521},Zd=Object.keys(Wd),Lg=Zd.join(" / ");async function I0(t,e){let r=$e.decode(t);return ti().decrypt(r,e)}var Vs={};It(Vs,{MAX_KEY_SIZE:()=>hn,RsaPrivateKey:()=>Dr,RsaPublicKey:()=>un,fromJwk:()=>sp,generateKeyPair:()=>op,unmarshalRsaPrivateKey:()=>np,unmarshalRsaPublicKey:()=>ip});var fn=Bt(ot(),1);var hx=Bt(N0(),1);function ar(t){if(isNaN(t)||t<=0)throw new K("random bytes length must be a Number bigger than 0","ERR_INVALID_LENGTH");return Cr(t)}var $g=Bt(Mn(),1),Ms=Bt(ot(),1);function D0(t,e){return e.map(r=>Gt(t[r]))}function k0(t){return Ms.default.pki.setRsaPrivateKey(...D0(t,["n","e","d","p","q","dp","dq","qi"]))}function P0(t){return Ms.default.pki.setRsaPublicKey(...D0(t,["n","e"]))}var cr={};It(cr,{jwkToPkcs1:()=>Jd,jwkToPkix:()=>tp,pkcs1ToJwk:()=>Xd,pkixToJwk:()=>jd});var Qg=Bt(Xr(),1),Xg=Bt(Mn(),1);var Ae=Bt(ot(),1);function Xd(t){let e=Ae.default.asn1.fromDer(pt(t,"ascii")),r=Ae.default.pki.privateKeyFromAsn1(e);return{kty:"RSA",n:re(r.n),e:re(r.e),d:re(r.d),p:re(r.p),q:re(r.q),dp:re(r.dP),dq:re(r.dQ),qi:re(r.qInv),alg:"RS256"}}function Jd(t){if(t.n==null||t.e==null||t.d==null||t.p==null||t.q==null||t.dp==null||t.dq==null||t.qi==null)throw new K("JWK was missing components","ERR_INVALID_PARAMETERS");let e=Ae.default.pki.privateKeyToAsn1({n:Gt(t.n),e:Gt(t.e),d:Gt(t.d),p:Gt(t.p),q:Gt(t.q),dP:Gt(t.dp),dQ:Gt(t.dq),qInv:Gt(t.qi)});return at(Ae.default.asn1.toDer(e).getBytes(),"ascii")}function jd(t){let e=Ae.default.asn1.fromDer(pt(t,"ascii")),r=Ae.default.pki.publicKeyFromAsn1(e);return{kty:"RSA",n:re(r.n),e:re(r.e)}}function tp(t){if(t.n==null||t.e==null)throw new K("JWK was missing components","ERR_INVALID_PARAMETERS");let e=Ae.default.pki.publicKeyToAsn1({n:Gt(t.n),e:Gt(t.e)});return at(Ae.default.asn1.toDer(e).getBytes(),"ascii")}async function K0(t){let e=await Ft.get().subtle.generateKey({name:"RSASSA-PKCS1-v1_5",modulusLength:t,publicExponent:new Uint8Array([1,0,1]),hash:{name:"SHA-256"}},!0,["sign","verify"]),r=await M0(e);return{privateKey:r[0],publicKey:r[1]}}async function Fs(t){let r=[await Ft.get().subtle.importKey("jwk",t,{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}},!0,["sign"]),await ep(t)],n=await M0({privateKey:r[0],publicKey:r[1]});return{privateKey:n[0],publicKey:n[1]}}async function U0(t,e){let r=await Ft.get().subtle.importKey("jwk",t,{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}},!1,["sign"]),n=await Ft.get().subtle.sign({name:"RSASSA-PKCS1-v1_5"},r,Uint8Array.from(e));return new Uint8Array(n,0,n.byteLength)}async function O0(t,e,r){let n=await Ft.get().subtle.importKey("jwk",t,{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}},!1,["verify"]);return Ft.get().subtle.verify({name:"RSASSA-PKCS1-v1_5"},n,e,r)}async function M0(t){if(t.privateKey==null||t.publicKey==null)throw new K("Private and public key are required","ERR_INVALID_PARAMETERS");return Promise.all([Ft.get().subtle.exportKey("jwk",t.privateKey),Ft.get().subtle.exportKey("jwk",t.publicKey)])}async function ep(t){return Ft.get().subtle.importKey("jwk",{kty:t.kty,n:t.n,e:t.e},{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}},!0,["verify"])}function F0(t,e,r,n){let i=e?P0(t):k0(t),s=pt(Uint8Array.from(r),"ascii"),a=n(s,i);return at(a,"ascii")}function V0(t,e){return F0(t,!0,e,(r,n)=>n.encrypt(r))}function q0(t,e){return F0(t,!1,e,(r,n)=>n.decrypt(r))}function ai(t){if(t.kty!=="RSA")throw new K("invalid key type","ERR_INVALID_KEY_TYPE");if(t.n==null)throw new K("invalid key modulus","ERR_INVALID_KEY_MODULUS");return at(t.n,"base64url").length*8}var hn=8192,un=class{_key;constructor(e){this._key=e}async verify(e,r){return O0(this._key,r,e)}marshal(){return cr.jwkToPkix(this._key)}get bytes(){return Be.encode({Type:wt.RSA,Data:this.marshal()}).subarray()}encrypt(e){return V0(this._key,e)}equals(e){return Ht(this.bytes,e.bytes)}async hash(){let{bytes:e}=await Pt.digest(this.bytes);return e}},Dr=class{_key;_publicKey;constructor(e,r){this._key=e,this._publicKey=r}genSecret(){return ar(16)}async sign(e){return U0(this._key,e)}get public(){if(this._publicKey==null)throw new K("public key not provided","ERR_PUBKEY_NOT_PROVIDED");return new un(this._publicKey)}decrypt(e){return q0(this._key,e)}marshal(){return cr.jwkToPkcs1(this._key)}get bytes(){return he.encode({Type:wt.RSA,Data:this.marshal()}).subarray()}equals(e){return Ht(this.bytes,e.bytes)}async hash(){let{bytes:e}=await Pt.digest(this.bytes);return e}async id(){let e=await this.public.hash();return pt(e,"base58btc")}async export(e,r="pkcs-8"){if(r==="pkcs-8"){let n=new fn.default.util.ByteBuffer(this.marshal()),i=fn.default.asn1.fromDer(n),s=fn.default.pki.privateKeyFromAsn1(i),a={algorithm:"aes256",count:1e4,saltSize:128/8,prfAlgorithm:"sha512"};return fn.default.pki.encryptRsaPrivateKey(s,e,a)}else{if(r==="libp2p-key")return Rr(this.bytes,e);throw new K(`export format '${r}' is not supported`,"ERR_INVALID_EXPORT_FORMAT")}}};async function np(t){let e=cr.pkcs1ToJwk(t);if(ai(e)>hn)throw new K("key size is too large","ERR_KEY_SIZE_TOO_LARGE");let r=await Fs(e);return new Dr(r.privateKey,r.publicKey)}function ip(t){let e=cr.pkixToJwk(t);if(ai(e)>hn)throw new K("key size is too large","ERR_KEY_SIZE_TOO_LARGE");return new un(e)}async function sp(t){if(ai(t)>hn)throw new K("key size is too large","ERR_KEY_SIZE_TOO_LARGE");let e=await Fs(t);return new Dr(e.privateKey,e.publicKey)}async function op(t){if(t>hn)throw new K("key size is too large","ERR_KEY_SIZE_TOO_LARGE");let e=await K0(t);return new Dr(e.privateKey,e.publicKey)}var $s={};It($s,{Secp256k1PrivateKey:()=>dn,Secp256k1PublicKey:()=>ln,generateKeyPair:()=>Ep,unmarshalSecp256k1PrivateKey:()=>vp,unmarshalSecp256k1PublicKey:()=>bp});var ap=(t,e,r)=>t&e^~t&r,cp=(t,e,r)=>t&e^t&r^e&r,fp=new Uint32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),qe=new Uint32Array([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),He=new Uint32Array(64),qs=class extends Ir{constructor(){super(64,32,8,!1),this.A=qe[0]|0,this.B=qe[1]|0,this.C=qe[2]|0,this.D=qe[3]|0,this.E=qe[4]|0,this.F=qe[5]|0,this.G=qe[6]|0,this.H=qe[7]|0}get(){let{A:e,B:r,C:n,D:i,E:s,F:a,G:o,H:c}=this;return[e,r,n,i,s,a,o,c]}set(e,r,n,i,s,a,o,c){this.A=e|0,this.B=r|0,this.C=n|0,this.D=i|0,this.E=s|0,this.F=a|0,this.G=o|0,this.H=c|0}process(e,r){for(let h=0;h<16;h++,r+=4)He[h]=e.getUint32(r,!1);for(let h=16;h<64;h++){let l=He[h-15],g=He[h-2],d=jt(l,7)^jt(l,18)^l>>>3,p=jt(g,17)^jt(g,19)^g>>>10;He[h]=p+He[h-7]+d+He[h-16]|0}let{A:n,B:i,C:s,D:a,E:o,F:c,G:f,H:u}=this;for(let h=0;h<64;h++){let l=jt(o,6)^jt(o,11)^jt(o,25),g=u+l+ap(o,c,f)+fp[h]+He[h]|0,p=(jt(n,2)^jt(n,13)^jt(n,22))+cp(n,i,s)|0;u=f,f=c,c=o,o=a+g|0,a=s,s=i,i=n,n=g+p|0}n=n+this.A|0,i=i+this.B|0,s=s+this.C|0,a=a+this.D|0,o=o+this.E|0,c=c+this.F|0,f=f+this.G|0,u=u+this.H|0,this.set(n,i,s,a,o,c,f,u)}roundClean(){He.fill(0)}destroy(){this.set(0,0,0,0,0,0,0,0),this.buffer.fill(0)}};var H0=Hn(()=>new qs);function up(t){let e=rn(t);ue(e,{a:"field",b:"field"},{allowedPrivateKeyLengths:"array",wrapPrivateKey:"boolean",isTorsionFree:"function",clearCofactor:"function",allowInfinityPoint:"boolean",fromBytes:"function",toBytes:"function"});let{endo:r,Fp:n,a:i}=e;if(r){if(!n.eql(i,n.ZERO))throw new Error("Endomorphism can only be defined for Koblitz curves that have a=0");if(typeof r!="object"||typeof r.beta!="bigint"||typeof r.splitScalar!="function")throw new Error("Expected endomorphism with beta: bigint and splitScalar: function")}return Object.freeze({...e})}var{bytesToNumberBE:hp,hexToBytes:lp}=$n,fr={Err:class extends Error{constructor(e=""){super(e)}},_parseInt(t){let{Err:e}=fr;if(t.length<2||t[0]!==2)throw new e("Invalid signature integer tag");let r=t[1],n=t.subarray(2,r+2);if(!r||n.length!==r)throw new e("Invalid signature integer: wrong length");if(n[0]&128)throw new e("Invalid signature integer: negative");if(n[0]===0&&!(n[1]&128))throw new e("Invalid signature integer: unnecessary leading zero");return{d:hp(n),l:t.subarray(r+2)}},toSig(t){let{Err:e}=fr,r=typeof t=="string"?lp(t):t;if(!(r instanceof Uint8Array))throw new Error("ui8a expected");let n=r.length;if(n<2||r[0]!=48)throw new e("Invalid signature tag");if(r[1]!==n-2)throw new e("Invalid signature: incorrect length");let{d:i,l:s}=fr._parseInt(r.subarray(2)),{d:a,l:o}=fr._parseInt(s);if(o.length)throw new e("Invalid signature: left bytes after parsing");return{r:i,s:a}},hexFromSig(t){let e=f=>Number.parseInt(f[0],16)&8?"00"+f:f,r=f=>{let u=f.toString(16);return u.length&1?`0${u}`:u},n=e(r(t.s)),i=e(r(t.r)),s=n.length/2,a=i.length/2,o=r(s),c=r(a);return`30${r(a+s+4)}02${c}${i}02${o}${n}`}},Ce=BigInt(0),Qt=BigInt(1),bx=BigInt(2),z0=BigInt(3),Ex=BigInt(4);function dp(t){let e=up(t),{Fp:r}=e,n=e.toBytes||((d,p,y)=>{let m=p.toAffine();return Ee(Uint8Array.from([4]),r.toBytes(m.x),r.toBytes(m.y))}),i=e.fromBytes||(d=>{let p=d.subarray(1),y=r.fromBytes(p.subarray(0,r.BYTES)),m=r.fromBytes(p.subarray(r.BYTES,2*r.BYTES));return{x:y,y:m}});function s(d){let{a:p,b:y}=e,m=r.sqr(d),E=r.mul(m,d);return r.add(r.add(E,r.mul(d,p)),y)}if(!r.eql(r.sqr(e.Gy),s(e.Gx)))throw new Error("bad generator point: equation left != right");function a(d){return typeof d=="bigint"&&Ce<d&&d<e.n}function o(d){if(!a(d))throw new Error("Expected valid bigint: 0 < bigint < curve.n")}function c(d){let{allowedPrivateKeyLengths:p,nByteLength:y,wrapPrivateKey:m,n:E}=e;if(p&&typeof d!="bigint"){if(d instanceof Uint8Array&&(d=ve(d)),typeof d!="string"||!p.includes(d.length))throw new Error("Invalid key");d=d.padStart(y*2,"0")}let b;try{b=typeof d=="bigint"?d:be(bt("private key",d,y))}catch{throw new Error(`private key must be ${y} bytes, hex or bigint, not ${typeof d}`)}return m&&(b=ft(b,E)),o(b),b}let f=new Map;function u(d){if(!(d instanceof h))throw new Error("ProjectivePoint expected")}class h{constructor(p,y,m){if(this.px=p,this.py=y,this.pz=m,p==null||!r.isValid(p))throw new Error("x required");if(y==null||!r.isValid(y))throw new Error("y required");if(m==null||!r.isValid(m))throw new Error("z required")}static fromAffine(p){let{x:y,y:m}=p||{};if(!p||!r.isValid(y)||!r.isValid(m))throw new Error("invalid affine point");if(p instanceof h)throw new Error("projective point not allowed");let E=b=>r.eql(b,r.ZERO);return E(y)&&E(m)?h.ZERO:new h(y,m,r.ONE)}get x(){return this.toAffine().x}get y(){return this.toAffine().y}static normalizeZ(p){let y=r.invertBatch(p.map(m=>m.pz));return p.map((m,E)=>m.toAffine(y[E])).map(h.fromAffine)}static fromHex(p){let y=h.fromAffine(i(bt("pointHex",p)));return y.assertValidity(),y}static fromPrivateKey(p){return h.BASE.multiply(c(p))}_setWindowSize(p){this._WINDOW_SIZE=p,f.delete(this)}assertValidity(){if(this.is0()){if(e.allowInfinityPoint&&!r.is0(this.py))return;throw new Error("bad point: ZERO")}let{x:p,y}=this.toAffine();if(!r.isValid(p)||!r.isValid(y))throw new Error("bad point: x or y not FE");let m=r.sqr(y),E=s(p);if(!r.eql(m,E))throw new Error("bad point: equation left != right");if(!this.isTorsionFree())throw new Error("bad point: not in prime-order subgroup")}hasEvenY(){let{y:p}=this.toAffine();if(r.isOdd)return!r.isOdd(p);throw new Error("Field doesn't support isOdd")}equals(p){u(p);let{px:y,py:m,pz:E}=this,{px:b,py:_,pz:w}=p,S=r.eql(r.mul(y,w),r.mul(b,E)),L=r.eql(r.mul(m,w),r.mul(_,E));return S&&L}negate(){return new h(this.px,r.neg(this.py),this.pz)}double(){let{a:p,b:y}=e,m=r.mul(y,z0),{px:E,py:b,pz:_}=this,w=r.ZERO,S=r.ZERO,L=r.ZERO,N=r.mul(E,E),H=r.mul(b,b),z=r.mul(_,_),V=r.mul(E,b);return V=r.add(V,V),L=r.mul(E,_),L=r.add(L,L),w=r.mul(p,L),S=r.mul(m,z),S=r.add(w,S),w=r.sub(H,S),S=r.add(H,S),S=r.mul(w,S),w=r.mul(V,w),L=r.mul(m,L),z=r.mul(p,z),V=r.sub(N,z),V=r.mul(p,V),V=r.add(V,L),L=r.add(N,N),N=r.add(L,N),N=r.add(N,z),N=r.mul(N,V),S=r.add(S,N),z=r.mul(b,_),z=r.add(z,z),N=r.mul(z,V),w=r.sub(w,N),L=r.mul(z,H),L=r.add(L,L),L=r.add(L,L),new h(w,S,L)}add(p){u(p);let{px:y,py:m,pz:E}=this,{px:b,py:_,pz:w}=p,S=r.ZERO,L=r.ZERO,N=r.ZERO,H=e.a,z=r.mul(e.b,z0),V=r.mul(y,b),Q=r.mul(m,_),ct=r.mul(E,w),Lt=r.add(y,m),I=r.add(b,_);Lt=r.mul(Lt,I),I=r.add(V,Q),Lt=r.sub(Lt,I),I=r.add(y,E);let k=r.add(b,w);return I=r.mul(I,k),k=r.add(V,ct),I=r.sub(I,k),k=r.add(m,E),S=r.add(_,w),k=r.mul(k,S),S=r.add(Q,ct),k=r.sub(k,S),N=r.mul(H,I),S=r.mul(z,ct),N=r.add(S,N),S=r.sub(Q,N),N=r.add(Q,N),L=r.mul(S,N),Q=r.add(V,V),Q=r.add(Q,V),ct=r.mul(H,ct),I=r.mul(z,I),Q=r.add(Q,ct),ct=r.sub(V,ct),ct=r.mul(H,ct),I=r.add(I,ct),V=r.mul(Q,I),L=r.add(L,V),V=r.mul(k,I),S=r.mul(Lt,S),S=r.sub(S,V),V=r.mul(Lt,Q),N=r.mul(k,N),N=r.add(N,V),new h(S,L,N)}subtract(p){return this.add(p.negate())}is0(){return this.equals(h.ZERO)}wNAF(p){return g.wNAFCached(this,f,p,y=>{let m=r.invertBatch(y.map(E=>E.pz));return y.map((E,b)=>E.toAffine(m[b])).map(h.fromAffine)})}multiplyUnsafe(p){let y=h.ZERO;if(p===Ce)return y;if(o(p),p===Qt)return this;let{endo:m}=e;if(!m)return g.unsafeLadder(this,p);let{k1neg:E,k1:b,k2neg:_,k2:w}=m.splitScalar(p),S=y,L=y,N=this;for(;b>Ce||w>Ce;)b&Qt&&(S=S.add(N)),w&Qt&&(L=L.add(N)),N=N.double(),b>>=Qt,w>>=Qt;return E&&(S=S.negate()),_&&(L=L.negate()),L=new h(r.mul(L.px,m.beta),L.py,L.pz),S.add(L)}multiply(p){o(p);let y=p,m,E,{endo:b}=e;if(b){let{k1neg:_,k1:w,k2neg:S,k2:L}=b.splitScalar(y),{p:N,f:H}=this.wNAF(w),{p:z,f:V}=this.wNAF(L);N=g.constTimeNegate(_,N),z=g.constTimeNegate(S,z),z=new h(r.mul(z.px,b.beta),z.py,z.pz),m=N.add(z),E=H.add(V)}else{let{p:_,f:w}=this.wNAF(y);m=_,E=w}return h.normalizeZ([m,E])[0]}multiplyAndAddUnsafe(p,y,m){let E=h.BASE,b=(w,S)=>S===Ce||S===Qt||!w.equals(E)?w.multiplyUnsafe(S):w.multiply(S),_=b(this,y).add(b(p,m));return _.is0()?void 0:_}toAffine(p){let{px:y,py:m,pz:E}=this,b=this.is0();p==null&&(p=b?r.ONE:r.inv(E));let _=r.mul(y,p),w=r.mul(m,p),S=r.mul(E,p);if(b)return{x:r.ZERO,y:r.ZERO};if(!r.eql(S,r.ONE))throw new Error("invZ was invalid");return{x:_,y:w}}isTorsionFree(){let{h:p,isTorsionFree:y}=e;if(p===Qt)return!0;if(y)return y(h,this);throw new Error("isTorsionFree() has not been declared for the elliptic curve")}clearCofactor(){let{h:p,clearCofactor:y}=e;return p===Qt?this:y?y(h,this):this.multiplyUnsafe(e.h)}toRawBytes(p=!0){return this.assertValidity(),n(h,this,p)}toHex(p=!0){return ve(this.toRawBytes(p))}}h.BASE=new h(e.Gx,e.Gy,r.ONE),h.ZERO=new h(r.ZERO,r.ONE,r.ZERO);let l=e.nBitLength,g=Qn(h,e.endo?Math.ceil(l/2):l);return{CURVE:e,ProjectivePoint:h,normPrivateKeyToScalar:c,weierstrassEquation:s,isWithinCurveOrder:a}}function pp(t){let e=rn(t);return ue(e,{hash:"hash",hmac:"function",randomBytes:"function"},{bits2int:"function",bits2int_modN:"function",lowS:"boolean"}),Object.freeze({lowS:!0,...e})}function G0(t){let e=pp(t),{Fp:r,n}=e,i=r.BYTES+1,s=2*r.BYTES+1;function a(I){return Ce<I&&I<r.ORDER}function o(I){return ft(I,n)}function c(I){return Wn(I,n)}let{ProjectivePoint:f,normPrivateKeyToScalar:u,weierstrassEquation:h,isWithinCurveOrder:l}=dp({...e,toBytes(I,k,R){let D=k.toAffine(),A=r.toBytes(D.x),O=Ee;return R?O(Uint8Array.from([k.hasEvenY()?2:3]),A):O(Uint8Array.from([4]),A,r.toBytes(D.y))},fromBytes(I){let k=I.length,R=I[0],D=I.subarray(1);if(k===i&&(R===2||R===3)){let A=be(D);if(!a(A))throw new Error("Point is not on curve");let O=h(A),M=r.sqrt(O),q=(M&Qt)===Qt;return(R&1)===1!==q&&(M=r.neg(M)),{x:A,y:M}}else if(k===s&&R===4){let A=r.fromBytes(D.subarray(0,r.BYTES)),O=r.fromBytes(D.subarray(r.BYTES,2*r.BYTES));return{x:A,y:O}}else throw new Error(`Point of length ${k} was invalid. Expected ${i} compressed bytes or ${s} uncompressed bytes`)}}),g=I=>ve(Fe(I,e.nByteLength));function d(I){let k=n>>Qt;return I>k}function p(I){return d(I)?o(-I):I}let y=(I,k,R)=>be(I.slice(k,R));class m{constructor(k,R,D){this.r=k,this.s=R,this.recovery=D,this.assertValidity()}static fromCompact(k){let R=e.nByteLength;return k=bt("compactSignature",k,R*2),new m(y(k,0,R),y(k,R,2*R))}static fromDER(k){let{r:R,s:D}=fr.toSig(bt("DER",k));return new m(R,D)}assertValidity(){if(!l(this.r))throw new Error("r must be 0 < r < CURVE.n");if(!l(this.s))throw new Error("s must be 0 < s < CURVE.n")}addRecoveryBit(k){return new m(this.r,this.s,k)}recoverPublicKey(k){let{r:R,s:D,recovery:A}=this,O=L(bt("msgHash",k));if(A==null||![0,1,2,3].includes(A))throw new Error("recovery id invalid");let M=A===2||A===3?R+e.n:R;if(M>=r.ORDER)throw new Error("recovery id 2 or 3 invalid");let q=A&1?"03":"02",W=f.fromHex(q+g(M)),X=c(M),st=o(-O*X),J=o(D*X),nt=f.BASE.multiplyAndAddUnsafe(W,st,J);if(!nt)throw new Error("point at infinify");return nt.assertValidity(),nt}hasHighS(){return d(this.s)}normalizeS(){return this.hasHighS()?new m(this.r,o(-this.s),this.recovery):this}toDERRawBytes(){return je(this.toDERHex())}toDERHex(){return fr.hexFromSig({r:this.r,s:this.s})}toCompactRawBytes(){return je(this.toCompactHex())}toCompactHex(){return g(this.r)+g(this.s)}}let E={isValidPrivateKey(I){try{return u(I),!0}catch{return!1}},normPrivateKeyToScalar:u,randomPrivateKey:()=>{let I=xs(e.n);return s0(e.randomBytes(I),e.n)},precompute(I=8,k=f.BASE){return k._setWindowSize(I),k.multiply(BigInt(3)),k}};function b(I,k=!0){return f.fromPrivateKey(I).toRawBytes(k)}function _(I){let k=I instanceof Uint8Array,R=typeof I=="string",D=(k||R)&&I.length;return k?D===i||D===s:R?D===2*i||D===2*s:I instanceof f}function w(I,k,R=!0){if(_(I))throw new Error("first arg must be private key");if(!_(k))throw new Error("second arg must be public key");return f.fromHex(k).multiply(u(I)).toRawBytes(R)}let S=e.bits2int||function(I){let k=be(I),R=I.length*8-e.nBitLength;return R>0?k>>BigInt(R):k},L=e.bits2int_modN||function(I){return o(S(I))},N=en(e.nBitLength);function H(I){if(typeof I!="bigint")throw new Error("bigint expected");if(!(Ce<=I&&I<N))throw new Error(`bigint expected < 2^${e.nBitLength}`);return Fe(I,e.nByteLength)}function z(I,k,R=V){if(["recovered","canonical"].some(mt=>mt in R))throw new Error("sign() legacy options not supported");let{hash:D,randomBytes:A}=e,{lowS:O,prehash:M,extraEntropy:q}=R;O==null&&(O=!0),I=bt("msgHash",I),M&&(I=bt("prehashed msgHash",D(I)));let W=L(I),X=u(k),st=[H(X),H(W)];if(q!=null){let mt=q===!0?A(r.BYTES):q;st.push(bt("extraEntropy",mt))}let J=Ee(...st),nt=W;function St(mt){let Nt=S(mt);if(!l(Nt))return;let Dt=c(Nt),At=f.BASE.multiply(Nt).toAffine(),Kt=o(At.x);if(Kt===Ce)return;let de=o(Dt*o(nt+Kt*X));if(de===Ce)return;let Ge=(At.x===Kt?0:2)|Number(At.y&Qt),Hr=de;return O&&d(de)&&(Hr=p(de),Ge^=1),new m(Kt,Hr,Ge)}return{seed:J,k2sig:St}}let V={lowS:e.lowS,prehash:!1},Q={lowS:e.lowS,prehash:!1};function ct(I,k,R=V){let{seed:D,k2sig:A}=z(I,k,R),O=e;return ds(O.hash.outputLen,O.nByteLength,O.hmac)(D,A)}f.BASE._setWindowSize(8);function Lt(I,k,R,D=Q){let A=I;if(k=bt("msgHash",k),R=bt("publicKey",R),"strict"in D)throw new Error("options.strict was renamed to lowS");let{lowS:O,prehash:M}=D,q,W;try{if(typeof A=="string"||A instanceof Uint8Array)try{q=m.fromDER(A)}catch(At){if(!(At instanceof fr.Err))throw At;q=m.fromCompact(A)}else if(typeof A=="object"&&typeof A.r=="bigint"&&typeof A.s=="bigint"){let{r:At,s:Kt}=A;q=new m(At,Kt)}else throw new Error("PARSE");W=f.fromHex(R)}catch(At){if(At.message==="PARSE")throw new Error("signature must be Signature instance, Uint8Array or hex string");return!1}if(O&&q.hasHighS())return!1;M&&(k=e.hash(k));let{r:X,s:st}=q,J=L(k),nt=c(st),St=o(J*nt),mt=o(X*nt),Nt=f.BASE.multiplyAndAddUnsafe(W,St,mt)?.toAffine();return Nt?o(Nt.x)===X:!1}return{CURVE:e,getPublicKey:b,getSharedSecret:w,sign:ct,verify:Lt,ProjectivePoint:f,Signature:m,utils:E}}var ci=class extends Ar{constructor(e,r){super(),this.finished=!1,this.destroyed=!1,$a(e);let n=tn(r);if(this.iHash=e.create(),typeof this.iHash.update!="function")throw new Error("Expected instance of class which extends utils.Hash");this.blockLen=this.iHash.blockLen,this.outputLen=this.iHash.outputLen;let i=this.blockLen,s=new Uint8Array(i);s.set(n.length>i?e.create().update(n).digest():n);for(let a=0;a<s.length;a++)s[a]^=54;this.iHash.update(s),this.oHash=e.create();for(let a=0;a<s.length;a++)s[a]^=106;this.oHash.update(s),s.fill(0)}update(e){return Br(this),this.iHash.update(e),this}digestInto(e){Br(this),os(e,this.outputLen),this.finished=!0,this.iHash.digestInto(e),this.oHash.update(e),this.oHash.digestInto(e),this.destroy()}digest(){let e=new Uint8Array(this.oHash.outputLen);return this.digestInto(e),e}_cloneInto(e){e||(e=Object.create(Object.getPrototypeOf(this),{}));let{oHash:r,iHash:n,finished:i,destroyed:s,blockLen:a,outputLen:o}=this;return e=e,e.finished=i,e.destroyed=s,e.blockLen=a,e.outputLen=o,e.oHash=r._cloneInto(e.oHash),e.iHash=n._cloneInto(e.iHash),e}destroy(){this.destroyed=!0,this.oHash.destroy(),this.iHash.destroy()}},Hs=(t,e,r)=>new ci(t,e).update(r).digest();Hs.create=(t,e)=>new ci(t,e);function yp(t){return{hash:t,hmac:(e,...r)=>Hs(t,e,qn(...r)),randomBytes:Cr}}function Y0(t,e){let r=n=>G0({...t,...yp(n)});return Object.freeze({...r(e),create:r})}var Z0=BigInt("0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffefffffc2f"),$0=BigInt("0xfffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd0364141"),gp=BigInt(1),zs=BigInt(2),W0=(t,e)=>(t+e/zs)/e;function xp(t){let e=Z0,r=BigInt(3),n=BigInt(6),i=BigInt(11),s=BigInt(22),a=BigInt(23),o=BigInt(44),c=BigInt(88),f=t*t*t%e,u=f*f*t%e,h=xt(u,r,e)*u%e,l=xt(h,r,e)*u%e,g=xt(l,zs,e)*f%e,d=xt(g,i,e)*g%e,p=xt(d,s,e)*d%e,y=xt(p,o,e)*p%e,m=xt(y,c,e)*y%e,E=xt(m,o,e)*p%e,b=xt(E,r,e)*u%e,_=xt(b,a,e)*d%e,w=xt(_,n,e)*f%e,S=xt(w,zs,e);if(!Gs.eql(Gs.sqr(S),t))throw new Error("Cannot find square root");return S}var Gs=Zn(Z0,void 0,void 0,{sqrt:xp}),Ie=Y0({a:BigInt(0),b:BigInt(7),Fp:Gs,n:$0,Gx:BigInt("55066263022277343669578718895168534326250603453777594175500187360389116729240"),Gy:BigInt("32670510020758816978083085130507043184471273380659243275938904335757337482424"),h:BigInt(1),lowS:!0,endo:{beta:BigInt("0x7ae96a2b657c07106e64479eac3434e99cf0497512f58995c1396c28719501ee"),splitScalar:t=>{let e=$0,r=BigInt("0x3086d221a7d46bcde86c90e49284eb15"),n=-gp*BigInt("0xe4437ed6010e88286f547fa90abfe4c3"),i=BigInt("0x114ca50f7a8e2f3f657c1108d9d44cfd8"),s=r,a=BigInt("0x100000000000000000000000000000000"),o=W0(s*t,e),c=W0(-n*t,e),f=ft(t-o*r-c*i,e),u=ft(-o*n-c*s,e),h=f>a,l=u>a;if(h&&(f=e-f),l&&(u=e-u),f>a||u>a)throw new Error("splitScalar: Endomorphism failed, k="+t);return{k1neg:h,k1:f,k2neg:l,k2:u}}}},H0),Dx=BigInt(0);var kx=Ie.ProjectivePoint;function Q0(){return Ie.utils.randomPrivateKey()}async function X0(t,e){let{digest:r}=await Pt.digest(e);try{return Ie.sign(r,t).toDERRawBytes()}catch(n){throw new K(String(n),"ERR_INVALID_INPUT")}}async function J0(t,e,r){try{let{digest:n}=await Pt.digest(r);return Ie.verify(e,n,t)}catch(n){throw new K(String(n),"ERR_INVALID_INPUT")}}function j0(t){return Ie.ProjectivePoint.fromHex(t).toRawBytes(!0)}function tc(t){try{Ie.getPublicKey(t,!0)}catch(e){throw new K(String(e),"ERR_INVALID_PRIVATE_KEY")}}function Ys(t){try{Ie.ProjectivePoint.fromHex(t)}catch(e){throw new K(String(e),"ERR_INVALID_PUBLIC_KEY")}}function ec(t){try{return Ie.getPublicKey(t,!0)}catch(e){throw new K(String(e),"ERR_INVALID_PRIVATE_KEY")}}var ln=class{_key;constructor(e){Ys(e),this._key=e}async verify(e,r){return J0(this._key,r,e)}marshal(){return j0(this._key)}get bytes(){return Be.encode({Type:wt.Secp256k1,Data:this.marshal()}).subarray()}equals(e){return Ht(this.bytes,e.bytes)}async hash(){let{bytes:e}=await Pt.digest(this.bytes);return e}},dn=class{_key;_publicKey;constructor(e,r){this._key=e,this._publicKey=r??ec(e),tc(this._key),Ys(this._publicKey)}async sign(e){return X0(this._key,e)}get public(){return new ln(this._publicKey)}marshal(){return this._key}get bytes(){return he.encode({Type:wt.Secp256k1,Data:this.marshal()}).subarray()}equals(e){return Ht(this.bytes,e.bytes)}async hash(){let{bytes:e}=await Pt.digest(this.bytes);return e}async id(){let e=await this.public.hash();return pt(e,"base58btc")}async export(e,r="libp2p-key"){if(r==="libp2p-key")return Rr(this.bytes,e);throw new K(`export format '${r}' is not supported`,"ERR_INVALID_EXPORT_FORMAT")}};function vp(t){return new dn(t)}function bp(t){return new ln(t)}async function Ep(){let t=Q0();return new dn(t)}var kr={rsa:Vs,ed25519:Ks,secp256k1:$s};function rc(t){let e=Object.keys(kr).join(" / ");return new K(`invalid or unsupported key type ${t}. Must be ${e}`,"ERR_UNSUPPORTED_KEY_TYPE")}function wp(t){if(t=t.toLowerCase(),t==="rsa"||t==="ed25519"||t==="secp256k1")return kr[t];throw rc(t)}async function nc(t,e){return wp(t).generateKeyPair(e??2048)}async function Ws(t){let e=he.decode(t),r=e.Data??new Uint8Array;switch(e.Type){case wt.RSA:return kr.rsa.unmarshalRsaPrivateKey(r);case wt.Ed25519:return kr.ed25519.unmarshalEd25519PrivateKey(r);case wt.Secp256k1:return kr.secp256k1.unmarshalSecp256k1PrivateKey(r);default:throw rc(e.Type??"RSA")}}async function pn(t,e){try{let i=await I0(t,e);return await Ws(i)}catch{}let r=fi.default.pki.decryptRsaPrivateKey(t,e);if(r===null)throw new K("Cannot read the key, most likely the password is wrong or not a RSA key","ERR_CANNOT_DECRYPT_PEM");let n=fi.default.asn1.toDer(fi.default.pki.privateKeyToAsn1(r));return n=at(n.getBytes(),"ascii"),kr.rsa.unmarshalRsaPrivateKey(n)}var sc=Bt(Qi(),1),oc=Bt(Et(),1),ic={sha1:"sha1","sha2-256":"sha256","sha2-512":"sha512"};function yn(t,e,r,n,i){if(i!=="sha1"&&i!=="sha2-256"&&i!=="sha2-512"){let o=Object.keys(ic).join(" / ");throw new K(`Hash '${i}' is unknown or not supported. Must be ${o}`,"ERR_UNSUPPORTED_HASH_TYPE")}let s=ic[i],a=(0,sc.default)(t,e,r,n,s);return oc.default.encode64(a,null)}var $t=Bt(hc(),1);$t.default.formatters.b=t=>t==null?"undefined":kt.baseEncode(t);$t.default.formatters.t=t=>t==null?"undefined":De.baseEncode(t);$t.default.formatters.m=t=>t==null?"undefined":$e.baseEncode(t);$t.default.formatters.p=t=>t==null?"undefined":t.toString();$t.default.formatters.c=t=>t==null?"undefined":t.toString();$t.default.formatters.k=t=>t==null?"undefined":t.toString();$t.default.formatters.a=t=>t==null?"undefined":t.toString();function Kp(t){let e=()=>{};return e.enabled=!1,e.color="",e.diff=0,e.log=()=>{},e.namespace=t,e.destroy=()=>!0,e.extend=()=>e,e}function lc(t){let e=Kp(`${t}:trace`);return $t.default.enabled(`${t}:trace`)&&$t.default.names.map(r=>r.toString()).find(r=>r.includes(":trace"))!=null&&(e=(0,$t.default)(`${t}:trace`)),Object.assign((0,$t.default)(t),{error:(0,$t.default)(`${t}:error`),trace:e})}var dc=Symbol.for("@libp2p/peer-id");var Up=Symbol.for("nodejs.util.inspect.custom"),pc=Object.values(Er).map(t=>t.decoder).reduce((t,e)=>t.or(e),Er.identity.decoder),yc=114,Zs=36,Qs=37,gn=class{type;multihash;privateKey;publicKey;string;constructor(e){this.type=e.type,this.multihash=e.multihash,this.privateKey=e.privateKey,Object.defineProperty(this,"string",{enumerable:!1,writable:!0})}get[Symbol.toStringTag](){return`PeerId(${this.toString()})`}[dc]=!0;toString(){return this.string==null&&(this.string=kt.encode(this.multihash.bytes).slice(1)),this.string}toCID(){return We.createV1(yc,this.multihash)}toBytes(){return this.multihash.bytes}toJSON(){return this.toString()}equals(e){if(e instanceof Uint8Array)return Ht(this.multihash.bytes,e);if(typeof e=="string")return Op(e).equals(this);if(e?.multihash?.bytes!=null)return Ht(this.multihash.bytes,e.multihash.bytes);throw new Error("not valid Id")}[Up](){return`PeerId(${this.toString()})`}},Or=class extends gn{type="RSA";publicKey;constructor(e){super({...e,type:"RSA"}),this.publicKey=e.publicKey}},Mr=class extends gn{type="Ed25519";publicKey;constructor(e){super({...e,type:"Ed25519"}),this.publicKey=e.multihash.digest}},Fr=class extends gn{type="secp256k1";publicKey;constructor(e){super({...e,type:"secp256k1"}),this.publicKey=e.multihash.digest}};function Op(t,e){if(e=e??pc,t.charAt(0)==="1"||t.charAt(0)==="Q"){let r=$r(kt.decode(`z${t}`));return t.startsWith("12D")?new Mr({multihash:r}):t.startsWith("16U")?new Fr({multihash:r}):new Or({multihash:r})}return Mp(pc.decode(t))}function Mp(t){try{let e=$r(t);if(e.code===ke.code){if(e.digest.length===Zs)return new Mr({multihash:e});if(e.digest.length===Qs)return new Fr({multihash:e})}if(e.code===Pt.code)return new Or({multihash:e})}catch{return Fp(We.decode(t))}throw new Error("Supplied PeerID CID is invalid")}function Fp(t){if(t==null||t.multihash==null||t.version==null||t.version===1&&t.code!==yc)throw new Error("Supplied PeerID CID is invalid");let e=t.multihash;if(e.code===Pt.code)return new Or({multihash:t.multihash});if(e.code===ke.code){if(e.digest.length===Zs)return new Mr({multihash:t.multihash});if(e.digest.length===Qs)return new Fr({multihash:t.multihash})}throw new Error("Supplied PeerID CID is invalid")}async function gc(t,e){return t.length===Zs?new Mr({multihash:ne(ke.code,t),privateKey:e}):t.length===Qs?new Fr({multihash:ne(ke.code,t),privateKey:e}):new Or({multihash:await Pt.digest(t),publicKey:t,privateKey:e})}var xc=(t=21)=>crypto.getRandomValues(new Uint8Array(t)).reduce((e,r)=>(r&=63,r<36?e+=r.toString(36):r<62?e+=(r-26).toString(36).toUpperCase():r>62?e+="-":e+="_",e),"");var Te="/",mc=new TextEncoder().encode(Te),li=mc[0],xn=class t{_buf;constructor(e,r){if(typeof e=="string")this._buf=at(e);else if(e instanceof Uint8Array)this._buf=e;else throw new Error("Invalid key, should be String of Uint8Array");if(r==null&&(r=!0),r&&this.clean(),this._buf.byteLength===0||this._buf[0]!==li)throw new Error("Invalid key")}toString(e="utf8"){return pt(this._buf,e)}uint8Array(){return this._buf}get[Symbol.toStringTag](){return`Key(${this.toString()})`}static withNamespaces(e){return new t(e.join(Te))}static random(){return new t(xc().replace(/-/g,""))}static asKey(e){return e instanceof Uint8Array||typeof e=="string"?new t(e):typeof e.uint8Array=="function"?new t(e.uint8Array()):null}clean(){if((this._buf==null||this._buf.byteLength===0)&&(this._buf=mc),this._buf[0]!==li){let e=new Uint8Array(this._buf.byteLength+1);e.fill(li,0,1),e.set(this._buf,1),this._buf=e}for(;this._buf.byteLength>1&&this._buf[this._buf.byteLength-1]===li;)this._buf=this._buf.subarray(0,-1)}less(e){let r=this.list(),n=e.list();for(let i=0;i<r.length;i++){if(n.length<i+1)return!1;let s=r[i],a=n[i];if(s<a)return!0;if(s>a)return!1}return r.length<n.length}reverse(){return t.withNamespaces(this.list().slice().reverse())}namespaces(){return this.list()}baseNamespace(){let e=this.namespaces();return e[e.length-1]}list(){return this.toString().split(Te).slice(1)}type(){return Vp(this.baseNamespace())}name(){return qp(this.baseNamespace())}instance(e){return new t(this.toString()+":"+e)}path(){let e=this.parent().toString();return e.endsWith(Te)||(e+=Te),e+=this.type(),new t(e)}parent(){let e=this.list();return e.length===1?new t(Te):new t(e.slice(0,-1).join(Te))}child(e){return this.toString()===Te?e:e.toString()===Te?this:new t(this.toString()+e.toString(),!1)}isAncestorOf(e){return e.toString()===this.toString()?!1:e.toString().startsWith(this.toString())}isDecendantOf(e){return e.toString()===this.toString()?!1:this.toString().startsWith(e.toString())}isTopLevel(){return this.list().length===1}concat(...e){return t.withNamespaces([...this.namespaces(),...Hp(e.map(r=>r.namespaces()))])}};function Vp(t){let e=t.split(":");return e.length<2?"":e.slice(0,-1).join(":")}function qp(t){let e=t.split(":");return e[e.length-1]}function Hp(t){return[].concat(...t)}var Ic=Bt(Cc(),1),Tc=Ic.default;var Oc=Bt(Uc(),1);var et;(function(t){t.ERR_INVALID_PARAMETERS="ERR_INVALID_PARAMETERS",t.ERR_INVALID_KEY_NAME="ERR_INVALID_KEY_NAME",t.ERR_INVALID_KEY_TYPE="ERR_INVALID_KEY_TYPE",t.ERR_KEY_ALREADY_EXISTS="ERR_KEY_ALREADY_EXISTS",t.ERR_INVALID_KEY_SIZE="ERR_INVALID_KEY_SIZE",t.ERR_KEY_NOT_FOUND="ERR_KEY_NOT_FOUND",t.ERR_OLD_KEY_NAME_INVALID="ERR_OLD_KEY_NAME_INVALID",t.ERR_NEW_KEY_NAME_INVALID="ERR_NEW_KEY_NAME_INVALID",t.ERR_PASSWORD_REQUIRED="ERR_PASSWORD_REQUIRED",t.ERR_PEM_REQUIRED="ERR_PEM_REQUIRED",t.ERR_CANNOT_READ_KEY="ERR_CANNOT_READ_KEY",t.ERR_MISSING_PRIVATE_KEY="ERR_MISSING_PRIVATE_KEY",t.ERR_INVALID_OLD_PASS_TYPE="ERR_INVALID_OLD_PASS_TYPE",t.ERR_INVALID_NEW_PASS_TYPE="ERR_INVALID_NEW_PASS_TYPE",t.ERR_INVALID_PASS_LENGTH="ERR_INVALID_PASS_LENGTH"})(et||(et={}));var yi=lc("libp2p:keychain"),a1="/pkcs8/",Mc="/info/",hr=new WeakMap,lr={minKeyLength:112/8,minSaltLength:128/8,minIterationCount:1e3},Js={dek:{keyLength:512/8,iterationCount:1e4,salt:"you should override this value with a crypto secure random number",hash:"sha2-512"}};function _e(t){return t==null||typeof t!="string"?!1:t===(0,Oc.default)(t.trim())&&t.length>0}async function ut(){let r=Math.random()*800+200;await new Promise(n=>setTimeout(n,r))}function le(t){return new xn(a1+t)}function ze(t){return new xn(Mc+t)}var js=class{components;init;constructor(e,r){if(this.components=e,this.init=Tc(Js,r),this.init.pass!=null&&this.init.pass?.length<20)throw new Error("pass must be least 20 characters");if(this.init.dek?.keyLength!=null&&this.init.dek.keyLength<lr.minKeyLength)throw new Error(`dek.keyLength must be least ${lr.minKeyLength} bytes`);if(this.init.dek?.salt?.length!=null&&this.init.dek.salt.length<lr.minSaltLength)throw new Error(`dek.saltLength must be least ${lr.minSaltLength} bytes`);if(this.init.dek?.iterationCount!=null&&this.init.dek.iterationCount<lr.minIterationCount)throw new Error(`dek.iterationCount must be least ${lr.minIterationCount}`);let n=this.init.pass!=null&&this.init.dek?.salt!=null?yn(this.init.pass,this.init.dek?.salt,this.init.dek?.iterationCount,this.init.dek?.keyLength,this.init.dek?.hash):"";hr.set(this,{dek:n})}static generateOptions(){let e=Object.assign({},Js),r=Math.ceil(lr.minSaltLength/3)*3;return e.dek.salt=pt(ar(r),"base64"),e}static get options(){return Js}async createKey(e,r,n=2048){if(!_e(e)||e==="self")throw await ut(),new K("Invalid key name",et.ERR_INVALID_KEY_NAME);if(typeof r!="string")throw await ut(),new K("Invalid key type",et.ERR_INVALID_KEY_TYPE);let i=le(e);if(await this.components.datastore.has(i))throw await ut(),new K("Key name already exists",et.ERR_KEY_ALREADY_EXISTS);switch(r.toLowerCase()){case"rsa":if(!Number.isSafeInteger(n)||n<2048)throw await ut(),new K("Invalid RSA key size",et.ERR_INVALID_KEY_SIZE);break;default:break}let a;try{let o=await nc(r,n),c=await o.id(),f=hr.get(this);if(f==null)throw new K("dek missing",et.ERR_INVALID_PARAMETERS);let u=f.dek,h=await o.export(u);a={name:e,id:c};let l=this.components.datastore.batch();l.put(i,at(h)),l.put(ze(e),at(JSON.stringify(a))),await l.commit()}catch(o){throw await ut(),o}return a}async listKeys(){let e={prefix:Mc},r=[];for await(let n of this.components.datastore.query(e))r.push(JSON.parse(pt(n.value)));return r}async findKeyById(e){try{let n=(await this.listKeys()).find(i=>i.id===e);if(n==null)throw new K(`Key with id '${e}' does not exist.`,et.ERR_KEY_NOT_FOUND);return n}catch(r){throw await ut(),r}}async findKeyByName(e){if(!_e(e))throw await ut(),new K(`Invalid key name '${e}'`,et.ERR_INVALID_KEY_NAME);let r=ze(e);try{let n=await this.components.datastore.get(r);return JSON.parse(pt(n))}catch(n){throw await ut(),yi.error(n),new K(`Key '${e}' does not exist.`,et.ERR_KEY_NOT_FOUND)}}async removeKey(e){if(!_e(e)||e==="self")throw await ut(),new K(`Invalid key name '${e}'`,et.ERR_INVALID_KEY_NAME);let r=le(e),n=await this.findKeyByName(e),i=this.components.datastore.batch();return i.delete(r),i.delete(ze(e)),await i.commit(),n}async renameKey(e,r){if(!_e(e)||e==="self")throw await ut(),new K(`Invalid old key name '${e}'`,et.ERR_OLD_KEY_NAME_INVALID);if(!_e(r)||r==="self")throw await ut(),new K(`Invalid new key name '${r}'`,et.ERR_NEW_KEY_NAME_INVALID);let n=le(e),i=le(r),s=ze(e),a=ze(r);if(await this.components.datastore.has(i))throw await ut(),new K(`Key '${r}' already exists`,et.ERR_KEY_ALREADY_EXISTS);try{let c=await this.components.datastore.get(n),f=await this.components.datastore.get(s),u=JSON.parse(pt(f));u.name=r;let h=this.components.datastore.batch();return h.put(i,c),h.put(a,at(JSON.stringify(u))),h.delete(n),h.delete(s),await h.commit(),u}catch(c){throw await ut(),c}}async exportKey(e,r){if(!_e(e))throw await ut(),new K(`Invalid key name '${e}'`,et.ERR_INVALID_KEY_NAME);if(r==null)throw await ut(),new K("Password is required",et.ERR_PASSWORD_REQUIRED);let n=le(e);try{let i=await this.components.datastore.get(n),s=pt(i),a=hr.get(this);if(a==null)throw new K("dek missing",et.ERR_INVALID_PARAMETERS);let o=a.dek;return await(await pn(s,o)).export(r)}catch(i){throw await ut(),i}}async exportPeerId(e){let r="temporary-password",n=await this.exportKey(e,r),i=await pn(n,r);return gc(i.public.bytes,i.bytes)}async importKey(e,r,n){if(!_e(e)||e==="self")throw await ut(),new K(`Invalid key name '${e}'`,et.ERR_INVALID_KEY_NAME);if(r==null)throw await ut(),new K("PEM encoded key is required",et.ERR_PEM_REQUIRED);let i=le(e);if(await this.components.datastore.has(i))throw await ut(),new K(`Key '${e}' already exists`,et.ERR_KEY_ALREADY_EXISTS);let a;try{a=await pn(r,n)}catch{throw await ut(),new K("Cannot read the key, most likely the password is wrong",et.ERR_CANNOT_READ_KEY)}let o;try{o=await a.id();let u=hr.get(this);if(u==null)throw new K("dek missing",et.ERR_INVALID_PARAMETERS);let h=u.dek;r=await a.export(h)}catch(u){throw await ut(),u}let c={name:e,id:o},f=this.components.datastore.batch();return f.put(i,at(r)),f.put(ze(e),at(JSON.stringify(c))),await f.commit(),c}async importPeer(e,r){try{if(!_e(e))throw new K(`Invalid key name '${e}'`,et.ERR_INVALID_KEY_NAME);if(r==null)throw new K("PeerId is required",et.ERR_MISSING_PRIVATE_KEY);if(r.privateKey==null)throw new K("PeerId.privKey is required",et.ERR_MISSING_PRIVATE_KEY);let n=await Ws(r.privateKey),i=le(e);if(await this.components.datastore.has(i))throw await ut(),new K(`Key '${e}' already exists`,et.ERR_KEY_ALREADY_EXISTS);let a=hr.get(this);if(a==null)throw new K("dek missing",et.ERR_INVALID_PARAMETERS);let o=a.dek,c=await n.export(o),f={name:e,id:r.toString()},u=this.components.datastore.batch();return u.put(i,at(c)),u.put(ze(e),at(JSON.stringify(f))),await u.commit(),f}catch(n){throw await ut(),n}}async getPrivateKey(e){if(!_e(e))throw await ut(),new K(`Invalid key name '${e}'`,et.ERR_INVALID_KEY_NAME);try{let r=le(e),n=await this.components.datastore.get(r);return pt(n)}catch(r){throw await ut(),yi.error(r),new K(`Key '${e}' does not exist.`,et.ERR_KEY_NOT_FOUND)}}async rotateKeychainPass(e,r){if(typeof e!="string")throw await ut(),new K(`Invalid old pass type '${typeof e}'`,et.ERR_INVALID_OLD_PASS_TYPE);if(typeof r!="string")throw await ut(),new K(`Invalid new pass type '${typeof r}'`,et.ERR_INVALID_NEW_PASS_TYPE);if(r.length<20)throw await ut(),new K(`Invalid pass length ${r.length}`,et.ERR_INVALID_PASS_LENGTH);yi("recreating keychain");let n=hr.get(this);if(n==null)throw new K("dek missing",et.ERR_INVALID_PARAMETERS);let i=n.dek;this.init.pass=r;let s=r!=null&&this.init.dek?.salt!=null?yn(r,this.init.dek.salt,this.init.dek?.iterationCount,this.init.dek?.keyLength,this.init.dek?.hash):"";hr.set(this,{dek:s});let a=await this.listKeys();for(let o of a){let c=await this.components.datastore.get(le(o.name)),f=pt(c),u=await pn(f,i),h=s.toString(),l=await u.export(h),g=this.components.datastore.batch(),d={name:o.name,id:o.id};g.put(le(o.name),at(l)),g.put(ze(o.name),at(JSON.stringify(d))),await g.commit()}yi("keychain reconstructed")}};return jc(c1);})();
/*! Bundled license information:

@noble/hashes/esm/utils.js:
  (*! noble-hashes - MIT License (c) 2022 Paul Miller (paulmillr.com) *)

@noble/curves/esm/abstract/utils.js:
  (*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) *)

@noble/curves/esm/abstract/modular.js:
  (*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) *)

@noble/curves/esm/abstract/curve.js:
  (*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) *)

@noble/curves/esm/abstract/edwards.js:
  (*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) *)

@noble/curves/esm/ed25519.js:
  (*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) *)

@noble/curves/esm/abstract/weierstrass.js:
  (*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) *)

@noble/curves/esm/_shortw_utils.js:
  (*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) *)

@noble/curves/esm/secp256k1.js:
  (*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) *)
*/
return Libp2PKeychain}));
