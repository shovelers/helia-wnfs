(function (root, factory) {(typeof module === 'object' && module.exports) ? module.exports = factory() : root.Libp2PCrypto = factory()}(typeof self !== 'undefined' ? self : this, function () {
"use strict";var Libp2PCrypto=(()=>{var nf=Object.create;var Yr=Object.defineProperty;var af=Object.getOwnPropertyDescriptor;var of=Object.getOwnPropertyNames;var sf=Object.getPrototypeOf,ff=Object.prototype.hasOwnProperty;var ft=(t,e)=>()=>(e||t((e={exports:{}}).exports,e),e.exports),gt=(t,e)=>{for(var r in e)Yr(t,r,{get:e[r],enumerable:!0})},Ma=(t,e,r,n)=>{if(e&&typeof e=="object"||typeof e=="function")for(let i of of(e))!ff.call(t,i)&&i!==r&&Yr(t,i,{get:()=>e[i],enumerable:!(n=af(e,i))||n.enumerable});return t};var Nt=(t,e,r)=>(r=t!=null?nf(sf(t)):{},Ma(e||!t||!t.__esModule?Yr(r,"default",{value:t,enumerable:!0}):r,t)),cf=t=>Ma(Yr({},"__esModule",{value:!0}),t);var it=ft((Dd,za)=>{za.exports={options:{usePureJavaScript:!1}}});var Ya=ft((kd,Wa)=>{var zn={};Wa.exports=zn;var Ga={};zn.encode=function(t,e,r){if(typeof e!="string")throw new TypeError('"alphabet" must be a string.');if(r!==void 0&&typeof r!="number")throw new TypeError('"maxline" must be a number.');var n="";if(!(t instanceof Uint8Array))n=uf(t,e);else{var i=0,a=e.length,s=e.charAt(0),o=[0];for(i=0;i<t.length;++i){for(var f=0,c=t[i];f<o.length;++f)c+=o[f]<<8,o[f]=c%a,c=c/a|0;for(;c>0;)o.push(c%a),c=c/a|0}for(i=0;t[i]===0&&i<t.length-1;++i)n+=s;for(i=o.length-1;i>=0;--i)n+=e[o[i]]}if(r){var u=new RegExp(".{1,"+r+"}","g");n=n.match(u).join(`\r
`)}return n};zn.decode=function(t,e){if(typeof t!="string")throw new TypeError('"input" must be a string.');if(typeof e!="string")throw new TypeError('"alphabet" must be a string.');var r=Ga[e];if(!r){r=Ga[e]=[];for(var n=0;n<e.length;++n)r[e.charCodeAt(n)]=n}t=t.replace(/\s/g,"");for(var i=e.length,a=e.charAt(0),s=[0],n=0;n<t.length;n++){var o=r[t.charCodeAt(n)];if(o===void 0)return;for(var f=0,c=o;f<s.length;++f)c+=s[f]*i,s[f]=c&255,c>>=8;for(;c>0;)s.push(c&255),c>>=8}for(var u=0;t[u]===a&&u<t.length-1;++u)s.push(0);return typeof Buffer<"u"?Buffer.from(s.reverse()):new Uint8Array(s.reverse())};function uf(t,e){var r=0,n=e.length,i=e.charAt(0),a=[0];for(r=0;r<t.length();++r){for(var s=0,o=t.at(r);s<a.length;++s)o+=a[s]<<8,a[s]=o%n,o=o/n|0;for(;o>0;)a.push(o%n),o=o/n|0}var f="";for(r=0;t.at(r)===0&&r<t.length()-1;++r)f+=i;for(r=a.length-1;r>=0;--r)f+=e[a[r]];return f}});var bt=ft((Pd,Xa)=>{var Za=it(),$a=Ya(),g=Xa.exports=Za.util=Za.util||{};(function(){if(typeof process<"u"&&process.nextTick&&!process.browser){g.nextTick=process.nextTick,typeof setImmediate=="function"?g.setImmediate=setImmediate:g.setImmediate=g.nextTick;return}if(typeof setImmediate=="function"){g.setImmediate=function(){return setImmediate.apply(void 0,arguments)},g.nextTick=function(o){return setImmediate(o)};return}if(g.setImmediate=function(o){setTimeout(o,0)},typeof window<"u"&&typeof window.postMessage=="function"){let o=function(f){if(f.source===window&&f.data===t){f.stopPropagation();var c=e.slice();e.length=0,c.forEach(function(u){u()})}};var s=o,t="forge.setImmediate",e=[];g.setImmediate=function(f){e.push(f),e.length===1&&window.postMessage(t,"*")},window.addEventListener("message",o,!0)}if(typeof MutationObserver<"u"){var r=Date.now(),n=!0,i=document.createElement("div"),e=[];new MutationObserver(function(){var f=e.slice();e.length=0,f.forEach(function(c){c()})}).observe(i,{attributes:!0});var a=g.setImmediate;g.setImmediate=function(f){Date.now()-r>15?(r=Date.now(),a(f)):(e.push(f),e.length===1&&i.setAttribute("a",n=!n))}}g.nextTick=g.setImmediate})();g.isNodejs=typeof process<"u"&&process.versions&&process.versions.node;g.globalScope=function(){return g.isNodejs?globalThis:typeof self>"u"?window:self}();g.isArray=Array.isArray||function(t){return Object.prototype.toString.call(t)==="[object Array]"};g.isArrayBuffer=function(t){return typeof ArrayBuffer<"u"&&t instanceof ArrayBuffer};g.isArrayBufferView=function(t){return t&&g.isArrayBuffer(t.buffer)&&t.byteLength!==void 0};function wr(t){if(!(t===8||t===16||t===24||t===32))throw new Error("Only 8, 16, 24, or 32 bits supported: "+t)}g.ByteBuffer=Gn;function Gn(t){if(this.data="",this.read=0,typeof t=="string")this.data=t;else if(g.isArrayBuffer(t)||g.isArrayBufferView(t))if(typeof Buffer<"u"&&t instanceof Buffer)this.data=t.toString("binary");else{var e=new Uint8Array(t);try{this.data=String.fromCharCode.apply(null,e)}catch{for(var r=0;r<e.length;++r)this.putByte(e[r])}}else(t instanceof Gn||typeof t=="object"&&typeof t.data=="string"&&typeof t.read=="number")&&(this.data=t.data,this.read=t.read);this._constructedStringLength=0}g.ByteStringBuffer=Gn;var hf=4096;g.ByteStringBuffer.prototype._optimizeConstructedString=function(t){this._constructedStringLength+=t,this._constructedStringLength>hf&&(this.data.substr(0,1),this._constructedStringLength=0)};g.ByteStringBuffer.prototype.length=function(){return this.data.length-this.read};g.ByteStringBuffer.prototype.isEmpty=function(){return this.length()<=0};g.ByteStringBuffer.prototype.putByte=function(t){return this.putBytes(String.fromCharCode(t))};g.ByteStringBuffer.prototype.fillWithByte=function(t,e){t=String.fromCharCode(t);for(var r=this.data;e>0;)e&1&&(r+=t),e>>>=1,e>0&&(t+=t);return this.data=r,this._optimizeConstructedString(e),this};g.ByteStringBuffer.prototype.putBytes=function(t){return this.data+=t,this._optimizeConstructedString(t.length),this};g.ByteStringBuffer.prototype.putString=function(t){return this.putBytes(g.encodeUtf8(t))};g.ByteStringBuffer.prototype.putInt16=function(t){return this.putBytes(String.fromCharCode(t>>8&255)+String.fromCharCode(t&255))};g.ByteStringBuffer.prototype.putInt24=function(t){return this.putBytes(String.fromCharCode(t>>16&255)+String.fromCharCode(t>>8&255)+String.fromCharCode(t&255))};g.ByteStringBuffer.prototype.putInt32=function(t){return this.putBytes(String.fromCharCode(t>>24&255)+String.fromCharCode(t>>16&255)+String.fromCharCode(t>>8&255)+String.fromCharCode(t&255))};g.ByteStringBuffer.prototype.putInt16Le=function(t){return this.putBytes(String.fromCharCode(t&255)+String.fromCharCode(t>>8&255))};g.ByteStringBuffer.prototype.putInt24Le=function(t){return this.putBytes(String.fromCharCode(t&255)+String.fromCharCode(t>>8&255)+String.fromCharCode(t>>16&255))};g.ByteStringBuffer.prototype.putInt32Le=function(t){return this.putBytes(String.fromCharCode(t&255)+String.fromCharCode(t>>8&255)+String.fromCharCode(t>>16&255)+String.fromCharCode(t>>24&255))};g.ByteStringBuffer.prototype.putInt=function(t,e){wr(e);var r="";do e-=8,r+=String.fromCharCode(t>>e&255);while(e>0);return this.putBytes(r)};g.ByteStringBuffer.prototype.putSignedInt=function(t,e){return t<0&&(t+=2<<e-1),this.putInt(t,e)};g.ByteStringBuffer.prototype.putBuffer=function(t){return this.putBytes(t.getBytes())};g.ByteStringBuffer.prototype.getByte=function(){return this.data.charCodeAt(this.read++)};g.ByteStringBuffer.prototype.getInt16=function(){var t=this.data.charCodeAt(this.read)<<8^this.data.charCodeAt(this.read+1);return this.read+=2,t};g.ByteStringBuffer.prototype.getInt24=function(){var t=this.data.charCodeAt(this.read)<<16^this.data.charCodeAt(this.read+1)<<8^this.data.charCodeAt(this.read+2);return this.read+=3,t};g.ByteStringBuffer.prototype.getInt32=function(){var t=this.data.charCodeAt(this.read)<<24^this.data.charCodeAt(this.read+1)<<16^this.data.charCodeAt(this.read+2)<<8^this.data.charCodeAt(this.read+3);return this.read+=4,t};g.ByteStringBuffer.prototype.getInt16Le=function(){var t=this.data.charCodeAt(this.read)^this.data.charCodeAt(this.read+1)<<8;return this.read+=2,t};g.ByteStringBuffer.prototype.getInt24Le=function(){var t=this.data.charCodeAt(this.read)^this.data.charCodeAt(this.read+1)<<8^this.data.charCodeAt(this.read+2)<<16;return this.read+=3,t};g.ByteStringBuffer.prototype.getInt32Le=function(){var t=this.data.charCodeAt(this.read)^this.data.charCodeAt(this.read+1)<<8^this.data.charCodeAt(this.read+2)<<16^this.data.charCodeAt(this.read+3)<<24;return this.read+=4,t};g.ByteStringBuffer.prototype.getInt=function(t){wr(t);var e=0;do e=(e<<8)+this.data.charCodeAt(this.read++),t-=8;while(t>0);return e};g.ByteStringBuffer.prototype.getSignedInt=function(t){var e=this.getInt(t),r=2<<t-2;return e>=r&&(e-=r<<1),e};g.ByteStringBuffer.prototype.getBytes=function(t){var e;return t?(t=Math.min(this.length(),t),e=this.data.slice(this.read,this.read+t),this.read+=t):t===0?e="":(e=this.read===0?this.data:this.data.slice(this.read),this.clear()),e};g.ByteStringBuffer.prototype.bytes=function(t){return typeof t>"u"?this.data.slice(this.read):this.data.slice(this.read,this.read+t)};g.ByteStringBuffer.prototype.at=function(t){return this.data.charCodeAt(this.read+t)};g.ByteStringBuffer.prototype.setAt=function(t,e){return this.data=this.data.substr(0,this.read+t)+String.fromCharCode(e)+this.data.substr(this.read+t+1),this};g.ByteStringBuffer.prototype.last=function(){return this.data.charCodeAt(this.data.length-1)};g.ByteStringBuffer.prototype.copy=function(){var t=g.createBuffer(this.data);return t.read=this.read,t};g.ByteStringBuffer.prototype.compact=function(){return this.read>0&&(this.data=this.data.slice(this.read),this.read=0),this};g.ByteStringBuffer.prototype.clear=function(){return this.data="",this.read=0,this};g.ByteStringBuffer.prototype.truncate=function(t){var e=Math.max(0,this.length()-t);return this.data=this.data.substr(this.read,e),this.read=0,this};g.ByteStringBuffer.prototype.toHex=function(){for(var t="",e=this.read;e<this.data.length;++e){var r=this.data.charCodeAt(e);r<16&&(t+="0"),t+=r.toString(16)}return t};g.ByteStringBuffer.prototype.toString=function(){return g.decodeUtf8(this.bytes())};function lf(t,e){e=e||{},this.read=e.readOffset||0,this.growSize=e.growSize||1024;var r=g.isArrayBuffer(t),n=g.isArrayBufferView(t);if(r||n){r?this.data=new DataView(t):this.data=new DataView(t.buffer,t.byteOffset,t.byteLength),this.write="writeOffset"in e?e.writeOffset:this.data.byteLength;return}this.data=new DataView(new ArrayBuffer(0)),this.write=0,t!=null&&this.putBytes(t),"writeOffset"in e&&(this.write=e.writeOffset)}g.DataBuffer=lf;g.DataBuffer.prototype.length=function(){return this.write-this.read};g.DataBuffer.prototype.isEmpty=function(){return this.length()<=0};g.DataBuffer.prototype.accommodate=function(t,e){if(this.length()>=t)return this;e=Math.max(e||this.growSize,t);var r=new Uint8Array(this.data.buffer,this.data.byteOffset,this.data.byteLength),n=new Uint8Array(this.length()+e);return n.set(r),this.data=new DataView(n.buffer),this};g.DataBuffer.prototype.putByte=function(t){return this.accommodate(1),this.data.setUint8(this.write++,t),this};g.DataBuffer.prototype.fillWithByte=function(t,e){this.accommodate(e);for(var r=0;r<e;++r)this.data.setUint8(t);return this};g.DataBuffer.prototype.putBytes=function(t,e){if(g.isArrayBufferView(t)){var r=new Uint8Array(t.buffer,t.byteOffset,t.byteLength),n=r.byteLength-r.byteOffset;this.accommodate(n);var i=new Uint8Array(this.data.buffer,this.write);return i.set(r),this.write+=n,this}if(g.isArrayBuffer(t)){var r=new Uint8Array(t);this.accommodate(r.byteLength);var i=new Uint8Array(this.data.buffer);return i.set(r,this.write),this.write+=r.byteLength,this}if(t instanceof g.DataBuffer||typeof t=="object"&&typeof t.read=="number"&&typeof t.write=="number"&&g.isArrayBufferView(t.data)){var r=new Uint8Array(t.data.byteLength,t.read,t.length());this.accommodate(r.byteLength);var i=new Uint8Array(t.data.byteLength,this.write);return i.set(r),this.write+=r.byteLength,this}if(t instanceof g.ByteStringBuffer&&(t=t.data,e="binary"),e=e||"binary",typeof t=="string"){var a;if(e==="hex")return this.accommodate(Math.ceil(t.length/2)),a=new Uint8Array(this.data.buffer,this.write),this.write+=g.binary.hex.decode(t,a,this.write),this;if(e==="base64")return this.accommodate(Math.ceil(t.length/4)*3),a=new Uint8Array(this.data.buffer,this.write),this.write+=g.binary.base64.decode(t,a,this.write),this;if(e==="utf8"&&(t=g.encodeUtf8(t),e="binary"),e==="binary"||e==="raw")return this.accommodate(t.length),a=new Uint8Array(this.data.buffer,this.write),this.write+=g.binary.raw.decode(a),this;if(e==="utf16")return this.accommodate(t.length*2),a=new Uint16Array(this.data.buffer,this.write),this.write+=g.text.utf16.encode(a),this;throw new Error("Invalid encoding: "+e)}throw Error("Invalid parameter: "+t)};g.DataBuffer.prototype.putBuffer=function(t){return this.putBytes(t),t.clear(),this};g.DataBuffer.prototype.putString=function(t){return this.putBytes(t,"utf16")};g.DataBuffer.prototype.putInt16=function(t){return this.accommodate(2),this.data.setInt16(this.write,t),this.write+=2,this};g.DataBuffer.prototype.putInt24=function(t){return this.accommodate(3),this.data.setInt16(this.write,t>>8&65535),this.data.setInt8(this.write,t>>16&255),this.write+=3,this};g.DataBuffer.prototype.putInt32=function(t){return this.accommodate(4),this.data.setInt32(this.write,t),this.write+=4,this};g.DataBuffer.prototype.putInt16Le=function(t){return this.accommodate(2),this.data.setInt16(this.write,t,!0),this.write+=2,this};g.DataBuffer.prototype.putInt24Le=function(t){return this.accommodate(3),this.data.setInt8(this.write,t>>16&255),this.data.setInt16(this.write,t>>8&65535,!0),this.write+=3,this};g.DataBuffer.prototype.putInt32Le=function(t){return this.accommodate(4),this.data.setInt32(this.write,t,!0),this.write+=4,this};g.DataBuffer.prototype.putInt=function(t,e){wr(e),this.accommodate(e/8);do e-=8,this.data.setInt8(this.write++,t>>e&255);while(e>0);return this};g.DataBuffer.prototype.putSignedInt=function(t,e){return wr(e),this.accommodate(e/8),t<0&&(t+=2<<e-1),this.putInt(t,e)};g.DataBuffer.prototype.getByte=function(){return this.data.getInt8(this.read++)};g.DataBuffer.prototype.getInt16=function(){var t=this.data.getInt16(this.read);return this.read+=2,t};g.DataBuffer.prototype.getInt24=function(){var t=this.data.getInt16(this.read)<<8^this.data.getInt8(this.read+2);return this.read+=3,t};g.DataBuffer.prototype.getInt32=function(){var t=this.data.getInt32(this.read);return this.read+=4,t};g.DataBuffer.prototype.getInt16Le=function(){var t=this.data.getInt16(this.read,!0);return this.read+=2,t};g.DataBuffer.prototype.getInt24Le=function(){var t=this.data.getInt8(this.read)^this.data.getInt16(this.read+1,!0)<<8;return this.read+=3,t};g.DataBuffer.prototype.getInt32Le=function(){var t=this.data.getInt32(this.read,!0);return this.read+=4,t};g.DataBuffer.prototype.getInt=function(t){wr(t);var e=0;do e=(e<<8)+this.data.getInt8(this.read++),t-=8;while(t>0);return e};g.DataBuffer.prototype.getSignedInt=function(t){var e=this.getInt(t),r=2<<t-2;return e>=r&&(e-=r<<1),e};g.DataBuffer.prototype.getBytes=function(t){var e;return t?(t=Math.min(this.length(),t),e=this.data.slice(this.read,this.read+t),this.read+=t):t===0?e="":(e=this.read===0?this.data:this.data.slice(this.read),this.clear()),e};g.DataBuffer.prototype.bytes=function(t){return typeof t>"u"?this.data.slice(this.read):this.data.slice(this.read,this.read+t)};g.DataBuffer.prototype.at=function(t){return this.data.getUint8(this.read+t)};g.DataBuffer.prototype.setAt=function(t,e){return this.data.setUint8(t,e),this};g.DataBuffer.prototype.last=function(){return this.data.getUint8(this.write-1)};g.DataBuffer.prototype.copy=function(){return new g.DataBuffer(this)};g.DataBuffer.prototype.compact=function(){if(this.read>0){var t=new Uint8Array(this.data.buffer,this.read),e=new Uint8Array(t.byteLength);e.set(t),this.data=new DataView(e),this.write-=this.read,this.read=0}return this};g.DataBuffer.prototype.clear=function(){return this.data=new DataView(new ArrayBuffer(0)),this.read=this.write=0,this};g.DataBuffer.prototype.truncate=function(t){return this.write=Math.max(0,this.length()-t),this.read=Math.min(this.read,this.write),this};g.DataBuffer.prototype.toHex=function(){for(var t="",e=this.read;e<this.data.byteLength;++e){var r=this.data.getUint8(e);r<16&&(t+="0"),t+=r.toString(16)}return t};g.DataBuffer.prototype.toString=function(t){var e=new Uint8Array(this.data,this.read,this.length());if(t=t||"utf8",t==="binary"||t==="raw")return g.binary.raw.encode(e);if(t==="hex")return g.binary.hex.encode(e);if(t==="base64")return g.binary.base64.encode(e);if(t==="utf8")return g.text.utf8.decode(e);if(t==="utf16")return g.text.utf16.decode(e);throw new Error("Invalid encoding: "+t)};g.createBuffer=function(t,e){return e=e||"raw",t!==void 0&&e==="utf8"&&(t=g.encodeUtf8(t)),new g.ByteBuffer(t)};g.fillString=function(t,e){for(var r="";e>0;)e&1&&(r+=t),e>>>=1,e>0&&(t+=t);return r};g.xorBytes=function(t,e,r){for(var n="",i="",a="",s=0,o=0;r>0;--r,++s)i=t.charCodeAt(s)^e.charCodeAt(s),o>=10&&(n+=a,a="",o=0),a+=String.fromCharCode(i),++o;return n+=a,n};g.hexToBytes=function(t){var e="",r=0;for(t.length&!0&&(r=1,e+=String.fromCharCode(parseInt(t[0],16)));r<t.length;r+=2)e+=String.fromCharCode(parseInt(t.substr(r,2),16));return e};g.bytesToHex=function(t){return g.createBuffer(t).toHex()};g.int32ToBytes=function(t){return String.fromCharCode(t>>24&255)+String.fromCharCode(t>>16&255)+String.fromCharCode(t>>8&255)+String.fromCharCode(t&255)};var Ae="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",Ce=[62,-1,-1,-1,63,52,53,54,55,56,57,58,59,60,61,-1,-1,-1,64,-1,-1,-1,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,-1,-1,-1,-1,-1,-1,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51],Qa="123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz";g.encode64=function(t,e){for(var r="",n="",i,a,s,o=0;o<t.length;)i=t.charCodeAt(o++),a=t.charCodeAt(o++),s=t.charCodeAt(o++),r+=Ae.charAt(i>>2),r+=Ae.charAt((i&3)<<4|a>>4),isNaN(a)?r+="==":(r+=Ae.charAt((a&15)<<2|s>>6),r+=isNaN(s)?"=":Ae.charAt(s&63)),e&&r.length>e&&(n+=r.substr(0,e)+`\r
`,r=r.substr(e));return n+=r,n};g.decode64=function(t){t=t.replace(/[^A-Za-z0-9\+\/\=]/g,"");for(var e="",r,n,i,a,s=0;s<t.length;)r=Ce[t.charCodeAt(s++)-43],n=Ce[t.charCodeAt(s++)-43],i=Ce[t.charCodeAt(s++)-43],a=Ce[t.charCodeAt(s++)-43],e+=String.fromCharCode(r<<2|n>>4),i!==64&&(e+=String.fromCharCode((n&15)<<4|i>>2),a!==64&&(e+=String.fromCharCode((i&3)<<6|a)));return e};g.encodeUtf8=function(t){return unescape(encodeURIComponent(t))};g.decodeUtf8=function(t){return decodeURIComponent(escape(t))};g.binary={raw:{},hex:{},base64:{},base58:{},baseN:{encode:$a.encode,decode:$a.decode}};g.binary.raw.encode=function(t){return String.fromCharCode.apply(null,t)};g.binary.raw.decode=function(t,e,r){var n=e;n||(n=new Uint8Array(t.length)),r=r||0;for(var i=r,a=0;a<t.length;++a)n[i++]=t.charCodeAt(a);return e?i-r:n};g.binary.hex.encode=g.bytesToHex;g.binary.hex.decode=function(t,e,r){var n=e;n||(n=new Uint8Array(Math.ceil(t.length/2))),r=r||0;var i=0,a=r;for(t.length&1&&(i=1,n[a++]=parseInt(t[0],16));i<t.length;i+=2)n[a++]=parseInt(t.substr(i,2),16);return e?a-r:n};g.binary.base64.encode=function(t,e){for(var r="",n="",i,a,s,o=0;o<t.byteLength;)i=t[o++],a=t[o++],s=t[o++],r+=Ae.charAt(i>>2),r+=Ae.charAt((i&3)<<4|a>>4),isNaN(a)?r+="==":(r+=Ae.charAt((a&15)<<2|s>>6),r+=isNaN(s)?"=":Ae.charAt(s&63)),e&&r.length>e&&(n+=r.substr(0,e)+`\r
`,r=r.substr(e));return n+=r,n};g.binary.base64.decode=function(t,e,r){var n=e;n||(n=new Uint8Array(Math.ceil(t.length/4)*3)),t=t.replace(/[^A-Za-z0-9\+\/\=]/g,""),r=r||0;for(var i,a,s,o,f=0,c=r;f<t.length;)i=Ce[t.charCodeAt(f++)-43],a=Ce[t.charCodeAt(f++)-43],s=Ce[t.charCodeAt(f++)-43],o=Ce[t.charCodeAt(f++)-43],n[c++]=i<<2|a>>4,s!==64&&(n[c++]=(a&15)<<4|s>>2,o!==64&&(n[c++]=(s&3)<<6|o));return e?c-r:n.subarray(0,c)};g.binary.base58.encode=function(t,e){return g.binary.baseN.encode(t,Qa,e)};g.binary.base58.decode=function(t,e){return g.binary.baseN.decode(t,Qa,e)};g.text={utf8:{},utf16:{}};g.text.utf8.encode=function(t,e,r){t=g.encodeUtf8(t);var n=e;n||(n=new Uint8Array(t.length)),r=r||0;for(var i=r,a=0;a<t.length;++a)n[i++]=t.charCodeAt(a);return e?i-r:n};g.text.utf8.decode=function(t){return g.decodeUtf8(String.fromCharCode.apply(null,t))};g.text.utf16.encode=function(t,e,r){var n=e;n||(n=new Uint8Array(t.length*2));var i=new Uint16Array(n.buffer);r=r||0;for(var a=r,s=r,o=0;o<t.length;++o)i[s++]=t.charCodeAt(o),a+=2;return e?a-r:n};g.text.utf16.decode=function(t){return String.fromCharCode.apply(null,new Uint16Array(t.buffer))};g.deflate=function(t,e,r){if(e=g.decode64(t.deflate(g.encode64(e)).rval),r){var n=2,i=e.charCodeAt(1);i&32&&(n=6),e=e.substring(n,e.length-4)}return e};g.inflate=function(t,e,r){var n=t.inflate(g.encode64(e)).rval;return n===null?null:g.decode64(n)};var Wn=function(t,e,r){if(!t)throw new Error("WebStorage not available.");var n;if(r===null?n=t.removeItem(e):(r=g.encode64(JSON.stringify(r)),n=t.setItem(e,r)),typeof n<"u"&&n.rval!==!0){var i=new Error(n.error.message);throw i.id=n.error.id,i.name=n.error.name,i}},Yn=function(t,e){if(!t)throw new Error("WebStorage not available.");var r=t.getItem(e);if(t.init)if(r.rval===null){if(r.error){var n=new Error(r.error.message);throw n.id=r.error.id,n.name=r.error.name,n}r=null}else r=r.rval;return r!==null&&(r=JSON.parse(g.decode64(r))),r},pf=function(t,e,r,n){var i=Yn(t,e);i===null&&(i={}),i[r]=n,Wn(t,e,i)},df=function(t,e,r){var n=Yn(t,e);return n!==null&&(n=r in n?n[r]:null),n},yf=function(t,e,r){var n=Yn(t,e);if(n!==null&&r in n){delete n[r];var i=!0;for(var a in n){i=!1;break}i&&(n=null),Wn(t,e,n)}},xf=function(t,e){Wn(t,e,null)},Zr=function(t,e,r){var n=null;typeof r>"u"&&(r=["web","flash"]);var i,a=!1,s=null;for(var o in r){i=r[o];try{if(i==="flash"||i==="both"){if(e[0]===null)throw new Error("Flash local storage not available.");n=t.apply(this,e),a=i==="flash"}(i==="web"||i==="both")&&(e[0]=localStorage,n=t.apply(this,e),a=!0)}catch(f){s=f}if(a)break}if(!a)throw s;return n};g.setItem=function(t,e,r,n,i){Zr(pf,arguments,i)};g.getItem=function(t,e,r,n){return Zr(df,arguments,n)};g.removeItem=function(t,e,r,n){Zr(yf,arguments,n)};g.clearItems=function(t,e,r){Zr(xf,arguments,r)};g.isEmpty=function(t){for(var e in t)if(t.hasOwnProperty(e))return!1;return!0};g.format=function(t){for(var e=/%./g,r,n,i=0,a=[],s=0;r=e.exec(t);){n=t.substring(s,e.lastIndex-2),n.length>0&&a.push(n),s=e.lastIndex;var o=r[0][1];switch(o){case"s":case"o":i<arguments.length?a.push(arguments[i+++1]):a.push("<?>");break;case"%":a.push("%");break;default:a.push("<%"+o+"?>")}}return a.push(t.substring(s)),a.join("")};g.formatNumber=function(t,e,r,n){var i=t,a=isNaN(e=Math.abs(e))?2:e,s=r===void 0?",":r,o=n===void 0?".":n,f=i<0?"-":"",c=parseInt(i=Math.abs(+i||0).toFixed(a),10)+"",u=c.length>3?c.length%3:0;return f+(u?c.substr(0,u)+o:"")+c.substr(u).replace(/(\d{3})(?=\d)/g,"$1"+o)+(a?s+Math.abs(i-c).toFixed(a).slice(2):"")};g.formatSize=function(t){return t>=1073741824?t=g.formatNumber(t/1073741824,2,".","")+" GiB":t>=1048576?t=g.formatNumber(t/1048576,2,".","")+" MiB":t>=1024?t=g.formatNumber(t/1024,0)+" KiB":t=g.formatNumber(t,0)+" bytes",t};g.bytesFromIP=function(t){return t.indexOf(".")!==-1?g.bytesFromIPv4(t):t.indexOf(":")!==-1?g.bytesFromIPv6(t):null};g.bytesFromIPv4=function(t){if(t=t.split("."),t.length!==4)return null;for(var e=g.createBuffer(),r=0;r<t.length;++r){var n=parseInt(t[r],10);if(isNaN(n))return null;e.putByte(n)}return e.getBytes()};g.bytesFromIPv6=function(t){var e=0;t=t.split(":").filter(function(s){return s.length===0&&++e,!0});for(var r=(8-t.length+e)*2,n=g.createBuffer(),i=0;i<8;++i){if(!t[i]||t[i].length===0){n.fillWithByte(0,r),r=0;continue}var a=g.hexToBytes(t[i]);a.length<2&&n.putByte(0),n.putBytes(a)}return n.getBytes()};g.bytesToIP=function(t){return t.length===4?g.bytesToIPv4(t):t.length===16?g.bytesToIPv6(t):null};g.bytesToIPv4=function(t){if(t.length!==4)return null;for(var e=[],r=0;r<t.length;++r)e.push(t.charCodeAt(r));return e.join(".")};g.bytesToIPv6=function(t){if(t.length!==16)return null;for(var e=[],r=[],n=0,i=0;i<t.length;i+=2){for(var a=g.bytesToHex(t[i]+t[i+1]);a[0]==="0"&&a!=="0";)a=a.substr(1);if(a==="0"){var s=r[r.length-1],o=e.length;!s||o!==s.end+1?r.push({start:o,end:o}):(s.end=o,s.end-s.start>r[n].end-r[n].start&&(n=r.length-1))}e.push(a)}if(r.length>0){var f=r[n];f.end-f.start>0&&(e.splice(f.start,f.end-f.start+1,""),f.start===0&&e.unshift(""),f.end===7&&e.push(""))}return e.join(":")};g.estimateCores=function(t,e){if(typeof t=="function"&&(e=t,t={}),t=t||{},"cores"in g&&!t.update)return e(null,g.cores);if(typeof navigator<"u"&&"hardwareConcurrency"in navigator&&navigator.hardwareConcurrency>0)return g.cores=navigator.hardwareConcurrency,e(null,g.cores);if(typeof Worker>"u")return g.cores=1,e(null,g.cores);if(typeof Blob>"u")return g.cores=2,e(null,g.cores);var r=URL.createObjectURL(new Blob(["(",function(){self.addEventListener("message",function(s){for(var o=Date.now(),f=o+4;Date.now()<f;);self.postMessage({st:o,et:f})})}.toString(),")()"],{type:"application/javascript"}));n([],5,16);function n(s,o,f){if(o===0){var c=Math.floor(s.reduce(function(u,h){return u+h},0)/s.length);return g.cores=Math.max(1,c),URL.revokeObjectURL(r),e(null,g.cores)}i(f,function(u,h){s.push(a(f,h)),n(s,o-1,f)})}function i(s,o){for(var f=[],c=[],u=0;u<s;++u){var h=new Worker(r);h.addEventListener("message",function(p){if(c.push(p.data),c.length===s){for(var x=0;x<s;++x)f[x].terminate();o(null,c)}}),f.push(h)}for(var u=0;u<s;++u)f[u].postMessage(u)}function a(s,o){for(var f=[],c=0;c<s;++c)for(var u=o[c],h=f[c]=[],p=0;p<s;++p)if(c!==p){var x=o[p];(u.st>x.st&&u.st<x.et||x.st>u.st&&x.st<u.et)&&h.push(p)}return f.reduce(function(l,d){return Math.max(l,d.length)},0)}}});var $n=ft((Ud,Ja)=>{var Ct=it();bt();Ja.exports=Ct.cipher=Ct.cipher||{};Ct.cipher.algorithms=Ct.cipher.algorithms||{};Ct.cipher.createCipher=function(t,e){var r=t;if(typeof r=="string"&&(r=Ct.cipher.getAlgorithm(r),r&&(r=r())),!r)throw new Error("Unsupported algorithm: "+t);return new Ct.cipher.BlockCipher({algorithm:r,key:e,decrypt:!1})};Ct.cipher.createDecipher=function(t,e){var r=t;if(typeof r=="string"&&(r=Ct.cipher.getAlgorithm(r),r&&(r=r())),!r)throw new Error("Unsupported algorithm: "+t);return new Ct.cipher.BlockCipher({algorithm:r,key:e,decrypt:!0})};Ct.cipher.registerAlgorithm=function(t,e){t=t.toUpperCase(),Ct.cipher.algorithms[t]=e};Ct.cipher.getAlgorithm=function(t){return t=t.toUpperCase(),t in Ct.cipher.algorithms?Ct.cipher.algorithms[t]:null};var Zn=Ct.cipher.BlockCipher=function(t){this.algorithm=t.algorithm,this.mode=this.algorithm.mode,this.blockSize=this.mode.blockSize,this._finish=!1,this._input=null,this.output=null,this._op=t.decrypt?this.mode.decrypt:this.mode.encrypt,this._decrypt=t.decrypt,this.algorithm.initialize(t)};Zn.prototype.start=function(t){t=t||{};var e={};for(var r in t)e[r]=t[r];e.decrypt=this._decrypt,this._finish=!1,this._input=Ct.util.createBuffer(),this.output=t.output||Ct.util.createBuffer(),this.mode.start(e)};Zn.prototype.update=function(t){for(t&&this._input.putBuffer(t);!this._op.call(this.mode,this._input,this.output,this._finish)&&!this._finish;);this._input.compact()};Zn.prototype.finish=function(t){t&&(this.mode.name==="ECB"||this.mode.name==="CBC")&&(this.mode.pad=function(r){return t(this.blockSize,r,!1)},this.mode.unpad=function(r){return t(this.blockSize,r,!0)});var e={};return e.decrypt=this._decrypt,e.overflow=this._input.length()%this.blockSize,!(!this._decrypt&&this.mode.pad&&!this.mode.pad(this._input,e)||(this._finish=!0,this.update(),this._decrypt&&this.mode.unpad&&!this.mode.unpad(this.output,e))||this.mode.afterFinish&&!this.mode.afterFinish(this.output,e))}});var Xn=ft((Kd,ja)=>{var It=it();bt();It.cipher=It.cipher||{};var $=ja.exports=It.cipher.modes=It.cipher.modes||{};$.ecb=function(t){t=t||{},this.name="ECB",this.cipher=t.cipher,this.blockSize=t.blockSize||16,this._ints=this.blockSize/4,this._inBlock=new Array(this._ints),this._outBlock=new Array(this._ints)};$.ecb.prototype.start=function(t){};$.ecb.prototype.encrypt=function(t,e,r){if(t.length()<this.blockSize&&!(r&&t.length()>0))return!0;for(var n=0;n<this._ints;++n)this._inBlock[n]=t.getInt32();this.cipher.encrypt(this._inBlock,this._outBlock);for(var n=0;n<this._ints;++n)e.putInt32(this._outBlock[n])};$.ecb.prototype.decrypt=function(t,e,r){if(t.length()<this.blockSize&&!(r&&t.length()>0))return!0;for(var n=0;n<this._ints;++n)this._inBlock[n]=t.getInt32();this.cipher.decrypt(this._inBlock,this._outBlock);for(var n=0;n<this._ints;++n)e.putInt32(this._outBlock[n])};$.ecb.prototype.pad=function(t,e){var r=t.length()===this.blockSize?this.blockSize:this.blockSize-t.length();return t.fillWithByte(r,r),!0};$.ecb.prototype.unpad=function(t,e){if(e.overflow>0)return!1;var r=t.length(),n=t.at(r-1);return n>this.blockSize<<2?!1:(t.truncate(n),!0)};$.cbc=function(t){t=t||{},this.name="CBC",this.cipher=t.cipher,this.blockSize=t.blockSize||16,this._ints=this.blockSize/4,this._inBlock=new Array(this._ints),this._outBlock=new Array(this._ints)};$.cbc.prototype.start=function(t){if(t.iv===null){if(!this._prev)throw new Error("Invalid IV parameter.");this._iv=this._prev.slice(0)}else if("iv"in t)this._iv=$r(t.iv,this.blockSize),this._prev=this._iv.slice(0);else throw new Error("Invalid IV parameter.")};$.cbc.prototype.encrypt=function(t,e,r){if(t.length()<this.blockSize&&!(r&&t.length()>0))return!0;for(var n=0;n<this._ints;++n)this._inBlock[n]=this._prev[n]^t.getInt32();this.cipher.encrypt(this._inBlock,this._outBlock);for(var n=0;n<this._ints;++n)e.putInt32(this._outBlock[n]);this._prev=this._outBlock};$.cbc.prototype.decrypt=function(t,e,r){if(t.length()<this.blockSize&&!(r&&t.length()>0))return!0;for(var n=0;n<this._ints;++n)this._inBlock[n]=t.getInt32();this.cipher.decrypt(this._inBlock,this._outBlock);for(var n=0;n<this._ints;++n)e.putInt32(this._prev[n]^this._outBlock[n]);this._prev=this._inBlock.slice(0)};$.cbc.prototype.pad=function(t,e){var r=t.length()===this.blockSize?this.blockSize:this.blockSize-t.length();return t.fillWithByte(r,r),!0};$.cbc.prototype.unpad=function(t,e){if(e.overflow>0)return!1;var r=t.length(),n=t.at(r-1);return n>this.blockSize<<2?!1:(t.truncate(n),!0)};$.cfb=function(t){t=t||{},this.name="CFB",this.cipher=t.cipher,this.blockSize=t.blockSize||16,this._ints=this.blockSize/4,this._inBlock=null,this._outBlock=new Array(this._ints),this._partialBlock=new Array(this._ints),this._partialOutput=It.util.createBuffer(),this._partialBytes=0};$.cfb.prototype.start=function(t){if(!("iv"in t))throw new Error("Invalid IV parameter.");this._iv=$r(t.iv,this.blockSize),this._inBlock=this._iv.slice(0),this._partialBytes=0};$.cfb.prototype.encrypt=function(t,e,r){var n=t.length();if(n===0)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),this._partialBytes===0&&n>=this.blockSize){for(var i=0;i<this._ints;++i)this._inBlock[i]=t.getInt32()^this._outBlock[i],e.putInt32(this._inBlock[i]);return}var a=(this.blockSize-n)%this.blockSize;a>0&&(a=this.blockSize-a),this._partialOutput.clear();for(var i=0;i<this._ints;++i)this._partialBlock[i]=t.getInt32()^this._outBlock[i],this._partialOutput.putInt32(this._partialBlock[i]);if(a>0)t.read-=this.blockSize;else for(var i=0;i<this._ints;++i)this._inBlock[i]=this._partialBlock[i];if(this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),a>0&&!r)return e.putBytes(this._partialOutput.getBytes(a-this._partialBytes)),this._partialBytes=a,!0;e.putBytes(this._partialOutput.getBytes(n-this._partialBytes)),this._partialBytes=0};$.cfb.prototype.decrypt=function(t,e,r){var n=t.length();if(n===0)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),this._partialBytes===0&&n>=this.blockSize){for(var i=0;i<this._ints;++i)this._inBlock[i]=t.getInt32(),e.putInt32(this._inBlock[i]^this._outBlock[i]);return}var a=(this.blockSize-n)%this.blockSize;a>0&&(a=this.blockSize-a),this._partialOutput.clear();for(var i=0;i<this._ints;++i)this._partialBlock[i]=t.getInt32(),this._partialOutput.putInt32(this._partialBlock[i]^this._outBlock[i]);if(a>0)t.read-=this.blockSize;else for(var i=0;i<this._ints;++i)this._inBlock[i]=this._partialBlock[i];if(this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),a>0&&!r)return e.putBytes(this._partialOutput.getBytes(a-this._partialBytes)),this._partialBytes=a,!0;e.putBytes(this._partialOutput.getBytes(n-this._partialBytes)),this._partialBytes=0};$.ofb=function(t){t=t||{},this.name="OFB",this.cipher=t.cipher,this.blockSize=t.blockSize||16,this._ints=this.blockSize/4,this._inBlock=null,this._outBlock=new Array(this._ints),this._partialOutput=It.util.createBuffer(),this._partialBytes=0};$.ofb.prototype.start=function(t){if(!("iv"in t))throw new Error("Invalid IV parameter.");this._iv=$r(t.iv,this.blockSize),this._inBlock=this._iv.slice(0),this._partialBytes=0};$.ofb.prototype.encrypt=function(t,e,r){var n=t.length();if(t.length()===0)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),this._partialBytes===0&&n>=this.blockSize){for(var i=0;i<this._ints;++i)e.putInt32(t.getInt32()^this._outBlock[i]),this._inBlock[i]=this._outBlock[i];return}var a=(this.blockSize-n)%this.blockSize;a>0&&(a=this.blockSize-a),this._partialOutput.clear();for(var i=0;i<this._ints;++i)this._partialOutput.putInt32(t.getInt32()^this._outBlock[i]);if(a>0)t.read-=this.blockSize;else for(var i=0;i<this._ints;++i)this._inBlock[i]=this._outBlock[i];if(this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),a>0&&!r)return e.putBytes(this._partialOutput.getBytes(a-this._partialBytes)),this._partialBytes=a,!0;e.putBytes(this._partialOutput.getBytes(n-this._partialBytes)),this._partialBytes=0};$.ofb.prototype.decrypt=$.ofb.prototype.encrypt;$.ctr=function(t){t=t||{},this.name="CTR",this.cipher=t.cipher,this.blockSize=t.blockSize||16,this._ints=this.blockSize/4,this._inBlock=null,this._outBlock=new Array(this._ints),this._partialOutput=It.util.createBuffer(),this._partialBytes=0};$.ctr.prototype.start=function(t){if(!("iv"in t))throw new Error("Invalid IV parameter.");this._iv=$r(t.iv,this.blockSize),this._inBlock=this._iv.slice(0),this._partialBytes=0};$.ctr.prototype.encrypt=function(t,e,r){var n=t.length();if(n===0)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),this._partialBytes===0&&n>=this.blockSize)for(var i=0;i<this._ints;++i)e.putInt32(t.getInt32()^this._outBlock[i]);else{var a=(this.blockSize-n)%this.blockSize;a>0&&(a=this.blockSize-a),this._partialOutput.clear();for(var i=0;i<this._ints;++i)this._partialOutput.putInt32(t.getInt32()^this._outBlock[i]);if(a>0&&(t.read-=this.blockSize),this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),a>0&&!r)return e.putBytes(this._partialOutput.getBytes(a-this._partialBytes)),this._partialBytes=a,!0;e.putBytes(this._partialOutput.getBytes(n-this._partialBytes)),this._partialBytes=0}Qr(this._inBlock)};$.ctr.prototype.decrypt=$.ctr.prototype.encrypt;$.gcm=function(t){t=t||{},this.name="GCM",this.cipher=t.cipher,this.blockSize=t.blockSize||16,this._ints=this.blockSize/4,this._inBlock=new Array(this._ints),this._outBlock=new Array(this._ints),this._partialOutput=It.util.createBuffer(),this._partialBytes=0,this._R=3774873600};$.gcm.prototype.start=function(t){if(!("iv"in t))throw new Error("Invalid IV parameter.");var e=It.util.createBuffer(t.iv);this._cipherLength=0;var r;if("additionalData"in t?r=It.util.createBuffer(t.additionalData):r=It.util.createBuffer(),"tagLength"in t?this._tagLength=t.tagLength:this._tagLength=128,this._tag=null,t.decrypt&&(this._tag=It.util.createBuffer(t.tag).getBytes(),this._tag.length!==this._tagLength/8))throw new Error("Authentication tag does not match tag length.");this._hashBlock=new Array(this._ints),this.tag=null,this._hashSubkey=new Array(this._ints),this.cipher.encrypt([0,0,0,0],this._hashSubkey),this.componentBits=4,this._m=this.generateHashTable(this._hashSubkey,this.componentBits);var n=e.length();if(n===12)this._j0=[e.getInt32(),e.getInt32(),e.getInt32(),1];else{for(this._j0=[0,0,0,0];e.length()>0;)this._j0=this.ghash(this._hashSubkey,this._j0,[e.getInt32(),e.getInt32(),e.getInt32(),e.getInt32()]);this._j0=this.ghash(this._hashSubkey,this._j0,[0,0].concat(Qn(n*8)))}this._inBlock=this._j0.slice(0),Qr(this._inBlock),this._partialBytes=0,r=It.util.createBuffer(r),this._aDataLength=Qn(r.length()*8);var i=r.length()%this.blockSize;for(i&&r.fillWithByte(0,this.blockSize-i),this._s=[0,0,0,0];r.length()>0;)this._s=this.ghash(this._hashSubkey,this._s,[r.getInt32(),r.getInt32(),r.getInt32(),r.getInt32()])};$.gcm.prototype.encrypt=function(t,e,r){var n=t.length();if(n===0)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),this._partialBytes===0&&n>=this.blockSize){for(var i=0;i<this._ints;++i)e.putInt32(this._outBlock[i]^=t.getInt32());this._cipherLength+=this.blockSize}else{var a=(this.blockSize-n)%this.blockSize;a>0&&(a=this.blockSize-a),this._partialOutput.clear();for(var i=0;i<this._ints;++i)this._partialOutput.putInt32(t.getInt32()^this._outBlock[i]);if(a<=0||r){if(r){var s=n%this.blockSize;this._cipherLength+=s,this._partialOutput.truncate(this.blockSize-s)}else this._cipherLength+=this.blockSize;for(var i=0;i<this._ints;++i)this._outBlock[i]=this._partialOutput.getInt32();this._partialOutput.read-=this.blockSize}if(this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),a>0&&!r)return t.read-=this.blockSize,e.putBytes(this._partialOutput.getBytes(a-this._partialBytes)),this._partialBytes=a,!0;e.putBytes(this._partialOutput.getBytes(n-this._partialBytes)),this._partialBytes=0}this._s=this.ghash(this._hashSubkey,this._s,this._outBlock),Qr(this._inBlock)};$.gcm.prototype.decrypt=function(t,e,r){var n=t.length();if(n<this.blockSize&&!(r&&n>0))return!0;this.cipher.encrypt(this._inBlock,this._outBlock),Qr(this._inBlock),this._hashBlock[0]=t.getInt32(),this._hashBlock[1]=t.getInt32(),this._hashBlock[2]=t.getInt32(),this._hashBlock[3]=t.getInt32(),this._s=this.ghash(this._hashSubkey,this._s,this._hashBlock);for(var i=0;i<this._ints;++i)e.putInt32(this._outBlock[i]^this._hashBlock[i]);n<this.blockSize?this._cipherLength+=n%this.blockSize:this._cipherLength+=this.blockSize};$.gcm.prototype.afterFinish=function(t,e){var r=!0;e.decrypt&&e.overflow&&t.truncate(this.blockSize-e.overflow),this.tag=It.util.createBuffer();var n=this._aDataLength.concat(Qn(this._cipherLength*8));this._s=this.ghash(this._hashSubkey,this._s,n);var i=[];this.cipher.encrypt(this._j0,i);for(var a=0;a<this._ints;++a)this.tag.putInt32(this._s[a]^i[a]);return this.tag.truncate(this.tag.length()%(this._tagLength/8)),e.decrypt&&this.tag.bytes()!==this._tag&&(r=!1),r};$.gcm.prototype.multiply=function(t,e){for(var r=[0,0,0,0],n=e.slice(0),i=0;i<128;++i){var a=t[i/32|0]&1<<31-i%32;a&&(r[0]^=n[0],r[1]^=n[1],r[2]^=n[2],r[3]^=n[3]),this.pow(n,n)}return r};$.gcm.prototype.pow=function(t,e){for(var r=t[3]&1,n=3;n>0;--n)e[n]=t[n]>>>1|(t[n-1]&1)<<31;e[0]=t[0]>>>1,r&&(e[0]^=this._R)};$.gcm.prototype.tableMultiply=function(t){for(var e=[0,0,0,0],r=0;r<32;++r){var n=r/8|0,i=t[n]>>>(7-r%8)*4&15,a=this._m[r][i];e[0]^=a[0],e[1]^=a[1],e[2]^=a[2],e[3]^=a[3]}return e};$.gcm.prototype.ghash=function(t,e,r){return e[0]^=r[0],e[1]^=r[1],e[2]^=r[2],e[3]^=r[3],this.tableMultiply(e)};$.gcm.prototype.generateHashTable=function(t,e){for(var r=8/e,n=4*r,i=16*r,a=new Array(i),s=0;s<i;++s){var o=[0,0,0,0],f=s/n|0,c=(n-1-s%n)*e;o[f]=1<<e-1<<c,a[s]=this.generateSubHashTable(this.multiply(o,t),e)}return a};$.gcm.prototype.generateSubHashTable=function(t,e){var r=1<<e,n=r>>>1,i=new Array(r);i[n]=t.slice(0);for(var a=n>>>1;a>0;)this.pow(i[2*a],i[a]=[]),a>>=1;for(a=2;a<n;){for(var s=1;s<a;++s){var o=i[a],f=i[s];i[a+s]=[o[0]^f[0],o[1]^f[1],o[2]^f[2],o[3]^f[3]]}a*=2}for(i[0]=[0,0,0,0],a=n+1;a<r;++a){var c=i[a^n];i[a]=[t[0]^c[0],t[1]^c[1],t[2]^c[2],t[3]^c[3]]}return i};function $r(t,e){if(typeof t=="string"&&(t=It.util.createBuffer(t)),It.util.isArray(t)&&t.length>4){var r=t;t=It.util.createBuffer();for(var n=0;n<r.length;++n)t.putByte(r[n])}if(t.length()<e)throw new Error("Invalid IV length; got "+t.length()+" bytes and expected "+e+" bytes.");if(!It.util.isArray(t)){for(var i=[],a=e/4,n=0;n<a;++n)i.push(t.getInt32());t=i}return t}function Qr(t){t[t.length-1]=t[t.length-1]+1&4294967295}function Qn(t){return[t/4294967296|0,t&4294967295]}});var Jr=ft((Od,no)=>{var st=it();$n();Xn();bt();no.exports=st.aes=st.aes||{};st.aes.startEncrypting=function(t,e,r,n){var i=Xr({key:t,output:r,decrypt:!1,mode:n});return i.start(e),i};st.aes.createEncryptionCipher=function(t,e){return Xr({key:t,output:null,decrypt:!1,mode:e})};st.aes.startDecrypting=function(t,e,r,n){var i=Xr({key:t,output:r,decrypt:!0,mode:n});return i.start(e),i};st.aes.createDecryptionCipher=function(t,e){return Xr({key:t,output:null,decrypt:!0,mode:e})};st.aes.Algorithm=function(t,e){ti||eo();var r=this;r.name=t,r.mode=new e({blockSize:16,cipher:{encrypt:function(n,i){return jn(r._w,n,i,!1)},decrypt:function(n,i){return jn(r._w,n,i,!0)}}}),r._init=!1};st.aes.Algorithm.prototype.initialize=function(t){if(!this._init){var e=t.key,r;if(typeof e=="string"&&(e.length===16||e.length===24||e.length===32))e=st.util.createBuffer(e);else if(st.util.isArray(e)&&(e.length===16||e.length===24||e.length===32)){r=e,e=st.util.createBuffer();for(var n=0;n<r.length;++n)e.putByte(r[n])}if(!st.util.isArray(e)){r=e,e=[];var i=r.length();if(i===16||i===24||i===32){i=i>>>2;for(var n=0;n<i;++n)e.push(r.getInt32())}}if(!st.util.isArray(e)||!(e.length===4||e.length===6||e.length===8))throw new Error("Invalid key parameter.");var a=this.mode.name,s=["CFB","OFB","CTR","GCM"].indexOf(a)!==-1;this._w=ro(e,t.decrypt&&!s),this._init=!0}};st.aes._expandKey=function(t,e){return ti||eo(),ro(t,e)};st.aes._updateBlock=jn;er("AES-ECB",st.cipher.modes.ecb);er("AES-CBC",st.cipher.modes.cbc);er("AES-CFB",st.cipher.modes.cfb);er("AES-OFB",st.cipher.modes.ofb);er("AES-CTR",st.cipher.modes.ctr);er("AES-GCM",st.cipher.modes.gcm);function er(t,e){var r=function(){return new st.aes.Algorithm(t,e)};st.cipher.registerAlgorithm(t,r)}var ti=!1,tr=4,Pt,Jn,to,Oe,Yt;function eo(){ti=!0,to=[0,1,2,4,8,16,32,64,128,27,54];for(var t=new Array(256),e=0;e<128;++e)t[e]=e<<1,t[e+128]=e+128<<1^283;Pt=new Array(256),Jn=new Array(256),Oe=new Array(4),Yt=new Array(4);for(var e=0;e<4;++e)Oe[e]=new Array(256),Yt[e]=new Array(256);for(var r=0,n=0,i,a,s,o,f,c,u,e=0;e<256;++e){o=n^n<<1^n<<2^n<<3^n<<4,o=o>>8^o&255^99,Pt[r]=o,Jn[o]=r,f=t[o],i=t[r],a=t[i],s=t[a],c=f<<24^o<<16^o<<8^(o^f),u=(i^a^s)<<24^(r^s)<<16^(r^a^s)<<8^(r^i^s);for(var h=0;h<4;++h)Oe[h][r]=c,Yt[h][o]=u,c=c<<24|c>>>8,u=u<<24|u>>>8;r===0?r=n=1:(r=i^t[t[t[i^s]]],n^=t[t[n]])}}function ro(t,e){for(var r=t.slice(0),n,i=1,a=r.length,s=a+6+1,o=tr*s,f=a;f<o;++f)n=r[f-1],f%a===0?(n=Pt[n>>>16&255]<<24^Pt[n>>>8&255]<<16^Pt[n&255]<<8^Pt[n>>>24]^to[i]<<24,i++):a>6&&f%a===4&&(n=Pt[n>>>24]<<24^Pt[n>>>16&255]<<16^Pt[n>>>8&255]<<8^Pt[n&255]),r[f]=r[f-a]^n;if(e){var c,u=Yt[0],h=Yt[1],p=Yt[2],x=Yt[3],l=r.slice(0);o=r.length;for(var f=0,d=o-tr;f<o;f+=tr,d-=tr)if(f===0||f===o-tr)l[f]=r[d],l[f+1]=r[d+3],l[f+2]=r[d+2],l[f+3]=r[d+1];else for(var y=0;y<tr;++y)c=r[d+y],l[f+(3&-y)]=u[Pt[c>>>24]]^h[Pt[c>>>16&255]]^p[Pt[c>>>8&255]]^x[Pt[c&255]];r=l}return r}function jn(t,e,r,n){var i=t.length/4-1,a,s,o,f,c;n?(a=Yt[0],s=Yt[1],o=Yt[2],f=Yt[3],c=Jn):(a=Oe[0],s=Oe[1],o=Oe[2],f=Oe[3],c=Pt);var u,h,p,x,l,d,y;u=e[0]^t[0],h=e[n?3:1]^t[1],p=e[2]^t[2],x=e[n?1:3]^t[3];for(var m=3,E=1;E<i;++E)l=a[u>>>24]^s[h>>>16&255]^o[p>>>8&255]^f[x&255]^t[++m],d=a[h>>>24]^s[p>>>16&255]^o[x>>>8&255]^f[u&255]^t[++m],y=a[p>>>24]^s[x>>>16&255]^o[u>>>8&255]^f[h&255]^t[++m],x=a[x>>>24]^s[u>>>16&255]^o[h>>>8&255]^f[p&255]^t[++m],u=l,h=d,p=y;r[0]=c[u>>>24]<<24^c[h>>>16&255]<<16^c[p>>>8&255]<<8^c[x&255]^t[++m],r[n?3:1]=c[h>>>24]<<24^c[p>>>16&255]<<16^c[x>>>8&255]<<8^c[u&255]^t[++m],r[2]=c[p>>>24]<<24^c[x>>>16&255]<<16^c[u>>>8&255]<<8^c[h&255]^t[++m],r[n?1:3]=c[x>>>24]<<24^c[u>>>16&255]<<16^c[h>>>8&255]<<8^c[p&255]^t[++m]}function Xr(t){t=t||{};var e=(t.mode||"CBC").toUpperCase(),r="AES-"+e,n;t.decrypt?n=st.cipher.createDecipher(r,t.key):n=st.cipher.createCipher(r,t.key);var i=n.start;return n.start=function(a,s){var o=null;s instanceof st.util.ByteBuffer&&(o=s,s={}),s=s||{},s.output=o,s.iv=a,i.call(n,s)},n}});var nn=ft((M1,_o)=>{var _r=it();_r.pki=_r.pki||{};var Ci=_o.exports=_r.pki.oids=_r.oids=_r.oids||{};function T(t,e){Ci[t]=e,Ci[e]=t}function rt(t,e){Ci[t]=e}T("1.2.840.113549.1.1.1","rsaEncryption");T("1.2.840.113549.1.1.4","md5WithRSAEncryption");T("1.2.840.113549.1.1.5","sha1WithRSAEncryption");T("1.2.840.113549.1.1.7","RSAES-OAEP");T("1.2.840.113549.1.1.8","mgf1");T("1.2.840.113549.1.1.9","pSpecified");T("1.2.840.113549.1.1.10","RSASSA-PSS");T("1.2.840.113549.1.1.11","sha256WithRSAEncryption");T("1.2.840.113549.1.1.12","sha384WithRSAEncryption");T("1.2.840.113549.1.1.13","sha512WithRSAEncryption");T("1.3.101.112","EdDSA25519");T("1.2.840.10040.4.3","dsa-with-sha1");T("1.3.14.3.2.7","desCBC");T("1.3.14.3.2.26","sha1");T("1.3.14.3.2.29","sha1WithRSASignature");T("2.16.840.1.101.3.4.2.1","sha256");T("2.16.840.1.101.3.4.2.2","sha384");T("2.16.840.1.101.3.4.2.3","sha512");T("2.16.840.1.101.3.4.2.4","sha224");T("2.16.840.1.101.3.4.2.5","sha512-224");T("2.16.840.1.101.3.4.2.6","sha512-256");T("1.2.840.113549.2.2","md2");T("1.2.840.113549.2.5","md5");T("1.2.840.113549.1.7.1","data");T("1.2.840.113549.1.7.2","signedData");T("1.2.840.113549.1.7.3","envelopedData");T("1.2.840.113549.1.7.4","signedAndEnvelopedData");T("1.2.840.113549.1.7.5","digestedData");T("1.2.840.113549.1.7.6","encryptedData");T("1.2.840.113549.1.9.1","emailAddress");T("1.2.840.113549.1.9.2","unstructuredName");T("1.2.840.113549.1.9.3","contentType");T("1.2.840.113549.1.9.4","messageDigest");T("1.2.840.113549.1.9.5","signingTime");T("1.2.840.113549.1.9.6","counterSignature");T("1.2.840.113549.1.9.7","challengePassword");T("1.2.840.113549.1.9.8","unstructuredAddress");T("1.2.840.113549.1.9.14","extensionRequest");T("1.2.840.113549.1.9.20","friendlyName");T("1.2.840.113549.1.9.21","localKeyId");T("1.2.840.113549.1.9.22.1","x509Certificate");T("1.2.840.113549.1.12.10.1.1","keyBag");T("1.2.840.113549.1.12.10.1.2","pkcs8ShroudedKeyBag");T("1.2.840.113549.1.12.10.1.3","certBag");T("1.2.840.113549.1.12.10.1.4","crlBag");T("1.2.840.113549.1.12.10.1.5","secretBag");T("1.2.840.113549.1.12.10.1.6","safeContentsBag");T("1.2.840.113549.1.5.13","pkcs5PBES2");T("1.2.840.113549.1.5.12","pkcs5PBKDF2");T("1.2.840.113549.1.12.1.1","pbeWithSHAAnd128BitRC4");T("1.2.840.113549.1.12.1.2","pbeWithSHAAnd40BitRC4");T("1.2.840.113549.1.12.1.3","pbeWithSHAAnd3-KeyTripleDES-CBC");T("1.2.840.113549.1.12.1.4","pbeWithSHAAnd2-KeyTripleDES-CBC");T("1.2.840.113549.1.12.1.5","pbeWithSHAAnd128BitRC2-CBC");T("1.2.840.113549.1.12.1.6","pbewithSHAAnd40BitRC2-CBC");T("1.2.840.113549.2.7","hmacWithSHA1");T("1.2.840.113549.2.8","hmacWithSHA224");T("1.2.840.113549.2.9","hmacWithSHA256");T("1.2.840.113549.2.10","hmacWithSHA384");T("1.2.840.113549.2.11","hmacWithSHA512");T("1.2.840.113549.3.7","des-EDE3-CBC");T("2.16.840.1.101.3.4.1.2","aes128-CBC");T("2.16.840.1.101.3.4.1.22","aes192-CBC");T("2.16.840.1.101.3.4.1.42","aes256-CBC");T("2.5.4.3","commonName");T("2.5.4.4","surname");T("2.5.4.5","serialNumber");T("2.5.4.6","countryName");T("2.5.4.7","localityName");T("2.5.4.8","stateOrProvinceName");T("2.5.4.9","streetAddress");T("2.5.4.10","organizationName");T("2.5.4.11","organizationalUnitName");T("2.5.4.12","title");T("2.5.4.13","description");T("2.5.4.15","businessCategory");T("2.5.4.17","postalCode");T("2.5.4.42","givenName");T("1.3.6.1.4.1.311.60.2.1.2","jurisdictionOfIncorporationStateOrProvinceName");T("1.3.6.1.4.1.311.60.2.1.3","jurisdictionOfIncorporationCountryName");T("2.16.840.1.113730.1.1","nsCertType");T("2.16.840.1.113730.1.13","nsComment");rt("2.5.29.1","authorityKeyIdentifier");rt("2.5.29.2","keyAttributes");rt("2.5.29.3","certificatePolicies");rt("2.5.29.4","keyUsageRestriction");rt("2.5.29.5","policyMapping");rt("2.5.29.6","subtreesConstraint");rt("2.5.29.7","subjectAltName");rt("2.5.29.8","issuerAltName");rt("2.5.29.9","subjectDirectoryAttributes");rt("2.5.29.10","basicConstraints");rt("2.5.29.11","nameConstraints");rt("2.5.29.12","policyConstraints");rt("2.5.29.13","basicConstraints");T("2.5.29.14","subjectKeyIdentifier");T("2.5.29.15","keyUsage");rt("2.5.29.16","privateKeyUsagePeriod");T("2.5.29.17","subjectAltName");T("2.5.29.18","issuerAltName");T("2.5.29.19","basicConstraints");rt("2.5.29.20","cRLNumber");rt("2.5.29.21","cRLReason");rt("2.5.29.22","expirationDate");rt("2.5.29.23","instructionCode");rt("2.5.29.24","invalidityDate");rt("2.5.29.25","cRLDistributionPoints");rt("2.5.29.26","issuingDistributionPoint");rt("2.5.29.27","deltaCRLIndicator");rt("2.5.29.28","issuingDistributionPoint");rt("2.5.29.29","certificateIssuer");rt("2.5.29.30","nameConstraints");T("2.5.29.31","cRLDistributionPoints");T("2.5.29.32","certificatePolicies");rt("2.5.29.33","policyMappings");rt("2.5.29.34","policyConstraints");T("2.5.29.35","authorityKeyIdentifier");rt("2.5.29.36","policyConstraints");T("2.5.29.37","extKeyUsage");rt("2.5.29.46","freshestCRL");rt("2.5.29.54","inhibitAnyPolicy");T("1.3.6.1.4.1.11129.2.4.2","timestampList");T("1.3.6.1.5.5.7.1.1","authorityInfoAccess");T("1.3.6.1.5.5.7.3.1","serverAuth");T("1.3.6.1.5.5.7.3.2","clientAuth");T("1.3.6.1.5.5.7.3.3","codeSigning");T("1.3.6.1.5.5.7.3.4","emailProtection");T("1.3.6.1.5.5.7.3.8","timeStamping")});var Lr=ft((V1,Lo)=>{var ct=it();bt();nn();var P=Lo.exports=ct.asn1=ct.asn1||{};P.Class={UNIVERSAL:0,APPLICATION:64,CONTEXT_SPECIFIC:128,PRIVATE:192};P.Type={NONE:0,BOOLEAN:1,INTEGER:2,BITSTRING:3,OCTETSTRING:4,NULL:5,OID:6,ODESC:7,EXTERNAL:8,REAL:9,ENUMERATED:10,EMBEDDED:11,UTF8:12,ROID:13,SEQUENCE:16,SET:17,PRINTABLESTRING:19,IA5STRING:22,UTCTIME:23,GENERALIZEDTIME:24,BMPSTRING:30};P.create=function(t,e,r,n,i){if(ct.util.isArray(n)){for(var a=[],s=0;s<n.length;++s)n[s]!==void 0&&a.push(n[s]);n=a}var o={tagClass:t,type:e,constructed:r,composed:r||ct.util.isArray(n),value:n};return i&&"bitStringContents"in i&&(o.bitStringContents=i.bitStringContents,o.original=P.copy(o)),o};P.copy=function(t,e){var r;if(ct.util.isArray(t)){r=[];for(var n=0;n<t.length;++n)r.push(P.copy(t[n],e));return r}return typeof t=="string"?t:(r={tagClass:t.tagClass,type:t.type,constructed:t.constructed,composed:t.composed,value:P.copy(t.value,e)},e&&!e.excludeBitStringContents&&(r.bitStringContents=t.bitStringContents),r)};P.equals=function(t,e,r){if(ct.util.isArray(t)){if(!ct.util.isArray(e)||t.length!==e.length)return!1;for(var n=0;n<t.length;++n)if(!P.equals(t[n],e[n]))return!1;return!0}if(typeof t!=typeof e)return!1;if(typeof t=="string")return t===e;var i=t.tagClass===e.tagClass&&t.type===e.type&&t.constructed===e.constructed&&t.composed===e.composed&&P.equals(t.value,e.value);return r&&r.includeBitStringContents&&(i=i&&t.bitStringContents===e.bitStringContents),i};P.getBerValueLength=function(t){var e=t.getByte();if(e!==128){var r,n=e&128;return n?r=t.getInt((e&127)<<3):r=e,r}};function Rr(t,e,r){if(r>e){var n=new Error("Too few bytes to parse DER.");throw n.available=t.length(),n.remaining=e,n.requested=r,n}}var Cc=function(t,e){var r=t.getByte();if(e--,r!==128){var n,i=r&128;if(!i)n=r;else{var a=r&127;Rr(t,e,a),n=t.getInt(a<<3)}if(n<0)throw new Error("Negative length: "+n);return n}};P.fromDer=function(t,e){e===void 0&&(e={strict:!0,parseAllBytes:!0,decodeBitStrings:!0}),typeof e=="boolean"&&(e={strict:e,parseAllBytes:!0,decodeBitStrings:!0}),"strict"in e||(e.strict=!0),"parseAllBytes"in e||(e.parseAllBytes=!0),"decodeBitStrings"in e||(e.decodeBitStrings=!0),typeof t=="string"&&(t=ct.util.createBuffer(t));var r=t.length(),n=an(t,t.length(),0,e);if(e.parseAllBytes&&t.length()!==0){var i=new Error("Unparsed DER bytes remain after ASN.1 parsing.");throw i.byteCount=r,i.remaining=t.length(),i}return n};function an(t,e,r,n){var i;Rr(t,e,2);var a=t.getByte();e--;var s=a&192,o=a&31;i=t.length();var f=Cc(t,e);if(e-=i-t.length(),f!==void 0&&f>e){if(n.strict){var c=new Error("Too few bytes to read ASN.1 value.");throw c.available=t.length(),c.remaining=e,c.requested=f,c}f=e}var u,h,p=(a&32)===32;if(p)if(u=[],f===void 0)for(;;){if(Rr(t,e,2),t.bytes(2)==="\0\0"){t.getBytes(2),e-=2;break}i=t.length(),u.push(an(t,e,r+1,n)),e-=i-t.length()}else for(;f>0;)i=t.length(),u.push(an(t,f,r+1,n)),e-=i-t.length(),f-=i-t.length();if(u===void 0&&s===P.Class.UNIVERSAL&&o===P.Type.BITSTRING&&(h=t.bytes(f)),u===void 0&&n.decodeBitStrings&&s===P.Class.UNIVERSAL&&o===P.Type.BITSTRING&&f>1){var x=t.read,l=e,d=0;if(o===P.Type.BITSTRING&&(Rr(t,e,1),d=t.getByte(),e--),d===0)try{i=t.length();var y={strict:!0,decodeBitStrings:!0},m=an(t,e,r+1,y),E=i-t.length();e-=E,o==P.Type.BITSTRING&&E++;var b=m.tagClass;E===f&&(b===P.Class.UNIVERSAL||b===P.Class.CONTEXT_SPECIFIC)&&(u=[m])}catch{}u===void 0&&(t.read=x,e=l)}if(u===void 0){if(f===void 0){if(n.strict)throw new Error("Non-constructed ASN.1 object of indefinite length.");f=e}if(o===P.Type.BMPSTRING)for(u="";f>0;f-=2)Rr(t,e,2),u+=String.fromCharCode(t.getInt16()),e-=2;else u=t.getBytes(f),e-=f}var R=h===void 0?null:{bitStringContents:h};return P.create(s,o,p,u,R)}P.toDer=function(t){var e=ct.util.createBuffer(),r=t.tagClass|t.type,n=ct.util.createBuffer(),i=!1;if("bitStringContents"in t&&(i=!0,t.original&&(i=P.equals(t,t.original))),i)n.putBytes(t.bitStringContents);else if(t.composed){t.constructed?r|=32:n.putByte(0);for(var a=0;a<t.value.length;++a)t.value[a]!==void 0&&n.putBuffer(P.toDer(t.value[a]))}else if(t.type===P.Type.BMPSTRING)for(var a=0;a<t.value.length;++a)n.putInt16(t.value.charCodeAt(a));else t.type===P.Type.INTEGER&&t.value.length>1&&(t.value.charCodeAt(0)===0&&!(t.value.charCodeAt(1)&128)||t.value.charCodeAt(0)===255&&(t.value.charCodeAt(1)&128)===128)?n.putBytes(t.value.substr(1)):n.putBytes(t.value);if(e.putByte(r),n.length()<=127)e.putByte(n.length()&127);else{var s=n.length(),o="";do o+=String.fromCharCode(s&255),s=s>>>8;while(s>0);e.putByte(o.length|128);for(var a=o.length-1;a>=0;--a)e.putByte(o.charCodeAt(a))}return e.putBuffer(n),e};P.oidToDer=function(t){var e=t.split("."),r=ct.util.createBuffer();r.putByte(40*parseInt(e[0],10)+parseInt(e[1],10));for(var n,i,a,s,o=2;o<e.length;++o){n=!0,i=[],a=parseInt(e[o],10);do s=a&127,a=a>>>7,n||(s|=128),i.push(s),n=!1;while(a>0);for(var f=i.length-1;f>=0;--f)r.putByte(i[f])}return r};P.derToOid=function(t){var e;typeof t=="string"&&(t=ct.util.createBuffer(t));var r=t.getByte();e=Math.floor(r/40)+"."+r%40;for(var n=0;t.length()>0;)r=t.getByte(),n=n<<7,r&128?n+=r&127:(e+="."+(n+r),n=0);return e};P.utcTimeToDate=function(t){var e=new Date,r=parseInt(t.substr(0,2),10);r=r>=50?1900+r:2e3+r;var n=parseInt(t.substr(2,2),10)-1,i=parseInt(t.substr(4,2),10),a=parseInt(t.substr(6,2),10),s=parseInt(t.substr(8,2),10),o=0;if(t.length>11){var f=t.charAt(10),c=10;f!=="+"&&f!=="-"&&(o=parseInt(t.substr(10,2),10),c+=2)}if(e.setUTCFullYear(r,n,i),e.setUTCHours(a,s,o,0),c&&(f=t.charAt(c),f==="+"||f==="-")){var u=parseInt(t.substr(c+1,2),10),h=parseInt(t.substr(c+4,2),10),p=u*60+h;p*=6e4,f==="+"?e.setTime(+e-p):e.setTime(+e+p)}return e};P.generalizedTimeToDate=function(t){var e=new Date,r=parseInt(t.substr(0,4),10),n=parseInt(t.substr(4,2),10)-1,i=parseInt(t.substr(6,2),10),a=parseInt(t.substr(8,2),10),s=parseInt(t.substr(10,2),10),o=parseInt(t.substr(12,2),10),f=0,c=0,u=!1;t.charAt(t.length-1)==="Z"&&(u=!0);var h=t.length-5,p=t.charAt(h);if(p==="+"||p==="-"){var x=parseInt(t.substr(h+1,2),10),l=parseInt(t.substr(h+4,2),10);c=x*60+l,c*=6e4,p==="+"&&(c*=-1),u=!0}return t.charAt(14)==="."&&(f=parseFloat(t.substr(14),10)*1e3),u?(e.setUTCFullYear(r,n,i),e.setUTCHours(a,s,o,f),e.setTime(+e+c)):(e.setFullYear(r,n,i),e.setHours(a,s,o,f)),e};P.dateToUtcTime=function(t){if(typeof t=="string")return t;var e="",r=[];r.push((""+t.getUTCFullYear()).substr(2)),r.push(""+(t.getUTCMonth()+1)),r.push(""+t.getUTCDate()),r.push(""+t.getUTCHours()),r.push(""+t.getUTCMinutes()),r.push(""+t.getUTCSeconds());for(var n=0;n<r.length;++n)r[n].length<2&&(e+="0"),e+=r[n];return e+="Z",e};P.dateToGeneralizedTime=function(t){if(typeof t=="string")return t;var e="",r=[];r.push(""+t.getUTCFullYear()),r.push(""+(t.getUTCMonth()+1)),r.push(""+t.getUTCDate()),r.push(""+t.getUTCHours()),r.push(""+t.getUTCMinutes()),r.push(""+t.getUTCSeconds());for(var n=0;n<r.length;++n)r[n].length<2&&(e+="0"),e+=r[n];return e+="Z",e};P.integerToDer=function(t){var e=ct.util.createBuffer();if(t>=-128&&t<128)return e.putSignedInt(t,8);if(t>=-32768&&t<32768)return e.putSignedInt(t,16);if(t>=-8388608&&t<8388608)return e.putSignedInt(t,24);if(t>=-2147483648&&t<2147483648)return e.putSignedInt(t,32);var r=new Error("Integer too large; max is 32-bits.");throw r.integer=t,r};P.derToInteger=function(t){typeof t=="string"&&(t=ct.util.createBuffer(t));var e=t.length()*8;if(e>32)throw new Error("Integer too large; max is 32-bits.");return t.getSignedInt(e)};P.validate=function(t,e,r,n){var i=!1;if((t.tagClass===e.tagClass||typeof e.tagClass>"u")&&(t.type===e.type||typeof e.type>"u"))if(t.constructed===e.constructed||typeof e.constructed>"u"){if(i=!0,e.value&&ct.util.isArray(e.value))for(var a=0,s=0;i&&s<e.value.length;++s)i=e.value[s].optional||!1,t.value[a]&&(i=P.validate(t.value[a],e.value[s],r,n),i?++a:e.value[s].optional&&(i=!0)),!i&&n&&n.push("["+e.name+'] Tag class "'+e.tagClass+'", type "'+e.type+'" expected value length "'+e.value.length+'", got "'+t.value.length+'"');if(i&&r&&(e.capture&&(r[e.capture]=t.value),e.captureAsn1&&(r[e.captureAsn1]=t),e.captureBitStringContents&&"bitStringContents"in t&&(r[e.captureBitStringContents]=t.bitStringContents),e.captureBitStringValue&&"bitStringContents"in t)){var o;if(t.bitStringContents.length<2)r[e.captureBitStringValue]="";else{var f=t.bitStringContents.charCodeAt(0);if(f!==0)throw new Error("captureBitStringValue only supported for zero unused bits");r[e.captureBitStringValue]=t.bitStringContents.slice(1)}}}else n&&n.push("["+e.name+'] Expected constructed "'+e.constructed+'", got "'+t.constructed+'"');else n&&(t.tagClass!==e.tagClass&&n.push("["+e.name+'] Expected tag class "'+e.tagClass+'", got "'+t.tagClass+'"'),t.type!==e.type&&n.push("["+e.name+'] Expected type "'+e.type+'", got "'+t.type+'"'));return i};var Ro=/[^\\u0000-\\u00ff]/;P.prettyPrint=function(t,e,r){var n="";e=e||0,r=r||2,e>0&&(n+=`
`);for(var i="",a=0;a<e*r;++a)i+=" ";switch(n+=i+"Tag: ",t.tagClass){case P.Class.UNIVERSAL:n+="Universal:";break;case P.Class.APPLICATION:n+="Application:";break;case P.Class.CONTEXT_SPECIFIC:n+="Context-Specific:";break;case P.Class.PRIVATE:n+="Private:";break}if(t.tagClass===P.Class.UNIVERSAL)switch(n+=t.type,t.type){case P.Type.NONE:n+=" (None)";break;case P.Type.BOOLEAN:n+=" (Boolean)";break;case P.Type.INTEGER:n+=" (Integer)";break;case P.Type.BITSTRING:n+=" (Bit string)";break;case P.Type.OCTETSTRING:n+=" (Octet string)";break;case P.Type.NULL:n+=" (Null)";break;case P.Type.OID:n+=" (Object Identifier)";break;case P.Type.ODESC:n+=" (Object Descriptor)";break;case P.Type.EXTERNAL:n+=" (External or Instance of)";break;case P.Type.REAL:n+=" (Real)";break;case P.Type.ENUMERATED:n+=" (Enumerated)";break;case P.Type.EMBEDDED:n+=" (Embedded PDV)";break;case P.Type.UTF8:n+=" (UTF8)";break;case P.Type.ROID:n+=" (Relative Object Identifier)";break;case P.Type.SEQUENCE:n+=" (Sequence)";break;case P.Type.SET:n+=" (Set)";break;case P.Type.PRINTABLESTRING:n+=" (Printable String)";break;case P.Type.IA5String:n+=" (IA5String (ASCII))";break;case P.Type.UTCTIME:n+=" (UTC time)";break;case P.Type.GENERALIZEDTIME:n+=" (Generalized time)";break;case P.Type.BMPSTRING:n+=" (BMP String)";break}else n+=t.type;if(n+=`
`,n+=i+"Constructed: "+t.constructed+`
`,t.composed){for(var s=0,o="",a=0;a<t.value.length;++a)t.value[a]!==void 0&&(s+=1,o+=P.prettyPrint(t.value[a],e+1,r),a+1<t.value.length&&(o+=","));n+=i+"Sub values: "+s+o}else{if(n+=i+"Value: ",t.type===P.Type.OID){var f=P.derToOid(t.value);n+=f,ct.pki&&ct.pki.oids&&f in ct.pki.oids&&(n+=" ("+ct.pki.oids[f]+") ")}if(t.type===P.Type.INTEGER)try{n+=P.derToInteger(t.value)}catch{n+="0x"+ct.util.bytesToHex(t.value)}else if(t.type===P.Type.BITSTRING){if(t.value.length>1?n+="0x"+ct.util.bytesToHex(t.value.slice(1)):n+="(none)",t.value.length>0){var c=t.value.charCodeAt(0);c==1?n+=" (1 unused bit shown)":c>1&&(n+=" ("+c+" unused bits shown)")}}else if(t.type===P.Type.OCTETSTRING)Ro.test(t.value)||(n+="("+t.value+") "),n+="0x"+ct.util.bytesToHex(t.value);else if(t.type===P.Type.UTF8)try{n+=ct.util.decodeUtf8(t.value)}catch(u){if(u.message==="URI malformed")n+="0x"+ct.util.bytesToHex(t.value)+" (malformed UTF8)";else throw u}else t.type===P.Type.PRINTABLESTRING||t.type===P.Type.IA5String?n+=t.value:Ro.test(t.value)?n+="0x"+ct.util.bytesToHex(t.value):t.value.length===0?n+="[null]":n+=t.value}return n}});var ko=ft((q1,Do)=>{var lt=it();$n();Xn();bt();Do.exports=lt.des=lt.des||{};lt.des.startEncrypting=function(t,e,r,n){var i=on({key:t,output:r,decrypt:!1,mode:n||(e===null?"ECB":"CBC")});return i.start(e),i};lt.des.createEncryptionCipher=function(t,e){return on({key:t,output:null,decrypt:!1,mode:e})};lt.des.startDecrypting=function(t,e,r,n){var i=on({key:t,output:r,decrypt:!0,mode:n||(e===null?"ECB":"CBC")});return i.start(e),i};lt.des.createDecryptionCipher=function(t,e){return on({key:t,output:null,decrypt:!0,mode:e})};lt.des.Algorithm=function(t,e){var r=this;r.name=t,r.mode=new e({blockSize:8,cipher:{encrypt:function(n,i){return No(r._keys,n,i,!1)},decrypt:function(n,i){return No(r._keys,n,i,!0)}}}),r._init=!1};lt.des.Algorithm.prototype.initialize=function(t){if(!this._init){var e=lt.util.createBuffer(t.key);if(this.name.indexOf("3DES")===0&&e.length()!==24)throw new Error("Invalid Triple-DES key size: "+e.length()*8);this._keys=Pc(e),this._init=!0}};ne("DES-ECB",lt.cipher.modes.ecb);ne("DES-CBC",lt.cipher.modes.cbc);ne("DES-CFB",lt.cipher.modes.cfb);ne("DES-OFB",lt.cipher.modes.ofb);ne("DES-CTR",lt.cipher.modes.ctr);ne("3DES-ECB",lt.cipher.modes.ecb);ne("3DES-CBC",lt.cipher.modes.cbc);ne("3DES-CFB",lt.cipher.modes.cfb);ne("3DES-OFB",lt.cipher.modes.ofb);ne("3DES-CTR",lt.cipher.modes.ctr);function ne(t,e){var r=function(){return new lt.des.Algorithm(t,e)};lt.cipher.registerAlgorithm(t,r)}var Ic=[16843776,0,65536,16843780,16842756,66564,4,65536,1024,16843776,16843780,1024,16778244,16842756,16777216,4,1028,16778240,16778240,66560,66560,16842752,16842752,16778244,65540,16777220,16777220,65540,0,1028,66564,16777216,65536,16843780,4,16842752,16843776,16777216,16777216,1024,16842756,65536,66560,16777220,1024,4,16778244,66564,16843780,65540,16842752,16778244,16777220,1028,66564,16843776,1028,16778240,16778240,0,65540,66560,0,16842756],Tc=[-2146402272,-2147450880,32768,1081376,1048576,32,-2146435040,-2147450848,-2147483616,-2146402272,-2146402304,-2147483648,-2147450880,1048576,32,-2146435040,1081344,1048608,-2147450848,0,-2147483648,32768,1081376,-2146435072,1048608,-2147483616,0,1081344,32800,-2146402304,-2146435072,32800,0,1081376,-2146435040,1048576,-2147450848,-2146435072,-2146402304,32768,-2146435072,-2147450880,32,-2146402272,1081376,32,32768,-2147483648,32800,-2146402304,1048576,-2147483616,1048608,-2147450848,-2147483616,1048608,1081344,0,-2147450880,32800,-2147483648,-2146435040,-2146402272,1081344],_c=[520,134349312,0,134348808,134218240,0,131592,134218240,131080,134217736,134217736,131072,134349320,131080,134348800,520,134217728,8,134349312,512,131584,134348800,134348808,131592,134218248,131584,131072,134218248,8,134349320,512,134217728,134349312,134217728,131080,520,131072,134349312,134218240,0,512,131080,134349320,134218240,134217736,512,0,134348808,134218248,131072,134217728,134349320,8,131592,131584,134217736,134348800,134218248,520,134348800,131592,8,134348808,131584],Rc=[8396801,8321,8321,128,8396928,8388737,8388609,8193,0,8396800,8396800,8396929,129,0,8388736,8388609,1,8192,8388608,8396801,128,8388608,8193,8320,8388737,1,8320,8388736,8192,8396928,8396929,129,8388736,8388609,8396800,8396929,129,0,0,8396800,8320,8388736,8388737,1,8396801,8321,8321,128,8396929,129,1,8192,8388609,8193,8396928,8388737,8193,8320,8388608,8396801,128,8388608,8192,8396928],Lc=[256,34078976,34078720,1107296512,524288,256,1073741824,34078720,1074266368,524288,33554688,1074266368,1107296512,1107820544,524544,1073741824,33554432,1074266112,1074266112,0,1073742080,1107820800,1107820800,33554688,1107820544,1073742080,0,1107296256,34078976,33554432,1107296256,524544,524288,1107296512,256,33554432,1073741824,34078720,1107296512,1074266368,33554688,1073741824,1107820544,34078976,1074266368,256,33554432,1107820544,1107820800,524544,1107296256,1107820800,34078720,0,1074266112,1107296256,524544,33554688,1073742080,524288,0,1074266112,34078976,1073742080],Nc=[536870928,541065216,16384,541081616,541065216,16,541081616,4194304,536887296,4210704,4194304,536870928,4194320,536887296,536870912,16400,0,4194320,536887312,16384,4210688,536887312,16,541065232,541065232,0,4210704,541081600,16400,4210688,541081600,536870912,536887296,16,541065232,4210688,541081616,4194304,16400,536870928,4194304,536887296,536870912,16400,536870928,541081616,4210688,541065216,4210704,541081600,0,541065232,16,16384,541065216,4210704,16384,4194320,536887312,0,541081600,536870912,4194320,536887312],Dc=[2097152,69206018,67110914,0,2048,67110914,2099202,69208064,69208066,2097152,0,67108866,2,67108864,69206018,2050,67110912,2099202,2097154,67110912,67108866,69206016,69208064,2097154,69206016,2048,2050,69208066,2099200,2,67108864,2099200,67108864,2099200,2097152,67110914,67110914,69206018,69206018,2,2097154,67108864,67110912,2097152,69208064,2050,2099202,69208064,2050,67108866,69208066,69206016,2099200,0,2,69208066,0,2099202,69206016,2048,67108866,67110912,2048,2097154],kc=[268439616,4096,262144,268701760,268435456,268439616,64,268435456,262208,268697600,268701760,266240,268701696,266304,4096,64,268697600,268435520,268439552,4160,266240,262208,268697664,268701696,4160,0,0,268697664,268435520,268439552,266304,262144,266304,262144,268701696,4096,64,268697664,4096,266304,268439552,64,268435520,268697600,268697664,268435456,262144,268439616,0,268701760,262208,268435520,268697600,268439552,268439616,0,268701760,266240,266240,4160,4160,262208,268435456,268701696];function Pc(t){for(var e=[0,4,536870912,536870916,65536,65540,536936448,536936452,512,516,536871424,536871428,66048,66052,536936960,536936964],r=[0,1,1048576,1048577,67108864,67108865,68157440,68157441,256,257,1048832,1048833,67109120,67109121,68157696,68157697],n=[0,8,2048,2056,16777216,16777224,16779264,16779272,0,8,2048,2056,16777216,16777224,16779264,16779272],i=[0,2097152,134217728,136314880,8192,2105344,134225920,136323072,131072,2228224,134348800,136445952,139264,2236416,134356992,136454144],a=[0,262144,16,262160,0,262144,16,262160,4096,266240,4112,266256,4096,266240,4112,266256],s=[0,1024,32,1056,0,1024,32,1056,33554432,33555456,33554464,33555488,33554432,33555456,33554464,33555488],o=[0,268435456,524288,268959744,2,268435458,524290,268959746,0,268435456,524288,268959744,2,268435458,524290,268959746],f=[0,65536,2048,67584,536870912,536936448,536872960,536938496,131072,196608,133120,198656,537001984,537067520,537004032,537069568],c=[0,262144,0,262144,2,262146,2,262146,33554432,33816576,33554432,33816576,33554434,33816578,33554434,33816578],u=[0,268435456,8,268435464,0,268435456,8,268435464,1024,268436480,1032,268436488,1024,268436480,1032,268436488],h=[0,32,0,32,1048576,1048608,1048576,1048608,8192,8224,8192,8224,1056768,1056800,1056768,1056800],p=[0,16777216,512,16777728,2097152,18874368,2097664,18874880,67108864,83886080,67109376,83886592,69206016,85983232,69206528,85983744],x=[0,4096,134217728,134221824,524288,528384,134742016,134746112,16,4112,134217744,134221840,524304,528400,134742032,134746128],l=[0,4,256,260,0,4,256,260,1,5,257,261,1,5,257,261],d=t.length()>8?3:1,y=[],m=[0,0,1,1,1,1,1,1,0,1,1,1,1,1,1,0],E=0,b,R=0;R<d;R++){var w=t.getInt32(),S=t.getInt32();b=(w>>>4^S)&252645135,S^=b,w^=b<<4,b=(S>>>-16^w)&65535,w^=b,S^=b<<-16,b=(w>>>2^S)&858993459,S^=b,w^=b<<2,b=(S>>>-16^w)&65535,w^=b,S^=b<<-16,b=(w>>>1^S)&1431655765,S^=b,w^=b<<1,b=(S>>>8^w)&16711935,w^=b,S^=b<<8,b=(w>>>1^S)&1431655765,S^=b,w^=b<<1,b=w<<8|S>>>20&240,w=S<<24|S<<8&16711680|S>>>8&65280|S>>>24&240,S=b;for(var L=0;L<m.length;++L){m[L]?(w=w<<2|w>>>26,S=S<<2|S>>>26):(w=w<<1|w>>>27,S=S<<1|S>>>27),w&=-15,S&=-15;var N=e[w>>>28]|r[w>>>24&15]|n[w>>>20&15]|i[w>>>16&15]|a[w>>>12&15]|s[w>>>8&15]|o[w>>>4&15],z=f[S>>>28]|c[S>>>24&15]|u[S>>>20&15]|h[S>>>16&15]|p[S>>>12&15]|x[S>>>8&15]|l[S>>>4&15];b=(z>>>16^N)&65535,y[E++]=N^b,y[E++]=z^b<<16}}return y}function No(t,e,r,n){var i=t.length===32?3:9,a;i===3?a=n?[30,-2,-2]:[0,32,2]:a=n?[94,62,-2,32,64,2,30,-2,-2]:[0,32,2,62,30,-2,64,96,2];var s,o=e[0],f=e[1];s=(o>>>4^f)&252645135,f^=s,o^=s<<4,s=(o>>>16^f)&65535,f^=s,o^=s<<16,s=(f>>>2^o)&858993459,o^=s,f^=s<<2,s=(f>>>8^o)&16711935,o^=s,f^=s<<8,s=(o>>>1^f)&1431655765,f^=s,o^=s<<1,o=o<<1|o>>>31,f=f<<1|f>>>31;for(var c=0;c<i;c+=3){for(var u=a[c+1],h=a[c+2],p=a[c];p!=u;p+=h){var x=f^t[p],l=(f>>>4|f<<28)^t[p+1];s=o,o=f,f=s^(Tc[x>>>24&63]|Rc[x>>>16&63]|Nc[x>>>8&63]|kc[x&63]|Ic[l>>>24&63]|_c[l>>>16&63]|Lc[l>>>8&63]|Dc[l&63])}s=o,o=f,f=s}o=o>>>1|o<<31,f=f>>>1|f<<31,s=(o>>>1^f)&1431655765,f^=s,o^=s<<1,s=(f>>>8^o)&16711935,o^=s,f^=s<<8,s=(f>>>2^o)&858993459,o^=s,f^=s<<2,s=(o>>>16^f)&65535,f^=s,o^=s<<16,s=(o>>>4^f)&252645135,f^=s,o^=s<<4,r[0]=o,r[1]=f}function on(t){t=t||{};var e=(t.mode||"CBC").toUpperCase(),r="DES-"+e,n;t.decrypt?n=lt.cipher.createDecipher(r,t.key):n=lt.cipher.createCipher(r,t.key);var i=n.start;return n.start=function(a,s){var o=null;s instanceof lt.util.ByteBuffer&&(o=s,s={}),s=s||{},s.output=o,s.iv=a,i.call(n,s)},n}});var qe=ft((F1,Po)=>{var sn=it();Po.exports=sn.md=sn.md||{};sn.md.algorithms=sn.md.algorithms||{}});var Ko=ft((H1,Uo)=>{var ye=it();qe();bt();var Uc=Uo.exports=ye.hmac=ye.hmac||{};Uc.create=function(){var t=null,e=null,r=null,n=null,i={};return i.start=function(a,s){if(a!==null)if(typeof a=="string")if(a=a.toLowerCase(),a in ye.md.algorithms)e=ye.md.algorithms[a].create();else throw new Error('Unknown hash algorithm "'+a+'"');else e=a;if(s===null)s=t;else{if(typeof s=="string")s=ye.util.createBuffer(s);else if(ye.util.isArray(s)){var o=s;s=ye.util.createBuffer();for(var f=0;f<o.length;++f)s.putByte(o[f])}var c=s.length();c>e.blockLength&&(e.start(),e.update(s.bytes()),s=e.digest()),r=ye.util.createBuffer(),n=ye.util.createBuffer(),c=s.length();for(var f=0;f<c;++f){var o=s.at(f);r.putByte(54^o),n.putByte(92^o)}if(c<e.blockLength)for(var o=e.blockLength-c,f=0;f<o;++f)r.putByte(54),n.putByte(92);t=s,r=r.bytes(),n=n.bytes()}e.start(),e.update(r)},i.update=function(a){e.update(a)},i.getMac=function(){var a=e.digest().bytes();return e.start(),e.update(n),e.update(a),e.digest()},i.digest=i.getMac,i}});var fn=ft(()=>{});var Ii=ft((W1,Oo)=>{var Ut=it();Ko();qe();bt();var Kc=Ut.pkcs5=Ut.pkcs5||{},xe;Ut.util.isNodejs&&!Ut.options.usePureJavaScript&&(xe=fn());Oo.exports=Ut.pbkdf2=Kc.pbkdf2=function(t,e,r,n,i,a){if(typeof i=="function"&&(a=i,i=null),Ut.util.isNodejs&&!Ut.options.usePureJavaScript&&xe.pbkdf2&&(i===null||typeof i!="object")&&(xe.pbkdf2Sync.length>4||!i||i==="sha1"))return typeof i!="string"&&(i="sha1"),t=Buffer.from(t,"binary"),e=Buffer.from(e,"binary"),a?xe.pbkdf2Sync.length===4?xe.pbkdf2(t,e,r,n,function(b,R){if(b)return a(b);a(null,R.toString("binary"))}):xe.pbkdf2(t,e,r,n,i,function(b,R){if(b)return a(b);a(null,R.toString("binary"))}):xe.pbkdf2Sync.length===4?xe.pbkdf2Sync(t,e,r,n).toString("binary"):xe.pbkdf2Sync(t,e,r,n,i).toString("binary");if((typeof i>"u"||i===null)&&(i="sha1"),typeof i=="string"){if(!(i in Ut.md.algorithms))throw new Error("Unknown hash algorithm: "+i);i=Ut.md[i].create()}var s=i.digestLength;if(n>4294967295*s){var o=new Error("Derived key is too long.");if(a)return a(o);throw o}var f=Math.ceil(n/s),c=n-(f-1)*s,u=Ut.hmac.create();u.start(i,t);var h="",p,x,l;if(!a){for(var d=1;d<=f;++d){u.start(null,null),u.update(e),u.update(Ut.util.int32ToBytes(d)),p=l=u.digest().getBytes();for(var y=2;y<=r;++y)u.start(null,null),u.update(l),x=u.digest().getBytes(),p=Ut.util.xorBytes(p,x,s),l=x;h+=d<f?p:p.substr(0,c)}return h}var d=1,y;function m(){if(d>f)return a(null,h);u.start(null,null),u.update(e),u.update(Ut.util.int32ToBytes(d)),p=l=u.digest().getBytes(),y=2,E()}function E(){if(y<=r)return u.start(null,null),u.update(l),x=u.digest().getBytes(),p=Ut.util.xorBytes(p,x,s),l=x,++y,Ut.util.setImmediate(E);h+=d<f?p:p.substr(0,c),++d,m()}m()}});var qo=ft((Y1,Vo)=>{var un=it();bt();var Mo=Vo.exports=un.pem=un.pem||{};Mo.encode=function(t,e){e=e||{};var r="-----BEGIN "+t.type+`-----\r
`,n;if(t.procType&&(n={name:"Proc-Type",values:[String(t.procType.version),t.procType.type]},r+=cn(n)),t.contentDomain&&(n={name:"Content-Domain",values:[t.contentDomain]},r+=cn(n)),t.dekInfo&&(n={name:"DEK-Info",values:[t.dekInfo.algorithm]},t.dekInfo.parameters&&n.values.push(t.dekInfo.parameters),r+=cn(n)),t.headers)for(var i=0;i<t.headers.length;++i)r+=cn(t.headers[i]);return t.procType&&(r+=`\r
`),r+=un.util.encode64(t.body,e.maxline||64)+`\r
`,r+="-----END "+t.type+`-----\r
`,r};Mo.decode=function(t){for(var e=[],r=/\s*-----BEGIN ([A-Z0-9- ]+)-----\r?\n?([\x21-\x7e\s]+?(?:\r?\n\r?\n))?([:A-Za-z0-9+\/=\s]+?)-----END \1-----/g,n=/([\x21-\x7e]+):\s*([\x21-\x7e\s^:]+)/,i=/\r?\n/,a;a=r.exec(t),!!a;){var s=a[1];s==="NEW CERTIFICATE REQUEST"&&(s="CERTIFICATE REQUEST");var o={type:s,procType:null,contentDomain:null,dekInfo:null,headers:[],body:un.util.decode64(a[3])};if(e.push(o),!!a[2]){for(var f=a[2].split(i),c=0;a&&c<f.length;){for(var u=f[c].replace(/\s+$/,""),h=c+1;h<f.length;++h){var p=f[h];if(!/\s/.test(p[0]))break;u+=p,c=h}if(a=u.match(n),a){for(var x={name:a[1],values:[]},l=a[2].split(","),d=0;d<l.length;++d)x.values.push(Oc(l[d]));if(o.procType)if(!o.contentDomain&&x.name==="Content-Domain")o.contentDomain=l[0]||"";else if(!o.dekInfo&&x.name==="DEK-Info"){if(x.values.length===0)throw new Error('Invalid PEM formatted message. The "DEK-Info" header must have at least one subfield.');o.dekInfo={algorithm:l[0],parameters:l[1]||null}}else o.headers.push(x);else{if(x.name!=="Proc-Type")throw new Error('Invalid PEM formatted message. The first encapsulated header must be "Proc-Type".');if(x.values.length!==2)throw new Error('Invalid PEM formatted message. The "Proc-Type" header must have two subfields.');o.procType={version:l[0],type:l[1]}}}++c}if(o.procType==="ENCRYPTED"&&!o.dekInfo)throw new Error('Invalid PEM formatted message. The "DEK-Info" header must be present if "Proc-Type" is "ENCRYPTED".')}}if(e.length===0)throw new Error("Invalid PEM formatted message.");return e};function cn(t){for(var e=t.name+": ",r=[],n=function(f,c){return" "+c},i=0;i<t.values.length;++i)r.push(t.values[i].replace(/^(\S+\r\n)/,n));e+=r.join(",")+`\r
`;for(var a=0,s=-1,i=0;i<e.length;++i,++a)if(a>65&&s!==-1){var o=e[s];o===","?(++s,e=e.substr(0,s)+`\r
 `+e.substr(s)):e=e.substr(0,s)+`\r
`+o+e.substr(s+1),a=i-s-1,s=-1,++i}else(e[i]===" "||e[i]==="	"||e[i]===",")&&(s=i);return e}function Oc(t){return t.replace(/^\s+/,"")}});var Yo=ft((Z1,Wo)=>{var ie=it();qe();bt();var Ho=Wo.exports=ie.sha256=ie.sha256||{};ie.md.sha256=ie.md.algorithms.sha256=Ho;Ho.create=function(){zo||Mc();var t=null,e=ie.util.createBuffer(),r=new Array(64),n={algorithm:"sha256",blockLength:64,digestLength:32,messageLength:0,fullMessageLength:null,messageLengthSize:8};return n.start=function(){n.messageLength=0,n.fullMessageLength=n.messageLength64=[];for(var i=n.messageLengthSize/4,a=0;a<i;++a)n.fullMessageLength.push(0);return e=ie.util.createBuffer(),t={h0:1779033703,h1:3144134277,h2:1013904242,h3:2773480762,h4:1359893119,h5:2600822924,h6:528734635,h7:1541459225},n},n.start(),n.update=function(i,a){a==="utf8"&&(i=ie.util.encodeUtf8(i));var s=i.length;n.messageLength+=s,s=[s/4294967296>>>0,s>>>0];for(var o=n.fullMessageLength.length-1;o>=0;--o)n.fullMessageLength[o]+=s[1],s[1]=s[0]+(n.fullMessageLength[o]/4294967296>>>0),n.fullMessageLength[o]=n.fullMessageLength[o]>>>0,s[0]=s[1]/4294967296>>>0;return e.putBytes(i),Fo(t,r,e),(e.read>2048||e.length()===0)&&e.compact(),n},n.digest=function(){var i=ie.util.createBuffer();i.putBytes(e.bytes());var a=n.fullMessageLength[n.fullMessageLength.length-1]+n.messageLengthSize,s=a&n.blockLength-1;i.putBytes(Ti.substr(0,n.blockLength-s));for(var o,f,c=n.fullMessageLength[0]*8,u=0;u<n.fullMessageLength.length-1;++u)o=n.fullMessageLength[u+1]*8,f=o/4294967296>>>0,c+=f,i.putInt32(c>>>0),c=o>>>0;i.putInt32(c);var h={h0:t.h0,h1:t.h1,h2:t.h2,h3:t.h3,h4:t.h4,h5:t.h5,h6:t.h6,h7:t.h7};Fo(h,r,i);var p=ie.util.createBuffer();return p.putInt32(h.h0),p.putInt32(h.h1),p.putInt32(h.h2),p.putInt32(h.h3),p.putInt32(h.h4),p.putInt32(h.h5),p.putInt32(h.h6),p.putInt32(h.h7),p},n};var Ti=null,zo=!1,Go=null;function Mc(){Ti="\x80",Ti+=ie.util.fillString("\0",64),Go=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298],zo=!0}function Fo(t,e,r){for(var n,i,a,s,o,f,c,u,h,p,x,l,d,y,m,E=r.length();E>=64;){for(c=0;c<16;++c)e[c]=r.getInt32();for(;c<64;++c)n=e[c-2],n=(n>>>17|n<<15)^(n>>>19|n<<13)^n>>>10,i=e[c-15],i=(i>>>7|i<<25)^(i>>>18|i<<14)^i>>>3,e[c]=n+e[c-7]+i+e[c-16]|0;for(u=t.h0,h=t.h1,p=t.h2,x=t.h3,l=t.h4,d=t.h5,y=t.h6,m=t.h7,c=0;c<64;++c)s=(l>>>6|l<<26)^(l>>>11|l<<21)^(l>>>25|l<<7),o=y^l&(d^y),a=(u>>>2|u<<30)^(u>>>13|u<<19)^(u>>>22|u<<10),f=u&h|p&(u^h),n=m+s+o+Go[c]+e[c],i=a+f,m=y,y=d,d=l,l=x+n>>>0,x=p,p=h,h=u,u=n+i>>>0;t.h0=t.h0+u|0,t.h1=t.h1+h|0,t.h2=t.h2+p|0,t.h3=t.h3+x|0,t.h4=t.h4+l|0,t.h5=t.h5+d|0,t.h6=t.h6+y|0,t.h7=t.h7+m|0,E-=64}}});var $o=ft(($1,Zo)=>{var ae=it();bt();var hn=null;ae.util.isNodejs&&!ae.options.usePureJavaScript&&!process.versions["node-webkit"]&&(hn=fn());var Vc=Zo.exports=ae.prng=ae.prng||{};Vc.create=function(t){for(var e={plugin:t,key:null,seed:null,time:null,reseeds:0,generated:0,keyBytes:""},r=t.md,n=new Array(32),i=0;i<32;++i)n[i]=r.create();e.pools=n,e.pool=0,e.generate=function(c,u){if(!u)return e.generateSync(c);var h=e.plugin.cipher,p=e.plugin.increment,x=e.plugin.formatKey,l=e.plugin.formatSeed,d=ae.util.createBuffer();e.key=null,y();function y(m){if(m)return u(m);if(d.length()>=c)return u(null,d.getBytes(c));if(e.generated>1048575&&(e.key=null),e.key===null)return ae.util.nextTick(function(){a(y)});var E=h(e.key,e.seed);e.generated+=E.length,d.putBytes(E),e.key=x(h(e.key,p(e.seed))),e.seed=l(h(e.key,e.seed)),ae.util.setImmediate(y)}},e.generateSync=function(c){var u=e.plugin.cipher,h=e.plugin.increment,p=e.plugin.formatKey,x=e.plugin.formatSeed;e.key=null;for(var l=ae.util.createBuffer();l.length()<c;){e.generated>1048575&&(e.key=null),e.key===null&&s();var d=u(e.key,e.seed);e.generated+=d.length,l.putBytes(d),e.key=p(u(e.key,h(e.seed))),e.seed=x(u(e.key,e.seed))}return l.getBytes(c)};function a(c){if(e.pools[0].messageLength>=32)return o(),c();var u=32-e.pools[0].messageLength<<5;e.seedFile(u,function(h,p){if(h)return c(h);e.collect(p),o(),c()})}function s(){if(e.pools[0].messageLength>=32)return o();var c=32-e.pools[0].messageLength<<5;e.collect(e.seedFileSync(c)),o()}function o(){e.reseeds=e.reseeds===4294967295?0:e.reseeds+1;var c=e.plugin.md.create();c.update(e.keyBytes);for(var u=1,h=0;h<32;++h)e.reseeds%u===0&&(c.update(e.pools[h].digest().getBytes()),e.pools[h].start()),u=u<<1;e.keyBytes=c.digest().getBytes(),c.start(),c.update(e.keyBytes);var p=c.digest().getBytes();e.key=e.plugin.formatKey(e.keyBytes),e.seed=e.plugin.formatSeed(p),e.generated=0}function f(c){var u=null,h=ae.util.globalScope,p=h.crypto||h.msCrypto;p&&p.getRandomValues&&(u=function(w){return p.getRandomValues(w)});var x=ae.util.createBuffer();if(u)for(;x.length()<c;){var l=Math.max(1,Math.min(c-x.length(),65536)/4),d=new Uint32Array(Math.floor(l));try{u(d);for(var y=0;y<d.length;++y)x.putInt32(d[y])}catch(w){if(!(typeof QuotaExceededError<"u"&&w instanceof QuotaExceededError))throw w}}if(x.length()<c)for(var m,E,b,R=Math.floor(Math.random()*65536);x.length()<c;){E=16807*(R&65535),m=16807*(R>>16),E+=(m&32767)<<16,E+=m>>15,E=(E&2147483647)+(E>>31),R=E&4294967295;for(var y=0;y<3;++y)b=R>>>(y<<3),b^=Math.floor(Math.random()*256),x.putByte(b&255)}return x.getBytes(c)}return hn?(e.seedFile=function(c,u){hn.randomBytes(c,function(h,p){if(h)return u(h);u(null,p.toString())})},e.seedFileSync=function(c){return hn.randomBytes(c).toString()}):(e.seedFile=function(c,u){try{u(null,f(c))}catch(h){u(h)}},e.seedFileSync=f),e.collect=function(c){for(var u=c.length,h=0;h<u;++h)e.pools[e.pool].update(c.substr(h,1)),e.pool=e.pool===31?0:e.pool+1},e.collectInt=function(c,u){for(var h="",p=0;p<u;p+=8)h+=String.fromCharCode(c>>p&255);e.collect(h)},e.registerWorker=function(c){if(c===self)e.seedFile=function(h,p){function x(l){var d=l.data;d.forge&&d.forge.prng&&(self.removeEventListener("message",x),p(d.forge.prng.err,d.forge.prng.bytes))}self.addEventListener("message",x),self.postMessage({forge:{prng:{needed:h}}})};else{var u=function(h){var p=h.data;p.forge&&p.forge.prng&&e.seedFile(p.forge.prng.needed,function(x,l){c.postMessage({forge:{prng:{err:x,bytes:l}}})})};c.addEventListener("message",u)}},e}});var Nr=ft((Q1,_i)=>{var Tt=it();Jr();Yo();$o();bt();(function(){if(Tt.random&&Tt.random.getBytes){_i.exports=Tt.random;return}(function(t){var e={},r=new Array(4),n=Tt.util.createBuffer();e.formatKey=function(h){var p=Tt.util.createBuffer(h);return h=new Array(4),h[0]=p.getInt32(),h[1]=p.getInt32(),h[2]=p.getInt32(),h[3]=p.getInt32(),Tt.aes._expandKey(h,!1)},e.formatSeed=function(h){var p=Tt.util.createBuffer(h);return h=new Array(4),h[0]=p.getInt32(),h[1]=p.getInt32(),h[2]=p.getInt32(),h[3]=p.getInt32(),h},e.cipher=function(h,p){return Tt.aes._updateBlock(h,p,r,!1),n.putInt32(r[0]),n.putInt32(r[1]),n.putInt32(r[2]),n.putInt32(r[3]),n.getBytes()},e.increment=function(h){return++h[3],h},e.md=Tt.md.sha256;function i(){var h=Tt.prng.create(e);return h.getBytes=function(p,x){return h.generate(p,x)},h.getBytesSync=function(p){return h.generate(p)},h}var a=i(),s=null,o=Tt.util.globalScope,f=o.crypto||o.msCrypto;if(f&&f.getRandomValues&&(s=function(h){return f.getRandomValues(h)}),Tt.options.usePureJavaScript||!Tt.util.isNodejs&&!s){if(typeof window>"u"||window.document,a.collectInt(+new Date,32),typeof navigator<"u"){var c="";for(var u in navigator)try{typeof navigator[u]=="string"&&(c+=navigator[u])}catch{}a.collect(c),c=null}t&&(t().mousemove(function(h){a.collectInt(h.clientX,16),a.collectInt(h.clientY,16)}),t().keypress(function(h){a.collectInt(h.charCode,8)}))}if(!Tt.random)Tt.random=a;else for(var u in a)Tt.random[u]=a[u];Tt.random.createInstance=i,_i.exports=Tt.random})(typeof jQuery<"u"?jQuery:null)})()});var jo=ft((X1,Jo)=>{var Kt=it();bt();var Ri=[217,120,249,196,25,221,181,237,40,233,253,121,74,160,216,157,198,126,55,131,43,118,83,142,98,76,100,136,68,139,251,162,23,154,89,245,135,179,79,19,97,69,109,141,9,129,125,50,189,143,64,235,134,183,123,11,240,149,33,34,92,107,78,130,84,214,101,147,206,96,178,28,115,86,192,20,167,140,241,220,18,117,202,31,59,190,228,209,66,61,212,48,163,60,182,38,111,191,14,218,70,105,7,87,39,242,29,155,188,148,67,3,248,17,199,246,144,239,62,231,6,195,213,47,200,102,30,215,8,232,234,222,128,82,238,247,132,170,114,172,53,77,106,42,150,26,210,113,90,21,73,116,75,159,208,94,4,24,164,236,194,224,65,110,15,81,203,204,36,145,175,80,161,244,112,57,153,124,58,133,35,184,180,122,252,2,54,91,37,85,151,49,45,93,250,152,227,138,146,174,5,223,41,16,103,108,186,201,211,0,230,207,225,158,168,44,99,22,1,63,88,226,137,169,13,56,52,27,171,51,255,176,187,72,12,95,185,177,205,46,197,243,219,71,229,165,156,119,10,166,32,104,254,127,193,173],Qo=[1,2,3,5],qc=function(t,e){return t<<e&65535|(t&65535)>>16-e},Fc=function(t,e){return(t&65535)>>e|t<<16-e&65535};Jo.exports=Kt.rc2=Kt.rc2||{};Kt.rc2.expandKey=function(t,e){typeof t=="string"&&(t=Kt.util.createBuffer(t)),e=e||128;var r=t,n=t.length(),i=e,a=Math.ceil(i/8),s=255>>(i&7),o;for(o=n;o<128;o++)r.putByte(Ri[r.at(o-1)+r.at(o-n)&255]);for(r.setAt(128-a,Ri[r.at(128-a)&s]),o=127-a;o>=0;o--)r.setAt(o,Ri[r.at(o+1)^r.at(o+a)]);return r};var Xo=function(t,e,r){var n=!1,i=null,a=null,s=null,o,f,c,u,h=[];for(t=Kt.rc2.expandKey(t,e),c=0;c<64;c++)h.push(t.getInt16Le());r?(o=function(l){for(c=0;c<4;c++)l[c]+=h[u]+(l[(c+3)%4]&l[(c+2)%4])+(~l[(c+3)%4]&l[(c+1)%4]),l[c]=qc(l[c],Qo[c]),u++},f=function(l){for(c=0;c<4;c++)l[c]+=h[l[(c+3)%4]&63]}):(o=function(l){for(c=3;c>=0;c--)l[c]=Fc(l[c],Qo[c]),l[c]-=h[u]+(l[(c+3)%4]&l[(c+2)%4])+(~l[(c+3)%4]&l[(c+1)%4]),u--},f=function(l){for(c=3;c>=0;c--)l[c]-=h[l[(c+3)%4]&63]});var p=function(l){var d=[];for(c=0;c<4;c++){var y=i.getInt16Le();s!==null&&(r?y^=s.getInt16Le():s.putInt16Le(y)),d.push(y&65535)}u=r?0:63;for(var m=0;m<l.length;m++)for(var E=0;E<l[m][0];E++)l[m][1](d);for(c=0;c<4;c++)s!==null&&(r?s.putInt16Le(d[c]):d[c]^=s.getInt16Le()),a.putInt16Le(d[c])},x=null;return x={start:function(l,d){l&&typeof l=="string"&&(l=Kt.util.createBuffer(l)),n=!1,i=Kt.util.createBuffer(),a=d||new Kt.util.createBuffer,s=l,x.output=a},update:function(l){for(n||i.putBuffer(l);i.length()>=8;)p([[5,o],[1,f],[6,o],[1,f],[5,o]])},finish:function(l){var d=!0;if(r)if(l)d=l(8,i,!r);else{var y=i.length()===8?8:8-i.length();i.fillWithByte(y,y)}if(d&&(n=!0,x.update()),!r&&(d=i.length()===0,d))if(l)d=l(8,a,!r);else{var m=a.length(),E=a.at(m-1);E>m?d=!1:a.truncate(E)}return d}},x};Kt.rc2.startEncrypting=function(t,e,r){var n=Kt.rc2.createEncryptionCipher(t,128);return n.start(e,r),n};Kt.rc2.createEncryptionCipher=function(t,e){return Xo(t,e,!0)};Kt.rc2.startDecrypting=function(t,e,r){var n=Kt.rc2.createDecryptionCipher(t,128);return n.start(e,r),n};Kt.rc2.createDecryptionCipher=function(t,e){return Xo(t,e,!1)}});var dn=ft((J1,ss)=>{var Li=it();ss.exports=Li.jsbn=Li.jsbn||{};var ge,Hc=0xdeadbeefcafe,ts=(Hc&16777215)==15715070;function C(t,e,r){this.data=[],t!=null&&(typeof t=="number"?this.fromNumber(t,e,r):e==null&&typeof t!="string"?this.fromString(t,256):this.fromString(t,e))}Li.jsbn.BigInteger=C;function tt(){return new C(null)}function zc(t,e,r,n,i,a){for(;--a>=0;){var s=e*this.data[t++]+r.data[n]+i;i=Math.floor(s/67108864),r.data[n++]=s&67108863}return i}function Gc(t,e,r,n,i,a){for(var s=e&32767,o=e>>15;--a>=0;){var f=this.data[t]&32767,c=this.data[t++]>>15,u=o*f+c*s;f=s*f+((u&32767)<<15)+r.data[n]+(i&1073741823),i=(f>>>30)+(u>>>15)+o*c+(i>>>30),r.data[n++]=f&1073741823}return i}function es(t,e,r,n,i,a){for(var s=e&16383,o=e>>14;--a>=0;){var f=this.data[t]&16383,c=this.data[t++]>>14,u=o*f+c*s;f=s*f+((u&16383)<<14)+r.data[n]+i,i=(f>>28)+(u>>14)+o*c,r.data[n++]=f&268435455}return i}typeof navigator>"u"?(C.prototype.am=es,ge=28):ts&&navigator.appName=="Microsoft Internet Explorer"?(C.prototype.am=Gc,ge=30):ts&&navigator.appName!="Netscape"?(C.prototype.am=zc,ge=26):(C.prototype.am=es,ge=28);C.prototype.DB=ge;C.prototype.DM=(1<<ge)-1;C.prototype.DV=1<<ge;var Ni=52;C.prototype.FV=Math.pow(2,Ni);C.prototype.F1=Ni-ge;C.prototype.F2=2*ge-Ni;var Wc="0123456789abcdefghijklmnopqrstuvwxyz",ln=new Array,sr,Ht;sr=48;for(Ht=0;Ht<=9;++Ht)ln[sr++]=Ht;sr=97;for(Ht=10;Ht<36;++Ht)ln[sr++]=Ht;sr=65;for(Ht=10;Ht<36;++Ht)ln[sr++]=Ht;function rs(t){return Wc.charAt(t)}function ns(t,e){var r=ln[t.charCodeAt(e)];return r??-1}function Yc(t){for(var e=this.t-1;e>=0;--e)t.data[e]=this.data[e];t.t=this.t,t.s=this.s}function Zc(t){this.t=1,this.s=t<0?-1:0,t>0?this.data[0]=t:t<-1?this.data[0]=t+this.DV:this.t=0}function Te(t){var e=tt();return e.fromInt(t),e}function $c(t,e){var r;if(e==16)r=4;else if(e==8)r=3;else if(e==256)r=8;else if(e==2)r=1;else if(e==32)r=5;else if(e==4)r=2;else{this.fromRadix(t,e);return}this.t=0,this.s=0;for(var n=t.length,i=!1,a=0;--n>=0;){var s=r==8?t[n]&255:ns(t,n);if(s<0){t.charAt(n)=="-"&&(i=!0);continue}i=!1,a==0?this.data[this.t++]=s:a+r>this.DB?(this.data[this.t-1]|=(s&(1<<this.DB-a)-1)<<a,this.data[this.t++]=s>>this.DB-a):this.data[this.t-1]|=s<<a,a+=r,a>=this.DB&&(a-=this.DB)}r==8&&t[0]&128&&(this.s=-1,a>0&&(this.data[this.t-1]|=(1<<this.DB-a)-1<<a)),this.clamp(),i&&C.ZERO.subTo(this,this)}function Qc(){for(var t=this.s&this.DM;this.t>0&&this.data[this.t-1]==t;)--this.t}function Xc(t){if(this.s<0)return"-"+this.negate().toString(t);var e;if(t==16)e=4;else if(t==8)e=3;else if(t==2)e=1;else if(t==32)e=5;else if(t==4)e=2;else return this.toRadix(t);var r=(1<<e)-1,n,i=!1,a="",s=this.t,o=this.DB-s*this.DB%e;if(s-- >0)for(o<this.DB&&(n=this.data[s]>>o)>0&&(i=!0,a=rs(n));s>=0;)o<e?(n=(this.data[s]&(1<<o)-1)<<e-o,n|=this.data[--s]>>(o+=this.DB-e)):(n=this.data[s]>>(o-=e)&r,o<=0&&(o+=this.DB,--s)),n>0&&(i=!0),i&&(a+=rs(n));return i?a:"0"}function Jc(){var t=tt();return C.ZERO.subTo(this,t),t}function jc(){return this.s<0?this.negate():this}function tu(t){var e=this.s-t.s;if(e!=0)return e;var r=this.t;if(e=r-t.t,e!=0)return this.s<0?-e:e;for(;--r>=0;)if((e=this.data[r]-t.data[r])!=0)return e;return 0}function pn(t){var e=1,r;return(r=t>>>16)!=0&&(t=r,e+=16),(r=t>>8)!=0&&(t=r,e+=8),(r=t>>4)!=0&&(t=r,e+=4),(r=t>>2)!=0&&(t=r,e+=2),(r=t>>1)!=0&&(t=r,e+=1),e}function eu(){return this.t<=0?0:this.DB*(this.t-1)+pn(this.data[this.t-1]^this.s&this.DM)}function ru(t,e){var r;for(r=this.t-1;r>=0;--r)e.data[r+t]=this.data[r];for(r=t-1;r>=0;--r)e.data[r]=0;e.t=this.t+t,e.s=this.s}function nu(t,e){for(var r=t;r<this.t;++r)e.data[r-t]=this.data[r];e.t=Math.max(this.t-t,0),e.s=this.s}function iu(t,e){var r=t%this.DB,n=this.DB-r,i=(1<<n)-1,a=Math.floor(t/this.DB),s=this.s<<r&this.DM,o;for(o=this.t-1;o>=0;--o)e.data[o+a+1]=this.data[o]>>n|s,s=(this.data[o]&i)<<r;for(o=a-1;o>=0;--o)e.data[o]=0;e.data[a]=s,e.t=this.t+a+1,e.s=this.s,e.clamp()}function au(t,e){e.s=this.s;var r=Math.floor(t/this.DB);if(r>=this.t){e.t=0;return}var n=t%this.DB,i=this.DB-n,a=(1<<n)-1;e.data[0]=this.data[r]>>n;for(var s=r+1;s<this.t;++s)e.data[s-r-1]|=(this.data[s]&a)<<i,e.data[s-r]=this.data[s]>>n;n>0&&(e.data[this.t-r-1]|=(this.s&a)<<i),e.t=this.t-r,e.clamp()}function ou(t,e){for(var r=0,n=0,i=Math.min(t.t,this.t);r<i;)n+=this.data[r]-t.data[r],e.data[r++]=n&this.DM,n>>=this.DB;if(t.t<this.t){for(n-=t.s;r<this.t;)n+=this.data[r],e.data[r++]=n&this.DM,n>>=this.DB;n+=this.s}else{for(n+=this.s;r<t.t;)n-=t.data[r],e.data[r++]=n&this.DM,n>>=this.DB;n-=t.s}e.s=n<0?-1:0,n<-1?e.data[r++]=this.DV+n:n>0&&(e.data[r++]=n),e.t=r,e.clamp()}function su(t,e){var r=this.abs(),n=t.abs(),i=r.t;for(e.t=i+n.t;--i>=0;)e.data[i]=0;for(i=0;i<n.t;++i)e.data[i+r.t]=r.am(0,n.data[i],e,i,0,r.t);e.s=0,e.clamp(),this.s!=t.s&&C.ZERO.subTo(e,e)}function fu(t){for(var e=this.abs(),r=t.t=2*e.t;--r>=0;)t.data[r]=0;for(r=0;r<e.t-1;++r){var n=e.am(r,e.data[r],t,2*r,0,1);(t.data[r+e.t]+=e.am(r+1,2*e.data[r],t,2*r+1,n,e.t-r-1))>=e.DV&&(t.data[r+e.t]-=e.DV,t.data[r+e.t+1]=1)}t.t>0&&(t.data[t.t-1]+=e.am(r,e.data[r],t,2*r,0,1)),t.s=0,t.clamp()}function cu(t,e,r){var n=t.abs();if(!(n.t<=0)){var i=this.abs();if(i.t<n.t){e?.fromInt(0),r!=null&&this.copyTo(r);return}r==null&&(r=tt());var a=tt(),s=this.s,o=t.s,f=this.DB-pn(n.data[n.t-1]);f>0?(n.lShiftTo(f,a),i.lShiftTo(f,r)):(n.copyTo(a),i.copyTo(r));var c=a.t,u=a.data[c-1];if(u!=0){var h=u*(1<<this.F1)+(c>1?a.data[c-2]>>this.F2:0),p=this.FV/h,x=(1<<this.F1)/h,l=1<<this.F2,d=r.t,y=d-c,m=e??tt();for(a.dlShiftTo(y,m),r.compareTo(m)>=0&&(r.data[r.t++]=1,r.subTo(m,r)),C.ONE.dlShiftTo(c,m),m.subTo(a,a);a.t<c;)a.data[a.t++]=0;for(;--y>=0;){var E=r.data[--d]==u?this.DM:Math.floor(r.data[d]*p+(r.data[d-1]+l)*x);if((r.data[d]+=a.am(0,E,r,y,0,c))<E)for(a.dlShiftTo(y,m),r.subTo(m,r);r.data[d]<--E;)r.subTo(m,r)}e!=null&&(r.drShiftTo(c,e),s!=o&&C.ZERO.subTo(e,e)),r.t=c,r.clamp(),f>0&&r.rShiftTo(f,r),s<0&&C.ZERO.subTo(r,r)}}}function uu(t){var e=tt();return this.abs().divRemTo(t,null,e),this.s<0&&e.compareTo(C.ZERO)>0&&t.subTo(e,e),e}function Fe(t){this.m=t}function hu(t){return t.s<0||t.compareTo(this.m)>=0?t.mod(this.m):t}function lu(t){return t}function pu(t){t.divRemTo(this.m,null,t)}function du(t,e,r){t.multiplyTo(e,r),this.reduce(r)}function yu(t,e){t.squareTo(e),this.reduce(e)}Fe.prototype.convert=hu;Fe.prototype.revert=lu;Fe.prototype.reduce=pu;Fe.prototype.mulTo=du;Fe.prototype.sqrTo=yu;function xu(){if(this.t<1)return 0;var t=this.data[0];if(!(t&1))return 0;var e=t&3;return e=e*(2-(t&15)*e)&15,e=e*(2-(t&255)*e)&255,e=e*(2-((t&65535)*e&65535))&65535,e=e*(2-t*e%this.DV)%this.DV,e>0?this.DV-e:-e}function He(t){this.m=t,this.mp=t.invDigit(),this.mpl=this.mp&32767,this.mph=this.mp>>15,this.um=(1<<t.DB-15)-1,this.mt2=2*t.t}function gu(t){var e=tt();return t.abs().dlShiftTo(this.m.t,e),e.divRemTo(this.m,null,e),t.s<0&&e.compareTo(C.ZERO)>0&&this.m.subTo(e,e),e}function mu(t){var e=tt();return t.copyTo(e),this.reduce(e),e}function vu(t){for(;t.t<=this.mt2;)t.data[t.t++]=0;for(var e=0;e<this.m.t;++e){var r=t.data[e]&32767,n=r*this.mpl+((r*this.mph+(t.data[e]>>15)*this.mpl&this.um)<<15)&t.DM;for(r=e+this.m.t,t.data[r]+=this.m.am(0,n,t,e,0,this.m.t);t.data[r]>=t.DV;)t.data[r]-=t.DV,t.data[++r]++}t.clamp(),t.drShiftTo(this.m.t,t),t.compareTo(this.m)>=0&&t.subTo(this.m,t)}function bu(t,e){t.squareTo(e),this.reduce(e)}function Eu(t,e,r){t.multiplyTo(e,r),this.reduce(r)}He.prototype.convert=gu;He.prototype.revert=mu;He.prototype.reduce=vu;He.prototype.mulTo=Eu;He.prototype.sqrTo=bu;function wu(){return(this.t>0?this.data[0]&1:this.s)==0}function Su(t,e){if(t>4294967295||t<1)return C.ONE;var r=tt(),n=tt(),i=e.convert(this),a=pn(t)-1;for(i.copyTo(r);--a>=0;)if(e.sqrTo(r,n),(t&1<<a)>0)e.mulTo(n,i,r);else{var s=r;r=n,n=s}return e.revert(r)}function Bu(t,e){var r;return t<256||e.isEven()?r=new Fe(e):r=new He(e),this.exp(t,r)}C.prototype.copyTo=Yc;C.prototype.fromInt=Zc;C.prototype.fromString=$c;C.prototype.clamp=Qc;C.prototype.dlShiftTo=ru;C.prototype.drShiftTo=nu;C.prototype.lShiftTo=iu;C.prototype.rShiftTo=au;C.prototype.subTo=ou;C.prototype.multiplyTo=su;C.prototype.squareTo=fu;C.prototype.divRemTo=cu;C.prototype.invDigit=xu;C.prototype.isEven=wu;C.prototype.exp=Su;C.prototype.toString=Xc;C.prototype.negate=Jc;C.prototype.abs=jc;C.prototype.compareTo=tu;C.prototype.bitLength=eu;C.prototype.mod=uu;C.prototype.modPowInt=Bu;C.ZERO=Te(0);C.ONE=Te(1);function Au(){var t=tt();return this.copyTo(t),t}function Cu(){if(this.s<0){if(this.t==1)return this.data[0]-this.DV;if(this.t==0)return-1}else{if(this.t==1)return this.data[0];if(this.t==0)return 0}return(this.data[1]&(1<<32-this.DB)-1)<<this.DB|this.data[0]}function Iu(){return this.t==0?this.s:this.data[0]<<24>>24}function Tu(){return this.t==0?this.s:this.data[0]<<16>>16}function _u(t){return Math.floor(Math.LN2*this.DB/Math.log(t))}function Ru(){return this.s<0?-1:this.t<=0||this.t==1&&this.data[0]<=0?0:1}function Lu(t){if(t==null&&(t=10),this.signum()==0||t<2||t>36)return"0";var e=this.chunkSize(t),r=Math.pow(t,e),n=Te(r),i=tt(),a=tt(),s="";for(this.divRemTo(n,i,a);i.signum()>0;)s=(r+a.intValue()).toString(t).substr(1)+s,i.divRemTo(n,i,a);return a.intValue().toString(t)+s}function Nu(t,e){this.fromInt(0),e==null&&(e=10);for(var r=this.chunkSize(e),n=Math.pow(e,r),i=!1,a=0,s=0,o=0;o<t.length;++o){var f=ns(t,o);if(f<0){t.charAt(o)=="-"&&this.signum()==0&&(i=!0);continue}s=e*s+f,++a>=r&&(this.dMultiply(n),this.dAddOffset(s,0),a=0,s=0)}a>0&&(this.dMultiply(Math.pow(e,a)),this.dAddOffset(s,0)),i&&C.ZERO.subTo(this,this)}function Du(t,e,r){if(typeof e=="number")if(t<2)this.fromInt(1);else for(this.fromNumber(t,r),this.testBit(t-1)||this.bitwiseTo(C.ONE.shiftLeft(t-1),Di,this),this.isEven()&&this.dAddOffset(1,0);!this.isProbablePrime(e);)this.dAddOffset(2,0),this.bitLength()>t&&this.subTo(C.ONE.shiftLeft(t-1),this);else{var n=new Array,i=t&7;n.length=(t>>3)+1,e.nextBytes(n),i>0?n[0]&=(1<<i)-1:n[0]=0,this.fromString(n,256)}}function ku(){var t=this.t,e=new Array;e[0]=this.s;var r=this.DB-t*this.DB%8,n,i=0;if(t-- >0)for(r<this.DB&&(n=this.data[t]>>r)!=(this.s&this.DM)>>r&&(e[i++]=n|this.s<<this.DB-r);t>=0;)r<8?(n=(this.data[t]&(1<<r)-1)<<8-r,n|=this.data[--t]>>(r+=this.DB-8)):(n=this.data[t]>>(r-=8)&255,r<=0&&(r+=this.DB,--t)),n&128&&(n|=-256),i==0&&(this.s&128)!=(n&128)&&++i,(i>0||n!=this.s)&&(e[i++]=n);return e}function Pu(t){return this.compareTo(t)==0}function Uu(t){return this.compareTo(t)<0?this:t}function Ku(t){return this.compareTo(t)>0?this:t}function Ou(t,e,r){var n,i,a=Math.min(t.t,this.t);for(n=0;n<a;++n)r.data[n]=e(this.data[n],t.data[n]);if(t.t<this.t){for(i=t.s&this.DM,n=a;n<this.t;++n)r.data[n]=e(this.data[n],i);r.t=this.t}else{for(i=this.s&this.DM,n=a;n<t.t;++n)r.data[n]=e(i,t.data[n]);r.t=t.t}r.s=e(this.s,t.s),r.clamp()}function Mu(t,e){return t&e}function Vu(t){var e=tt();return this.bitwiseTo(t,Mu,e),e}function Di(t,e){return t|e}function qu(t){var e=tt();return this.bitwiseTo(t,Di,e),e}function is(t,e){return t^e}function Fu(t){var e=tt();return this.bitwiseTo(t,is,e),e}function as(t,e){return t&~e}function Hu(t){var e=tt();return this.bitwiseTo(t,as,e),e}function zu(){for(var t=tt(),e=0;e<this.t;++e)t.data[e]=this.DM&~this.data[e];return t.t=this.t,t.s=~this.s,t}function Gu(t){var e=tt();return t<0?this.rShiftTo(-t,e):this.lShiftTo(t,e),e}function Wu(t){var e=tt();return t<0?this.lShiftTo(-t,e):this.rShiftTo(t,e),e}function Yu(t){if(t==0)return-1;var e=0;return t&65535||(t>>=16,e+=16),t&255||(t>>=8,e+=8),t&15||(t>>=4,e+=4),t&3||(t>>=2,e+=2),t&1||++e,e}function Zu(){for(var t=0;t<this.t;++t)if(this.data[t]!=0)return t*this.DB+Yu(this.data[t]);return this.s<0?this.t*this.DB:-1}function $u(t){for(var e=0;t!=0;)t&=t-1,++e;return e}function Qu(){for(var t=0,e=this.s&this.DM,r=0;r<this.t;++r)t+=$u(this.data[r]^e);return t}function Xu(t){var e=Math.floor(t/this.DB);return e>=this.t?this.s!=0:(this.data[e]&1<<t%this.DB)!=0}function Ju(t,e){var r=C.ONE.shiftLeft(t);return this.bitwiseTo(r,e,r),r}function ju(t){return this.changeBit(t,Di)}function th(t){return this.changeBit(t,as)}function eh(t){return this.changeBit(t,is)}function rh(t,e){for(var r=0,n=0,i=Math.min(t.t,this.t);r<i;)n+=this.data[r]+t.data[r],e.data[r++]=n&this.DM,n>>=this.DB;if(t.t<this.t){for(n+=t.s;r<this.t;)n+=this.data[r],e.data[r++]=n&this.DM,n>>=this.DB;n+=this.s}else{for(n+=this.s;r<t.t;)n+=t.data[r],e.data[r++]=n&this.DM,n>>=this.DB;n+=t.s}e.s=n<0?-1:0,n>0?e.data[r++]=n:n<-1&&(e.data[r++]=this.DV+n),e.t=r,e.clamp()}function nh(t){var e=tt();return this.addTo(t,e),e}function ih(t){var e=tt();return this.subTo(t,e),e}function ah(t){var e=tt();return this.multiplyTo(t,e),e}function oh(t){var e=tt();return this.divRemTo(t,e,null),e}function sh(t){var e=tt();return this.divRemTo(t,null,e),e}function fh(t){var e=tt(),r=tt();return this.divRemTo(t,e,r),new Array(e,r)}function ch(t){this.data[this.t]=this.am(0,t-1,this,0,0,this.t),++this.t,this.clamp()}function uh(t,e){if(t!=0){for(;this.t<=e;)this.data[this.t++]=0;for(this.data[e]+=t;this.data[e]>=this.DV;)this.data[e]-=this.DV,++e>=this.t&&(this.data[this.t++]=0),++this.data[e]}}function Dr(){}function os(t){return t}function hh(t,e,r){t.multiplyTo(e,r)}function lh(t,e){t.squareTo(e)}Dr.prototype.convert=os;Dr.prototype.revert=os;Dr.prototype.mulTo=hh;Dr.prototype.sqrTo=lh;function ph(t){return this.exp(t,new Dr)}function dh(t,e,r){var n=Math.min(this.t+t.t,e);for(r.s=0,r.t=n;n>0;)r.data[--n]=0;var i;for(i=r.t-this.t;n<i;++n)r.data[n+this.t]=this.am(0,t.data[n],r,n,0,this.t);for(i=Math.min(t.t,e);n<i;++n)this.am(0,t.data[n],r,n,0,e-n);r.clamp()}function yh(t,e,r){--e;var n=r.t=this.t+t.t-e;for(r.s=0;--n>=0;)r.data[n]=0;for(n=Math.max(e-this.t,0);n<t.t;++n)r.data[this.t+n-e]=this.am(e-n,t.data[n],r,0,0,this.t+n-e);r.clamp(),r.drShiftTo(1,r)}function fr(t){this.r2=tt(),this.q3=tt(),C.ONE.dlShiftTo(2*t.t,this.r2),this.mu=this.r2.divide(t),this.m=t}function xh(t){if(t.s<0||t.t>2*this.m.t)return t.mod(this.m);if(t.compareTo(this.m)<0)return t;var e=tt();return t.copyTo(e),this.reduce(e),e}function gh(t){return t}function mh(t){for(t.drShiftTo(this.m.t-1,this.r2),t.t>this.m.t+1&&(t.t=this.m.t+1,t.clamp()),this.mu.multiplyUpperTo(this.r2,this.m.t+1,this.q3),this.m.multiplyLowerTo(this.q3,this.m.t+1,this.r2);t.compareTo(this.r2)<0;)t.dAddOffset(1,this.m.t+1);for(t.subTo(this.r2,t);t.compareTo(this.m)>=0;)t.subTo(this.m,t)}function vh(t,e){t.squareTo(e),this.reduce(e)}function bh(t,e,r){t.multiplyTo(e,r),this.reduce(r)}fr.prototype.convert=xh;fr.prototype.revert=gh;fr.prototype.reduce=mh;fr.prototype.mulTo=bh;fr.prototype.sqrTo=vh;function Eh(t,e){var r=t.bitLength(),n,i=Te(1),a;if(r<=0)return i;r<18?n=1:r<48?n=3:r<144?n=4:r<768?n=5:n=6,r<8?a=new Fe(e):e.isEven()?a=new fr(e):a=new He(e);var s=new Array,o=3,f=n-1,c=(1<<n)-1;if(s[1]=a.convert(this),n>1){var u=tt();for(a.sqrTo(s[1],u);o<=c;)s[o]=tt(),a.mulTo(u,s[o-2],s[o]),o+=2}var h=t.t-1,p,x=!0,l=tt(),d;for(r=pn(t.data[h])-1;h>=0;){for(r>=f?p=t.data[h]>>r-f&c:(p=(t.data[h]&(1<<r+1)-1)<<f-r,h>0&&(p|=t.data[h-1]>>this.DB+r-f)),o=n;!(p&1);)p>>=1,--o;if((r-=o)<0&&(r+=this.DB,--h),x)s[p].copyTo(i),x=!1;else{for(;o>1;)a.sqrTo(i,l),a.sqrTo(l,i),o-=2;o>0?a.sqrTo(i,l):(d=i,i=l,l=d),a.mulTo(l,s[p],i)}for(;h>=0&&!(t.data[h]&1<<r);)a.sqrTo(i,l),d=i,i=l,l=d,--r<0&&(r=this.DB-1,--h)}return a.revert(i)}function wh(t){var e=this.s<0?this.negate():this.clone(),r=t.s<0?t.negate():t.clone();if(e.compareTo(r)<0){var n=e;e=r,r=n}var i=e.getLowestSetBit(),a=r.getLowestSetBit();if(a<0)return e;for(i<a&&(a=i),a>0&&(e.rShiftTo(a,e),r.rShiftTo(a,r));e.signum()>0;)(i=e.getLowestSetBit())>0&&e.rShiftTo(i,e),(i=r.getLowestSetBit())>0&&r.rShiftTo(i,r),e.compareTo(r)>=0?(e.subTo(r,e),e.rShiftTo(1,e)):(r.subTo(e,r),r.rShiftTo(1,r));return a>0&&r.lShiftTo(a,r),r}function Sh(t){if(t<=0)return 0;var e=this.DV%t,r=this.s<0?t-1:0;if(this.t>0)if(e==0)r=this.data[0]%t;else for(var n=this.t-1;n>=0;--n)r=(e*r+this.data[n])%t;return r}function Bh(t){var e=t.isEven();if(this.isEven()&&e||t.signum()==0)return C.ZERO;for(var r=t.clone(),n=this.clone(),i=Te(1),a=Te(0),s=Te(0),o=Te(1);r.signum()!=0;){for(;r.isEven();)r.rShiftTo(1,r),e?((!i.isEven()||!a.isEven())&&(i.addTo(this,i),a.subTo(t,a)),i.rShiftTo(1,i)):a.isEven()||a.subTo(t,a),a.rShiftTo(1,a);for(;n.isEven();)n.rShiftTo(1,n),e?((!s.isEven()||!o.isEven())&&(s.addTo(this,s),o.subTo(t,o)),s.rShiftTo(1,s)):o.isEven()||o.subTo(t,o),o.rShiftTo(1,o);r.compareTo(n)>=0?(r.subTo(n,r),e&&i.subTo(s,i),a.subTo(o,a)):(n.subTo(r,n),e&&s.subTo(i,s),o.subTo(a,o))}if(n.compareTo(C.ONE)!=0)return C.ZERO;if(o.compareTo(t)>=0)return o.subtract(t);if(o.signum()<0)o.addTo(t,o);else return o;return o.signum()<0?o.add(t):o}var Zt=[2,3,5,7,11,13,17,19,23,29,31,37,41,43,47,53,59,61,67,71,73,79,83,89,97,101,103,107,109,113,127,131,137,139,149,151,157,163,167,173,179,181,191,193,197,199,211,223,227,229,233,239,241,251,257,263,269,271,277,281,283,293,307,311,313,317,331,337,347,349,353,359,367,373,379,383,389,397,401,409,419,421,431,433,439,443,449,457,461,463,467,479,487,491,499,503,509],Ah=(1<<26)/Zt[Zt.length-1];function Ch(t){var e,r=this.abs();if(r.t==1&&r.data[0]<=Zt[Zt.length-1]){for(e=0;e<Zt.length;++e)if(r.data[0]==Zt[e])return!0;return!1}if(r.isEven())return!1;for(e=1;e<Zt.length;){for(var n=Zt[e],i=e+1;i<Zt.length&&n<Ah;)n*=Zt[i++];for(n=r.modInt(n);e<i;)if(n%Zt[e++]==0)return!1}return r.millerRabin(t)}function Ih(t){var e=this.subtract(C.ONE),r=e.getLowestSetBit();if(r<=0)return!1;for(var n=e.shiftRight(r),i=Th(),a,s=0;s<t;++s){do a=new C(this.bitLength(),i);while(a.compareTo(C.ONE)<=0||a.compareTo(e)>=0);var o=a.modPow(n,this);if(o.compareTo(C.ONE)!=0&&o.compareTo(e)!=0){for(var f=1;f++<r&&o.compareTo(e)!=0;)if(o=o.modPowInt(2,this),o.compareTo(C.ONE)==0)return!1;if(o.compareTo(e)!=0)return!1}}return!0}function Th(){return{nextBytes:function(t){for(var e=0;e<t.length;++e)t[e]=Math.floor(Math.random()*256)}}}C.prototype.chunkSize=_u;C.prototype.toRadix=Lu;C.prototype.fromRadix=Nu;C.prototype.fromNumber=Du;C.prototype.bitwiseTo=Ou;C.prototype.changeBit=Ju;C.prototype.addTo=rh;C.prototype.dMultiply=ch;C.prototype.dAddOffset=uh;C.prototype.multiplyLowerTo=dh;C.prototype.multiplyUpperTo=yh;C.prototype.modInt=Sh;C.prototype.millerRabin=Ih;C.prototype.clone=Au;C.prototype.intValue=Cu;C.prototype.byteValue=Iu;C.prototype.shortValue=Tu;C.prototype.signum=Ru;C.prototype.toByteArray=ku;C.prototype.equals=Pu;C.prototype.min=Uu;C.prototype.max=Ku;C.prototype.and=Vu;C.prototype.or=qu;C.prototype.xor=Fu;C.prototype.andNot=Hu;C.prototype.not=zu;C.prototype.shiftLeft=Gu;C.prototype.shiftRight=Wu;C.prototype.getLowestSetBit=Zu;C.prototype.bitCount=Qu;C.prototype.testBit=Xu;C.prototype.setBit=ju;C.prototype.clearBit=th;C.prototype.flipBit=eh;C.prototype.add=nh;C.prototype.subtract=ih;C.prototype.multiply=ah;C.prototype.divide=oh;C.prototype.remainder=sh;C.prototype.divideAndRemainder=fh;C.prototype.modPow=Eh;C.prototype.modInverse=Bh;C.prototype.pow=ph;C.prototype.gcd=wh;C.prototype.isProbablePrime=Ch});var ls=ft((j1,hs)=>{var oe=it();qe();bt();var cs=hs.exports=oe.sha1=oe.sha1||{};oe.md.sha1=oe.md.algorithms.sha1=cs;cs.create=function(){us||_h();var t=null,e=oe.util.createBuffer(),r=new Array(80),n={algorithm:"sha1",blockLength:64,digestLength:20,messageLength:0,fullMessageLength:null,messageLengthSize:8};return n.start=function(){n.messageLength=0,n.fullMessageLength=n.messageLength64=[];for(var i=n.messageLengthSize/4,a=0;a<i;++a)n.fullMessageLength.push(0);return e=oe.util.createBuffer(),t={h0:1732584193,h1:4023233417,h2:2562383102,h3:271733878,h4:3285377520},n},n.start(),n.update=function(i,a){a==="utf8"&&(i=oe.util.encodeUtf8(i));var s=i.length;n.messageLength+=s,s=[s/4294967296>>>0,s>>>0];for(var o=n.fullMessageLength.length-1;o>=0;--o)n.fullMessageLength[o]+=s[1],s[1]=s[0]+(n.fullMessageLength[o]/4294967296>>>0),n.fullMessageLength[o]=n.fullMessageLength[o]>>>0,s[0]=s[1]/4294967296>>>0;return e.putBytes(i),fs(t,r,e),(e.read>2048||e.length()===0)&&e.compact(),n},n.digest=function(){var i=oe.util.createBuffer();i.putBytes(e.bytes());var a=n.fullMessageLength[n.fullMessageLength.length-1]+n.messageLengthSize,s=a&n.blockLength-1;i.putBytes(ki.substr(0,n.blockLength-s));for(var o,f,c=n.fullMessageLength[0]*8,u=0;u<n.fullMessageLength.length-1;++u)o=n.fullMessageLength[u+1]*8,f=o/4294967296>>>0,c+=f,i.putInt32(c>>>0),c=o>>>0;i.putInt32(c);var h={h0:t.h0,h1:t.h1,h2:t.h2,h3:t.h3,h4:t.h4};fs(h,r,i);var p=oe.util.createBuffer();return p.putInt32(h.h0),p.putInt32(h.h1),p.putInt32(h.h2),p.putInt32(h.h3),p.putInt32(h.h4),p},n};var ki=null,us=!1;function _h(){ki="\x80",ki+=oe.util.fillString("\0",64),us=!0}function fs(t,e,r){for(var n,i,a,s,o,f,c,u,h=r.length();h>=64;){for(i=t.h0,a=t.h1,s=t.h2,o=t.h3,f=t.h4,u=0;u<16;++u)n=r.getInt32(),e[u]=n,c=o^a&(s^o),n=(i<<5|i>>>27)+c+f+1518500249+n,f=o,o=s,s=(a<<30|a>>>2)>>>0,a=i,i=n;for(;u<20;++u)n=e[u-3]^e[u-8]^e[u-14]^e[u-16],n=n<<1|n>>>31,e[u]=n,c=o^a&(s^o),n=(i<<5|i>>>27)+c+f+1518500249+n,f=o,o=s,s=(a<<30|a>>>2)>>>0,a=i,i=n;for(;u<32;++u)n=e[u-3]^e[u-8]^e[u-14]^e[u-16],n=n<<1|n>>>31,e[u]=n,c=a^s^o,n=(i<<5|i>>>27)+c+f+1859775393+n,f=o,o=s,s=(a<<30|a>>>2)>>>0,a=i,i=n;for(;u<40;++u)n=e[u-6]^e[u-16]^e[u-28]^e[u-32],n=n<<2|n>>>30,e[u]=n,c=a^s^o,n=(i<<5|i>>>27)+c+f+1859775393+n,f=o,o=s,s=(a<<30|a>>>2)>>>0,a=i,i=n;for(;u<60;++u)n=e[u-6]^e[u-16]^e[u-28]^e[u-32],n=n<<2|n>>>30,e[u]=n,c=a&s|o&(a^s),n=(i<<5|i>>>27)+c+f+2400959708+n,f=o,o=s,s=(a<<30|a>>>2)>>>0,a=i,i=n;for(;u<80;++u)n=e[u-6]^e[u-16]^e[u-28]^e[u-32],n=n<<2|n>>>30,e[u]=n,c=a^s^o,n=(i<<5|i>>>27)+c+f+3395469782+n,f=o,o=s,s=(a<<30|a>>>2)>>>0,a=i,i=n;t.h0=t.h0+i|0,t.h1=t.h1+a|0,t.h2=t.h2+s|0,t.h3=t.h3+o|0,t.h4=t.h4+f|0,h-=64}}});var ys=ft((ty,ds)=>{var se=it();bt();Nr();ls();var ps=ds.exports=se.pkcs1=se.pkcs1||{};ps.encode_rsa_oaep=function(t,e,r){var n,i,a,s;typeof r=="string"?(n=r,i=arguments[3]||void 0,a=arguments[4]||void 0):r&&(n=r.label||void 0,i=r.seed||void 0,a=r.md||void 0,r.mgf1&&r.mgf1.md&&(s=r.mgf1.md)),a?a.start():a=se.md.sha1.create(),s||(s=a);var o=Math.ceil(t.n.bitLength()/8),f=o-2*a.digestLength-2;if(e.length>f){var c=new Error("RSAES-OAEP input message length is too long.");throw c.length=e.length,c.maxLength=f,c}n||(n=""),a.update(n,"raw");for(var u=a.digest(),h="",p=f-e.length,x=0;x<p;x++)h+="\0";var l=u.getBytes()+h+""+e;if(!i)i=se.random.getBytes(a.digestLength);else if(i.length!==a.digestLength){var c=new Error("Invalid RSAES-OAEP seed. The seed length must match the digest length.");throw c.seedLength=i.length,c.digestLength=a.digestLength,c}var d=yn(i,o-a.digestLength-1,s),y=se.util.xorBytes(l,d,l.length),m=yn(y,a.digestLength,s),E=se.util.xorBytes(i,m,i.length);return"\0"+E+y};ps.decode_rsa_oaep=function(t,e,r){var n,i,a;typeof r=="string"?(n=r,i=arguments[3]||void 0):r&&(n=r.label||void 0,i=r.md||void 0,r.mgf1&&r.mgf1.md&&(a=r.mgf1.md));var s=Math.ceil(t.n.bitLength()/8);if(e.length!==s){var y=new Error("RSAES-OAEP encoded message length is invalid.");throw y.length=e.length,y.expectedLength=s,y}if(i===void 0?i=se.md.sha1.create():i.start(),a||(a=i),s<2*i.digestLength+2)throw new Error("RSAES-OAEP key is too short for the hash function.");n||(n=""),i.update(n,"raw");for(var o=i.digest().getBytes(),f=e.charAt(0),c=e.substring(1,i.digestLength+1),u=e.substring(1+i.digestLength),h=yn(u,i.digestLength,a),p=se.util.xorBytes(c,h,c.length),x=yn(p,s-i.digestLength-1,a),l=se.util.xorBytes(u,x,u.length),d=l.substring(0,i.digestLength),y=f!=="\0",m=0;m<i.digestLength;++m)y|=o.charAt(m)!==d.charAt(m);for(var E=1,b=i.digestLength,R=i.digestLength;R<l.length;R++){var w=l.charCodeAt(R),S=w&1^1,L=E?65534:0;y|=w&L,E=E&S,b+=E}if(y||l.charCodeAt(b)!==1)throw new Error("Invalid RSAES-OAEP padding.");return l.substring(b+1)};function yn(t,e,r){r||(r=se.md.sha1.create());for(var n="",i=Math.ceil(e/r.digestLength),a=0;a<i;++a){var s=String.fromCharCode(a>>24&255,a>>16&255,a>>8&255,a&255);r.start(),r.update(t+s),n+=r.digest().getBytes()}return n.substring(0,e)}});var xs=ft((ey,Pi)=>{var _e=it();bt();dn();Nr();(function(){if(_e.prime){Pi.exports=_e.prime;return}var t=Pi.exports=_e.prime=_e.prime||{},e=_e.jsbn.BigInteger,r=[6,4,2,4,2,4,6,2],n=new e(null);n.fromInt(30);var i=function(h,p){return h|p};t.generateProbablePrime=function(h,p,x){typeof p=="function"&&(x=p,p={}),p=p||{};var l=p.algorithm||"PRIMEINC";typeof l=="string"&&(l={name:l}),l.options=l.options||{};var d=p.prng||_e.random,y={nextBytes:function(m){for(var E=d.getBytesSync(m.length),b=0;b<m.length;++b)m[b]=E.charCodeAt(b)}};if(l.name==="PRIMEINC")return a(h,y,l.options,x);throw new Error("Invalid prime generation algorithm: "+l.name)};function a(h,p,x,l){return"workers"in x?f(h,p,x,l):s(h,p,x,l)}function s(h,p,x,l){var d=c(h,p),y=0,m=u(d.bitLength());"millerRabinTests"in x&&(m=x.millerRabinTests);var E=10;"maxBlockTime"in x&&(E=x.maxBlockTime),o(d,h,p,y,m,E,l)}function o(h,p,x,l,d,y,m){var E=+new Date;do{if(h.bitLength()>p&&(h=c(p,x)),h.isProbablePrime(d))return m(null,h);h.dAddOffset(r[l++%8],0)}while(y<0||+new Date-E<y);_e.util.setImmediate(function(){o(h,p,x,l,d,y,m)})}function f(h,p,x,l){if(typeof Worker>"u")return s(h,p,x,l);var d=c(h,p),y=x.workers,m=x.workLoad||100,E=m*30/8,b=x.workerScript||"forge/prime.worker.js";if(y===-1)return _e.util.estimateCores(function(w,S){w&&(S=2),y=S-1,R()});R();function R(){y=Math.max(1,y);for(var w=[],S=0;S<y;++S)w[S]=new Worker(b);for(var L=y,S=0;S<y;++S)w[S].addEventListener("message",z);var N=!1;function z(H){if(!N){--L;var V=H.data;if(V.found){for(var Q=0;Q<w.length;++Q)w[Q].terminate();return N=!0,l(null,new e(V.prime,16))}d.bitLength()>h&&(d=c(h,p));var at=d.toString(16);H.target.postMessage({hex:at,workLoad:m}),d.dAddOffset(E,0)}}}}function c(h,p){var x=new e(h,p),l=h-1;return x.testBit(l)||x.bitwiseTo(e.ONE.shiftLeft(l),i,x),x.dAddOffset(31-x.mod(n).byteValue(),0),x}function u(h){return h<=100?27:h<=150?18:h<=200?15:h<=250?12:h<=300?9:h<=350?8:h<=400?7:h<=500?6:h<=600?5:h<=800?4:h<=1250?3:2}})()});var gn=ft((ry,Ss)=>{var M=it();Lr();dn();nn();ys();xs();Nr();bt();typeof j>"u"&&(j=M.jsbn.BigInteger);var j,Ui=M.util.isNodejs?fn():null,v=M.asn1,zt=M.util;M.pki=M.pki||{};Ss.exports=M.pki.rsa=M.rsa=M.rsa||{};var G=M.pki,Rh=[6,4,2,4,2,4,6,2],Lh={name:"PrivateKeyInfo",tagClass:v.Class.UNIVERSAL,type:v.Type.SEQUENCE,constructed:!0,value:[{name:"PrivateKeyInfo.version",tagClass:v.Class.UNIVERSAL,type:v.Type.INTEGER,constructed:!1,capture:"privateKeyVersion"},{name:"PrivateKeyInfo.privateKeyAlgorithm",tagClass:v.Class.UNIVERSAL,type:v.Type.SEQUENCE,constructed:!0,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:v.Class.UNIVERSAL,type:v.Type.OID,constructed:!1,capture:"privateKeyOid"}]},{name:"PrivateKeyInfo",tagClass:v.Class.UNIVERSAL,type:v.Type.OCTETSTRING,constructed:!1,capture:"privateKey"}]},Nh={name:"RSAPrivateKey",tagClass:v.Class.UNIVERSAL,type:v.Type.SEQUENCE,constructed:!0,value:[{name:"RSAPrivateKey.version",tagClass:v.Class.UNIVERSAL,type:v.Type.INTEGER,constructed:!1,capture:"privateKeyVersion"},{name:"RSAPrivateKey.modulus",tagClass:v.Class.UNIVERSAL,type:v.Type.INTEGER,constructed:!1,capture:"privateKeyModulus"},{name:"RSAPrivateKey.publicExponent",tagClass:v.Class.UNIVERSAL,type:v.Type.INTEGER,constructed:!1,capture:"privateKeyPublicExponent"},{name:"RSAPrivateKey.privateExponent",tagClass:v.Class.UNIVERSAL,type:v.Type.INTEGER,constructed:!1,capture:"privateKeyPrivateExponent"},{name:"RSAPrivateKey.prime1",tagClass:v.Class.UNIVERSAL,type:v.Type.INTEGER,constructed:!1,capture:"privateKeyPrime1"},{name:"RSAPrivateKey.prime2",tagClass:v.Class.UNIVERSAL,type:v.Type.INTEGER,constructed:!1,capture:"privateKeyPrime2"},{name:"RSAPrivateKey.exponent1",tagClass:v.Class.UNIVERSAL,type:v.Type.INTEGER,constructed:!1,capture:"privateKeyExponent1"},{name:"RSAPrivateKey.exponent2",tagClass:v.Class.UNIVERSAL,type:v.Type.INTEGER,constructed:!1,capture:"privateKeyExponent2"},{name:"RSAPrivateKey.coefficient",tagClass:v.Class.UNIVERSAL,type:v.Type.INTEGER,constructed:!1,capture:"privateKeyCoefficient"}]},Dh={name:"RSAPublicKey",tagClass:v.Class.UNIVERSAL,type:v.Type.SEQUENCE,constructed:!0,value:[{name:"RSAPublicKey.modulus",tagClass:v.Class.UNIVERSAL,type:v.Type.INTEGER,constructed:!1,capture:"publicKeyModulus"},{name:"RSAPublicKey.exponent",tagClass:v.Class.UNIVERSAL,type:v.Type.INTEGER,constructed:!1,capture:"publicKeyExponent"}]},kh=M.pki.rsa.publicKeyValidator={name:"SubjectPublicKeyInfo",tagClass:v.Class.UNIVERSAL,type:v.Type.SEQUENCE,constructed:!0,captureAsn1:"subjectPublicKeyInfo",value:[{name:"SubjectPublicKeyInfo.AlgorithmIdentifier",tagClass:v.Class.UNIVERSAL,type:v.Type.SEQUENCE,constructed:!0,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:v.Class.UNIVERSAL,type:v.Type.OID,constructed:!1,capture:"publicKeyOid"}]},{name:"SubjectPublicKeyInfo.subjectPublicKey",tagClass:v.Class.UNIVERSAL,type:v.Type.BITSTRING,constructed:!1,value:[{name:"SubjectPublicKeyInfo.subjectPublicKey.RSAPublicKey",tagClass:v.Class.UNIVERSAL,type:v.Type.SEQUENCE,constructed:!0,optional:!0,captureAsn1:"rsaPublicKey"}]}]},Ph={name:"DigestInfo",tagClass:v.Class.UNIVERSAL,type:v.Type.SEQUENCE,constructed:!0,value:[{name:"DigestInfo.DigestAlgorithm",tagClass:v.Class.UNIVERSAL,type:v.Type.SEQUENCE,constructed:!0,value:[{name:"DigestInfo.DigestAlgorithm.algorithmIdentifier",tagClass:v.Class.UNIVERSAL,type:v.Type.OID,constructed:!1,capture:"algorithmIdentifier"},{name:"DigestInfo.DigestAlgorithm.parameters",tagClass:v.Class.UNIVERSAL,type:v.Type.NULL,capture:"parameters",optional:!0,constructed:!1}]},{name:"DigestInfo.digest",tagClass:v.Class.UNIVERSAL,type:v.Type.OCTETSTRING,constructed:!1,capture:"digest"}]},Uh=function(t){var e;if(t.algorithm in G.oids)e=G.oids[t.algorithm];else{var r=new Error("Unknown message digest algorithm.");throw r.algorithm=t.algorithm,r}var n=v.oidToDer(e).getBytes(),i=v.create(v.Class.UNIVERSAL,v.Type.SEQUENCE,!0,[]),a=v.create(v.Class.UNIVERSAL,v.Type.SEQUENCE,!0,[]);a.value.push(v.create(v.Class.UNIVERSAL,v.Type.OID,!1,n)),a.value.push(v.create(v.Class.UNIVERSAL,v.Type.NULL,!1,""));var s=v.create(v.Class.UNIVERSAL,v.Type.OCTETSTRING,!1,t.digest().getBytes());return i.value.push(a),i.value.push(s),v.toDer(i).getBytes()},Es=function(t,e,r){if(r)return t.modPow(e.e,e.n);if(!e.p||!e.q)return t.modPow(e.d,e.n);e.dP||(e.dP=e.d.mod(e.p.subtract(j.ONE))),e.dQ||(e.dQ=e.d.mod(e.q.subtract(j.ONE))),e.qInv||(e.qInv=e.q.modInverse(e.p));var n;do n=new j(M.util.bytesToHex(M.random.getBytes(e.n.bitLength()/8)),16);while(n.compareTo(e.n)>=0||!n.gcd(e.n).equals(j.ONE));t=t.multiply(n.modPow(e.e,e.n)).mod(e.n);for(var i=t.mod(e.p).modPow(e.dP,e.p),a=t.mod(e.q).modPow(e.dQ,e.q);i.compareTo(a)<0;)i=i.add(e.p);var s=i.subtract(a).multiply(e.qInv).mod(e.p).multiply(e.q).add(a);return s=s.multiply(n.modInverse(e.n)).mod(e.n),s};G.rsa.encrypt=function(t,e,r){var n=r,i,a=Math.ceil(e.n.bitLength()/8);r!==!1&&r!==!0?(n=r===2,i=ws(t,e,r)):(i=M.util.createBuffer(),i.putBytes(t));for(var s=new j(i.toHex(),16),o=Es(s,e,n),f=o.toString(16),c=M.util.createBuffer(),u=a-Math.ceil(f.length/2);u>0;)c.putByte(0),--u;return c.putBytes(M.util.hexToBytes(f)),c.getBytes()};G.rsa.decrypt=function(t,e,r,n){var i=Math.ceil(e.n.bitLength()/8);if(t.length!==i){var a=new Error("Encrypted message length is invalid.");throw a.length=t.length,a.expected=i,a}var s=new j(M.util.createBuffer(t).toHex(),16);if(s.compareTo(e.n)>=0)throw new Error("Encrypted message is invalid.");for(var o=Es(s,e,r),f=o.toString(16),c=M.util.createBuffer(),u=i-Math.ceil(f.length/2);u>0;)c.putByte(0),--u;return c.putBytes(M.util.hexToBytes(f)),n!==!1?xn(c.getBytes(),e,r):c.getBytes()};G.rsa.createKeyPairGenerationState=function(t,e,r){typeof t=="string"&&(t=parseInt(t,10)),t=t||2048,r=r||{};var n=r.prng||M.random,i={nextBytes:function(o){for(var f=n.getBytesSync(o.length),c=0;c<o.length;++c)o[c]=f.charCodeAt(c)}},a=r.algorithm||"PRIMEINC",s;if(a==="PRIMEINC")s={algorithm:a,state:0,bits:t,rng:i,eInt:e||65537,e:new j(null),p:null,q:null,qBits:t>>1,pBits:t-(t>>1),pqState:0,num:null,keys:null},s.e.fromInt(s.eInt);else throw new Error("Invalid key generation algorithm: "+a);return s};G.rsa.stepKeyPairGenerationState=function(t,e){"algorithm"in t||(t.algorithm="PRIMEINC");var r=new j(null);r.fromInt(30);for(var n=0,i=function(h,p){return h|p},a=+new Date,s,o=0;t.keys===null&&(e<=0||o<e);){if(t.state===0){var f=t.p===null?t.pBits:t.qBits,c=f-1;t.pqState===0?(t.num=new j(f,t.rng),t.num.testBit(c)||t.num.bitwiseTo(j.ONE.shiftLeft(c),i,t.num),t.num.dAddOffset(31-t.num.mod(r).byteValue(),0),n=0,++t.pqState):t.pqState===1?t.num.bitLength()>f?t.pqState=0:t.num.isProbablePrime(Oh(t.num.bitLength()))?++t.pqState:t.num.dAddOffset(Rh[n++%8],0):t.pqState===2?t.pqState=t.num.subtract(j.ONE).gcd(t.e).compareTo(j.ONE)===0?3:0:t.pqState===3&&(t.pqState=0,t.p===null?t.p=t.num:t.q=t.num,t.p!==null&&t.q!==null&&++t.state,t.num=null)}else if(t.state===1)t.p.compareTo(t.q)<0&&(t.num=t.p,t.p=t.q,t.q=t.num),++t.state;else if(t.state===2)t.p1=t.p.subtract(j.ONE),t.q1=t.q.subtract(j.ONE),t.phi=t.p1.multiply(t.q1),++t.state;else if(t.state===3)t.phi.gcd(t.e).compareTo(j.ONE)===0?++t.state:(t.p=null,t.q=null,t.state=0);else if(t.state===4)t.n=t.p.multiply(t.q),t.n.bitLength()===t.bits?++t.state:(t.q=null,t.state=0);else if(t.state===5){var u=t.e.modInverse(t.phi);t.keys={privateKey:G.rsa.setPrivateKey(t.n,t.e,u,t.p,t.q,u.mod(t.p1),u.mod(t.q1),t.q.modInverse(t.p)),publicKey:G.rsa.setPublicKey(t.n,t.e)}}s=+new Date,o+=s-a,a=s}return t.keys!==null};G.rsa.generateKeyPair=function(t,e,r,n){if(arguments.length===1?typeof t=="object"?(r=t,t=void 0):typeof t=="function"&&(n=t,t=void 0):arguments.length===2?typeof t=="number"?typeof e=="function"?(n=e,e=void 0):typeof e!="number"&&(r=e,e=void 0):(r=t,n=e,t=void 0,e=void 0):arguments.length===3&&(typeof e=="number"?typeof r=="function"&&(n=r,r=void 0):(n=r,r=e,e=void 0)),r=r||{},t===void 0&&(t=r.bits||2048),e===void 0&&(e=r.e||65537),!M.options.usePureJavaScript&&!r.prng&&t>=256&&t<=16384&&(e===65537||e===3)){if(n){if(gs("generateKeyPair"))return Ui.generateKeyPair("rsa",{modulusLength:t,publicExponent:e,publicKeyEncoding:{type:"spki",format:"pem"},privateKeyEncoding:{type:"pkcs8",format:"pem"}},function(o,f,c){if(o)return n(o);n(null,{privateKey:G.privateKeyFromPem(c),publicKey:G.publicKeyFromPem(f)})});if(ms("generateKey")&&ms("exportKey"))return zt.globalScope.crypto.subtle.generateKey({name:"RSASSA-PKCS1-v1_5",modulusLength:t,publicExponent:bs(e),hash:{name:"SHA-256"}},!0,["sign","verify"]).then(function(o){return zt.globalScope.crypto.subtle.exportKey("pkcs8",o.privateKey)}).then(void 0,function(o){n(o)}).then(function(o){if(o){var f=G.privateKeyFromAsn1(v.fromDer(M.util.createBuffer(o)));n(null,{privateKey:f,publicKey:G.setRsaPublicKey(f.n,f.e)})}});if(vs("generateKey")&&vs("exportKey")){var i=zt.globalScope.msCrypto.subtle.generateKey({name:"RSASSA-PKCS1-v1_5",modulusLength:t,publicExponent:bs(e),hash:{name:"SHA-256"}},!0,["sign","verify"]);i.oncomplete=function(o){var f=o.target.result,c=zt.globalScope.msCrypto.subtle.exportKey("pkcs8",f.privateKey);c.oncomplete=function(u){var h=u.target.result,p=G.privateKeyFromAsn1(v.fromDer(M.util.createBuffer(h)));n(null,{privateKey:p,publicKey:G.setRsaPublicKey(p.n,p.e)})},c.onerror=function(u){n(u)}},i.onerror=function(o){n(o)};return}}else if(gs("generateKeyPairSync")){var a=Ui.generateKeyPairSync("rsa",{modulusLength:t,publicExponent:e,publicKeyEncoding:{type:"spki",format:"pem"},privateKeyEncoding:{type:"pkcs8",format:"pem"}});return{privateKey:G.privateKeyFromPem(a.privateKey),publicKey:G.publicKeyFromPem(a.publicKey)}}}var s=G.rsa.createKeyPairGenerationState(t,e,r);if(!n)return G.rsa.stepKeyPairGenerationState(s,0),s.keys;Kh(s,r,n)};G.setRsaPublicKey=G.rsa.setPublicKey=function(t,e){var r={n:t,e};return r.encrypt=function(n,i,a){if(typeof i=="string"?i=i.toUpperCase():i===void 0&&(i="RSAES-PKCS1-V1_5"),i==="RSAES-PKCS1-V1_5")i={encode:function(o,f,c){return ws(o,f,2).getBytes()}};else if(i==="RSA-OAEP"||i==="RSAES-OAEP")i={encode:function(o,f){return M.pkcs1.encode_rsa_oaep(f,o,a)}};else if(["RAW","NONE","NULL",null].indexOf(i)!==-1)i={encode:function(o){return o}};else if(typeof i=="string")throw new Error('Unsupported encryption scheme: "'+i+'".');var s=i.encode(n,r,!0);return G.rsa.encrypt(s,r,!0)},r.verify=function(n,i,a,s){typeof a=="string"?a=a.toUpperCase():a===void 0&&(a="RSASSA-PKCS1-V1_5"),s===void 0&&(s={_parseAllDigestBytes:!0}),"_parseAllDigestBytes"in s||(s._parseAllDigestBytes=!0),a==="RSASSA-PKCS1-V1_5"?a={verify:function(f,c){c=xn(c,r,!0);var u=v.fromDer(c,{parseAllBytes:s._parseAllDigestBytes}),h={},p=[];if(!v.validate(u,Ph,h,p)){var x=new Error("ASN.1 object does not contain a valid RSASSA-PKCS1-v1_5 DigestInfo value.");throw x.errors=p,x}var l=v.derToOid(h.algorithmIdentifier);if(!(l===M.oids.md2||l===M.oids.md5||l===M.oids.sha1||l===M.oids.sha224||l===M.oids.sha256||l===M.oids.sha384||l===M.oids.sha512||l===M.oids["sha512-224"]||l===M.oids["sha512-256"])){var x=new Error("Unknown RSASSA-PKCS1-v1_5 DigestAlgorithm identifier.");throw x.oid=l,x}if((l===M.oids.md2||l===M.oids.md5)&&!("parameters"in h))throw new Error("ASN.1 object does not contain a valid RSASSA-PKCS1-v1_5 DigestInfo value. Missing algorithm identifer NULL parameters.");return f===h.digest}}:(a==="NONE"||a==="NULL"||a===null)&&(a={verify:function(f,c){return c=xn(c,r,!0),f===c}});var o=G.rsa.decrypt(i,r,!0,!1);return a.verify(n,o,r.n.bitLength())},r};G.setRsaPrivateKey=G.rsa.setPrivateKey=function(t,e,r,n,i,a,s,o){var f={n:t,e,d:r,p:n,q:i,dP:a,dQ:s,qInv:o};return f.decrypt=function(c,u,h){typeof u=="string"?u=u.toUpperCase():u===void 0&&(u="RSAES-PKCS1-V1_5");var p=G.rsa.decrypt(c,f,!1,!1);if(u==="RSAES-PKCS1-V1_5")u={decode:xn};else if(u==="RSA-OAEP"||u==="RSAES-OAEP")u={decode:function(x,l){return M.pkcs1.decode_rsa_oaep(l,x,h)}};else if(["RAW","NONE","NULL",null].indexOf(u)!==-1)u={decode:function(x){return x}};else throw new Error('Unsupported encryption scheme: "'+u+'".');return u.decode(p,f,!1)},f.sign=function(c,u){var h=!1;typeof u=="string"&&(u=u.toUpperCase()),u===void 0||u==="RSASSA-PKCS1-V1_5"?(u={encode:Uh},h=1):(u==="NONE"||u==="NULL"||u===null)&&(u={encode:function(){return c}},h=1);var p=u.encode(c,f.n.bitLength());return G.rsa.encrypt(p,f,h)},f};G.wrapRsaPrivateKey=function(t){return v.create(v.Class.UNIVERSAL,v.Type.SEQUENCE,!0,[v.create(v.Class.UNIVERSAL,v.Type.INTEGER,!1,v.integerToDer(0).getBytes()),v.create(v.Class.UNIVERSAL,v.Type.SEQUENCE,!0,[v.create(v.Class.UNIVERSAL,v.Type.OID,!1,v.oidToDer(G.oids.rsaEncryption).getBytes()),v.create(v.Class.UNIVERSAL,v.Type.NULL,!1,"")]),v.create(v.Class.UNIVERSAL,v.Type.OCTETSTRING,!1,v.toDer(t).getBytes())])};G.privateKeyFromAsn1=function(t){var e={},r=[];if(v.validate(t,Lh,e,r)&&(t=v.fromDer(M.util.createBuffer(e.privateKey))),e={},r=[],!v.validate(t,Nh,e,r)){var n=new Error("Cannot read private key. ASN.1 object does not contain an RSAPrivateKey.");throw n.errors=r,n}var i,a,s,o,f,c,u,h;return i=M.util.createBuffer(e.privateKeyModulus).toHex(),a=M.util.createBuffer(e.privateKeyPublicExponent).toHex(),s=M.util.createBuffer(e.privateKeyPrivateExponent).toHex(),o=M.util.createBuffer(e.privateKeyPrime1).toHex(),f=M.util.createBuffer(e.privateKeyPrime2).toHex(),c=M.util.createBuffer(e.privateKeyExponent1).toHex(),u=M.util.createBuffer(e.privateKeyExponent2).toHex(),h=M.util.createBuffer(e.privateKeyCoefficient).toHex(),G.setRsaPrivateKey(new j(i,16),new j(a,16),new j(s,16),new j(o,16),new j(f,16),new j(c,16),new j(u,16),new j(h,16))};G.privateKeyToAsn1=G.privateKeyToRSAPrivateKey=function(t){return v.create(v.Class.UNIVERSAL,v.Type.SEQUENCE,!0,[v.create(v.Class.UNIVERSAL,v.Type.INTEGER,!1,v.integerToDer(0).getBytes()),v.create(v.Class.UNIVERSAL,v.Type.INTEGER,!1,fe(t.n)),v.create(v.Class.UNIVERSAL,v.Type.INTEGER,!1,fe(t.e)),v.create(v.Class.UNIVERSAL,v.Type.INTEGER,!1,fe(t.d)),v.create(v.Class.UNIVERSAL,v.Type.INTEGER,!1,fe(t.p)),v.create(v.Class.UNIVERSAL,v.Type.INTEGER,!1,fe(t.q)),v.create(v.Class.UNIVERSAL,v.Type.INTEGER,!1,fe(t.dP)),v.create(v.Class.UNIVERSAL,v.Type.INTEGER,!1,fe(t.dQ)),v.create(v.Class.UNIVERSAL,v.Type.INTEGER,!1,fe(t.qInv))])};G.publicKeyFromAsn1=function(t){var e={},r=[];if(v.validate(t,kh,e,r)){var n=v.derToOid(e.publicKeyOid);if(n!==G.oids.rsaEncryption){var i=new Error("Cannot read public key. Unknown OID.");throw i.oid=n,i}t=e.rsaPublicKey}if(r=[],!v.validate(t,Dh,e,r)){var i=new Error("Cannot read public key. ASN.1 object does not contain an RSAPublicKey.");throw i.errors=r,i}var a=M.util.createBuffer(e.publicKeyModulus).toHex(),s=M.util.createBuffer(e.publicKeyExponent).toHex();return G.setRsaPublicKey(new j(a,16),new j(s,16))};G.publicKeyToAsn1=G.publicKeyToSubjectPublicKeyInfo=function(t){return v.create(v.Class.UNIVERSAL,v.Type.SEQUENCE,!0,[v.create(v.Class.UNIVERSAL,v.Type.SEQUENCE,!0,[v.create(v.Class.UNIVERSAL,v.Type.OID,!1,v.oidToDer(G.oids.rsaEncryption).getBytes()),v.create(v.Class.UNIVERSAL,v.Type.NULL,!1,"")]),v.create(v.Class.UNIVERSAL,v.Type.BITSTRING,!1,[G.publicKeyToRSAPublicKey(t)])])};G.publicKeyToRSAPublicKey=function(t){return v.create(v.Class.UNIVERSAL,v.Type.SEQUENCE,!0,[v.create(v.Class.UNIVERSAL,v.Type.INTEGER,!1,fe(t.n)),v.create(v.Class.UNIVERSAL,v.Type.INTEGER,!1,fe(t.e))])};function ws(t,e,r){var n=M.util.createBuffer(),i=Math.ceil(e.n.bitLength()/8);if(t.length>i-11){var a=new Error("Message is too long for PKCS#1 v1.5 padding.");throw a.length=t.length,a.max=i-11,a}n.putByte(0),n.putByte(r);var s=i-3-t.length,o;if(r===0||r===1){o=r===0?0:255;for(var f=0;f<s;++f)n.putByte(o)}else for(;s>0;){for(var c=0,u=M.random.getBytes(s),f=0;f<s;++f)o=u.charCodeAt(f),o===0?++c:n.putByte(o);s=c}return n.putByte(0),n.putBytes(t),n}function xn(t,e,r,n){var i=Math.ceil(e.n.bitLength()/8),a=M.util.createBuffer(t),s=a.getByte(),o=a.getByte();if(s!==0||r&&o!==0&&o!==1||!r&&o!=2||r&&o===0&&typeof n>"u")throw new Error("Encryption block is invalid.");var f=0;if(o===0){f=i-3-n;for(var c=0;c<f;++c)if(a.getByte()!==0)throw new Error("Encryption block is invalid.")}else if(o===1)for(f=0;a.length()>1;){if(a.getByte()!==255){--a.read;break}++f}else if(o===2)for(f=0;a.length()>1;){if(a.getByte()===0){--a.read;break}++f}var u=a.getByte();if(u!==0||f!==i-3-a.length())throw new Error("Encryption block is invalid.");return a.getBytes()}function Kh(t,e,r){typeof e=="function"&&(r=e,e={}),e=e||{};var n={algorithm:{name:e.algorithm||"PRIMEINC",options:{workers:e.workers||2,workLoad:e.workLoad||100,workerScript:e.workerScript}}};"prng"in e&&(n.prng=e.prng),i();function i(){a(t.pBits,function(o,f){if(o)return r(o);if(t.p=f,t.q!==null)return s(o,t.q);a(t.qBits,s)})}function a(o,f){M.prime.generateProbablePrime(o,n,f)}function s(o,f){if(o)return r(o);if(t.q=f,t.p.compareTo(t.q)<0){var c=t.p;t.p=t.q,t.q=c}if(t.p.subtract(j.ONE).gcd(t.e).compareTo(j.ONE)!==0){t.p=null,i();return}if(t.q.subtract(j.ONE).gcd(t.e).compareTo(j.ONE)!==0){t.q=null,a(t.qBits,s);return}if(t.p1=t.p.subtract(j.ONE),t.q1=t.q.subtract(j.ONE),t.phi=t.p1.multiply(t.q1),t.phi.gcd(t.e).compareTo(j.ONE)!==0){t.p=t.q=null,i();return}if(t.n=t.p.multiply(t.q),t.n.bitLength()!==t.bits){t.q=null,a(t.qBits,s);return}var u=t.e.modInverse(t.phi);t.keys={privateKey:G.rsa.setPrivateKey(t.n,t.e,u,t.p,t.q,u.mod(t.p1),u.mod(t.q1),t.q.modInverse(t.p)),publicKey:G.rsa.setPublicKey(t.n,t.e)},r(null,t.keys)}}function fe(t){var e=t.toString(16);e[0]>="8"&&(e="00"+e);var r=M.util.hexToBytes(e);return r.length>1&&(r.charCodeAt(0)===0&&!(r.charCodeAt(1)&128)||r.charCodeAt(0)===255&&(r.charCodeAt(1)&128)===128)?r.substr(1):r}function Oh(t){return t<=100?27:t<=150?18:t<=200?15:t<=250?12:t<=300?9:t<=350?8:t<=400?7:t<=500?6:t<=600?5:t<=800?4:t<=1250?3:2}function gs(t){return M.util.isNodejs&&typeof Ui[t]=="function"}function ms(t){return typeof zt.globalScope<"u"&&typeof zt.globalScope.crypto=="object"&&typeof zt.globalScope.crypto.subtle=="object"&&typeof zt.globalScope.crypto.subtle[t]=="function"}function vs(t){return typeof zt.globalScope<"u"&&typeof zt.globalScope.msCrypto=="object"&&typeof zt.globalScope.msCrypto.subtle=="object"&&typeof zt.globalScope.msCrypto.subtle[t]=="function"}function bs(t){for(var e=M.util.hexToBytes(t.toString(16)),r=new Uint8Array(e.length),n=0;n<e.length;++n)r[n]=e.charCodeAt(n);return r}});var _s=ft((ny,Ts)=>{var U=it();Jr();Lr();ko();qe();nn();Ii();qo();Nr();jo();gn();bt();typeof Bs>"u"&&(Bs=U.jsbn.BigInteger);var Bs,B=U.asn1,W=U.pki=U.pki||{};Ts.exports=W.pbe=U.pbe=U.pbe||{};var ze=W.oids,Mh={name:"EncryptedPrivateKeyInfo",tagClass:B.Class.UNIVERSAL,type:B.Type.SEQUENCE,constructed:!0,value:[{name:"EncryptedPrivateKeyInfo.encryptionAlgorithm",tagClass:B.Class.UNIVERSAL,type:B.Type.SEQUENCE,constructed:!0,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:B.Class.UNIVERSAL,type:B.Type.OID,constructed:!1,capture:"encryptionOid"},{name:"AlgorithmIdentifier.parameters",tagClass:B.Class.UNIVERSAL,type:B.Type.SEQUENCE,constructed:!0,captureAsn1:"encryptionParams"}]},{name:"EncryptedPrivateKeyInfo.encryptedData",tagClass:B.Class.UNIVERSAL,type:B.Type.OCTETSTRING,constructed:!1,capture:"encryptedData"}]},Vh={name:"PBES2Algorithms",tagClass:B.Class.UNIVERSAL,type:B.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.keyDerivationFunc",tagClass:B.Class.UNIVERSAL,type:B.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.keyDerivationFunc.oid",tagClass:B.Class.UNIVERSAL,type:B.Type.OID,constructed:!1,capture:"kdfOid"},{name:"PBES2Algorithms.params",tagClass:B.Class.UNIVERSAL,type:B.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.params.salt",tagClass:B.Class.UNIVERSAL,type:B.Type.OCTETSTRING,constructed:!1,capture:"kdfSalt"},{name:"PBES2Algorithms.params.iterationCount",tagClass:B.Class.UNIVERSAL,type:B.Type.INTEGER,constructed:!1,capture:"kdfIterationCount"},{name:"PBES2Algorithms.params.keyLength",tagClass:B.Class.UNIVERSAL,type:B.Type.INTEGER,constructed:!1,optional:!0,capture:"keyLength"},{name:"PBES2Algorithms.params.prf",tagClass:B.Class.UNIVERSAL,type:B.Type.SEQUENCE,constructed:!0,optional:!0,value:[{name:"PBES2Algorithms.params.prf.algorithm",tagClass:B.Class.UNIVERSAL,type:B.Type.OID,constructed:!1,capture:"prfOid"}]}]}]},{name:"PBES2Algorithms.encryptionScheme",tagClass:B.Class.UNIVERSAL,type:B.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.encryptionScheme.oid",tagClass:B.Class.UNIVERSAL,type:B.Type.OID,constructed:!1,capture:"encOid"},{name:"PBES2Algorithms.encryptionScheme.iv",tagClass:B.Class.UNIVERSAL,type:B.Type.OCTETSTRING,constructed:!1,capture:"encIv"}]}]},qh={name:"pkcs-12PbeParams",tagClass:B.Class.UNIVERSAL,type:B.Type.SEQUENCE,constructed:!0,value:[{name:"pkcs-12PbeParams.salt",tagClass:B.Class.UNIVERSAL,type:B.Type.OCTETSTRING,constructed:!1,capture:"salt"},{name:"pkcs-12PbeParams.iterations",tagClass:B.Class.UNIVERSAL,type:B.Type.INTEGER,constructed:!1,capture:"iterations"}]};W.encryptPrivateKeyInfo=function(t,e,r){r=r||{},r.saltSize=r.saltSize||8,r.count=r.count||2048,r.algorithm=r.algorithm||"aes128",r.prfAlgorithm=r.prfAlgorithm||"sha1";var n=U.random.getBytesSync(r.saltSize),i=r.count,a=B.integerToDer(i),s,o,f;if(r.algorithm.indexOf("aes")===0||r.algorithm==="des"){var c,u,h;switch(r.algorithm){case"aes128":s=16,c=16,u=ze["aes128-CBC"],h=U.aes.createEncryptionCipher;break;case"aes192":s=24,c=16,u=ze["aes192-CBC"],h=U.aes.createEncryptionCipher;break;case"aes256":s=32,c=16,u=ze["aes256-CBC"],h=U.aes.createEncryptionCipher;break;case"des":s=8,c=8,u=ze.desCBC,h=U.des.createEncryptionCipher;break;default:var p=new Error("Cannot encrypt private key. Unknown encryption algorithm.");throw p.algorithm=r.algorithm,p}var x="hmacWith"+r.prfAlgorithm.toUpperCase(),l=Is(x),d=U.pkcs5.pbkdf2(e,n,i,s,l),y=U.random.getBytesSync(c),m=h(d);m.start(y),m.update(B.toDer(t)),m.finish(),f=m.output.getBytes();var E=Fh(n,a,s,x);o=B.create(B.Class.UNIVERSAL,B.Type.SEQUENCE,!0,[B.create(B.Class.UNIVERSAL,B.Type.OID,!1,B.oidToDer(ze.pkcs5PBES2).getBytes()),B.create(B.Class.UNIVERSAL,B.Type.SEQUENCE,!0,[B.create(B.Class.UNIVERSAL,B.Type.SEQUENCE,!0,[B.create(B.Class.UNIVERSAL,B.Type.OID,!1,B.oidToDer(ze.pkcs5PBKDF2).getBytes()),E]),B.create(B.Class.UNIVERSAL,B.Type.SEQUENCE,!0,[B.create(B.Class.UNIVERSAL,B.Type.OID,!1,B.oidToDer(u).getBytes()),B.create(B.Class.UNIVERSAL,B.Type.OCTETSTRING,!1,y)])])])}else if(r.algorithm==="3des"){s=24;var b=new U.util.ByteBuffer(n),d=W.pbe.generatePkcs12Key(e,b,1,i,s),y=W.pbe.generatePkcs12Key(e,b,2,i,s),m=U.des.createEncryptionCipher(d);m.start(y),m.update(B.toDer(t)),m.finish(),f=m.output.getBytes(),o=B.create(B.Class.UNIVERSAL,B.Type.SEQUENCE,!0,[B.create(B.Class.UNIVERSAL,B.Type.OID,!1,B.oidToDer(ze["pbeWithSHAAnd3-KeyTripleDES-CBC"]).getBytes()),B.create(B.Class.UNIVERSAL,B.Type.SEQUENCE,!0,[B.create(B.Class.UNIVERSAL,B.Type.OCTETSTRING,!1,n),B.create(B.Class.UNIVERSAL,B.Type.INTEGER,!1,a.getBytes())])])}else{var p=new Error("Cannot encrypt private key. Unknown encryption algorithm.");throw p.algorithm=r.algorithm,p}var R=B.create(B.Class.UNIVERSAL,B.Type.SEQUENCE,!0,[o,B.create(B.Class.UNIVERSAL,B.Type.OCTETSTRING,!1,f)]);return R};W.decryptPrivateKeyInfo=function(t,e){var r=null,n={},i=[];if(!B.validate(t,Mh,n,i)){var a=new Error("Cannot read encrypted private key. ASN.1 object is not a supported EncryptedPrivateKeyInfo.");throw a.errors=i,a}var s=B.derToOid(n.encryptionOid),o=W.pbe.getCipher(s,n.encryptionParams,e),f=U.util.createBuffer(n.encryptedData);return o.update(f),o.finish()&&(r=B.fromDer(o.output)),r};W.encryptedPrivateKeyToPem=function(t,e){var r={type:"ENCRYPTED PRIVATE KEY",body:B.toDer(t).getBytes()};return U.pem.encode(r,{maxline:e})};W.encryptedPrivateKeyFromPem=function(t){var e=U.pem.decode(t)[0];if(e.type!=="ENCRYPTED PRIVATE KEY"){var r=new Error('Could not convert encrypted private key from PEM; PEM header type is "ENCRYPTED PRIVATE KEY".');throw r.headerType=e.type,r}if(e.procType&&e.procType.type==="ENCRYPTED")throw new Error("Could not convert encrypted private key from PEM; PEM is encrypted.");return B.fromDer(e.body)};W.encryptRsaPrivateKey=function(t,e,r){if(r=r||{},!r.legacy){var n=W.wrapRsaPrivateKey(W.privateKeyToAsn1(t));return n=W.encryptPrivateKeyInfo(n,e,r),W.encryptedPrivateKeyToPem(n)}var i,a,s,o;switch(r.algorithm){case"aes128":i="AES-128-CBC",s=16,a=U.random.getBytesSync(16),o=U.aes.createEncryptionCipher;break;case"aes192":i="AES-192-CBC",s=24,a=U.random.getBytesSync(16),o=U.aes.createEncryptionCipher;break;case"aes256":i="AES-256-CBC",s=32,a=U.random.getBytesSync(16),o=U.aes.createEncryptionCipher;break;case"3des":i="DES-EDE3-CBC",s=24,a=U.random.getBytesSync(8),o=U.des.createEncryptionCipher;break;case"des":i="DES-CBC",s=8,a=U.random.getBytesSync(8),o=U.des.createEncryptionCipher;break;default:var f=new Error('Could not encrypt RSA private key; unsupported encryption algorithm "'+r.algorithm+'".');throw f.algorithm=r.algorithm,f}var c=U.pbe.opensslDeriveBytes(e,a.substr(0,8),s),u=o(c);u.start(a),u.update(B.toDer(W.privateKeyToAsn1(t))),u.finish();var h={type:"RSA PRIVATE KEY",procType:{version:"4",type:"ENCRYPTED"},dekInfo:{algorithm:i,parameters:U.util.bytesToHex(a).toUpperCase()},body:u.output.getBytes()};return U.pem.encode(h)};W.decryptRsaPrivateKey=function(t,e){var r=null,n=U.pem.decode(t)[0];if(n.type!=="ENCRYPTED PRIVATE KEY"&&n.type!=="PRIVATE KEY"&&n.type!=="RSA PRIVATE KEY"){var i=new Error('Could not convert private key from PEM; PEM header type is not "ENCRYPTED PRIVATE KEY", "PRIVATE KEY", or "RSA PRIVATE KEY".');throw i.headerType=i,i}if(n.procType&&n.procType.type==="ENCRYPTED"){var a,s;switch(n.dekInfo.algorithm){case"DES-CBC":a=8,s=U.des.createDecryptionCipher;break;case"DES-EDE3-CBC":a=24,s=U.des.createDecryptionCipher;break;case"AES-128-CBC":a=16,s=U.aes.createDecryptionCipher;break;case"AES-192-CBC":a=24,s=U.aes.createDecryptionCipher;break;case"AES-256-CBC":a=32,s=U.aes.createDecryptionCipher;break;case"RC2-40-CBC":a=5,s=function(h){return U.rc2.createDecryptionCipher(h,40)};break;case"RC2-64-CBC":a=8,s=function(h){return U.rc2.createDecryptionCipher(h,64)};break;case"RC2-128-CBC":a=16,s=function(h){return U.rc2.createDecryptionCipher(h,128)};break;default:var i=new Error('Could not decrypt private key; unsupported encryption algorithm "'+n.dekInfo.algorithm+'".');throw i.algorithm=n.dekInfo.algorithm,i}var o=U.util.hexToBytes(n.dekInfo.parameters),f=U.pbe.opensslDeriveBytes(e,o.substr(0,8),a),c=s(f);if(c.start(o),c.update(U.util.createBuffer(n.body)),c.finish())r=c.output.getBytes();else return r}else r=n.body;return n.type==="ENCRYPTED PRIVATE KEY"?r=W.decryptPrivateKeyInfo(B.fromDer(r),e):r=B.fromDer(r),r!==null&&(r=W.privateKeyFromAsn1(r)),r};W.pbe.generatePkcs12Key=function(t,e,r,n,i,a){var s,o;if(typeof a>"u"||a===null){if(!("sha1"in U.md))throw new Error('"sha1" hash algorithm unavailable.');a=U.md.sha1.create()}var f=a.digestLength,c=a.blockLength,u=new U.util.ByteBuffer,h=new U.util.ByteBuffer;if(t!=null){for(o=0;o<t.length;o++)h.putInt16(t.charCodeAt(o));h.putInt16(0)}var p=h.length(),x=e.length(),l=new U.util.ByteBuffer;l.fillWithByte(r,c);var d=c*Math.ceil(x/c),y=new U.util.ByteBuffer;for(o=0;o<d;o++)y.putByte(e.at(o%x));var m=c*Math.ceil(p/c),E=new U.util.ByteBuffer;for(o=0;o<m;o++)E.putByte(h.at(o%p));var b=y;b.putBuffer(E);for(var R=Math.ceil(i/f),w=1;w<=R;w++){var S=new U.util.ByteBuffer;S.putBytes(l.bytes()),S.putBytes(b.bytes());for(var L=0;L<n;L++)a.start(),a.update(S.getBytes()),S=a.digest();var N=new U.util.ByteBuffer;for(o=0;o<c;o++)N.putByte(S.at(o%f));var z=Math.ceil(x/c)+Math.ceil(p/c),H=new U.util.ByteBuffer;for(s=0;s<z;s++){var V=new U.util.ByteBuffer(b.getBytes(c)),Q=511;for(o=N.length()-1;o>=0;o--)Q=Q>>8,Q+=N.at(o)+V.at(o),V.setAt(o,Q&255);H.putBuffer(V)}b=H,u.putBuffer(S)}return u.truncate(u.length()-i),u};W.pbe.getCipher=function(t,e,r){switch(t){case W.oids.pkcs5PBES2:return W.pbe.getCipherForPBES2(t,e,r);case W.oids["pbeWithSHAAnd3-KeyTripleDES-CBC"]:case W.oids["pbewithSHAAnd40BitRC2-CBC"]:return W.pbe.getCipherForPKCS12PBE(t,e,r);default:var n=new Error("Cannot read encrypted PBE data block. Unsupported OID.");throw n.oid=t,n.supportedOids=["pkcs5PBES2","pbeWithSHAAnd3-KeyTripleDES-CBC","pbewithSHAAnd40BitRC2-CBC"],n}};W.pbe.getCipherForPBES2=function(t,e,r){var n={},i=[];if(!B.validate(e,Vh,n,i)){var a=new Error("Cannot read password-based-encryption algorithm parameters. ASN.1 object is not a supported EncryptedPrivateKeyInfo.");throw a.errors=i,a}if(t=B.derToOid(n.kdfOid),t!==W.oids.pkcs5PBKDF2){var a=new Error("Cannot read encrypted private key. Unsupported key derivation function OID.");throw a.oid=t,a.supportedOids=["pkcs5PBKDF2"],a}if(t=B.derToOid(n.encOid),t!==W.oids["aes128-CBC"]&&t!==W.oids["aes192-CBC"]&&t!==W.oids["aes256-CBC"]&&t!==W.oids["des-EDE3-CBC"]&&t!==W.oids.desCBC){var a=new Error("Cannot read encrypted private key. Unsupported encryption scheme OID.");throw a.oid=t,a.supportedOids=["aes128-CBC","aes192-CBC","aes256-CBC","des-EDE3-CBC","desCBC"],a}var s=n.kdfSalt,o=U.util.createBuffer(n.kdfIterationCount);o=o.getInt(o.length()<<3);var f,c;switch(W.oids[t]){case"aes128-CBC":f=16,c=U.aes.createDecryptionCipher;break;case"aes192-CBC":f=24,c=U.aes.createDecryptionCipher;break;case"aes256-CBC":f=32,c=U.aes.createDecryptionCipher;break;case"des-EDE3-CBC":f=24,c=U.des.createDecryptionCipher;break;case"desCBC":f=8,c=U.des.createDecryptionCipher;break}var u=Cs(n.prfOid),h=U.pkcs5.pbkdf2(r,s,o,f,u),p=n.encIv,x=c(h);return x.start(p),x};W.pbe.getCipherForPKCS12PBE=function(t,e,r){var n={},i=[];if(!B.validate(e,qh,n,i)){var a=new Error("Cannot read password-based-encryption algorithm parameters. ASN.1 object is not a supported EncryptedPrivateKeyInfo.");throw a.errors=i,a}var s=U.util.createBuffer(n.salt),o=U.util.createBuffer(n.iterations);o=o.getInt(o.length()<<3);var f,c,u;switch(t){case W.oids["pbeWithSHAAnd3-KeyTripleDES-CBC"]:f=24,c=8,u=U.des.startDecrypting;break;case W.oids["pbewithSHAAnd40BitRC2-CBC"]:f=5,c=8,u=function(d,y){var m=U.rc2.createDecryptionCipher(d,40);return m.start(y,null),m};break;default:var a=new Error("Cannot read PKCS #12 PBE data block. Unsupported OID.");throw a.oid=t,a}var h=Cs(n.prfOid),p=W.pbe.generatePkcs12Key(r,s,1,o,f,h);h.start();var x=W.pbe.generatePkcs12Key(r,s,2,o,c,h);return u(p,x)};W.pbe.opensslDeriveBytes=function(t,e,r,n){if(typeof n>"u"||n===null){if(!("md5"in U.md))throw new Error('"md5" hash algorithm unavailable.');n=U.md.md5.create()}e===null&&(e="");for(var i=[As(n,t+e)],a=16,s=1;a<r;++s,a+=16)i.push(As(n,i[s-1]+t+e));return i.join("").substr(0,r)};function As(t,e){return t.start().update(e).digest().getBytes()}function Cs(t){var e;if(!t)e="hmacWithSHA1";else if(e=W.oids[B.derToOid(t)],!e){var r=new Error("Unsupported PRF OID.");throw r.oid=t,r.supported=["hmacWithSHA1","hmacWithSHA224","hmacWithSHA256","hmacWithSHA384","hmacWithSHA512"],r}return Is(e)}function Is(t){var e=U.md;switch(t){case"hmacWithSHA224":e=U.md.sha512;case"hmacWithSHA1":case"hmacWithSHA256":case"hmacWithSHA384":case"hmacWithSHA512":t=t.substr(8).toLowerCase();break;default:var r=new Error("Unsupported PRF algorithm.");throw r.algorithm=t,r.supported=["hmacWithSHA1","hmacWithSHA224","hmacWithSHA256","hmacWithSHA384","hmacWithSHA512"],r}if(!e||!(t in e))throw new Error("Unknown hash algorithm: "+t);return e[t].create()}function Fh(t,e,r,n){var i=B.create(B.Class.UNIVERSAL,B.Type.SEQUENCE,!0,[B.create(B.Class.UNIVERSAL,B.Type.OCTETSTRING,!1,t),B.create(B.Class.UNIVERSAL,B.Type.INTEGER,!1,e.getBytes())]);return n!=="hmacWithSHA1"&&i.value.push(B.create(B.Class.UNIVERSAL,B.Type.INTEGER,!1,U.util.hexToBytes(r.toString(16))),B.create(B.Class.UNIVERSAL,B.Type.SEQUENCE,!0,[B.create(B.Class.UNIVERSAL,B.Type.OID,!1,B.oidToDer(W.oids[n]).getBytes()),B.create(B.Class.UNIVERSAL,B.Type.NULL,!1,"")])),i}});var E0=ft((nx,b0)=>{var ht=it();qe();bt();var qr=b0.exports=ht.sha512=ht.sha512||{};ht.md.sha512=ht.md.algorithms.sha512=qr;var m0=ht.sha384=ht.sha512.sha384=ht.sha512.sha384||{};m0.create=function(){return qr.create("SHA-384")};ht.md.sha384=ht.md.algorithms.sha384=m0;ht.sha512.sha256=ht.sha512.sha256||{create:function(){return qr.create("SHA-512/256")}};ht.md["sha512/256"]=ht.md.algorithms["sha512/256"]=ht.sha512.sha256;ht.sha512.sha224=ht.sha512.sha224||{create:function(){return qr.create("SHA-512/224")}};ht.md["sha512/224"]=ht.md.algorithms["sha512/224"]=ht.sha512.sha224;qr.create=function(t){if(v0||sp(),typeof t>"u"&&(t="SHA-512"),!(t in Xe))throw new Error("Invalid SHA-512 algorithm: "+t);for(var e=Xe[t],r=null,n=ht.util.createBuffer(),i=new Array(80),a=0;a<80;++a)i[a]=new Array(2);var s=64;switch(t){case"SHA-384":s=48;break;case"SHA-512/256":s=32;break;case"SHA-512/224":s=28;break}var o={algorithm:t.replace("-","").toLowerCase(),blockLength:128,digestLength:s,messageLength:0,fullMessageLength:null,messageLengthSize:16};return o.start=function(){o.messageLength=0,o.fullMessageLength=o.messageLength128=[];for(var f=o.messageLengthSize/4,c=0;c<f;++c)o.fullMessageLength.push(0);n=ht.util.createBuffer(),r=new Array(e.length);for(var c=0;c<e.length;++c)r[c]=e[c].slice(0);return o},o.start(),o.update=function(f,c){c==="utf8"&&(f=ht.util.encodeUtf8(f));var u=f.length;o.messageLength+=u,u=[u/4294967296>>>0,u>>>0];for(var h=o.fullMessageLength.length-1;h>=0;--h)o.fullMessageLength[h]+=u[1],u[1]=u[0]+(o.fullMessageLength[h]/4294967296>>>0),o.fullMessageLength[h]=o.fullMessageLength[h]>>>0,u[0]=u[1]/4294967296>>>0;return n.putBytes(f),g0(r,i,n),(n.read>2048||n.length()===0)&&n.compact(),o},o.digest=function(){var f=ht.util.createBuffer();f.putBytes(n.bytes());var c=o.fullMessageLength[o.fullMessageLength.length-1]+o.messageLengthSize,u=c&o.blockLength-1;f.putBytes(xa.substr(0,o.blockLength-u));for(var h,p,x=o.fullMessageLength[0]*8,l=0;l<o.fullMessageLength.length-1;++l)h=o.fullMessageLength[l+1]*8,p=h/4294967296>>>0,x+=p,f.putInt32(x>>>0),x=h>>>0;f.putInt32(x);for(var d=new Array(r.length),l=0;l<r.length;++l)d[l]=r[l].slice(0);g0(d,i,f);var y=ht.util.createBuffer(),m;t==="SHA-512"?m=d.length:t==="SHA-384"?m=d.length-2:m=d.length-4;for(var l=0;l<m;++l)y.putInt32(d[l][0]),(l!==m-1||t!=="SHA-512/224")&&y.putInt32(d[l][1]);return y},o};var xa=null,v0=!1,ga=null,Xe=null;function sp(){xa="\x80",xa+=ht.util.fillString("\0",128),ga=[[1116352408,3609767458],[1899447441,602891725],[3049323471,3964484399],[3921009573,2173295548],[961987163,4081628472],[1508970993,3053834265],[2453635748,2937671579],[2870763221,3664609560],[3624381080,2734883394],[310598401,1164996542],[607225278,1323610764],[1426881987,3590304994],[1925078388,4068182383],[2162078206,991336113],[2614888103,633803317],[3248222580,3479774868],[3835390401,2666613458],[4022224774,944711139],[264347078,2341262773],[604807628,2007800933],[770255983,1495990901],[1249150122,1856431235],[1555081692,3175218132],[1996064986,2198950837],[2554220882,3999719339],[2821834349,766784016],[2952996808,2566594879],[3210313671,3203337956],[3336571891,1034457026],[3584528711,2466948901],[113926993,3758326383],[338241895,168717936],[666307205,1188179964],[773529912,1546045734],[1294757372,1522805485],[1396182291,2643833823],[1695183700,2343527390],[1986661051,1014477480],[2177026350,1206759142],[2456956037,344077627],[2730485921,1290863460],[2820302411,3158454273],[3259730800,3505952657],[3345764771,106217008],[3516065817,3606008344],[3600352804,1432725776],[4094571909,1467031594],[275423344,851169720],[430227734,3100823752],[506948616,1363258195],[659060556,3750685593],[883997877,3785050280],[958139571,3318307427],[1322822218,3812723403],[1537002063,2003034995],[1747873779,3602036899],[1955562222,1575990012],[2024104815,1125592928],[2227730452,2716904306],[2361852424,442776044],[2428436474,593698344],[2756734187,3733110249],[3204031479,2999351573],[3329325298,3815920427],[3391569614,3928383900],[3515267271,566280711],[3940187606,3454069534],[4118630271,4000239992],[116418474,1914138554],[174292421,2731055270],[289380356,3203993006],[460393269,320620315],[685471733,587496836],[852142971,1086792851],[1017036298,365543100],[1126000580,2618297676],[1288033470,3409855158],[1501505948,4234509866],[1607167915,987167468],[1816402316,1246189591]],Xe={},Xe["SHA-512"]=[[1779033703,4089235720],[3144134277,2227873595],[1013904242,4271175723],[2773480762,1595750129],[1359893119,2917565137],[2600822924,725511199],[528734635,4215389547],[1541459225,327033209]],Xe["SHA-384"]=[[3418070365,3238371032],[1654270250,914150663],[2438529370,812702999],[355462360,4144912697],[1731405415,4290775857],[2394180231,1750603025],[3675008525,1694076839],[1203062813,3204075428]],Xe["SHA-512/256"]=[[573645204,4230739756],[2673172387,3360449730],[596883563,1867755857],[2520282905,1497426621],[2519219938,2827943907],[3193839141,1401305490],[721525244,746961066],[246885852,2177182882]],Xe["SHA-512/224"]=[[2352822216,424955298],[1944164710,2312950998],[502970286,855612546],[1738396948,1479516111],[258812777,2077511080],[2011393907,79989058],[1067287976,1780299464],[286451373,2446758561]],v0=!0}function g0(t,e,r){for(var n,i,a,s,o,f,c,u,h,p,x,l,d,y,m,E,b,R,w,S,L,N,z,H,V,Q,at,_t,I,k,_,D,A,K,O,F=r.length();F>=128;){for(I=0;I<16;++I)e[I][0]=r.getInt32()>>>0,e[I][1]=r.getInt32()>>>0;for(;I<80;++I)D=e[I-2],k=D[0],_=D[1],n=((k>>>19|_<<13)^(_>>>29|k<<3)^k>>>6)>>>0,i=((k<<13|_>>>19)^(_<<3|k>>>29)^(k<<26|_>>>6))>>>0,K=e[I-15],k=K[0],_=K[1],a=((k>>>1|_<<31)^(k>>>8|_<<24)^k>>>7)>>>0,s=((k<<31|_>>>1)^(k<<24|_>>>8)^(k<<25|_>>>7))>>>0,A=e[I-7],O=e[I-16],_=i+A[1]+s+O[1],e[I][0]=n+A[0]+a+O[0]+(_/4294967296>>>0)>>>0,e[I][1]=_>>>0;for(d=t[0][0],y=t[0][1],m=t[1][0],E=t[1][1],b=t[2][0],R=t[2][1],w=t[3][0],S=t[3][1],L=t[4][0],N=t[4][1],z=t[5][0],H=t[5][1],V=t[6][0],Q=t[6][1],at=t[7][0],_t=t[7][1],I=0;I<80;++I)c=((L>>>14|N<<18)^(L>>>18|N<<14)^(N>>>9|L<<23))>>>0,u=((L<<18|N>>>14)^(L<<14|N>>>18)^(N<<23|L>>>9))>>>0,h=(V^L&(z^V))>>>0,p=(Q^N&(H^Q))>>>0,o=((d>>>28|y<<4)^(y>>>2|d<<30)^(y>>>7|d<<25))>>>0,f=((d<<4|y>>>28)^(y<<30|d>>>2)^(y<<25|d>>>7))>>>0,x=(d&m|b&(d^m))>>>0,l=(y&E|R&(y^E))>>>0,_=_t+u+p+ga[I][1]+e[I][1],n=at+c+h+ga[I][0]+e[I][0]+(_/4294967296>>>0)>>>0,i=_>>>0,_=f+l,a=o+x+(_/4294967296>>>0)>>>0,s=_>>>0,at=V,_t=Q,V=z,Q=H,z=L,H=N,_=S+i,L=w+n+(_/4294967296>>>0)>>>0,N=_>>>0,w=b,S=R,b=m,R=E,m=d,E=y,_=i+s,d=n+a+(_/4294967296>>>0)>>>0,y=_>>>0;_=t[0][1]+y,t[0][0]=t[0][0]+d+(_/4294967296>>>0)>>>0,t[0][1]=_>>>0,_=t[1][1]+E,t[1][0]=t[1][0]+m+(_/4294967296>>>0)>>>0,t[1][1]=_>>>0,_=t[2][1]+R,t[2][0]=t[2][0]+b+(_/4294967296>>>0)>>>0,t[2][1]=_>>>0,_=t[3][1]+S,t[3][0]=t[3][0]+w+(_/4294967296>>>0)>>>0,t[3][1]=_>>>0,_=t[4][1]+N,t[4][0]=t[4][0]+L+(_/4294967296>>>0)>>>0,t[4][1]=_>>>0,_=t[5][1]+H,t[5][0]=t[5][0]+z+(_/4294967296>>>0)>>>0,t[5][1]=_>>>0,_=t[6][1]+Q,t[6][0]=t[6][0]+V+(_/4294967296>>>0)>>>0,t[6][1]=_>>>0,_=t[7][1]+_t,t[7][0]=t[7][0]+at+(_/4294967296>>>0)>>>0,t[7][1]=_>>>0,F-=128}}});var Mp={};gt(Mp,{aes:()=>Bi,hmac:()=>rn,keys:()=>_a,pbkdf2:()=>Ra,randomBytes:()=>vr});var Bi={};gt(Bi,{create:()=>Sc});var qp=Symbol.for("@libp2p/connection");var Hp=Symbol.for("@libp2p/content-routing");var Wp=Symbol.for("@libp2p/peer-discovery");var Zp=Symbol.for("@libp2p/peer-id");var Qp=Symbol.for("@libp2p/peer-routing");var Va;(function(t){t.Accept="accept",t.Ignore="ignore",t.Reject="reject"})(Va||(Va={}));var td=Symbol.for("@libp2p/transport");var qa;(function(t){t[t.FATAL_ALL=0]="FATAL_ALL",t[t.NO_FATAL=1]="NO_FATAL"})(qa||(qa={}));var q=class extends Error{code;props;constructor(e,r,n){super(e),this.code=r,this.name=n?.name??"CodeError",this.props=n??{}}};var Hn=class extends Event{detail;constructor(e,r){super(e,r),this.detail=r?.detail}},od=globalThis.CustomEvent??Hn;var Fa={16:"aes-128-ctr",32:"aes-256-ctr"};function Ha(t){if(t.length===16||t.length===32)return Fa[t.length];let e=Object.entries(Fa).map(([r,n])=>`${r} (${n})`).join(" / ");throw new q(`Invalid key length ${t.length} bytes. Must be ${e}`,"ERR_INVALID_KEY_LENGTH")}var L1=Nt(Jr(),1),Tr=Nt(it(),1);function Me(t){return globalThis.Buffer!=null?new Uint8Array(t.buffer,t.byteOffset,t.byteLength):t}var ai={};gt(ai,{base10:()=>wf});function gf(t,e){if(t.length>=255)throw new TypeError("Alphabet too long");for(var r=new Uint8Array(256),n=0;n<r.length;n++)r[n]=255;for(var i=0;i<t.length;i++){var a=t.charAt(i),s=a.charCodeAt(0);if(r[s]!==255)throw new TypeError(a+" is ambiguous");r[s]=i}var o=t.length,f=t.charAt(0),c=Math.log(o)/Math.log(256),u=Math.log(256)/Math.log(o);function h(l){if(l instanceof Uint8Array||(ArrayBuffer.isView(l)?l=new Uint8Array(l.buffer,l.byteOffset,l.byteLength):Array.isArray(l)&&(l=Uint8Array.from(l))),!(l instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(l.length===0)return"";for(var d=0,y=0,m=0,E=l.length;m!==E&&l[m]===0;)m++,d++;for(var b=(E-m)*u+1>>>0,R=new Uint8Array(b);m!==E;){for(var w=l[m],S=0,L=b-1;(w!==0||S<y)&&L!==-1;L--,S++)w+=256*R[L]>>>0,R[L]=w%o>>>0,w=w/o>>>0;if(w!==0)throw new Error("Non-zero carry");y=S,m++}for(var N=b-y;N!==b&&R[N]===0;)N++;for(var z=f.repeat(d);N<b;++N)z+=t.charAt(R[N]);return z}function p(l){if(typeof l!="string")throw new TypeError("Expected String");if(l.length===0)return new Uint8Array;var d=0;if(l[d]!==" "){for(var y=0,m=0;l[d]===f;)y++,d++;for(var E=(l.length-d)*c+1>>>0,b=new Uint8Array(E);l[d];){var R=r[l.charCodeAt(d)];if(R===255)return;for(var w=0,S=E-1;(R!==0||w<m)&&S!==-1;S--,w++)R+=o*b[S]>>>0,b[S]=R%256>>>0,R=R/256>>>0;if(R!==0)throw new Error("Non-zero carry");m=w,d++}if(l[d]!==" "){for(var L=E-m;L!==E&&b[L]===0;)L++;for(var N=new Uint8Array(y+(E-L)),z=y;L!==E;)N[z++]=b[L++];return N}}}function x(l){var d=p(l);if(d)return d;throw new Error(`Non-${e} character`)}return{encode:h,decodeUnsafe:p,decode:x}}var mf=gf,vf=mf,io=vf;var qd=new Uint8Array(0);var ao=(t,e)=>{if(t===e)return!0;if(t.byteLength!==e.byteLength)return!1;for(let r=0;r<t.byteLength;r++)if(t[r]!==e[r])return!1;return!0},pe=t=>{if(t instanceof Uint8Array&&t.constructor.name==="Uint8Array")return t;if(t instanceof ArrayBuffer)return new Uint8Array(t);if(ArrayBuffer.isView(t))return new Uint8Array(t.buffer,t.byteOffset,t.byteLength);throw new Error("Unknown type, must be binary type")};var oo=t=>new TextEncoder().encode(t),so=t=>new TextDecoder().decode(t);var ei=class{constructor(e,r,n){this.name=e,this.prefix=r,this.baseEncode=n}encode(e){if(e instanceof Uint8Array)return`${this.prefix}${this.baseEncode(e)}`;throw Error("Unknown type, must be binary type")}},ri=class{constructor(e,r,n){if(this.name=e,this.prefix=r,r.codePointAt(0)===void 0)throw new Error("Invalid prefix character");this.prefixCodePoint=r.codePointAt(0),this.baseDecode=n}decode(e){if(typeof e=="string"){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(e)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(e.slice(this.prefix.length))}else throw Error("Can only multibase decode strings")}or(e){return co(this,e)}},ni=class{constructor(e){this.decoders=e}or(e){return co(this,e)}decode(e){let r=e[0],n=this.decoders[r];if(n)return n.decode(e);throw RangeError(`Unable to decode multibase string ${JSON.stringify(e)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}},co=(t,e)=>new ni({...t.decoders||{[t.prefix]:t},...e.decoders||{[e.prefix]:e}}),ii=class{constructor(e,r,n,i){this.name=e,this.prefix=r,this.baseEncode=n,this.baseDecode=i,this.encoder=new ei(e,r,n),this.decoder=new ri(e,r,i)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}},rr=({name:t,prefix:e,encode:r,decode:n})=>new ii(t,e,r,n),Ie=({prefix:t,name:e,alphabet:r})=>{let{encode:n,decode:i}=io(r,e);return rr({prefix:t,name:e,encode:n,decode:a=>pe(i(a))})},bf=(t,e,r,n)=>{let i={};for(let u=0;u<e.length;++u)i[e[u]]=u;let a=t.length;for(;t[a-1]==="=";)--a;let s=new Uint8Array(a*r/8|0),o=0,f=0,c=0;for(let u=0;u<a;++u){let h=i[t[u]];if(h===void 0)throw new SyntaxError(`Non-${n} character`);f=f<<r|h,o+=r,o>=8&&(o-=8,s[c++]=255&f>>o)}if(o>=r||255&f<<8-o)throw new SyntaxError("Unexpected end of data");return s},Ef=(t,e,r)=>{let n=e[e.length-1]==="=",i=(1<<r)-1,a="",s=0,o=0;for(let f=0;f<t.length;++f)for(o=o<<8|t[f],s+=8;s>r;)s-=r,a+=e[i&o>>s];if(s&&(a+=e[i&o<<r-s]),n)for(;a.length*r&7;)a+="=";return a},mt=({name:t,prefix:e,bitsPerChar:r,alphabet:n})=>rr({prefix:e,name:t,encode(i){return Ef(i,n,r)},decode(i){return bf(i,n,r,t)}});var wf=Ie({prefix:"9",name:"base10",alphabet:"0123456789"});var oi={};gt(oi,{base16:()=>Sf,base16upper:()=>Bf});var Sf=mt({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),Bf=mt({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4});var si={};gt(si,{base2:()=>Af});var Af=mt({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1});var fi={};gt(fi,{base256emoji:()=>Rf});var uo=Array.from("\u{1F680}\u{1FA90}\u2604\u{1F6F0}\u{1F30C}\u{1F311}\u{1F312}\u{1F313}\u{1F314}\u{1F315}\u{1F316}\u{1F317}\u{1F318}\u{1F30D}\u{1F30F}\u{1F30E}\u{1F409}\u2600\u{1F4BB}\u{1F5A5}\u{1F4BE}\u{1F4BF}\u{1F602}\u2764\u{1F60D}\u{1F923}\u{1F60A}\u{1F64F}\u{1F495}\u{1F62D}\u{1F618}\u{1F44D}\u{1F605}\u{1F44F}\u{1F601}\u{1F525}\u{1F970}\u{1F494}\u{1F496}\u{1F499}\u{1F622}\u{1F914}\u{1F606}\u{1F644}\u{1F4AA}\u{1F609}\u263A\u{1F44C}\u{1F917}\u{1F49C}\u{1F614}\u{1F60E}\u{1F607}\u{1F339}\u{1F926}\u{1F389}\u{1F49E}\u270C\u2728\u{1F937}\u{1F631}\u{1F60C}\u{1F338}\u{1F64C}\u{1F60B}\u{1F497}\u{1F49A}\u{1F60F}\u{1F49B}\u{1F642}\u{1F493}\u{1F929}\u{1F604}\u{1F600}\u{1F5A4}\u{1F603}\u{1F4AF}\u{1F648}\u{1F447}\u{1F3B6}\u{1F612}\u{1F92D}\u2763\u{1F61C}\u{1F48B}\u{1F440}\u{1F62A}\u{1F611}\u{1F4A5}\u{1F64B}\u{1F61E}\u{1F629}\u{1F621}\u{1F92A}\u{1F44A}\u{1F973}\u{1F625}\u{1F924}\u{1F449}\u{1F483}\u{1F633}\u270B\u{1F61A}\u{1F61D}\u{1F634}\u{1F31F}\u{1F62C}\u{1F643}\u{1F340}\u{1F337}\u{1F63B}\u{1F613}\u2B50\u2705\u{1F97A}\u{1F308}\u{1F608}\u{1F918}\u{1F4A6}\u2714\u{1F623}\u{1F3C3}\u{1F490}\u2639\u{1F38A}\u{1F498}\u{1F620}\u261D\u{1F615}\u{1F33A}\u{1F382}\u{1F33B}\u{1F610}\u{1F595}\u{1F49D}\u{1F64A}\u{1F639}\u{1F5E3}\u{1F4AB}\u{1F480}\u{1F451}\u{1F3B5}\u{1F91E}\u{1F61B}\u{1F534}\u{1F624}\u{1F33C}\u{1F62B}\u26BD\u{1F919}\u2615\u{1F3C6}\u{1F92B}\u{1F448}\u{1F62E}\u{1F646}\u{1F37B}\u{1F343}\u{1F436}\u{1F481}\u{1F632}\u{1F33F}\u{1F9E1}\u{1F381}\u26A1\u{1F31E}\u{1F388}\u274C\u270A\u{1F44B}\u{1F630}\u{1F928}\u{1F636}\u{1F91D}\u{1F6B6}\u{1F4B0}\u{1F353}\u{1F4A2}\u{1F91F}\u{1F641}\u{1F6A8}\u{1F4A8}\u{1F92C}\u2708\u{1F380}\u{1F37A}\u{1F913}\u{1F619}\u{1F49F}\u{1F331}\u{1F616}\u{1F476}\u{1F974}\u25B6\u27A1\u2753\u{1F48E}\u{1F4B8}\u2B07\u{1F628}\u{1F31A}\u{1F98B}\u{1F637}\u{1F57A}\u26A0\u{1F645}\u{1F61F}\u{1F635}\u{1F44E}\u{1F932}\u{1F920}\u{1F927}\u{1F4CC}\u{1F535}\u{1F485}\u{1F9D0}\u{1F43E}\u{1F352}\u{1F617}\u{1F911}\u{1F30A}\u{1F92F}\u{1F437}\u260E\u{1F4A7}\u{1F62F}\u{1F486}\u{1F446}\u{1F3A4}\u{1F647}\u{1F351}\u2744\u{1F334}\u{1F4A3}\u{1F438}\u{1F48C}\u{1F4CD}\u{1F940}\u{1F922}\u{1F445}\u{1F4A1}\u{1F4A9}\u{1F450}\u{1F4F8}\u{1F47B}\u{1F910}\u{1F92E}\u{1F3BC}\u{1F975}\u{1F6A9}\u{1F34E}\u{1F34A}\u{1F47C}\u{1F48D}\u{1F4E3}\u{1F942}"),Cf=uo.reduce((t,e,r)=>(t[r]=e,t),[]),If=uo.reduce((t,e,r)=>(t[e.codePointAt(0)]=r,t),[]);function Tf(t){return t.reduce((e,r)=>(e+=Cf[r],e),"")}function _f(t){let e=[];for(let r of t){let n=If[r.codePointAt(0)];if(n===void 0)throw new Error(`Non-base256emoji character: ${r}`);e.push(n)}return new Uint8Array(e)}var Rf=rr({prefix:"\u{1F680}",name:"base256emoji",encode:Tf,decode:_f});var ci={};gt(ci,{base32:()=>nr,base32hex:()=>kf,base32hexpad:()=>Uf,base32hexpadupper:()=>Kf,base32hexupper:()=>Pf,base32pad:()=>Nf,base32padupper:()=>Df,base32upper:()=>Lf,base32z:()=>Of});var nr=mt({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),Lf=mt({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),Nf=mt({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),Df=mt({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),kf=mt({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),Pf=mt({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),Uf=mt({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),Kf=mt({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),Of=mt({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5});var ui={};gt(ui,{base36:()=>Mf,base36upper:()=>Vf});var Mf=Ie({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),Vf=Ie({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"});var hi={};gt(hi,{base58btc:()=>Ft,base58flickr:()=>qf});var Ft=Ie({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),qf=Ie({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"});var li={};gt(li,{base64:()=>Sr,base64pad:()=>Ff,base64url:()=>Hf,base64urlpad:()=>zf});var Sr=mt({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),Ff=mt({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),Hf=mt({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),zf=mt({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6});var pi={};gt(pi,{base8:()=>Gf});var Gf=mt({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3});var di={};gt(di,{identity:()=>Wf});var Wf=rr({prefix:"\0",name:"identity",encode:t=>so(t),decode:t=>oo(t)});var r1=new TextEncoder,n1=new TextDecoder;var gi={};gt(gi,{identity:()=>xi});var $f=po,ho=128,Qf=127,Xf=~Qf,Jf=Math.pow(2,31);function po(t,e,r){e=e||[],r=r||0;for(var n=r;t>=Jf;)e[r++]=t&255|ho,t/=128;for(;t&Xf;)e[r++]=t&255|ho,t>>>=7;return e[r]=t|0,po.bytes=r-n+1,e}var jf=yi,tc=128,lo=127;function yi(t,n){var r=0,n=n||0,i=0,a=n,s,o=t.length;do{if(a>=o)throw yi.bytes=0,new RangeError("Could not decode varint");s=t[a++],r+=i<28?(s&lo)<<i:(s&lo)*Math.pow(2,i),i+=7}while(s>=tc);return yi.bytes=a-n,r}var ec=Math.pow(2,7),rc=Math.pow(2,14),nc=Math.pow(2,21),ic=Math.pow(2,28),ac=Math.pow(2,35),oc=Math.pow(2,42),sc=Math.pow(2,49),fc=Math.pow(2,56),cc=Math.pow(2,63),uc=function(t){return t<ec?1:t<rc?2:t<nc?3:t<ic?4:t<ac?5:t<oc?6:t<sc?7:t<fc?8:t<cc?9:10},hc={encode:$f,decode:jf,encodingLength:uc},lc=hc,Br=lc;var Ar=(t,e=0)=>[Br.decode(t,e),Br.decode.bytes],ir=(t,e,r=0)=>(Br.encode(t,e,r),e),ar=t=>Br.encodingLength(t);var Ve=(t,e)=>{let r=e.byteLength,n=ar(t),i=n+ar(r),a=new Uint8Array(i+r);return ir(t,a,0),ir(r,a,n),a.set(e,i),new or(t,r,e,a)},yo=t=>{let e=pe(t),[r,n]=Ar(e),[i,a]=Ar(e.subarray(n)),s=e.subarray(n+a);if(s.byteLength!==i)throw new Error("Incorrect length");return new or(r,i,s,e)},xo=(t,e)=>{if(t===e)return!0;{let r=e;return t.code===r.code&&t.size===r.size&&r.bytes instanceof Uint8Array&&ao(t.bytes,r.bytes)}},or=class{constructor(e,r,n,i){this.code=e,this.size=r,this.digest=n,this.bytes=i}};var go=0,pc="identity",mo=pe,dc=t=>Ve(go,mo(t)),xi={code:go,name:pc,encode:mo,digest:dc};var bi={};gt(bi,{sha256:()=>Mt,sha512:()=>yc});var vi=({name:t,code:e,encode:r})=>new mi(t,e,r),mi=class{constructor(e,r,n){this.name=e,this.code=r,this.encode=n}digest(e){if(e instanceof Uint8Array){let r=this.encode(e);return r instanceof Uint8Array?Ve(this.code,r):r.then(n=>Ve(this.code,n))}else throw Error("Unknown type, must be binary type")}};var bo=t=>async e=>new Uint8Array(await crypto.subtle.digest(t,e)),Mt=vi({name:"sha2-256",code:18,encode:bo("SHA-256")}),yc=vi({name:"sha2-512",code:19,encode:bo("SHA-512")});var Eo=(t,e)=>{let{bytes:r,version:n}=t;switch(n){case 0:return gc(r,Ei(t),e||Ft.encoder);default:return mc(r,Ei(t),e||nr.encoder)}};var wo=new WeakMap,Ei=t=>{let e=wo.get(t);if(e==null){let r=new Map;return wo.set(t,r),r}return e},tn=class t{constructor(e,r,n,i){this.code=r,this.version=e,this.multihash=n,this.bytes=i,this["/"]=i}get asCID(){return this}get byteOffset(){return this.bytes.byteOffset}get byteLength(){return this.bytes.byteLength}toV0(){switch(this.version){case 0:return this;case 1:{let{code:e,multihash:r}=this;if(e!==Ir)throw new Error("Cannot convert a non dag-pb CID to CIDv0");if(r.code!==vc)throw new Error("Cannot convert non sha2-256 multihash CID to CIDv0");return t.createV0(r)}default:throw Error(`Can not convert CID version ${this.version} to version 0. This is a bug please report`)}}toV1(){switch(this.version){case 0:{let{code:e,digest:r}=this.multihash,n=Ve(e,r);return t.createV1(this.code,n)}case 1:return this;default:throw Error(`Can not convert CID version ${this.version} to version 1. This is a bug please report`)}}equals(e){return t.equals(this,e)}static equals(e,r){let n=r;return n&&e.code===n.code&&e.version===n.version&&xo(e.multihash,n.multihash)}toString(e){return Eo(this,e)}toJSON(){return{"/":Eo(this)}}link(){return this}get[Symbol.toStringTag](){return"CID"}[Symbol.for("nodejs.util.inspect.custom")](){return`CID(${this.toString()})`}static asCID(e){if(e==null)return null;let r=e;if(r instanceof t)return r;if(r["/"]!=null&&r["/"]===r.bytes||r.asCID===r){let{version:n,code:i,multihash:a,bytes:s}=r;return new t(n,i,a,s||So(n,i,a.bytes))}else if(r[bc]===!0){let{version:n,multihash:i,code:a}=r,s=yo(i);return t.create(n,a,s)}else return null}static create(e,r,n){if(typeof r!="number")throw new Error("String codecs are no longer supported");if(!(n.bytes instanceof Uint8Array))throw new Error("Invalid digest");switch(e){case 0:{if(r!==Ir)throw new Error(`Version 0 CID must use dag-pb (code: ${Ir}) block encoding`);return new t(e,r,n,n.bytes)}case 1:{let i=So(e,r,n.bytes);return new t(e,r,n,i)}default:throw new Error("Invalid version")}}static createV0(e){return t.create(0,Ir,e)}static createV1(e,r){return t.create(1,e,r)}static decode(e){let[r,n]=t.decodeFirst(e);if(n.length)throw new Error("Incorrect length");return r}static decodeFirst(e){let r=t.inspectBytes(e),n=r.size-r.multihashSize,i=pe(e.subarray(n,n+r.multihashSize));if(i.byteLength!==r.multihashSize)throw new Error("Incorrect length");let a=i.subarray(r.multihashSize-r.digestSize),s=new or(r.multihashCode,r.digestSize,a,i);return[r.version===0?t.createV0(s):t.createV1(r.codec,s),e.subarray(r.size)]}static inspectBytes(e){let r=0,n=()=>{let[h,p]=Ar(e.subarray(r));return r+=p,h},i=n(),a=Ir;if(i===18?(i=0,r=0):a=n(),i!==0&&i!==1)throw new RangeError(`Invalid CID version ${i}`);let s=r,o=n(),f=n(),c=r+f,u=c-s;return{version:i,codec:a,multihashCode:o,digestSize:f,multihashSize:u,size:c}}static parse(e,r){let[n,i]=xc(e,r),a=t.decode(i);if(a.version===0&&e[0]!=="Q")throw Error("Version 0 CID string must not include multibase prefix");return Ei(a).set(n,e),a}},xc=(t,e)=>{switch(t[0]){case"Q":{let r=e||Ft;return[Ft.prefix,r.decode(`${Ft.prefix}${t}`)]}case Ft.prefix:{let r=e||Ft;return[Ft.prefix,r.decode(t)]}case nr.prefix:{let r=e||nr;return[nr.prefix,r.decode(t)]}default:{if(e==null)throw Error("To parse non base32 or base58btc encoded CID multibase decoder must be provided");return[t[0],e.decode(t)]}}},gc=(t,e,r)=>{let{prefix:n}=r;if(n!==Ft.prefix)throw Error(`Cannot string encode V0 in ${r.name} encoding`);let i=e.get(n);if(i==null){let a=r.encode(t).slice(1);return e.set(n,a),a}else return i},mc=(t,e,r)=>{let{prefix:n}=r,i=e.get(n);if(i==null){let a=r.encode(t);return e.set(n,a),a}else return i},Ir=112,vc=18,So=(t,e,r)=>{let n=ar(t),i=n+ar(e),a=new Uint8Array(i+r.byteLength);return ir(t,a,0),ir(e,a,n),a.set(r,i),a},bc=Symbol.for("@ipld/js-cid/CID");var wi={...di,...si,...pi,...ai,...oi,...ci,...ui,...hi,...li,...fi},v1={...bi,...gi};function de(t=0){return globalThis.Buffer?.allocUnsafe!=null?Me(globalThis.Buffer.allocUnsafe(t)):new Uint8Array(t)}function Ao(t,e,r,n){return{name:t,prefix:e,encoder:{name:t,prefix:e,encode:r},decoder:{decode:n}}}var Bo=Ao("utf8","u",t=>"u"+new TextDecoder("utf8").decode(t),t=>new TextEncoder().encode(t.substring(1))),Si=Ao("ascii","a",t=>{let e="a";for(let r=0;r<t.length;r++)e+=String.fromCharCode(t[r]);return e},t=>{t=t.substring(1);let e=de(t.length);for(let r=0;r<t.length;r++)e[r]=t.charCodeAt(r);return e}),Ec={utf8:Bo,"utf-8":Bo,hex:wi.base16,latin1:Si,ascii:Si,binary:Si,...wi},en=Ec;function St(t,e="utf8"){let r=en[e];if(r==null)throw new Error(`Unsupported encoding "${e}"`);return(e==="utf8"||e==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?Me(globalThis.Buffer.from(t,"utf-8")):r.decoder.decode(`${r.prefix}${t}`)}function yt(t,e="utf8"){let r=en[e];if(r==null)throw new Error(`Unsupported encoding "${e}"`);return(e==="utf8"||e==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?globalThis.Buffer.from(t.buffer,t.byteOffset,t.byteLength).toString("utf8"):r.encoder.encode(t).substring(1)}function Co(t,e,r){let n=Tr.default.cipher.createCipher("AES-CTR",yt(e,"ascii"));return n.start({iv:yt(r,"ascii")}),{update:i=>(n.update(Tr.default.util.createBuffer(yt(i,"ascii"))),St(n.output.getBytes(),"ascii"))}}function Io(t,e,r){let n=Tr.default.cipher.createDecipher("AES-CTR",yt(e,"ascii"));return n.start({iv:yt(r,"ascii")}),{update:i=>(n.update(Tr.default.util.createBuffer(yt(i,"ascii"))),St(n.output.getBytes(),"ascii"))}}function Sc(t,e){let r=Ha(t),n=Co(r,t,e),i=Io(r,t,e);return{async encrypt(s){return n.update(s)},async decrypt(s){return i.update(s)}}}var rn={};gt(rn,{create:()=>Ai});var Et={get(t=globalThis){let e=t.crypto;if(e==null||e.subtle==null)throw Object.assign(new Error("Missing Web Crypto API. The most likely cause of this error is that this page is being accessed from an insecure context (i.e. not HTTPS). For more information and possible resolutions see https://github.com/libp2p/js-libp2p/blob/main/packages/crypto/README.md#web-crypto-api"),{code:"ERR_MISSING_WEB_CRYPTO"});return e}};var To={SHA1:20,SHA256:32,SHA512:64};var Bc={SHA1:"SHA-1",SHA256:"SHA-256",SHA512:"SHA-512"},Ac=async(t,e)=>{let r=await Et.get().subtle.sign({name:"HMAC"},t,e);return new Uint8Array(r,0,r.byteLength)};async function Ai(t,e){let r=Bc[t],n=await Et.get().subtle.importKey("raw",e,{name:"HMAC",hash:{name:r}},!1,["sign"]);return{async digest(i){return Ac(n,i)},length:To[t]}}var _a={};gt(_a,{generateEphemeralKeyPair:()=>p0,generateKeyPair:()=>Dp,generateKeyPairFromSeed:()=>kp,importKey:()=>Op,keyStretcher:()=>x0,keysPBM:()=>gr,marshalPrivateKey:()=>Kp,marshalPublicKey:()=>Up,supportedKeys:()=>he,unmarshalPrivateKey:()=>G0,unmarshalPublicKey:()=>Pp});var sg=Nt(Lr(),1),fg=Nt(_s(),1);var qn=Nt(it(),1);var da={};gt(da,{Ed25519PrivateKey:()=>Qe,Ed25519PublicKey:()=>Vr,generateKeyPair:()=>np,generateKeyPairFromSeed:()=>pa,unmarshalEd25519PrivateKey:()=>ep,unmarshalEd25519PublicKey:()=>rp});function $t(t,e){if(t===e)return!0;if(t.byteLength!==e.byteLength)return!1;for(let r=0;r<t.byteLength;r++)if(t[r]!==e[r])return!1;return!0}var fy=Nt(bt(),1),cy=Nt(dn(),1),Rs=Nt(it(),1);function ce(t,e){if(globalThis.Buffer!=null)return Me(globalThis.Buffer.concat(t,e));e==null&&(e=t.reduce((i,a)=>i+a.length,0));let r=de(e),n=0;for(let i of t)r.set(i,n),n+=i.length;return Me(r)}function Qt(t,e){let r=Uint8Array.from(t.abs().toByteArray());if(r=r[0]===0?r.subarray(1):r,e!=null){if(r.length>e)throw new Error("byte array longer than desired length");r=ce([new Uint8Array(e-r.length),r])}return yt(r,"base64url")}function Vt(t){let e=mn(t);return new Rs.default.jsbn.BigInteger(yt(e,"base16"),16)}function mn(t,e){let r=St(t,"base64urlpad");if(e!=null){if(r.length>e)throw new Error("byte array longer than desired length");r=ce([new Uint8Array(e-r.length),r])}return r}function Gt(t){return t==null?!1:typeof t.then=="function"&&typeof t.catch=="function"&&typeof t.finally=="function"}function Ls(t){if(!Number.isSafeInteger(t)||t<0)throw new Error(`Wrong positive integer: ${t}`)}function Ki(t,...e){if(!(t instanceof Uint8Array))throw new Error("Expected Uint8Array");if(e.length>0&&!e.includes(t.length))throw new Error(`Expected Uint8Array of length ${e}, not of length=${t.length}`)}function Ns(t){if(typeof t!="function"||typeof t.create!="function")throw new Error("Hash should be wrapped by utils.wrapConstructor");Ls(t.outputLen),Ls(t.blockLen)}function cr(t,e=!0){if(t.destroyed)throw new Error("Hash instance has been destroyed");if(e&&t.finished)throw new Error("Hash#digest() has already been called")}function Ds(t,e){Ki(t);let r=e.outputLen;if(t.length<r)throw new Error(`digestInto() expects output buffer of length at least ${r}`)}var vn=typeof globalThis=="object"&&"crypto"in globalThis?globalThis.crypto:void 0;var ks=t=>t instanceof Uint8Array;var bn=t=>new DataView(t.buffer,t.byteOffset,t.byteLength),Xt=(t,e)=>t<<32-e|t>>>e,Hh=new Uint8Array(new Uint32Array([287454020]).buffer)[0]===68;if(!Hh)throw new Error("Non little-endian hardware is not supported");function Oi(t){if(typeof t!="string")throw new Error(`utf8ToBytes expected string, got ${typeof t}`);return new Uint8Array(new TextEncoder().encode(t))}function kr(t){if(typeof t=="string"&&(t=Oi(t)),!ks(t))throw new Error(`expected Uint8Array, got ${typeof t}`);return t}function En(...t){let e=new Uint8Array(t.reduce((n,i)=>n+i.length,0)),r=0;return t.forEach(n=>{if(!ks(n))throw new Error("Uint8Array expected");e.set(n,r),r+=n.length}),e}var ur=class{clone(){return this._cloneInto()}},gy={}.toString;function wn(t){let e=n=>t().update(kr(n)).digest(),r=t();return e.outputLen=r.outputLen,e.blockLen=r.blockLen,e.create=()=>t(),e}function hr(t=32){if(vn&&typeof vn.getRandomValues=="function")return vn.getRandomValues(new Uint8Array(t));throw new Error("crypto.getRandomValues must be defined")}function zh(t,e,r,n){if(typeof t.setBigUint64=="function")return t.setBigUint64(e,r,n);let i=BigInt(32),a=BigInt(4294967295),s=Number(r>>i&a),o=Number(r&a),f=n?4:0,c=n?0:4;t.setUint32(e+f,s,n),t.setUint32(e+c,o,n)}var lr=class extends ur{constructor(e,r,n,i){super(),this.blockLen=e,this.outputLen=r,this.padOffset=n,this.isLE=i,this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.buffer=new Uint8Array(e),this.view=bn(this.buffer)}update(e){cr(this);let{view:r,buffer:n,blockLen:i}=this;e=kr(e);let a=e.length;for(let s=0;s<a;){let o=Math.min(i-this.pos,a-s);if(o===i){let f=bn(e);for(;i<=a-s;s+=i)this.process(f,s);continue}n.set(e.subarray(s,s+o),this.pos),this.pos+=o,s+=o,this.pos===i&&(this.process(r,0),this.pos=0)}return this.length+=e.length,this.roundClean(),this}digestInto(e){cr(this),Ds(e,this),this.finished=!0;let{buffer:r,view:n,blockLen:i,isLE:a}=this,{pos:s}=this;r[s++]=128,this.buffer.subarray(s).fill(0),this.padOffset>i-s&&(this.process(n,0),s=0);for(let h=s;h<i;h++)r[h]=0;zh(n,i-8,BigInt(this.length*8),a),this.process(n,0);let o=bn(e),f=this.outputLen;if(f%4)throw new Error("_sha2: outputLen should be aligned to 32bit");let c=f/4,u=this.get();if(c>u.length)throw new Error("_sha2: outputLen bigger than state");for(let h=0;h<c;h++)o.setUint32(4*h,u[h],a)}digest(){let{buffer:e,outputLen:r}=this;this.digestInto(e);let n=e.slice(0,r);return this.destroy(),n}_cloneInto(e){e||(e=new this.constructor),e.set(...this.get());let{blockLen:r,buffer:n,length:i,finished:a,destroyed:s,pos:o}=this;return e.length=i,e.pos=o,e.finished=a,e.destroyed=s,i%r&&e.buffer.set(n),e}};var Sn=BigInt(4294967295),Mi=BigInt(32);function Ps(t,e=!1){return e?{h:Number(t&Sn),l:Number(t>>Mi&Sn)}:{h:Number(t>>Mi&Sn)|0,l:Number(t&Sn)|0}}function Gh(t,e=!1){let r=new Uint32Array(t.length),n=new Uint32Array(t.length);for(let i=0;i<t.length;i++){let{h:a,l:s}=Ps(t[i],e);[r[i],n[i]]=[a,s]}return[r,n]}var Wh=(t,e)=>BigInt(t>>>0)<<Mi|BigInt(e>>>0),Yh=(t,e,r)=>t>>>r,Zh=(t,e,r)=>t<<32-r|e>>>r,$h=(t,e,r)=>t>>>r|e<<32-r,Qh=(t,e,r)=>t<<32-r|e>>>r,Xh=(t,e,r)=>t<<64-r|e>>>r-32,Jh=(t,e,r)=>t>>>r-32|e<<64-r,jh=(t,e)=>e,tl=(t,e)=>t,el=(t,e,r)=>t<<r|e>>>32-r,rl=(t,e,r)=>e<<r|t>>>32-r,nl=(t,e,r)=>e<<r-32|t>>>64-r,il=(t,e,r)=>t<<r-32|e>>>64-r;function al(t,e,r,n){let i=(e>>>0)+(n>>>0);return{h:t+r+(i/2**32|0)|0,l:i|0}}var ol=(t,e,r)=>(t>>>0)+(e>>>0)+(r>>>0),sl=(t,e,r,n)=>e+r+n+(t/2**32|0)|0,fl=(t,e,r,n)=>(t>>>0)+(e>>>0)+(r>>>0)+(n>>>0),cl=(t,e,r,n,i)=>e+r+n+i+(t/2**32|0)|0,ul=(t,e,r,n,i)=>(t>>>0)+(e>>>0)+(r>>>0)+(n>>>0)+(i>>>0),hl=(t,e,r,n,i,a)=>e+r+n+i+a+(t/2**32|0)|0;var ll={fromBig:Ps,split:Gh,toBig:Wh,shrSH:Yh,shrSL:Zh,rotrSH:$h,rotrSL:Qh,rotrBH:Xh,rotrBL:Jh,rotr32H:jh,rotr32L:tl,rotlSH:el,rotlSL:rl,rotlBH:nl,rotlBL:il,add:al,add3L:ol,add3H:sl,add4L:fl,add4H:cl,add5H:hl,add5L:ul},Y=ll;var[pl,dl]=Y.split(["0x428a2f98d728ae22","0x7137449123ef65cd","0xb5c0fbcfec4d3b2f","0xe9b5dba58189dbbc","0x3956c25bf348b538","0x59f111f1b605d019","0x923f82a4af194f9b","0xab1c5ed5da6d8118","0xd807aa98a3030242","0x12835b0145706fbe","0x243185be4ee4b28c","0x550c7dc3d5ffb4e2","0x72be5d74f27b896f","0x80deb1fe3b1696b1","0x9bdc06a725c71235","0xc19bf174cf692694","0xe49b69c19ef14ad2","0xefbe4786384f25e3","0x0fc19dc68b8cd5b5","0x240ca1cc77ac9c65","0x2de92c6f592b0275","0x4a7484aa6ea6e483","0x5cb0a9dcbd41fbd4","0x76f988da831153b5","0x983e5152ee66dfab","0xa831c66d2db43210","0xb00327c898fb213f","0xbf597fc7beef0ee4","0xc6e00bf33da88fc2","0xd5a79147930aa725","0x06ca6351e003826f","0x142929670a0e6e70","0x27b70a8546d22ffc","0x2e1b21385c26c926","0x4d2c6dfc5ac42aed","0x53380d139d95b3df","0x650a73548baf63de","0x766a0abb3c77b2a8","0x81c2c92e47edaee6","0x92722c851482353b","0xa2bfe8a14cf10364","0xa81a664bbc423001","0xc24b8b70d0f89791","0xc76c51a30654be30","0xd192e819d6ef5218","0xd69906245565a910","0xf40e35855771202a","0x106aa07032bbd1b8","0x19a4c116b8d2d0c8","0x1e376c085141ab53","0x2748774cdf8eeb99","0x34b0bcb5e19b48a8","0x391c0cb3c5c95a63","0x4ed8aa4ae3418acb","0x5b9cca4f7763e373","0x682e6ff3d6b2b8a3","0x748f82ee5defb2fc","0x78a5636f43172f60","0x84c87814a1f0ab72","0x8cc702081a6439ec","0x90befffa23631e28","0xa4506cebde82bde9","0xbef9a3f7b2c67915","0xc67178f2e372532b","0xca273eceea26619c","0xd186b8c721c0c207","0xeada7dd6cde0eb1e","0xf57d4f7fee6ed178","0x06f067aa72176fba","0x0a637dc5a2c898a6","0x113f9804bef90dae","0x1b710b35131c471b","0x28db77f523047d84","0x32caab7b40c72493","0x3c9ebe0a15c9bebc","0x431d67c49c100d4c","0x4cc5d4becb3e42b6","0x597f299cfc657e2a","0x5fcb6fab3ad6faec","0x6c44198c4a475817"].map(t=>BigInt(t))),Re=new Uint32Array(80),Le=new Uint32Array(80),Vi=class extends lr{constructor(){super(128,64,16,!1),this.Ah=1779033703,this.Al=-205731576,this.Bh=-1150833019,this.Bl=-2067093701,this.Ch=1013904242,this.Cl=-23791573,this.Dh=-1521486534,this.Dl=1595750129,this.Eh=1359893119,this.El=-1377402159,this.Fh=-1694144372,this.Fl=725511199,this.Gh=528734635,this.Gl=-79577749,this.Hh=1541459225,this.Hl=327033209}get(){let{Ah:e,Al:r,Bh:n,Bl:i,Ch:a,Cl:s,Dh:o,Dl:f,Eh:c,El:u,Fh:h,Fl:p,Gh:x,Gl:l,Hh:d,Hl:y}=this;return[e,r,n,i,a,s,o,f,c,u,h,p,x,l,d,y]}set(e,r,n,i,a,s,o,f,c,u,h,p,x,l,d,y){this.Ah=e|0,this.Al=r|0,this.Bh=n|0,this.Bl=i|0,this.Ch=a|0,this.Cl=s|0,this.Dh=o|0,this.Dl=f|0,this.Eh=c|0,this.El=u|0,this.Fh=h|0,this.Fl=p|0,this.Gh=x|0,this.Gl=l|0,this.Hh=d|0,this.Hl=y|0}process(e,r){for(let b=0;b<16;b++,r+=4)Re[b]=e.getUint32(r),Le[b]=e.getUint32(r+=4);for(let b=16;b<80;b++){let R=Re[b-15]|0,w=Le[b-15]|0,S=Y.rotrSH(R,w,1)^Y.rotrSH(R,w,8)^Y.shrSH(R,w,7),L=Y.rotrSL(R,w,1)^Y.rotrSL(R,w,8)^Y.shrSL(R,w,7),N=Re[b-2]|0,z=Le[b-2]|0,H=Y.rotrSH(N,z,19)^Y.rotrBH(N,z,61)^Y.shrSH(N,z,6),V=Y.rotrSL(N,z,19)^Y.rotrBL(N,z,61)^Y.shrSL(N,z,6),Q=Y.add4L(L,V,Le[b-7],Le[b-16]),at=Y.add4H(Q,S,H,Re[b-7],Re[b-16]);Re[b]=at|0,Le[b]=Q|0}let{Ah:n,Al:i,Bh:a,Bl:s,Ch:o,Cl:f,Dh:c,Dl:u,Eh:h,El:p,Fh:x,Fl:l,Gh:d,Gl:y,Hh:m,Hl:E}=this;for(let b=0;b<80;b++){let R=Y.rotrSH(h,p,14)^Y.rotrSH(h,p,18)^Y.rotrBH(h,p,41),w=Y.rotrSL(h,p,14)^Y.rotrSL(h,p,18)^Y.rotrBL(h,p,41),S=h&x^~h&d,L=p&l^~p&y,N=Y.add5L(E,w,L,dl[b],Le[b]),z=Y.add5H(N,m,R,S,pl[b],Re[b]),H=N|0,V=Y.rotrSH(n,i,28)^Y.rotrBH(n,i,34)^Y.rotrBH(n,i,39),Q=Y.rotrSL(n,i,28)^Y.rotrBL(n,i,34)^Y.rotrBL(n,i,39),at=n&a^n&o^a&o,_t=i&s^i&f^s&f;m=d|0,E=y|0,d=x|0,y=l|0,x=h|0,l=p|0,{h,l:p}=Y.add(c|0,u|0,z|0,H|0),c=o|0,u=f|0,o=a|0,f=s|0,a=n|0,s=i|0;let I=Y.add3L(H,Q,_t);n=Y.add3H(I,z,V,at),i=I|0}({h:n,l:i}=Y.add(this.Ah|0,this.Al|0,n|0,i|0)),{h:a,l:s}=Y.add(this.Bh|0,this.Bl|0,a|0,s|0),{h:o,l:f}=Y.add(this.Ch|0,this.Cl|0,o|0,f|0),{h:c,l:u}=Y.add(this.Dh|0,this.Dl|0,c|0,u|0),{h,l:p}=Y.add(this.Eh|0,this.El|0,h|0,p|0),{h:x,l}=Y.add(this.Fh|0,this.Fl|0,x|0,l|0),{h:d,l:y}=Y.add(this.Gh|0,this.Gl|0,d|0,y|0),{h:m,l:E}=Y.add(this.Hh|0,this.Hl|0,m|0,E|0),this.set(n,i,a,s,o,f,c,u,h,p,x,l,d,y,m,E)}roundClean(){Re.fill(0),Le.fill(0)}destroy(){this.buffer.fill(0),this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)}};var qi=wn(()=>new Vi);var Cn={};gt(Cn,{bitGet:()=>El,bitLen:()=>bl,bitMask:()=>Pr,bitSet:()=>wl,bytesToHex:()=>me,bytesToNumberBE:()=>ve,bytesToNumberLE:()=>Ne,concatBytes:()=>be,createHmacDrbg:()=>zi,ensureBytes:()=>vt,equalBytes:()=>ml,hexToBytes:()=>Ge,hexToNumber:()=>Hi,numberToBytesBE:()=>De,numberToBytesLE:()=>We,numberToHexUnpadded:()=>Os,numberToVarBytesBE:()=>gl,utf8ToBytes:()=>vl,validateObject:()=>ue});var Ks=BigInt(0),Bn=BigInt(1),yl=BigInt(2),An=t=>t instanceof Uint8Array,xl=Array.from({length:256},(t,e)=>e.toString(16).padStart(2,"0"));function me(t){if(!An(t))throw new Error("Uint8Array expected");let e="";for(let r=0;r<t.length;r++)e+=xl[t[r]];return e}function Os(t){let e=t.toString(16);return e.length&1?`0${e}`:e}function Hi(t){if(typeof t!="string")throw new Error("hex string expected, got "+typeof t);return BigInt(t===""?"0":`0x${t}`)}function Ge(t){if(typeof t!="string")throw new Error("hex string expected, got "+typeof t);let e=t.length;if(e%2)throw new Error("padded hex string expected, got unpadded hex of length "+e);let r=new Uint8Array(e/2);for(let n=0;n<r.length;n++){let i=n*2,a=t.slice(i,i+2),s=Number.parseInt(a,16);if(Number.isNaN(s)||s<0)throw new Error("Invalid byte sequence");r[n]=s}return r}function ve(t){return Hi(me(t))}function Ne(t){if(!An(t))throw new Error("Uint8Array expected");return Hi(me(Uint8Array.from(t).reverse()))}function De(t,e){return Ge(t.toString(16).padStart(e*2,"0"))}function We(t,e){return De(t,e).reverse()}function gl(t){return Ge(Os(t))}function vt(t,e,r){let n;if(typeof e=="string")try{n=Ge(e)}catch(a){throw new Error(`${t} must be valid hex string, got "${e}". Cause: ${a}`)}else if(An(e))n=Uint8Array.from(e);else throw new Error(`${t} must be hex string or Uint8Array`);let i=n.length;if(typeof r=="number"&&i!==r)throw new Error(`${t} expected ${r} bytes, got ${i}`);return n}function be(...t){let e=new Uint8Array(t.reduce((n,i)=>n+i.length,0)),r=0;return t.forEach(n=>{if(!An(n))throw new Error("Uint8Array expected");e.set(n,r),r+=n.length}),e}function ml(t,e){if(t.length!==e.length)return!1;for(let r=0;r<t.length;r++)if(t[r]!==e[r])return!1;return!0}function vl(t){if(typeof t!="string")throw new Error(`utf8ToBytes expected string, got ${typeof t}`);return new Uint8Array(new TextEncoder().encode(t))}function bl(t){let e;for(e=0;t>Ks;t>>=Bn,e+=1);return e}function El(t,e){return t>>BigInt(e)&Bn}var wl=(t,e,r)=>t|(r?Bn:Ks)<<BigInt(e),Pr=t=>(yl<<BigInt(t-1))-Bn,Fi=t=>new Uint8Array(t),Us=t=>Uint8Array.from(t);function zi(t,e,r){if(typeof t!="number"||t<2)throw new Error("hashLen must be a number");if(typeof e!="number"||e<2)throw new Error("qByteLen must be a number");if(typeof r!="function")throw new Error("hmacFn must be a function");let n=Fi(t),i=Fi(t),a=0,s=()=>{n.fill(1),i.fill(0),a=0},o=(...h)=>r(i,n,...h),f=(h=Fi())=>{i=o(Us([0]),h),n=o(),h.length!==0&&(i=o(Us([1]),h),n=o())},c=()=>{if(a++>=1e3)throw new Error("drbg: tried 1000 values");let h=0,p=[];for(;h<e;){n=o();let x=n.slice();p.push(x),h+=n.length}return be(...p)};return(h,p)=>{s(),f(h);let x;for(;!(x=p(c()));)f();return s(),x}}var Sl={bigint:t=>typeof t=="bigint",function:t=>typeof t=="function",boolean:t=>typeof t=="boolean",string:t=>typeof t=="string",stringOrUint8Array:t=>typeof t=="string"||t instanceof Uint8Array,isSafeInteger:t=>Number.isSafeInteger(t),array:t=>Array.isArray(t),field:(t,e)=>e.Fp.isValid(t),hash:t=>typeof t=="function"&&Number.isSafeInteger(t.outputLen)};function ue(t,e,r={}){let n=(i,a,s)=>{let o=Sl[a];if(typeof o!="function")throw new Error(`Invalid validator "${a}", expected function`);let f=t[i];if(!(s&&f===void 0)&&!o(f,t))throw new Error(`Invalid param ${String(i)}=${f} (${typeof f}), expected ${a}`)};for(let[i,a]of Object.entries(e))n(i,a,!1);for(let[i,a]of Object.entries(r))n(i,a,!0);return t}var At=BigInt(0),pt=BigInt(1),Ye=BigInt(2),Bl=BigInt(3),Gi=BigInt(4),Ms=BigInt(5),Vs=BigInt(8),Al=BigInt(9),Cl=BigInt(16);function ot(t,e){let r=t%e;return r>=At?r:e+r}function Il(t,e,r){if(r<=At||e<At)throw new Error("Expected power/modulo > 0");if(r===pt)return At;let n=pt;for(;e>At;)e&pt&&(n=n*t%r),t=t*t%r,e>>=pt;return n}function dt(t,e,r){let n=t;for(;e-- >At;)n*=n,n%=r;return n}function In(t,e){if(t===At||e<=At)throw new Error(`invert: expected positive integers, got n=${t} mod=${e}`);let r=ot(t,e),n=e,i=At,a=pt,s=pt,o=At;for(;r!==At;){let c=n/r,u=n%r,h=i-s*c,p=a-o*c;n=r,r=u,i=s,a=o,s=h,o=p}if(n!==pt)throw new Error("invert: does not exist");return ot(i,e)}function Tl(t){let e=(t-pt)/Ye,r,n,i;for(r=t-pt,n=0;r%Ye===At;r/=Ye,n++);for(i=Ye;i<t&&Il(i,e,t)!==t-pt;i++);if(n===1){let s=(t+pt)/Gi;return function(f,c){let u=f.pow(c,s);if(!f.eql(f.sqr(u),c))throw new Error("Cannot find square root");return u}}let a=(r+pt)/Ye;return function(o,f){if(o.pow(f,e)===o.neg(o.ONE))throw new Error("Cannot find square root");let c=n,u=o.pow(o.mul(o.ONE,i),r),h=o.pow(f,a),p=o.pow(f,r);for(;!o.eql(p,o.ONE);){if(o.eql(p,o.ZERO))return o.ZERO;let x=1;for(let d=o.sqr(p);x<c&&!o.eql(d,o.ONE);x++)d=o.sqr(d);let l=o.pow(u,pt<<BigInt(c-x-1));u=o.sqr(l),h=o.mul(h,l),p=o.mul(p,u),c=x}return h}}function _l(t){if(t%Gi===Bl){let e=(t+pt)/Gi;return function(n,i){let a=n.pow(i,e);if(!n.eql(n.sqr(a),i))throw new Error("Cannot find square root");return a}}if(t%Vs===Ms){let e=(t-Ms)/Vs;return function(n,i){let a=n.mul(i,Ye),s=n.pow(a,e),o=n.mul(i,s),f=n.mul(n.mul(o,Ye),s),c=n.mul(o,n.sub(f,n.ONE));if(!n.eql(n.sqr(c),i))throw new Error("Cannot find square root");return c}}return t%Cl,Tl(t)}var qs=(t,e)=>(ot(t,e)&pt)===pt,Rl=["create","isValid","is0","neg","inv","sqrt","sqr","eql","add","sub","mul","pow","div","addN","subN","mulN","sqrN"];function Wi(t){let e={ORDER:"bigint",MASK:"bigint",BYTES:"isSafeInteger",BITS:"isSafeInteger"},r=Rl.reduce((n,i)=>(n[i]="function",n),e);return ue(t,r)}function Ll(t,e,r){if(r<At)throw new Error("Expected power > 0");if(r===At)return t.ONE;if(r===pt)return e;let n=t.ONE,i=e;for(;r>At;)r&pt&&(n=t.mul(n,i)),i=t.sqr(i),r>>=pt;return n}function Nl(t,e){let r=new Array(e.length),n=e.reduce((a,s,o)=>t.is0(s)?a:(r[o]=a,t.mul(a,s)),t.ONE),i=t.inv(n);return e.reduceRight((a,s,o)=>t.is0(s)?a:(r[o]=t.mul(a,r[o]),t.mul(a,s)),i),r}function Yi(t,e){let r=e!==void 0?e:t.toString(2).length,n=Math.ceil(r/8);return{nBitLength:r,nByteLength:n}}function Tn(t,e,r=!1,n={}){if(t<=At)throw new Error(`Expected Field ORDER > 0, got ${t}`);let{nBitLength:i,nByteLength:a}=Yi(t,e);if(a>2048)throw new Error("Field lengths over 2048 bytes are not supported");let s=_l(t),o=Object.freeze({ORDER:t,BITS:i,BYTES:a,MASK:Pr(i),ZERO:At,ONE:pt,create:f=>ot(f,t),isValid:f=>{if(typeof f!="bigint")throw new Error(`Invalid field element: expected bigint, got ${typeof f}`);return At<=f&&f<t},is0:f=>f===At,isOdd:f=>(f&pt)===pt,neg:f=>ot(-f,t),eql:(f,c)=>f===c,sqr:f=>ot(f*f,t),add:(f,c)=>ot(f+c,t),sub:(f,c)=>ot(f-c,t),mul:(f,c)=>ot(f*c,t),pow:(f,c)=>Ll(o,f,c),div:(f,c)=>ot(f*In(c,t),t),sqrN:f=>f*f,addN:(f,c)=>f+c,subN:(f,c)=>f-c,mulN:(f,c)=>f*c,inv:f=>In(f,t),sqrt:n.sqrt||(f=>s(o,f)),invertBatch:f=>Nl(o,f),cmov:(f,c,u)=>u?c:f,toBytes:f=>r?We(f,a):De(f,a),fromBytes:f=>{if(f.length!==a)throw new Error(`Fp.fromBytes: expected ${a}, got ${f.length}`);return r?Ne(f):ve(f)}});return Object.freeze(o)}function Fs(t,e){if(!t.isOdd)throw new Error("Field doesn't have isOdd");let r=t.sqrt(e);return t.isOdd(r)?t.neg(r):r}function Hs(t){if(typeof t!="bigint")throw new Error("field order must be bigint");let e=t.toString(2).length;return Math.ceil(e/8)}function Zi(t){let e=Hs(t);return e+Math.ceil(e/2)}function zs(t,e,r=!1){let n=t.length,i=Hs(e),a=Zi(e);if(n<16||n<a||n>1024)throw new Error(`expected ${a}-1024 bytes of input, got ${n}`);let s=r?ve(t):Ne(t),o=ot(s,e-pt)+pt;return r?We(o,i):De(o,i)}var kl=BigInt(0),$i=BigInt(1);function _n(t,e){let r=(i,a)=>{let s=a.negate();return i?s:a},n=i=>{let a=Math.ceil(e/i)+1,s=2**(i-1);return{windows:a,windowSize:s}};return{constTimeNegate:r,unsafeLadder(i,a){let s=t.ZERO,o=i;for(;a>kl;)a&$i&&(s=s.add(o)),o=o.double(),a>>=$i;return s},precomputeWindow(i,a){let{windows:s,windowSize:o}=n(a),f=[],c=i,u=c;for(let h=0;h<s;h++){u=c,f.push(u);for(let p=1;p<o;p++)u=u.add(c),f.push(u);c=u.double()}return f},wNAF(i,a,s){let{windows:o,windowSize:f}=n(i),c=t.ZERO,u=t.BASE,h=BigInt(2**i-1),p=2**i,x=BigInt(i);for(let l=0;l<o;l++){let d=l*f,y=Number(s&h);s>>=x,y>f&&(y-=p,s+=$i);let m=d,E=d+Math.abs(y)-1,b=l%2!==0,R=y<0;y===0?u=u.add(r(b,a[m])):c=c.add(r(R,a[E]))}return{p:c,f:u}},wNAFCached(i,a,s,o){let f=i._WINDOW_SIZE||1,c=a.get(i);return c||(c=this.precomputeWindow(i,f),f!==1&&a.set(i,o(c))),this.wNAF(f,c,s)}}}function Ur(t){return Wi(t.Fp),ue(t,{n:"bigint",h:"bigint",Gx:"field",Gy:"field"},{nBitLength:"isSafeInteger",nByteLength:"isSafeInteger"}),Object.freeze({...Yi(t.n,t.nBitLength),...t,p:t.Fp.ORDER})}var Jt=BigInt(0),qt=BigInt(1),Rn=BigInt(2),Pl=BigInt(8),Ul={zip215:!0};function Kl(t){let e=Ur(t);return ue(t,{hash:"function",a:"bigint",d:"bigint",randomBytes:"function"},{adjustScalarBytes:"function",domain:"function",uvRatio:"function",mapToCurve:"function"}),Object.freeze({...e})}function Ln(t){let e=Kl(t),{Fp:r,n,prehash:i,hash:a,randomBytes:s,nByteLength:o,h:f}=e,c=Rn<<BigInt(o*8)-qt,u=r.create,h=e.uvRatio||((D,A)=>{try{return{isValid:!0,value:r.sqrt(D*r.inv(A))}}catch{return{isValid:!1,value:Jt}}}),p=e.adjustScalarBytes||(D=>D),x=e.domain||((D,A,K)=>{if(A.length||K)throw new Error("Contexts/pre-hash are not supported");return D}),l=D=>typeof D=="bigint"&&Jt<D,d=(D,A)=>l(D)&&l(A)&&D<A,y=D=>D===Jt||d(D,c);function m(D,A){if(d(D,A))return D;throw new Error(`Expected valid scalar < ${A}, got ${typeof D} ${D}`)}function E(D){return D===Jt?D:m(D,n)}let b=new Map;function R(D){if(!(D instanceof w))throw new Error("ExtendedPoint expected")}class w{constructor(A,K,O,F){if(this.ex=A,this.ey=K,this.ez=O,this.et=F,!y(A))throw new Error("x required");if(!y(K))throw new Error("y required");if(!y(O))throw new Error("z required");if(!y(F))throw new Error("t required")}get x(){return this.toAffine().x}get y(){return this.toAffine().y}static fromAffine(A){if(A instanceof w)throw new Error("extended point not allowed");let{x:K,y:O}=A||{};if(!y(K)||!y(O))throw new Error("invalid affine point");return new w(K,O,qt,u(K*O))}static normalizeZ(A){let K=r.invertBatch(A.map(O=>O.ez));return A.map((O,F)=>O.toAffine(K[F])).map(w.fromAffine)}_setWindowSize(A){this._WINDOW_SIZE=A,b.delete(this)}assertValidity(){let{a:A,d:K}=e;if(this.is0())throw new Error("bad point: ZERO");let{ex:O,ey:F,ez:Z,et:X}=this,nt=u(O*O),J=u(F*F),et=u(Z*Z),wt=u(et*et),xt=u(nt*A),Rt=u(et*u(xt+J)),Lt=u(wt+u(K*u(nt*J)));if(Rt!==Lt)throw new Error("bad point: equation left != right (1)");let Bt=u(O*F),Dt=u(Z*X);if(Bt!==Dt)throw new Error("bad point: equation left != right (2)")}equals(A){R(A);let{ex:K,ey:O,ez:F}=this,{ex:Z,ey:X,ez:nt}=A,J=u(K*nt),et=u(Z*F),wt=u(O*nt),xt=u(X*F);return J===et&&wt===xt}is0(){return this.equals(w.ZERO)}negate(){return new w(u(-this.ex),this.ey,this.ez,u(-this.et))}double(){let{a:A}=e,{ex:K,ey:O,ez:F}=this,Z=u(K*K),X=u(O*O),nt=u(Rn*u(F*F)),J=u(A*Z),et=K+O,wt=u(u(et*et)-Z-X),xt=J+X,Rt=xt-nt,Lt=J-X,Bt=u(wt*Rt),Dt=u(xt*Lt),le=u(wt*Lt),Ke=u(Rt*xt);return new w(Bt,Dt,Ke,le)}add(A){R(A);let{a:K,d:O}=e,{ex:F,ey:Z,ez:X,et:nt}=this,{ex:J,ey:et,ez:wt,et:xt}=A;if(K===BigInt(-1)){let Na=u((Z-F)*(et+J)),Da=u((Z+F)*(et-J)),Fn=u(Da-Na);if(Fn===Jt)return this.double();let ka=u(X*Rn*xt),Pa=u(nt*Rn*wt),Ua=Pa+ka,Ka=Da+Na,Oa=Pa-ka,j0=u(Ua*Fn),tf=u(Ka*Oa),ef=u(Ua*Oa),rf=u(Fn*Ka);return new w(j0,tf,rf,ef)}let Rt=u(F*J),Lt=u(Z*et),Bt=u(nt*O*xt),Dt=u(X*wt),le=u((F+Z)*(J+et)-Rt-Lt),Ke=Dt-Bt,Er=Dt+Bt,La=u(Lt-K*Rt),$0=u(le*Ke),Q0=u(Er*La),X0=u(le*La),J0=u(Ke*Er);return new w($0,Q0,J0,X0)}subtract(A){return this.add(A.negate())}wNAF(A){return N.wNAFCached(this,b,A,w.normalizeZ)}multiply(A){let{p:K,f:O}=this.wNAF(m(A,n));return w.normalizeZ([K,O])[0]}multiplyUnsafe(A){let K=E(A);return K===Jt?L:this.equals(L)||K===qt?this:this.equals(S)?this.wNAF(K).p:N.unsafeLadder(this,K)}isSmallOrder(){return this.multiplyUnsafe(f).is0()}isTorsionFree(){return N.unsafeLadder(this,n).is0()}toAffine(A){let{ex:K,ey:O,ez:F}=this,Z=this.is0();A==null&&(A=Z?Pl:r.inv(F));let X=u(K*A),nt=u(O*A),J=u(F*A);if(Z)return{x:Jt,y:qt};if(J!==qt)throw new Error("invZ was invalid");return{x:X,y:nt}}clearCofactor(){let{h:A}=e;return A===qt?this:this.multiplyUnsafe(A)}static fromHex(A,K=!1){let{d:O,a:F}=e,Z=r.BYTES;A=vt("pointHex",A,Z);let X=A.slice(),nt=A[Z-1];X[Z-1]=nt&-129;let J=Ne(X);J===Jt||(K?m(J,c):m(J,r.ORDER));let et=u(J*J),wt=u(et-qt),xt=u(O*et-F),{isValid:Rt,value:Lt}=h(wt,xt);if(!Rt)throw new Error("Point.fromHex: invalid y coordinate");let Bt=(Lt&qt)===qt,Dt=(nt&128)!==0;if(!K&&Lt===Jt&&Dt)throw new Error("Point.fromHex: x=0 and x_0=1");return Dt!==Bt&&(Lt=u(-Lt)),w.fromAffine({x:Lt,y:J})}static fromPrivateKey(A){return V(A).point}toRawBytes(){let{x:A,y:K}=this.toAffine(),O=We(K,r.BYTES);return O[O.length-1]|=A&qt?128:0,O}toHex(){return me(this.toRawBytes())}}w.BASE=new w(e.Gx,e.Gy,qt,u(e.Gx*e.Gy)),w.ZERO=new w(Jt,qt,qt,Jt);let{BASE:S,ZERO:L}=w,N=_n(w,o*8);function z(D){return ot(D,n)}function H(D){return z(Ne(D))}function V(D){let A=o;D=vt("private key",D,A);let K=vt("hashed private key",a(D),2*A),O=p(K.slice(0,A)),F=K.slice(A,2*A),Z=H(O),X=S.multiply(Z),nt=X.toRawBytes();return{head:O,prefix:F,scalar:Z,point:X,pointBytes:nt}}function Q(D){return V(D).pointBytes}function at(D=new Uint8Array,...A){let K=be(...A);return H(a(x(K,vt("context",D),!!i)))}function _t(D,A,K={}){D=vt("message",D),i&&(D=i(D));let{prefix:O,scalar:F,pointBytes:Z}=V(A),X=at(K.context,O,D),nt=S.multiply(X).toRawBytes(),J=at(K.context,nt,Z,D),et=z(X+J*F);E(et);let wt=be(nt,We(et,r.BYTES));return vt("result",wt,o*2)}let I=Ul;function k(D,A,K,O=I){let{context:F,zip215:Z}=O,X=r.BYTES;D=vt("signature",D,2*X),A=vt("message",A),i&&(A=i(A));let nt=Ne(D.slice(X,2*X)),J,et,wt;try{J=w.fromHex(K,Z),et=w.fromHex(D.slice(0,X),Z),wt=S.multiplyUnsafe(nt)}catch{return!1}if(!Z&&J.isSmallOrder())return!1;let xt=at(F,et.toRawBytes(),J.toRawBytes(),A);return et.add(J.multiplyUnsafe(xt)).subtract(wt).clearCofactor().equals(w.ZERO)}return S._setWindowSize(8),{CURVE:e,getPublicKey:Q,sign:_t,verify:k,ExtendedPoint:w,utils:{getExtendedPublicKey:V,randomPrivateKey:()=>s(r.BYTES),precompute(D=8,A=w.BASE){return A._setWindowSize(D),A.multiply(BigInt(3)),A}}}}var Xi=BigInt("57896044618658097711785492504343953926634992332820282019728792003956564819949"),Gs=BigInt("19681161376707505956807079304988542015446066515923890162744021073123829784752"),My=BigInt(0),Ol=BigInt(1),Qi=BigInt(2),Ml=BigInt(5),Ws=BigInt(10),Vl=BigInt(20),ql=BigInt(40),Ys=BigInt(80);function Fl(t){let e=Xi,n=t*t%e*t%e,i=dt(n,Qi,e)*n%e,a=dt(i,Ol,e)*t%e,s=dt(a,Ml,e)*a%e,o=dt(s,Ws,e)*s%e,f=dt(o,Vl,e)*o%e,c=dt(f,ql,e)*f%e,u=dt(c,Ys,e)*c%e,h=dt(u,Ys,e)*c%e,p=dt(h,Ws,e)*s%e;return{pow_p_5_8:dt(p,Qi,e)*t%e,b2:n}}function Hl(t){return t[0]&=248,t[31]&=127,t[31]|=64,t}function zl(t,e){let r=Xi,n=ot(e*e*e,r),i=ot(n*n*e,r),a=Fl(t*i).pow_p_5_8,s=ot(t*n*a,r),o=ot(e*s*s,r),f=s,c=ot(s*Gs,r),u=o===t,h=o===ot(-t,r),p=o===ot(-t*Gs,r);return u&&(s=f),(h||p)&&(s=c),qs(s,r)&&(s=ot(-s,r)),{isValid:u||h,value:s}}var Ee=Tn(Xi,void 0,!0),Ji={a:BigInt(-1),d:BigInt("37095705934669439343138083508754565189542113879843219016388785533085940283555"),Fp:Ee,n:BigInt("7237005577332262213973186563042994240857116359379907606001950938285454250989"),h:BigInt(8),Gx:BigInt("15112221349535400772501151409588531511454012693041857206046113283949847762202"),Gy:BigInt("46316835694926478169428394003475163141307993866256225615783033603165251855960"),hash:qi,randomBytes:hr,adjustScalarBytes:Hl,uvRatio:zl},pr=Ln(Ji);function Zs(t,e,r){if(e.length>255)throw new Error("Context is too big");return En(Oi("SigEd25519 no Ed25519 collisions"),new Uint8Array([r?1:0,e.length]),e,t)}var Vy=Ln({...Ji,domain:Zs}),qy=Ln({...Ji,domain:Zs,prehash:qi});var Gl=(Ee.ORDER+BigInt(3))/BigInt(8),Fy=Ee.pow(Qi,Gl),Hy=Ee.sqrt(Ee.neg(Ee.ONE)),zy=(Ee.ORDER-BigInt(5))/BigInt(8),Gy=BigInt(486662);var Wy=Fs(Ee,Ee.neg(BigInt(486664)));var Yy=BigInt("25063068953384623474111414158702152701244531502492656460079210482610430750235"),Zy=BigInt("54469307008909316920995813868745141605393597292927456921205312896311721017578"),$y=BigInt("1159843021668779879193775521855586647937357759715417654439879720876111806838"),Qy=BigInt("40440834346308536858101042469323190826248399146238708352240133220865137265952");var Xy=BigInt("0x7fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff");var dr=32,we=64,Nn=32;function $s(){let t=pr.utils.randomPrivateKey(),e=pr.getPublicKey(t);return{privateKey:js(t,e),publicKey:e}}function Qs(t){if(t.length!==Nn)throw new TypeError('"seed" must be 32 bytes in length.');if(!(t instanceof Uint8Array))throw new TypeError('"seed" must be a node.js Buffer, or Uint8Array.');let e=t,r=pr.getPublicKey(e);return{privateKey:js(e,r),publicKey:r}}function Xs(t,e){let r=t.subarray(0,Nn);return pr.sign(e instanceof Uint8Array?e:e.subarray(),r)}function Js(t,e,r){return pr.verify(e,r instanceof Uint8Array?r:r.subarray(),t)}function js(t,e){let r=new Uint8Array(we);for(let n=0;n<Nn;n++)r[n]=t[n],r[Nn+n]=e[n];return r}var ji={alg:"A128GCM",ext:!0,k:"scm9jmO_4BJAgdwWGVulLg",key_ops:["encrypt","decrypt"],kty:"oct"};function Dn(t){let e=t?.algorithm??"AES-GCM",r=t?.keyLength??16,n=t?.nonceLength??12,i=t?.digest??"SHA-256",a=t?.saltLength??16,s=t?.iterations??32767,o=Et.get();r*=8;async function f(h,p){let x=o.getRandomValues(new Uint8Array(a)),l=o.getRandomValues(new Uint8Array(n)),d={name:e,iv:l};typeof p=="string"&&(p=St(p));let y;if(p.length===0){y=await o.subtle.importKey("jwk",ji,{name:"AES-GCM"},!0,["encrypt"]);try{let E={name:"PBKDF2",salt:x,iterations:s,hash:{name:i}},b=await o.subtle.importKey("raw",p,{name:"PBKDF2"},!1,["deriveKey"]);y=await o.subtle.deriveKey(E,b,{name:e,length:r},!0,["encrypt"])}catch{y=await o.subtle.importKey("jwk",ji,{name:"AES-GCM"},!0,["encrypt"])}}else{let E={name:"PBKDF2",salt:x,iterations:s,hash:{name:i}},b=await o.subtle.importKey("raw",p,{name:"PBKDF2"},!1,["deriveKey"]);y=await o.subtle.deriveKey(E,b,{name:e,length:r},!0,["encrypt"])}let m=await o.subtle.encrypt(d,y,h);return ce([x,d.iv,new Uint8Array(m)])}async function c(h,p){let x=h.subarray(0,a),l=h.subarray(a,a+n),d=h.subarray(a+n),y={name:e,iv:l};typeof p=="string"&&(p=St(p));let m;if(p.length===0)try{let b={name:"PBKDF2",salt:x,iterations:s,hash:{name:i}},R=await o.subtle.importKey("raw",p,{name:"PBKDF2"},!1,["deriveKey"]);m=await o.subtle.deriveKey(b,R,{name:e,length:r},!0,["decrypt"])}catch{m=await o.subtle.importKey("jwk",ji,{name:"AES-GCM"},!0,["decrypt"])}else{let b={name:"PBKDF2",salt:x,iterations:s,hash:{name:i}},R=await o.subtle.importKey("raw",p,{name:"PBKDF2"},!1,["deriveKey"]);m=await o.subtle.deriveKey(b,R,{name:e,length:r},!0,["decrypt"])}let E=await o.subtle.decrypt(y,m,d);return new Uint8Array(E)}return{encrypt:f,decrypt:c}}async function yr(t,e){let n=await Dn().encrypt(t,e);return Sr.encode(n)}var gr={};gt(gr,{KeyType:()=>ut,PrivateKey:()=>ee,PublicKey:()=>te});var ta=new Float32Array([-0]),ke=new Uint8Array(ta.buffer);function e0(t,e,r){ta[0]=t,e[r]=ke[0],e[r+1]=ke[1],e[r+2]=ke[2],e[r+3]=ke[3]}function r0(t,e){return ke[0]=t[e],ke[1]=t[e+1],ke[2]=t[e+2],ke[3]=t[e+3],ta[0]}var ea=new Float64Array([-0]),kt=new Uint8Array(ea.buffer);function n0(t,e,r){ea[0]=t,e[r]=kt[0],e[r+1]=kt[1],e[r+2]=kt[2],e[r+3]=kt[3],e[r+4]=kt[4],e[r+5]=kt[5],e[r+6]=kt[6],e[r+7]=kt[7]}function i0(t,e){return kt[0]=t[e],kt[1]=t[e+1],kt[2]=t[e+2],kt[3]=t[e+3],kt[4]=t[e+4],kt[5]=t[e+5],kt[6]=t[e+6],kt[7]=t[e+7],ea[0]}var Yl=BigInt(Number.MAX_SAFE_INTEGER),Zl=BigInt(Number.MIN_SAFE_INTEGER),Ot=class t{lo;hi;constructor(e,r){this.lo=e|0,this.hi=r|0}toNumber(e=!1){if(!e&&this.hi>>>31>0){let r=~this.lo+1>>>0,n=~this.hi>>>0;return r===0&&(n=n+1>>>0),-(r+n*4294967296)}return this.lo+this.hi*4294967296}toBigInt(e=!1){if(e)return BigInt(this.lo>>>0)+(BigInt(this.hi>>>0)<<32n);if(this.hi>>>31){let r=~this.lo+1>>>0,n=~this.hi>>>0;return r===0&&(n=n+1>>>0),-(BigInt(r)+(BigInt(n)<<32n))}return BigInt(this.lo>>>0)+(BigInt(this.hi>>>0)<<32n)}toString(e=!1){return this.toBigInt(e).toString()}zzEncode(){let e=this.hi>>31;return this.hi=((this.hi<<1|this.lo>>>31)^e)>>>0,this.lo=(this.lo<<1^e)>>>0,this}zzDecode(){let e=-(this.lo&1);return this.lo=((this.lo>>>1|this.hi<<31)^e)>>>0,this.hi=(this.hi>>>1^e)>>>0,this}length(){let e=this.lo,r=(this.lo>>>28|this.hi<<4)>>>0,n=this.hi>>>24;return n===0?r===0?e<16384?e<128?1:2:e<2097152?3:4:r<16384?r<128?5:6:r<2097152?7:8:n<128?9:10}static fromBigInt(e){if(e===0n)return Ze;if(e<Yl&&e>Zl)return this.fromNumber(Number(e));let r=e<0n;r&&(e=-e);let n=e>>32n,i=e-(n<<32n);return r&&(n=~n|0n,i=~i|0n,++i>a0&&(i=0n,++n>a0&&(n=0n))),new t(Number(i),Number(n))}static fromNumber(e){if(e===0)return Ze;let r=e<0;r&&(e=-e);let n=e>>>0,i=(e-n)/4294967296>>>0;return r&&(i=~i>>>0,n=~n>>>0,++n>4294967295&&(n=0,++i>4294967295&&(i=0))),new t(n,i)}static from(e){return typeof e=="number"?t.fromNumber(e):typeof e=="bigint"?t.fromBigInt(e):typeof e=="string"?t.fromBigInt(BigInt(e)):e.low!=null||e.high!=null?new t(e.low>>>0,e.high>>>0):Ze}},Ze=new Ot(0,0);Ze.toBigInt=function(){return 0n};Ze.zzEncode=Ze.zzDecode=function(){return this};Ze.length=function(){return 1};var a0=4294967296n;function o0(t){let e=0,r=0;for(let n=0;n<t.length;++n)r=t.charCodeAt(n),r<128?e+=1:r<2048?e+=2:(r&64512)===55296&&(t.charCodeAt(n+1)&64512)===56320?(++n,e+=4):e+=3;return e}function s0(t,e,r){if(r-e<1)return"";let i,a=[],s=0,o;for(;e<r;)o=t[e++],o<128?a[s++]=o:o>191&&o<224?a[s++]=(o&31)<<6|t[e++]&63:o>239&&o<365?(o=((o&7)<<18|(t[e++]&63)<<12|(t[e++]&63)<<6|t[e++]&63)-65536,a[s++]=55296+(o>>10),a[s++]=56320+(o&1023)):a[s++]=(o&15)<<12|(t[e++]&63)<<6|t[e++]&63,s>8191&&((i??(i=[])).push(String.fromCharCode.apply(String,a)),s=0);return i!=null?(s>0&&i.push(String.fromCharCode.apply(String,a.slice(0,s))),i.join("")):String.fromCharCode.apply(String,a.slice(0,s))}function ra(t,e,r){let n=r,i,a;for(let s=0;s<t.length;++s)i=t.charCodeAt(s),i<128?e[r++]=i:i<2048?(e[r++]=i>>6|192,e[r++]=i&63|128):(i&64512)===55296&&((a=t.charCodeAt(s+1))&64512)===56320?(i=65536+((i&1023)<<10)+(a&1023),++s,e[r++]=i>>18|240,e[r++]=i>>12&63|128,e[r++]=i>>6&63|128,e[r++]=i&63|128):(e[r++]=i>>12|224,e[r++]=i>>6&63|128,e[r++]=i&63|128);return r-n}function jt(t,e){return RangeError(`index out of range: ${t.pos} + ${e??1} > ${t.len}`)}function kn(t,e){return(t[e-4]|t[e-3]<<8|t[e-2]<<16|t[e-1]<<24)>>>0}var na=class{buf;pos;len;_slice=Uint8Array.prototype.subarray;constructor(e){this.buf=e,this.pos=0,this.len=e.length}uint32(){let e=4294967295;if(e=(this.buf[this.pos]&127)>>>0,this.buf[this.pos++]<128||(e=(e|(this.buf[this.pos]&127)<<7)>>>0,this.buf[this.pos++]<128)||(e=(e|(this.buf[this.pos]&127)<<14)>>>0,this.buf[this.pos++]<128)||(e=(e|(this.buf[this.pos]&127)<<21)>>>0,this.buf[this.pos++]<128)||(e=(e|(this.buf[this.pos]&15)<<28)>>>0,this.buf[this.pos++]<128))return e;if((this.pos+=5)>this.len)throw this.pos=this.len,jt(this,10);return e}int32(){return this.uint32()|0}sint32(){let e=this.uint32();return e>>>1^-(e&1)|0}bool(){return this.uint32()!==0}fixed32(){if(this.pos+4>this.len)throw jt(this,4);return kn(this.buf,this.pos+=4)}sfixed32(){if(this.pos+4>this.len)throw jt(this,4);return kn(this.buf,this.pos+=4)|0}float(){if(this.pos+4>this.len)throw jt(this,4);let e=r0(this.buf,this.pos);return this.pos+=4,e}double(){if(this.pos+8>this.len)throw jt(this,4);let e=i0(this.buf,this.pos);return this.pos+=8,e}bytes(){let e=this.uint32(),r=this.pos,n=this.pos+e;if(n>this.len)throw jt(this,e);return this.pos+=e,r===n?new Uint8Array(0):this.buf.subarray(r,n)}string(){let e=this.bytes();return s0(e,0,e.length)}skip(e){if(typeof e=="number"){if(this.pos+e>this.len)throw jt(this,e);this.pos+=e}else do if(this.pos>=this.len)throw jt(this);while(this.buf[this.pos++]&128);return this}skipType(e){switch(e){case 0:this.skip();break;case 1:this.skip(8);break;case 2:this.skip(this.uint32());break;case 3:for(;(e=this.uint32()&7)!==4;)this.skipType(e);break;case 5:this.skip(4);break;default:throw Error(`invalid wire type ${e} at offset ${this.pos}`)}return this}readLongVarint(){let e=new Ot(0,0),r=0;if(this.len-this.pos>4){for(;r<4;++r)if(e.lo=(e.lo|(this.buf[this.pos]&127)<<r*7)>>>0,this.buf[this.pos++]<128)return e;if(e.lo=(e.lo|(this.buf[this.pos]&127)<<28)>>>0,e.hi=(e.hi|(this.buf[this.pos]&127)>>4)>>>0,this.buf[this.pos++]<128)return e;r=0}else{for(;r<3;++r){if(this.pos>=this.len)throw jt(this);if(e.lo=(e.lo|(this.buf[this.pos]&127)<<r*7)>>>0,this.buf[this.pos++]<128)return e}return e.lo=(e.lo|(this.buf[this.pos++]&127)<<r*7)>>>0,e}if(this.len-this.pos>4){for(;r<5;++r)if(e.hi=(e.hi|(this.buf[this.pos]&127)<<r*7+3)>>>0,this.buf[this.pos++]<128)return e}else for(;r<5;++r){if(this.pos>=this.len)throw jt(this);if(e.hi=(e.hi|(this.buf[this.pos]&127)<<r*7+3)>>>0,this.buf[this.pos++]<128)return e}throw Error("invalid varint encoding")}readFixed64(){if(this.pos+8>this.len)throw jt(this,8);let e=kn(this.buf,this.pos+=4),r=kn(this.buf,this.pos+=4);return new Ot(e,r)}int64(){return this.readLongVarint().toBigInt()}int64Number(){return this.readLongVarint().toNumber()}int64String(){return this.readLongVarint().toString()}uint64(){return this.readLongVarint().toBigInt(!0)}uint64Number(){return this.readLongVarint().toNumber(!0)}uint64String(){return this.readLongVarint().toString(!0)}sint64(){return this.readLongVarint().zzDecode().toBigInt()}sint64Number(){return this.readLongVarint().zzDecode().toNumber()}sint64String(){return this.readLongVarint().zzDecode().toString()}fixed64(){return this.readFixed64().toBigInt()}fixed64Number(){return this.readFixed64().toNumber()}fixed64String(){return this.readFixed64().toString()}sfixed64(){return this.readFixed64().toBigInt()}sfixed64Number(){return this.readFixed64().toNumber()}sfixed64String(){return this.readFixed64().toString()}};function ia(t){return new na(t instanceof Uint8Array?t:t.subarray())}function Pn(t,e){let r=ia(t);return e.decode(r)}function aa(t){let e=t??8192,r=e>>>1,n,i=e;return function(s){if(s<1||s>r)return de(s);i+s>e&&(n=de(e),i=0);let o=n.subarray(i,i+=s);return i&7&&(i=(i|7)+1),o}}var $e=class{fn;len;next;val;constructor(e,r,n){this.fn=e,this.len=r,this.next=void 0,this.val=n}};function oa(){}var fa=class{head;tail;len;next;constructor(e){this.head=e.head,this.tail=e.tail,this.len=e.len,this.next=e.states}},$l=aa();function Ql(t){return globalThis.Buffer!=null?de(t):$l(t)}var Mr=class{len;head;tail;states;constructor(){this.len=0,this.head=new $e(oa,0,0),this.tail=this.head,this.states=null}_push(e,r,n){return this.tail=this.tail.next=new $e(e,r,n),this.len+=r,this}uint32(e){return this.len+=(this.tail=this.tail.next=new ca((e=e>>>0)<128?1:e<16384?2:e<2097152?3:e<268435456?4:5,e)).len,this}int32(e){return e<0?this._push(Kr,10,Ot.fromNumber(e)):this.uint32(e)}sint32(e){return this.uint32((e<<1^e>>31)>>>0)}uint64(e){let r=Ot.fromBigInt(e);return this._push(Kr,r.length(),r)}uint64Number(e){let r=Ot.fromNumber(e);return this._push(Kr,r.length(),r)}uint64String(e){return this.uint64(BigInt(e))}int64(e){return this.uint64(e)}int64Number(e){return this.uint64Number(e)}int64String(e){return this.uint64String(e)}sint64(e){let r=Ot.fromBigInt(e).zzEncode();return this._push(Kr,r.length(),r)}sint64Number(e){let r=Ot.fromNumber(e).zzEncode();return this._push(Kr,r.length(),r)}sint64String(e){return this.sint64(BigInt(e))}bool(e){return this._push(sa,1,e?1:0)}fixed32(e){return this._push(Or,4,e>>>0)}sfixed32(e){return this.fixed32(e)}fixed64(e){let r=Ot.fromBigInt(e);return this._push(Or,4,r.lo)._push(Or,4,r.hi)}fixed64Number(e){let r=Ot.fromNumber(e);return this._push(Or,4,r.lo)._push(Or,4,r.hi)}fixed64String(e){return this.fixed64(BigInt(e))}sfixed64(e){return this.fixed64(e)}sfixed64Number(e){return this.fixed64Number(e)}sfixed64String(e){return this.fixed64String(e)}float(e){return this._push(e0,4,e)}double(e){return this._push(n0,8,e)}bytes(e){let r=e.length>>>0;return r===0?this._push(sa,1,0):this.uint32(r)._push(Jl,r,e)}string(e){let r=o0(e);return r!==0?this.uint32(r)._push(ra,r,e):this._push(sa,1,0)}fork(){return this.states=new fa(this),this.head=this.tail=new $e(oa,0,0),this.len=0,this}reset(){return this.states!=null?(this.head=this.states.head,this.tail=this.states.tail,this.len=this.states.len,this.states=this.states.next):(this.head=this.tail=new $e(oa,0,0),this.len=0),this}ldelim(){let e=this.head,r=this.tail,n=this.len;return this.reset().uint32(n),n!==0&&(this.tail.next=e.next,this.tail=r,this.len+=n),this}finish(){let e=this.head.next,r=Ql(this.len),n=0;for(;e!=null;)e.fn(e.val,r,n),n+=e.len,e=e.next;return r}};function sa(t,e,r){e[r]=t&255}function Xl(t,e,r){for(;t>127;)e[r++]=t&127|128,t>>>=7;e[r]=t}var ca=class extends $e{next;constructor(e,r){super(Xl,e,r),this.next=void 0}};function Kr(t,e,r){for(;t.hi!==0;)e[r++]=t.lo&127|128,t.lo=(t.lo>>>7|t.hi<<25)>>>0,t.hi>>>=7;for(;t.lo>127;)e[r++]=t.lo&127|128,t.lo=t.lo>>>7;e[r++]=t.lo}function Or(t,e,r){e[r]=t&255,e[r+1]=t>>>8&255,e[r+2]=t>>>16&255,e[r+3]=t>>>24}function Jl(t,e,r){e.set(t,r)}globalThis.Buffer!=null&&(Mr.prototype.bytes=function(t){let e=t.length>>>0;return this.uint32(e),e>0&&this._push(jl,e,t),this},Mr.prototype.string=function(t){let e=globalThis.Buffer.byteLength(t);return this.uint32(e),e>0&&this._push(tp,e,t),this});function jl(t,e,r){e.set(t,r)}function tp(t,e,r){t.length<40?ra(t,e,r):e.utf8Write!=null?e.utf8Write(t,r):e.set(St(t),r)}function ua(){return new Mr}function Un(t,e){let r=ua();return e.encode(t,r,{lengthDelimited:!1}),r.finish()}var xr;(function(t){t[t.VARINT=0]="VARINT",t[t.BIT64=1]="BIT64",t[t.LENGTH_DELIMITED=2]="LENGTH_DELIMITED",t[t.START_GROUP=3]="START_GROUP",t[t.END_GROUP=4]="END_GROUP",t[t.BIT32=5]="BIT32"})(xr||(xr={}));function Kn(t,e,r,n){return{name:t,type:e,encode:r,decode:n}}function ha(t){function e(i){if(t[i.toString()]==null)throw new Error("Invalid enum value");return t[i]}let r=function(a,s){let o=e(a);s.int32(o)},n=function(a){let s=a.int32();return e(s)};return Kn("enum",xr.VARINT,r,n)}function On(t,e){return Kn("message",xr.LENGTH_DELIMITED,t,e)}var ut;(function(t){t.RSA="RSA",t.Ed25519="Ed25519",t.Secp256k1="Secp256k1"})(ut||(ut={}));var la;(function(t){t[t.RSA=0]="RSA",t[t.Ed25519=1]="Ed25519",t[t.Secp256k1=2]="Secp256k1"})(la||(la={}));(function(t){t.codec=()=>ha(la)})(ut||(ut={}));var te;(function(t){let e;t.codec=()=>(e==null&&(e=On((r,n,i={})=>{i.lengthDelimited!==!1&&n.fork(),r.Type!=null&&(n.uint32(8),ut.codec().encode(r.Type,n)),r.Data!=null&&(n.uint32(18),n.bytes(r.Data)),i.lengthDelimited!==!1&&n.ldelim()},(r,n)=>{let i={},a=n==null?r.len:r.pos+n;for(;r.pos<a;){let s=r.uint32();switch(s>>>3){case 1:i.Type=ut.codec().decode(r);break;case 2:i.Data=r.bytes();break;default:r.skipType(s&7);break}}return i})),e),t.encode=r=>Un(r,t.codec()),t.decode=r=>Pn(r,t.codec())})(te||(te={}));var ee;(function(t){let e;t.codec=()=>(e==null&&(e=On((r,n,i={})=>{i.lengthDelimited!==!1&&n.fork(),r.Type!=null&&(n.uint32(8),ut.codec().encode(r.Type,n)),r.Data!=null&&(n.uint32(18),n.bytes(r.Data)),i.lengthDelimited!==!1&&n.ldelim()},(r,n)=>{let i={},a=n==null?r.len:r.pos+n;for(;r.pos<a;){let s=r.uint32();switch(s>>>3){case 1:i.Type=ut.codec().decode(r);break;case 2:i.Data=r.bytes();break;default:r.skipType(s&7);break}}return i})),e),t.encode=r=>Un(r,t.codec()),t.decode=r=>Pn(r,t.codec())})(ee||(ee={}));var Vr=class{_key;constructor(e){this._key=mr(e,dr)}verify(e,r){return Js(this._key,r,e)}marshal(){return this._key}get bytes(){return te.encode({Type:ut.Ed25519,Data:this.marshal()}).subarray()}equals(e){return $t(this.bytes,e.bytes)}hash(){let e=Mt.digest(this.bytes);return Gt(e)?e.then(({bytes:r})=>r):e.bytes}},Qe=class{_key;_publicKey;constructor(e,r){this._key=mr(e,we),this._publicKey=mr(r,dr)}sign(e){return Xs(this._key,e)}get public(){return new Vr(this._publicKey)}marshal(){return this._key}get bytes(){return ee.encode({Type:ut.Ed25519,Data:this.marshal()}).subarray()}equals(e){return $t(this.bytes,e.bytes)}async hash(){let e=Mt.digest(this.bytes),r;return Gt(e)?{bytes:r}=await e:r=e.bytes,r}async id(){let e=xi.digest(this.public.bytes);return Ft.encode(e.bytes).substring(1)}async export(e,r="libp2p-key"){if(r==="libp2p-key")return yr(this.bytes,e);throw new q(`export format '${r}' is not supported`,"ERR_INVALID_EXPORT_FORMAT")}};function ep(t){if(t.length>we){t=mr(t,we+dr);let n=t.subarray(0,we),i=t.subarray(we,t.length);return new Qe(n,i)}t=mr(t,we);let e=t.subarray(0,we),r=t.subarray(dr);return new Qe(e,r)}function rp(t){return t=mr(t,dr),new Vr(t)}async function np(){let{privateKey:t,publicKey:e}=$s();return new Qe(t,e)}async function pa(t){let{privateKey:e,publicKey:r}=Qs(t);return new Qe(e,r)}function mr(t,e){if(t=Uint8Array.from(t??[]),t.length!==e)throw new q(`Key must be a Uint8Array of length ${e}, got ${t.length}`,"ERR_INVALID_KEY_TYPE");return t}var c0={"P-256":256,"P-384":384,"P-521":521},ip=Object.keys(c0),ya=ip.join(" / ");async function u0(t){if(t!=="P-256"&&t!=="P-384"&&t!=="P-521")throw new q(`Unknown curve: ${t}. Must be ${ya}`,"ERR_INVALID_CURVE");let e=await Et.get().subtle.generateKey({name:"ECDH",namedCurve:t},!0,["deriveBits"]),r=async(a,s)=>{let o;s!=null?o=await Et.get().subtle.importKey("jwk",op(t,s),{name:"ECDH",namedCurve:t},!1,["deriveBits"]):o=e.privateKey;let f=await Et.get().subtle.importKey("jwk",l0(t,a),{name:"ECDH",namedCurve:t},!1,[]),c=await Et.get().subtle.deriveBits({name:"ECDH",namedCurve:t,public:f},o,c0[t]);return new Uint8Array(c,0,c.byteLength)},n=await Et.get().subtle.exportKey("jwk",e.publicKey);return{key:ap(n),genSharedKey:r}}var h0={"P-256":32,"P-384":48,"P-521":66};function ap(t){if(t.crv==null||t.x==null||t.y==null)throw new q("JWK was missing components","ERR_INVALID_PARAMETERS");if(t.crv!=="P-256"&&t.crv!=="P-384"&&t.crv!=="P-521")throw new q(`Unknown curve: ${t.crv}. Must be ${ya}`,"ERR_INVALID_CURVE");let e=h0[t.crv];return ce([Uint8Array.from([4]),mn(t.x,e),mn(t.y,e)],1+e*2)}function l0(t,e){if(t!=="P-256"&&t!=="P-384"&&t!=="P-521")throw new q(`Unknown curve: ${t}. Must be ${ya}`,"ERR_INVALID_CURVE");let r=h0[t];if(!$t(e.subarray(0,1),Uint8Array.from([4])))throw new q("Cannot unmarshal public key - invalid key format","ERR_INVALID_KEY_FORMAT");return{kty:"EC",crv:t,x:yt(e.subarray(1,r+1),"base64url"),y:yt(e.subarray(1+r),"base64url"),ext:!0}}var op=(t,e)=>({...l0(t,e.public),d:yt(e.private,"base64url")});var p0=u0;async function d0(t,e){let r=Sr.decode(t);return Dn().decrypt(r,e)}var y0={"AES-128":{ivSize:16,keySize:16},"AES-256":{ivSize:16,keySize:32},Blowfish:{ivSize:8,keySize:32}};async function x0(t,e,r){let n=y0[t];if(n==null){let E=Object.keys(y0).join(" / ");throw new q(`unknown cipher type '${t}'. Must be ${E}`,"ERR_INVALID_CIPHER_TYPE")}if(e==null)throw new q("missing hash type","ERR_MISSING_HASH_TYPE");let i=n.keySize,a=n.ivSize,s=20,o=St("key expansion"),f=2*(a+i+s),c=await Ai(e,r),u=await c.digest(o),h=[],p=0;for(;p<f;){let E=await c.digest(ce([u,o])),b=E.length;p+b>f&&(b=f-p),h.push(E),p+=b,u=await c.digest(u)}let x=f/2,l=ce(h),d=l.subarray(0,x),y=l.subarray(x,f),m=E=>({iv:E.subarray(0,a),cipherKey:E.subarray(a,a+i),macKey:E.subarray(a+i)});return{k1:m(d),k2:m(y)}}var ba={};gt(ba,{MAX_KEY_SIZE:()=>zr,RsaPrivateKey:()=>br,RsaPublicKey:()=>Hr,fromJwk:()=>xp,generateKeyPair:()=>gp,unmarshalRsaPrivateKey:()=>dp,unmarshalRsaPublicKey:()=>yp});var Fr=Nt(it(),1);var Ax=Nt(E0(),1);function vr(t){if(isNaN(t)||t<=0)throw new q("random bytes length must be a Number bigger than 0","ERR_INVALID_LENGTH");return hr(t)}var sx=Nt(gn(),1),ma=Nt(it(),1);function w0(t,e){return e.map(r=>Vt(t[r]))}function S0(t){return ma.default.pki.setRsaPrivateKey(...w0(t,["n","e","d","p","q","dp","dq","qi"]))}function B0(t){return ma.default.pki.setRsaPublicKey(...w0(t,["n","e"]))}var Je={};gt(Je,{jwkToPkcs1:()=>cp,jwkToPkix:()=>hp,pkcs1ToJwk:()=>fp,pkixToJwk:()=>up});var ux=Nt(Lr(),1),hx=Nt(gn(),1);var Se=Nt(it(),1);function fp(t){let e=Se.default.asn1.fromDer(yt(t,"ascii")),r=Se.default.pki.privateKeyFromAsn1(e);return{kty:"RSA",n:Qt(r.n),e:Qt(r.e),d:Qt(r.d),p:Qt(r.p),q:Qt(r.q),dp:Qt(r.dP),dq:Qt(r.dQ),qi:Qt(r.qInv),alg:"RS256"}}function cp(t){if(t.n==null||t.e==null||t.d==null||t.p==null||t.q==null||t.dp==null||t.dq==null||t.qi==null)throw new q("JWK was missing components","ERR_INVALID_PARAMETERS");let e=Se.default.pki.privateKeyToAsn1({n:Vt(t.n),e:Vt(t.e),d:Vt(t.d),p:Vt(t.p),q:Vt(t.q),dP:Vt(t.dp),dQ:Vt(t.dq),qInv:Vt(t.qi)});return St(Se.default.asn1.toDer(e).getBytes(),"ascii")}function up(t){let e=Se.default.asn1.fromDer(yt(t,"ascii")),r=Se.default.pki.publicKeyFromAsn1(e);return{kty:"RSA",n:Qt(r.n),e:Qt(r.e)}}function hp(t){if(t.n==null||t.e==null)throw new q("JWK was missing components","ERR_INVALID_PARAMETERS");let e=Se.default.pki.publicKeyToAsn1({n:Vt(t.n),e:Vt(t.e)});return St(Se.default.asn1.toDer(e).getBytes(),"ascii")}async function A0(t){let e=await Et.get().subtle.generateKey({name:"RSASSA-PKCS1-v1_5",modulusLength:t,publicExponent:new Uint8Array([1,0,1]),hash:{name:"SHA-256"}},!0,["sign","verify"]),r=await T0(e);return{privateKey:r[0],publicKey:r[1]}}async function va(t){let r=[await Et.get().subtle.importKey("jwk",t,{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}},!0,["sign"]),await lp(t)],n=await T0({privateKey:r[0],publicKey:r[1]});return{privateKey:n[0],publicKey:n[1]}}async function C0(t,e){let r=await Et.get().subtle.importKey("jwk",t,{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}},!1,["sign"]),n=await Et.get().subtle.sign({name:"RSASSA-PKCS1-v1_5"},r,e instanceof Uint8Array?e:e.subarray());return new Uint8Array(n,0,n.byteLength)}async function I0(t,e,r){let n=await Et.get().subtle.importKey("jwk",t,{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}},!1,["verify"]);return Et.get().subtle.verify({name:"RSASSA-PKCS1-v1_5"},n,e,r instanceof Uint8Array?r:r.subarray())}async function T0(t){if(t.privateKey==null||t.publicKey==null)throw new q("Private and public key are required","ERR_INVALID_PARAMETERS");return Promise.all([Et.get().subtle.exportKey("jwk",t.privateKey),Et.get().subtle.exportKey("jwk",t.publicKey)])}async function lp(t){return Et.get().subtle.importKey("jwk",{kty:t.kty,n:t.n,e:t.e},{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}},!0,["verify"])}function _0(t,e,r,n){let i=e?B0(t):S0(t),a=yt(r instanceof Uint8Array?r:r.subarray(),"ascii"),s=n(a,i);return St(s,"ascii")}function R0(t,e){return _0(t,!0,e,(r,n)=>n.encrypt(r))}function L0(t,e){return _0(t,!1,e,(r,n)=>n.decrypt(r))}function Mn(t){if(t.kty!=="RSA")throw new q("invalid key type","ERR_INVALID_KEY_TYPE");if(t.n==null)throw new q("invalid key modulus","ERR_INVALID_KEY_MODULUS");return St(t.n,"base64url").length*8}var zr=8192,Hr=class{_key;constructor(e){this._key=e}verify(e,r){return I0(this._key,r,e)}marshal(){return Je.jwkToPkix(this._key)}get bytes(){return te.encode({Type:ut.RSA,Data:this.marshal()}).subarray()}encrypt(e){return R0(this._key,e)}equals(e){return $t(this.bytes,e.bytes)}hash(){let e=Mt.digest(this.bytes);return Gt(e)?e.then(({bytes:r})=>r):e.bytes}},br=class{_key;_publicKey;constructor(e,r){this._key=e,this._publicKey=r}genSecret(){return vr(16)}sign(e){return C0(this._key,e)}get public(){if(this._publicKey==null)throw new q("public key not provided","ERR_PUBKEY_NOT_PROVIDED");return new Hr(this._publicKey)}decrypt(e){return L0(this._key,e)}marshal(){return Je.jwkToPkcs1(this._key)}get bytes(){return ee.encode({Type:ut.RSA,Data:this.marshal()}).subarray()}equals(e){return $t(this.bytes,e.bytes)}hash(){let e=Mt.digest(this.bytes);return Gt(e)?e.then(({bytes:r})=>r):e.bytes}async id(){let e=await this.public.hash();return yt(e,"base58btc")}async export(e,r="pkcs-8"){if(r==="pkcs-8"){let n=new Fr.default.util.ByteBuffer(this.marshal()),i=Fr.default.asn1.fromDer(n),a=Fr.default.pki.privateKeyFromAsn1(i),s={algorithm:"aes256",count:1e4,saltSize:128/8,prfAlgorithm:"sha512"};return Fr.default.pki.encryptRsaPrivateKey(a,e,s)}else{if(r==="libp2p-key")return yr(this.bytes,e);throw new q(`export format '${r}' is not supported`,"ERR_INVALID_EXPORT_FORMAT")}}};async function dp(t){let e=Je.pkcs1ToJwk(t);if(Mn(e)>zr)throw new q("key size is too large","ERR_KEY_SIZE_TOO_LARGE");let r=await va(e);return new br(r.privateKey,r.publicKey)}function yp(t){let e=Je.pkixToJwk(t);if(Mn(e)>zr)throw new q("key size is too large","ERR_KEY_SIZE_TOO_LARGE");return new Hr(e)}async function xp(t){if(Mn(t)>zr)throw new q("key size is too large","ERR_KEY_SIZE_TOO_LARGE");let e=await va(t);return new br(e.privateKey,e.publicKey)}async function gp(t){if(t>zr)throw new q("key size is too large","ERR_KEY_SIZE_TOO_LARGE");let e=await A0(t);return new br(e.privateKey,e.publicKey)}var Ca={};gt(Ca,{Secp256k1PrivateKey:()=>Wr,Secp256k1PublicKey:()=>Gr,generateKeyPair:()=>Np,unmarshalSecp256k1PrivateKey:()=>Rp,unmarshalSecp256k1PublicKey:()=>Lp});var mp=(t,e,r)=>t&e^~t&r,vp=(t,e,r)=>t&e^t&r^e&r,bp=new Uint32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),Pe=new Uint32Array([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),Ue=new Uint32Array(64),Ea=class extends lr{constructor(){super(64,32,8,!1),this.A=Pe[0]|0,this.B=Pe[1]|0,this.C=Pe[2]|0,this.D=Pe[3]|0,this.E=Pe[4]|0,this.F=Pe[5]|0,this.G=Pe[6]|0,this.H=Pe[7]|0}get(){let{A:e,B:r,C:n,D:i,E:a,F:s,G:o,H:f}=this;return[e,r,n,i,a,s,o,f]}set(e,r,n,i,a,s,o,f){this.A=e|0,this.B=r|0,this.C=n|0,this.D=i|0,this.E=a|0,this.F=s|0,this.G=o|0,this.H=f|0}process(e,r){for(let h=0;h<16;h++,r+=4)Ue[h]=e.getUint32(r,!1);for(let h=16;h<64;h++){let p=Ue[h-15],x=Ue[h-2],l=Xt(p,7)^Xt(p,18)^p>>>3,d=Xt(x,17)^Xt(x,19)^x>>>10;Ue[h]=d+Ue[h-7]+l+Ue[h-16]|0}let{A:n,B:i,C:a,D:s,E:o,F:f,G:c,H:u}=this;for(let h=0;h<64;h++){let p=Xt(o,6)^Xt(o,11)^Xt(o,25),x=u+p+mp(o,f,c)+bp[h]+Ue[h]|0,d=(Xt(n,2)^Xt(n,13)^Xt(n,22))+vp(n,i,a)|0;u=c,c=f,f=o,o=s+x|0,s=a,a=i,i=n,n=x+d|0}n=n+this.A|0,i=i+this.B|0,a=a+this.C|0,s=s+this.D|0,o=o+this.E|0,f=f+this.F|0,c=c+this.G|0,u=u+this.H|0,this.set(n,i,a,s,o,f,c,u)}roundClean(){Ue.fill(0)}destroy(){this.set(0,0,0,0,0,0,0,0),this.buffer.fill(0)}};var N0=wn(()=>new Ea);function Ep(t){let e=Ur(t);ue(e,{a:"field",b:"field"},{allowedPrivateKeyLengths:"array",wrapPrivateKey:"boolean",isTorsionFree:"function",clearCofactor:"function",allowInfinityPoint:"boolean",fromBytes:"function",toBytes:"function"});let{endo:r,Fp:n,a:i}=e;if(r){if(!n.eql(i,n.ZERO))throw new Error("Endomorphism can only be defined for Koblitz curves that have a=0");if(typeof r!="object"||typeof r.beta!="bigint"||typeof r.splitScalar!="function")throw new Error("Expected endomorphism with beta: bigint and splitScalar: function")}return Object.freeze({...e})}var{bytesToNumberBE:wp,hexToBytes:Sp}=Cn,je={Err:class extends Error{constructor(e=""){super(e)}},_parseInt(t){let{Err:e}=je;if(t.length<2||t[0]!==2)throw new e("Invalid signature integer tag");let r=t[1],n=t.subarray(2,r+2);if(!r||n.length!==r)throw new e("Invalid signature integer: wrong length");if(n[0]&128)throw new e("Invalid signature integer: negative");if(n[0]===0&&!(n[1]&128))throw new e("Invalid signature integer: unnecessary leading zero");return{d:wp(n),l:t.subarray(r+2)}},toSig(t){let{Err:e}=je,r=typeof t=="string"?Sp(t):t;if(!(r instanceof Uint8Array))throw new Error("ui8a expected");let n=r.length;if(n<2||r[0]!=48)throw new e("Invalid signature tag");if(r[1]!==n-2)throw new e("Invalid signature: incorrect length");let{d:i,l:a}=je._parseInt(r.subarray(2)),{d:s,l:o}=je._parseInt(a);if(o.length)throw new e("Invalid signature: left bytes after parsing");return{r:i,s}},hexFromSig(t){let e=c=>Number.parseInt(c[0],16)&8?"00"+c:c,r=c=>{let u=c.toString(16);return u.length&1?`0${u}`:u},n=e(r(t.s)),i=e(r(t.r)),a=n.length/2,s=i.length/2,o=r(a),f=r(s);return`30${r(s+a+4)}02${f}${i}02${o}${n}`}},Be=BigInt(0),Wt=BigInt(1),Px=BigInt(2),D0=BigInt(3),Ux=BigInt(4);function Bp(t){let e=Ep(t),{Fp:r}=e,n=e.toBytes||((l,d,y)=>{let m=d.toAffine();return be(Uint8Array.from([4]),r.toBytes(m.x),r.toBytes(m.y))}),i=e.fromBytes||(l=>{let d=l.subarray(1),y=r.fromBytes(d.subarray(0,r.BYTES)),m=r.fromBytes(d.subarray(r.BYTES,2*r.BYTES));return{x:y,y:m}});function a(l){let{a:d,b:y}=e,m=r.sqr(l),E=r.mul(m,l);return r.add(r.add(E,r.mul(l,d)),y)}if(!r.eql(r.sqr(e.Gy),a(e.Gx)))throw new Error("bad generator point: equation left != right");function s(l){return typeof l=="bigint"&&Be<l&&l<e.n}function o(l){if(!s(l))throw new Error("Expected valid bigint: 0 < bigint < curve.n")}function f(l){let{allowedPrivateKeyLengths:d,nByteLength:y,wrapPrivateKey:m,n:E}=e;if(d&&typeof l!="bigint"){if(l instanceof Uint8Array&&(l=me(l)),typeof l!="string"||!d.includes(l.length))throw new Error("Invalid key");l=l.padStart(y*2,"0")}let b;try{b=typeof l=="bigint"?l:ve(vt("private key",l,y))}catch{throw new Error(`private key must be ${y} bytes, hex or bigint, not ${typeof l}`)}return m&&(b=ot(b,E)),o(b),b}let c=new Map;function u(l){if(!(l instanceof h))throw new Error("ProjectivePoint expected")}class h{constructor(d,y,m){if(this.px=d,this.py=y,this.pz=m,d==null||!r.isValid(d))throw new Error("x required");if(y==null||!r.isValid(y))throw new Error("y required");if(m==null||!r.isValid(m))throw new Error("z required")}static fromAffine(d){let{x:y,y:m}=d||{};if(!d||!r.isValid(y)||!r.isValid(m))throw new Error("invalid affine point");if(d instanceof h)throw new Error("projective point not allowed");let E=b=>r.eql(b,r.ZERO);return E(y)&&E(m)?h.ZERO:new h(y,m,r.ONE)}get x(){return this.toAffine().x}get y(){return this.toAffine().y}static normalizeZ(d){let y=r.invertBatch(d.map(m=>m.pz));return d.map((m,E)=>m.toAffine(y[E])).map(h.fromAffine)}static fromHex(d){let y=h.fromAffine(i(vt("pointHex",d)));return y.assertValidity(),y}static fromPrivateKey(d){return h.BASE.multiply(f(d))}_setWindowSize(d){this._WINDOW_SIZE=d,c.delete(this)}assertValidity(){if(this.is0()){if(e.allowInfinityPoint&&!r.is0(this.py))return;throw new Error("bad point: ZERO")}let{x:d,y}=this.toAffine();if(!r.isValid(d)||!r.isValid(y))throw new Error("bad point: x or y not FE");let m=r.sqr(y),E=a(d);if(!r.eql(m,E))throw new Error("bad point: equation left != right");if(!this.isTorsionFree())throw new Error("bad point: not in prime-order subgroup")}hasEvenY(){let{y:d}=this.toAffine();if(r.isOdd)return!r.isOdd(d);throw new Error("Field doesn't support isOdd")}equals(d){u(d);let{px:y,py:m,pz:E}=this,{px:b,py:R,pz:w}=d,S=r.eql(r.mul(y,w),r.mul(b,E)),L=r.eql(r.mul(m,w),r.mul(R,E));return S&&L}negate(){return new h(this.px,r.neg(this.py),this.pz)}double(){let{a:d,b:y}=e,m=r.mul(y,D0),{px:E,py:b,pz:R}=this,w=r.ZERO,S=r.ZERO,L=r.ZERO,N=r.mul(E,E),z=r.mul(b,b),H=r.mul(R,R),V=r.mul(E,b);return V=r.add(V,V),L=r.mul(E,R),L=r.add(L,L),w=r.mul(d,L),S=r.mul(m,H),S=r.add(w,S),w=r.sub(z,S),S=r.add(z,S),S=r.mul(w,S),w=r.mul(V,w),L=r.mul(m,L),H=r.mul(d,H),V=r.sub(N,H),V=r.mul(d,V),V=r.add(V,L),L=r.add(N,N),N=r.add(L,N),N=r.add(N,H),N=r.mul(N,V),S=r.add(S,N),H=r.mul(b,R),H=r.add(H,H),N=r.mul(H,V),w=r.sub(w,N),L=r.mul(H,z),L=r.add(L,L),L=r.add(L,L),new h(w,S,L)}add(d){u(d);let{px:y,py:m,pz:E}=this,{px:b,py:R,pz:w}=d,S=r.ZERO,L=r.ZERO,N=r.ZERO,z=e.a,H=r.mul(e.b,D0),V=r.mul(y,b),Q=r.mul(m,R),at=r.mul(E,w),_t=r.add(y,m),I=r.add(b,R);_t=r.mul(_t,I),I=r.add(V,Q),_t=r.sub(_t,I),I=r.add(y,E);let k=r.add(b,w);return I=r.mul(I,k),k=r.add(V,at),I=r.sub(I,k),k=r.add(m,E),S=r.add(R,w),k=r.mul(k,S),S=r.add(Q,at),k=r.sub(k,S),N=r.mul(z,I),S=r.mul(H,at),N=r.add(S,N),S=r.sub(Q,N),N=r.add(Q,N),L=r.mul(S,N),Q=r.add(V,V),Q=r.add(Q,V),at=r.mul(z,at),I=r.mul(H,I),Q=r.add(Q,at),at=r.sub(V,at),at=r.mul(z,at),I=r.add(I,at),V=r.mul(Q,I),L=r.add(L,V),V=r.mul(k,I),S=r.mul(_t,S),S=r.sub(S,V),V=r.mul(_t,Q),N=r.mul(k,N),N=r.add(N,V),new h(S,L,N)}subtract(d){return this.add(d.negate())}is0(){return this.equals(h.ZERO)}wNAF(d){return x.wNAFCached(this,c,d,y=>{let m=r.invertBatch(y.map(E=>E.pz));return y.map((E,b)=>E.toAffine(m[b])).map(h.fromAffine)})}multiplyUnsafe(d){let y=h.ZERO;if(d===Be)return y;if(o(d),d===Wt)return this;let{endo:m}=e;if(!m)return x.unsafeLadder(this,d);let{k1neg:E,k1:b,k2neg:R,k2:w}=m.splitScalar(d),S=y,L=y,N=this;for(;b>Be||w>Be;)b&Wt&&(S=S.add(N)),w&Wt&&(L=L.add(N)),N=N.double(),b>>=Wt,w>>=Wt;return E&&(S=S.negate()),R&&(L=L.negate()),L=new h(r.mul(L.px,m.beta),L.py,L.pz),S.add(L)}multiply(d){o(d);let y=d,m,E,{endo:b}=e;if(b){let{k1neg:R,k1:w,k2neg:S,k2:L}=b.splitScalar(y),{p:N,f:z}=this.wNAF(w),{p:H,f:V}=this.wNAF(L);N=x.constTimeNegate(R,N),H=x.constTimeNegate(S,H),H=new h(r.mul(H.px,b.beta),H.py,H.pz),m=N.add(H),E=z.add(V)}else{let{p:R,f:w}=this.wNAF(y);m=R,E=w}return h.normalizeZ([m,E])[0]}multiplyAndAddUnsafe(d,y,m){let E=h.BASE,b=(w,S)=>S===Be||S===Wt||!w.equals(E)?w.multiplyUnsafe(S):w.multiply(S),R=b(this,y).add(b(d,m));return R.is0()?void 0:R}toAffine(d){let{px:y,py:m,pz:E}=this,b=this.is0();d==null&&(d=b?r.ONE:r.inv(E));let R=r.mul(y,d),w=r.mul(m,d),S=r.mul(E,d);if(b)return{x:r.ZERO,y:r.ZERO};if(!r.eql(S,r.ONE))throw new Error("invZ was invalid");return{x:R,y:w}}isTorsionFree(){let{h:d,isTorsionFree:y}=e;if(d===Wt)return!0;if(y)return y(h,this);throw new Error("isTorsionFree() has not been declared for the elliptic curve")}clearCofactor(){let{h:d,clearCofactor:y}=e;return d===Wt?this:y?y(h,this):this.multiplyUnsafe(e.h)}toRawBytes(d=!0){return this.assertValidity(),n(h,this,d)}toHex(d=!0){return me(this.toRawBytes(d))}}h.BASE=new h(e.Gx,e.Gy,r.ONE),h.ZERO=new h(r.ZERO,r.ONE,r.ZERO);let p=e.nBitLength,x=_n(h,e.endo?Math.ceil(p/2):p);return{CURVE:e,ProjectivePoint:h,normPrivateKeyToScalar:f,weierstrassEquation:a,isWithinCurveOrder:s}}function Ap(t){let e=Ur(t);return ue(e,{hash:"hash",hmac:"function",randomBytes:"function"},{bits2int:"function",bits2int_modN:"function",lowS:"boolean"}),Object.freeze({lowS:!0,...e})}function k0(t){let e=Ap(t),{Fp:r,n}=e,i=r.BYTES+1,a=2*r.BYTES+1;function s(I){return Be<I&&I<r.ORDER}function o(I){return ot(I,n)}function f(I){return In(I,n)}let{ProjectivePoint:c,normPrivateKeyToScalar:u,weierstrassEquation:h,isWithinCurveOrder:p}=Bp({...e,toBytes(I,k,_){let D=k.toAffine(),A=r.toBytes(D.x),K=be;return _?K(Uint8Array.from([k.hasEvenY()?2:3]),A):K(Uint8Array.from([4]),A,r.toBytes(D.y))},fromBytes(I){let k=I.length,_=I[0],D=I.subarray(1);if(k===i&&(_===2||_===3)){let A=ve(D);if(!s(A))throw new Error("Point is not on curve");let K=h(A),O=r.sqrt(K),F=(O&Wt)===Wt;return(_&1)===1!==F&&(O=r.neg(O)),{x:A,y:O}}else if(k===a&&_===4){let A=r.fromBytes(D.subarray(0,r.BYTES)),K=r.fromBytes(D.subarray(r.BYTES,2*r.BYTES));return{x:A,y:K}}else throw new Error(`Point of length ${k} was invalid. Expected ${i} compressed bytes or ${a} uncompressed bytes`)}}),x=I=>me(De(I,e.nByteLength));function l(I){let k=n>>Wt;return I>k}function d(I){return l(I)?o(-I):I}let y=(I,k,_)=>ve(I.slice(k,_));class m{constructor(k,_,D){this.r=k,this.s=_,this.recovery=D,this.assertValidity()}static fromCompact(k){let _=e.nByteLength;return k=vt("compactSignature",k,_*2),new m(y(k,0,_),y(k,_,2*_))}static fromDER(k){let{r:_,s:D}=je.toSig(vt("DER",k));return new m(_,D)}assertValidity(){if(!p(this.r))throw new Error("r must be 0 < r < CURVE.n");if(!p(this.s))throw new Error("s must be 0 < s < CURVE.n")}addRecoveryBit(k){return new m(this.r,this.s,k)}recoverPublicKey(k){let{r:_,s:D,recovery:A}=this,K=L(vt("msgHash",k));if(A==null||![0,1,2,3].includes(A))throw new Error("recovery id invalid");let O=A===2||A===3?_+e.n:_;if(O>=r.ORDER)throw new Error("recovery id 2 or 3 invalid");let F=A&1?"03":"02",Z=c.fromHex(F+x(O)),X=f(O),nt=o(-K*X),J=o(D*X),et=c.BASE.multiplyAndAddUnsafe(Z,nt,J);if(!et)throw new Error("point at infinify");return et.assertValidity(),et}hasHighS(){return l(this.s)}normalizeS(){return this.hasHighS()?new m(this.r,o(-this.s),this.recovery):this}toDERRawBytes(){return Ge(this.toDERHex())}toDERHex(){return je.hexFromSig({r:this.r,s:this.s})}toCompactRawBytes(){return Ge(this.toCompactHex())}toCompactHex(){return x(this.r)+x(this.s)}}let E={isValidPrivateKey(I){try{return u(I),!0}catch{return!1}},normPrivateKeyToScalar:u,randomPrivateKey:()=>{let I=Zi(e.n);return zs(e.randomBytes(I),e.n)},precompute(I=8,k=c.BASE){return k._setWindowSize(I),k.multiply(BigInt(3)),k}};function b(I,k=!0){return c.fromPrivateKey(I).toRawBytes(k)}function R(I){let k=I instanceof Uint8Array,_=typeof I=="string",D=(k||_)&&I.length;return k?D===i||D===a:_?D===2*i||D===2*a:I instanceof c}function w(I,k,_=!0){if(R(I))throw new Error("first arg must be private key");if(!R(k))throw new Error("second arg must be public key");return c.fromHex(k).multiply(u(I)).toRawBytes(_)}let S=e.bits2int||function(I){let k=ve(I),_=I.length*8-e.nBitLength;return _>0?k>>BigInt(_):k},L=e.bits2int_modN||function(I){return o(S(I))},N=Pr(e.nBitLength);function z(I){if(typeof I!="bigint")throw new Error("bigint expected");if(!(Be<=I&&I<N))throw new Error(`bigint expected < 2^${e.nBitLength}`);return De(I,e.nByteLength)}function H(I,k,_=V){if(["recovered","canonical"].some(xt=>xt in _))throw new Error("sign() legacy options not supported");let{hash:D,randomBytes:A}=e,{lowS:K,prehash:O,extraEntropy:F}=_;K==null&&(K=!0),I=vt("msgHash",I),O&&(I=vt("prehashed msgHash",D(I)));let Z=L(I),X=u(k),nt=[z(X),z(Z)];if(F!=null){let xt=F===!0?A(r.BYTES):F;nt.push(vt("extraEntropy",xt))}let J=be(...nt),et=Z;function wt(xt){let Rt=S(xt);if(!p(Rt))return;let Lt=f(Rt),Bt=c.BASE.multiply(Rt).toAffine(),Dt=o(Bt.x);if(Dt===Be)return;let le=o(Lt*o(et+Dt*X));if(le===Be)return;let Ke=(Bt.x===Dt?0:2)|Number(Bt.y&Wt),Er=le;return K&&l(le)&&(Er=d(le),Ke^=1),new m(Dt,Er,Ke)}return{seed:J,k2sig:wt}}let V={lowS:e.lowS,prehash:!1},Q={lowS:e.lowS,prehash:!1};function at(I,k,_=V){let{seed:D,k2sig:A}=H(I,k,_),K=e;return zi(K.hash.outputLen,K.nByteLength,K.hmac)(D,A)}c.BASE._setWindowSize(8);function _t(I,k,_,D=Q){let A=I;if(k=vt("msgHash",k),_=vt("publicKey",_),"strict"in D)throw new Error("options.strict was renamed to lowS");let{lowS:K,prehash:O}=D,F,Z;try{if(typeof A=="string"||A instanceof Uint8Array)try{F=m.fromDER(A)}catch(Bt){if(!(Bt instanceof je.Err))throw Bt;F=m.fromCompact(A)}else if(typeof A=="object"&&typeof A.r=="bigint"&&typeof A.s=="bigint"){let{r:Bt,s:Dt}=A;F=new m(Bt,Dt)}else throw new Error("PARSE");Z=c.fromHex(_)}catch(Bt){if(Bt.message==="PARSE")throw new Error("signature must be Signature instance, Uint8Array or hex string");return!1}if(K&&F.hasHighS())return!1;O&&(k=e.hash(k));let{r:X,s:nt}=F,J=L(k),et=f(nt),wt=o(J*et),xt=o(X*et),Rt=c.BASE.multiplyAndAddUnsafe(Z,wt,xt)?.toAffine();return Rt?o(Rt.x)===X:!1}return{CURVE:e,getPublicKey:b,getSharedSecret:w,sign:at,verify:_t,ProjectivePoint:c,Signature:m,utils:E}}var Vn=class extends ur{constructor(e,r){super(),this.finished=!1,this.destroyed=!1,Ns(e);let n=kr(r);if(this.iHash=e.create(),typeof this.iHash.update!="function")throw new Error("Expected instance of class which extends utils.Hash");this.blockLen=this.iHash.blockLen,this.outputLen=this.iHash.outputLen;let i=this.blockLen,a=new Uint8Array(i);a.set(n.length>i?e.create().update(n).digest():n);for(let s=0;s<a.length;s++)a[s]^=54;this.iHash.update(a),this.oHash=e.create();for(let s=0;s<a.length;s++)a[s]^=106;this.oHash.update(a),a.fill(0)}update(e){return cr(this),this.iHash.update(e),this}digestInto(e){cr(this),Ki(e,this.outputLen),this.finished=!0,this.iHash.digestInto(e),this.oHash.update(e),this.oHash.digestInto(e),this.destroy()}digest(){let e=new Uint8Array(this.oHash.outputLen);return this.digestInto(e),e}_cloneInto(e){e||(e=Object.create(Object.getPrototypeOf(this),{}));let{oHash:r,iHash:n,finished:i,destroyed:a,blockLen:s,outputLen:o}=this;return e=e,e.finished=i,e.destroyed=a,e.blockLen=s,e.outputLen=o,e.oHash=r._cloneInto(e.oHash),e.iHash=n._cloneInto(e.iHash),e}destroy(){this.destroyed=!0,this.oHash.destroy(),this.iHash.destroy()}},wa=(t,e,r)=>new Vn(t,e).update(r).digest();wa.create=(t,e)=>new Vn(t,e);function Cp(t){return{hash:t,hmac:(e,...r)=>wa(t,e,En(...r)),randomBytes:hr}}function P0(t,e){let r=n=>k0({...t,...Cp(n)});return Object.freeze({...r(e),create:r})}var O0=BigInt("0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffefffffc2f"),U0=BigInt("0xfffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd0364141"),Ip=BigInt(1),Sa=BigInt(2),K0=(t,e)=>(t+e/Sa)/e;function Tp(t){let e=O0,r=BigInt(3),n=BigInt(6),i=BigInt(11),a=BigInt(22),s=BigInt(23),o=BigInt(44),f=BigInt(88),c=t*t*t%e,u=c*c*t%e,h=dt(u,r,e)*u%e,p=dt(h,r,e)*u%e,x=dt(p,Sa,e)*c%e,l=dt(x,i,e)*x%e,d=dt(l,a,e)*l%e,y=dt(d,o,e)*d%e,m=dt(y,f,e)*y%e,E=dt(m,o,e)*d%e,b=dt(E,r,e)*u%e,R=dt(b,s,e)*l%e,w=dt(R,n,e)*c%e,S=dt(w,Sa,e);if(!Ba.eql(Ba.sqr(S),t))throw new Error("Cannot find square root");return S}var Ba=Tn(O0,void 0,void 0,{sqrt:Tp}),re=P0({a:BigInt(0),b:BigInt(7),Fp:Ba,n:U0,Gx:BigInt("55066263022277343669578718895168534326250603453777594175500187360389116729240"),Gy:BigInt("32670510020758816978083085130507043184471273380659243275938904335757337482424"),h:BigInt(1),lowS:!0,endo:{beta:BigInt("0x7ae96a2b657c07106e64479eac3434e99cf0497512f58995c1396c28719501ee"),splitScalar:t=>{let e=U0,r=BigInt("0x3086d221a7d46bcde86c90e49284eb15"),n=-Ip*BigInt("0xe4437ed6010e88286f547fa90abfe4c3"),i=BigInt("0x114ca50f7a8e2f3f657c1108d9d44cfd8"),a=r,s=BigInt("0x100000000000000000000000000000000"),o=K0(a*t,e),f=K0(-n*t,e),c=ot(t-o*r-f*i,e),u=ot(-o*n-f*a,e),h=c>s,p=u>s;if(h&&(c=e-c),p&&(u=e-u),c>s||u>s)throw new Error("splitScalar: Endomorphism failed, k="+t);return{k1neg:h,k1:c,k2neg:p,k2:u}}}},N0),Zx=BigInt(0);var $x=re.ProjectivePoint;function M0(){return re.utils.randomPrivateKey()}function V0(t,e){let r=Mt.digest(e instanceof Uint8Array?e:e.subarray());if(Gt(r))return r.then(({digest:n})=>re.sign(n,t).toDERRawBytes()).catch(n=>{throw new q(String(n),"ERR_INVALID_INPUT")});try{return re.sign(r.digest,t).toDERRawBytes()}catch(n){throw new q(String(n),"ERR_INVALID_INPUT")}}function q0(t,e,r){let n=Mt.digest(r instanceof Uint8Array?r:r.subarray());if(Gt(n))return n.then(({digest:i})=>re.verify(e,i,t)).catch(i=>{throw new q(String(i),"ERR_INVALID_INPUT")});try{return re.verify(e,n.digest,t)}catch(i){throw new q(String(i),"ERR_INVALID_INPUT")}}function F0(t){return re.ProjectivePoint.fromHex(t).toRawBytes(!0)}function H0(t){try{re.getPublicKey(t,!0)}catch(e){throw new q(String(e),"ERR_INVALID_PRIVATE_KEY")}}function Aa(t){try{re.ProjectivePoint.fromHex(t)}catch(e){throw new q(String(e),"ERR_INVALID_PUBLIC_KEY")}}function z0(t){try{return re.getPublicKey(t,!0)}catch(e){throw new q(String(e),"ERR_INVALID_PRIVATE_KEY")}}var Gr=class{_key;constructor(e){Aa(e),this._key=e}verify(e,r){return q0(this._key,r,e)}marshal(){return F0(this._key)}get bytes(){return te.encode({Type:ut.Secp256k1,Data:this.marshal()}).subarray()}equals(e){return $t(this.bytes,e.bytes)}async hash(){let e=Mt.digest(this.bytes),r;return Gt(e)?{bytes:r}=await e:r=e.bytes,r}},Wr=class{_key;_publicKey;constructor(e,r){this._key=e,this._publicKey=r??z0(e),H0(this._key),Aa(this._publicKey)}sign(e){return V0(this._key,e)}get public(){return new Gr(this._publicKey)}marshal(){return this._key}get bytes(){return ee.encode({Type:ut.Secp256k1,Data:this.marshal()}).subarray()}equals(e){return $t(this.bytes,e.bytes)}hash(){let e=Mt.digest(this.bytes);return Gt(e)?e.then(({bytes:r})=>r):e.bytes}async id(){let e=await this.public.hash();return yt(e,"base58btc")}async export(e,r="libp2p-key"){if(r==="libp2p-key")return yr(this.bytes,e);throw new q(`export format '${r}' is not supported`,"ERR_INVALID_EXPORT_FORMAT")}};function Rp(t){return new Wr(t)}function Lp(t){return new Gr(t)}async function Np(){let t=M0();return new Wr(t)}var he={rsa:ba,ed25519:da,secp256k1:Ca};function Ia(t){let e=Object.keys(he).join(" / ");return new q(`invalid or unsupported key type ${t}. Must be ${e}`,"ERR_UNSUPPORTED_KEY_TYPE")}function Ta(t){if(t=t.toLowerCase(),t==="rsa"||t==="ed25519"||t==="secp256k1")return he[t];throw Ia(t)}async function Dp(t,e){return Ta(t).generateKeyPair(e??2048)}async function kp(t,e,r){if(t.toLowerCase()!=="ed25519")throw new q("Seed key derivation is unimplemented for RSA or secp256k1","ERR_UNSUPPORTED_KEY_DERIVATION_TYPE");return pa(e)}function Pp(t){let e=te.decode(t),r=e.Data??new Uint8Array;switch(e.Type){case ut.RSA:return he.rsa.unmarshalRsaPublicKey(r);case ut.Ed25519:return he.ed25519.unmarshalEd25519PublicKey(r);case ut.Secp256k1:return he.secp256k1.unmarshalSecp256k1PublicKey(r);default:throw Ia(e.Type??"unknown")}}function Up(t,e){return e=(e??"rsa").toLowerCase(),Ta(e),t.bytes}async function G0(t){let e=ee.decode(t),r=e.Data??new Uint8Array;switch(e.Type){case ut.RSA:return he.rsa.unmarshalRsaPrivateKey(r);case ut.Ed25519:return he.ed25519.unmarshalEd25519PrivateKey(r);case ut.Secp256k1:return he.secp256k1.unmarshalSecp256k1PrivateKey(r);default:throw Ia(e.Type??"RSA")}}function Kp(t,e){return e=(e??"rsa").toLowerCase(),Ta(e),t.bytes}async function Op(t,e){try{let i=await d0(t,e);return await G0(i)}catch{}let r=qn.default.pki.decryptRsaPrivateKey(t,e);if(r===null)throw new q("Cannot read the key, most likely the password is wrong or not a RSA key","ERR_CANNOT_DECRYPT_PEM");let n=qn.default.asn1.toDer(qn.default.pki.privateKeyToAsn1(r));return n=St(n.getBytes(),"ascii"),he.rsa.unmarshalRsaPrivateKey(n)}var Y0=Nt(Ii(),1),Z0=Nt(bt(),1),W0={sha1:"sha1","sha2-256":"sha256","sha2-512":"sha512"};function Ra(t,e,r,n,i){if(i!=="sha1"&&i!=="sha2-256"&&i!=="sha2-512"){let o=Object.keys(W0).join(" / ");throw new q(`Hash '${i}' is unknown or not supported. Must be ${o}`,"ERR_UNSUPPORTED_HASH_TYPE")}let a=W0[i],s=(0,Y0.default)(t,e,r,n,a);return Z0.default.encode64(s,null)}return cf(Mp);})();
/*! Bundled license information:

@noble/hashes/esm/utils.js:
  (*! noble-hashes - MIT License (c) 2022 Paul Miller (paulmillr.com) *)

@noble/curves/esm/abstract/utils.js:
  (*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) *)

@noble/curves/esm/abstract/modular.js:
  (*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) *)

@noble/curves/esm/abstract/curve.js:
  (*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) *)

@noble/curves/esm/abstract/edwards.js:
  (*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) *)

@noble/curves/esm/ed25519.js:
  (*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) *)

@noble/curves/esm/abstract/weierstrass.js:
  (*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) *)

@noble/curves/esm/_shortw_utils.js:
  (*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) *)

@noble/curves/esm/secp256k1.js:
  (*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) *)
*/
return Libp2PCrypto}));
