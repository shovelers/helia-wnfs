(function (root, factory) {(typeof module === 'object' && module.exports) ? module.exports = factory() : root.IpldDagJson = factory()}(typeof self !== 'undefined' ? self : this, function () {
"use strict";var IpldDagJson=(()=>{var Be=Object.defineProperty;var gr=Object.getOwnPropertyDescriptor;var wr=Object.getOwnPropertyNames;var br=Object.prototype.hasOwnProperty;var kr=(e,t)=>{for(var r in t)Be(e,r,{get:t[r],enumerable:!0})},Er=(e,t,r,n)=>{if(t&&typeof t=="object"||typeof t=="function")for(let o of wr(t))!br.call(e,o)&&o!==r&&Be(e,o,{get:()=>t[o],enumerable:!(n=gr(t,o))||n.enumerable});return e};var _r=e=>Er(Be({},"__esModule",{value:!0}),e);var jn={};kr(jn,{code:()=>Dn,decode:()=>xr,encode:()=>mr,format:()=>zn,name:()=>Mn,parse:()=>On,stringify:()=>zn});var vr=["string","number","bigint","symbol"],Ar=["Function","Generator","AsyncGenerator","GeneratorFunction","AsyncGeneratorFunction","AsyncFunction","Observable","Array","Buffer","Object","RegExp","Date","Error","Map","Set","WeakMap","WeakSet","ArrayBuffer","SharedArrayBuffer","DataView","Promise","URL","HTMLElement","Int8Array","Uint8Array","Uint8ClampedArray","Int16Array","Uint16Array","Int32Array","Uint32Array","Float32Array","Float64Array","BigInt64Array","BigUint64Array"];function tt(e){if(e===null)return"null";if(e===void 0)return"undefined";if(e===!0||e===!1)return"boolean";let t=typeof e;if(vr.includes(t))return t;if(t==="function")return"Function";if(Array.isArray(e))return"Array";if(Ur(e))return"Buffer";let r=Sr(e);return r||"Object"}function Ur(e){return e&&e.constructor&&e.constructor.isBuffer&&e.constructor.isBuffer.call(null,e)}function Sr(e){let t=Object.prototype.toString.call(e).slice(8,-1);if(Ar.includes(t))return t}var i=class{constructor(t,r,n){this.major=t,this.majorEncoded=t<<5,this.name=r,this.terminal=n}toString(){return`Type[${this.major}].${this.name}`}compare(t){return this.major<t.major?-1:this.major>t.major?1:0}};i.uint=new i(0,"uint",!0);i.negint=new i(1,"negint",!0);i.bytes=new i(2,"bytes",!0);i.string=new i(3,"string",!0);i.array=new i(4,"array",!1);i.map=new i(5,"map",!1);i.tag=new i(6,"tag",!1);i.float=new i(7,"float",!0);i.false=new i(7,"false",!0);i.true=new i(7,"true",!0);i.null=new i(7,"null",!0);i.undefined=new i(7,"undefined",!0);i.break=new i(7,"break",!0);var c=class{constructor(t,r,n){this.type=t,this.value=r,this.encodedLength=n,this.encodedBytes=void 0,this.byteValue=void 0}toString(){return`Token[${this.type}].${this.value}`}};var G=globalThis.process&&!globalThis.process.browser&&globalThis.Buffer&&typeof globalThis.Buffer.isBuffer=="function",Tr=new TextDecoder,Br=new TextEncoder;function xe(e){return G&&globalThis.Buffer.isBuffer(e)}function ne(e){return e instanceof Uint8Array?xe(e)?new Uint8Array(e.buffer,e.byteOffset,e.byteLength):e:Uint8Array.from(e)}var it=G?(e,t,r)=>r-t>64?globalThis.Buffer.from(e.subarray(t,r)).toString("utf8"):nt(e,t,r):(e,t,r)=>r-t>64?Tr.decode(e.subarray(t,r)):nt(e,t,r),ye=G?e=>e.length>64?globalThis.Buffer.from(e):rt(e):e=>e.length>64?Br.encode(e):rt(e);var J=G?(e,t,r)=>xe(e)?new Uint8Array(e.subarray(t,r)):e.slice(t,r):(e,t,r)=>e.slice(t,r),st=G?(e,t)=>(e=e.map(r=>r instanceof Uint8Array?r:globalThis.Buffer.from(r)),ne(globalThis.Buffer.concat(e,t))):(e,t)=>{let r=new Uint8Array(t),n=0;for(let o of e)n+o.length>r.length&&(o=o.subarray(0,r.length-n)),r.set(o,n),n+=o.length;return r},at=G?e=>globalThis.Buffer.allocUnsafe(e):e=>new Uint8Array(e);function ct(e,t){if(xe(e)&&xe(t))return e.compare(t);for(let r=0;r<e.length;r++)if(e[r]!==t[r])return e[r]<t[r]?-1:1;return 0}function rt(e){let t=[],r=0;for(let n=0;n<e.length;n++){let o=e.charCodeAt(n);o<128?t[r++]=o:o<2048?(t[r++]=o>>6|192,t[r++]=o&63|128):(o&64512)===55296&&n+1<e.length&&(e.charCodeAt(n+1)&64512)===56320?(o=65536+((o&1023)<<10)+(e.charCodeAt(++n)&1023),t[r++]=o>>18|240,t[r++]=o>>12&63|128,t[r++]=o>>6&63|128,t[r++]=o&63|128):(t[r++]=o>>12|224,t[r++]=o>>6&63|128,t[r++]=o&63|128)}return t}function nt(e,t,r){let n=[];for(;t<r;){let o=e[t],s=null,a=o>239?4:o>223?3:o>191?2:1;if(t+a<=r){let u,h,x,l;switch(a){case 1:o<128&&(s=o);break;case 2:u=e[t+1],(u&192)===128&&(l=(o&31)<<6|u&63,l>127&&(s=l));break;case 3:u=e[t+1],h=e[t+2],(u&192)===128&&(h&192)===128&&(l=(o&15)<<12|(u&63)<<6|h&63,l>2047&&(l<55296||l>57343)&&(s=l));break;case 4:u=e[t+1],h=e[t+2],x=e[t+3],(u&192)===128&&(h&192)===128&&(x&192)===128&&(l=(o&15)<<18|(u&63)<<12|(h&63)<<6|x&63,l>65535&&l<1114112&&(s=l))}}s===null?(s=65533,a=1):s>65535&&(s-=65536,n.push(s>>>10&1023|55296),s=56320|s&1023),n.push(s),t+=a}return $e(n)}var ot=4096;function $e(e){let t=e.length;if(t<=ot)return String.fromCharCode.apply(String,e);let r="",n=0;for(;n<t;)r+=String.fromCharCode.apply(String,e.slice(n,n+=ot));return r}var $r=256,oe=class{constructor(t=$r){this.chunkSize=t,this.cursor=0,this.maxCursor=-1,this.chunks=[],this._initReuseChunk=null}reset(){this.cursor=0,this.maxCursor=-1,this.chunks.length&&(this.chunks=[]),this._initReuseChunk!==null&&(this.chunks.push(this._initReuseChunk),this.maxCursor=this._initReuseChunk.length-1)}push(t){let r=this.chunks[this.chunks.length-1];if(this.cursor+t.length<=this.maxCursor+1){let o=r.length-(this.maxCursor-this.cursor)-1;r.set(t,o)}else{if(r){let o=r.length-(this.maxCursor-this.cursor)-1;o<r.length&&(this.chunks[this.chunks.length-1]=r.subarray(0,o),this.maxCursor=this.cursor-1)}t.length<64&&t.length<this.chunkSize?(r=at(this.chunkSize),this.chunks.push(r),this.maxCursor+=r.length,this._initReuseChunk===null&&(this._initReuseChunk=r),r.set(t,0)):(this.chunks.push(t),this.maxCursor+=t.length)}this.cursor+=t.length}toBytes(t=!1){let r;if(this.chunks.length===1){let n=this.chunks[0];t&&this.cursor>n.length/2?(r=this.cursor===n.length?n:n.subarray(0,this.cursor),this._initReuseChunk=null,this.chunks=[]):r=J(n,0,this.cursor)}else r=st(this.chunks,this.cursor);return t&&this.reset(),r}};var d="CBOR decode error:",O="CBOR encode error:",ie=[];ie[23]=1;ie[24]=2;ie[25]=3;ie[26]=5;ie[27]=9;function V(e,t,r){if(e.length-t<r)throw new Error(`${d} not enough data for type`)}var g=[24,256,65536,4294967296,BigInt("18446744073709551616")];function E(e,t,r){V(e,t,1);let n=e[t];if(r.strict===!0&&n<g[0])throw new Error(`${d} integer encoded in more bytes than necessary (strict decode)`);return n}function _(e,t,r){V(e,t,2);let n=e[t]<<8|e[t+1];if(r.strict===!0&&n<g[1])throw new Error(`${d} integer encoded in more bytes than necessary (strict decode)`);return n}function v(e,t,r){V(e,t,4);let n=e[t]*16777216+(e[t+1]<<16)+(e[t+2]<<8)+e[t+3];if(r.strict===!0&&n<g[2])throw new Error(`${d} integer encoded in more bytes than necessary (strict decode)`);return n}function A(e,t,r){V(e,t,8);let n=e[t]*16777216+(e[t+1]<<16)+(e[t+2]<<8)+e[t+3],o=e[t+4]*16777216+(e[t+5]<<16)+(e[t+6]<<8)+e[t+7],s=(BigInt(n)<<BigInt(32))+BigInt(o);if(r.strict===!0&&s<g[3])throw new Error(`${d} integer encoded in more bytes than necessary (strict decode)`);if(s<=Number.MAX_SAFE_INTEGER)return Number(s);if(r.allowBigInt===!0)return s;throw new Error(`${d} integers outside of the safe integer range are not supported`)}function ut(e,t,r,n){return new c(i.uint,E(e,t+1,n),2)}function ft(e,t,r,n){return new c(i.uint,_(e,t+1,n),3)}function dt(e,t,r,n){return new c(i.uint,v(e,t+1,n),5)}function ht(e,t,r,n){return new c(i.uint,A(e,t+1,n),9)}function S(e,t){return w(e,0,t.value)}function w(e,t,r){if(r<g[0]){let n=Number(r);e.push([t|n])}else if(r<g[1]){let n=Number(r);e.push([t|24,n])}else if(r<g[2]){let n=Number(r);e.push([t|25,n>>>8,n&255])}else if(r<g[3]){let n=Number(r);e.push([t|26,n>>>24&255,n>>>16&255,n>>>8&255,n&255])}else{let n=BigInt(r);if(n<g[4]){let o=[t|27,0,0,0,0,0,0,0],s=Number(n&BigInt(4294967295)),a=Number(n>>BigInt(32)&BigInt(4294967295));o[8]=s&255,s=s>>8,o[7]=s&255,s=s>>8,o[6]=s&255,s=s>>8,o[5]=s&255,o[4]=a&255,a=a>>8,o[3]=a&255,a=a>>8,o[2]=a&255,a=a>>8,o[1]=a&255,e.push(o)}else throw new Error(`${d} encountered BigInt larger than allowable range`)}}S.encodedSize=function(t){return w.encodedSize(t.value)};w.encodedSize=function(t){return t<g[0]?1:t<g[1]?2:t<g[2]?3:t<g[3]?5:9};S.compareTokens=function(t,r){return t.value<r.value?-1:t.value>r.value?1:0};function pt(e,t,r,n){return new c(i.negint,-1-E(e,t+1,n),2)}function lt(e,t,r,n){return new c(i.negint,-1-_(e,t+1,n),3)}function mt(e,t,r,n){return new c(i.negint,-1-v(e,t+1,n),5)}var Ce=BigInt(-1),xt=BigInt(1);function yt(e,t,r,n){let o=A(e,t+1,n);if(typeof o!="bigint"){let s=-1-o;if(s>=Number.MIN_SAFE_INTEGER)return new c(i.negint,s,9)}if(n.allowBigInt!==!0)throw new Error(`${d} integers outside of the safe integer range are not supported`);return new c(i.negint,Ce-BigInt(o),9)}function ge(e,t){let r=t.value,n=typeof r=="bigint"?r*Ce-xt:r*-1-1;w(e,t.type.majorEncoded,n)}ge.encodedSize=function(t){let r=t.value,n=typeof r=="bigint"?r*Ce-xt:r*-1-1;return n<g[0]?1:n<g[1]?2:n<g[2]?3:n<g[3]?5:9};ge.compareTokens=function(t,r){return t.value<r.value?1:t.value>r.value?-1:0};function se(e,t,r,n){V(e,t,r+n);let o=J(e,t+r,t+r+n);return new c(i.bytes,o,r+n)}function gt(e,t,r,n){return se(e,t,1,r)}function wt(e,t,r,n){return se(e,t,2,E(e,t+1,n))}function bt(e,t,r,n){return se(e,t,3,_(e,t+1,n))}function kt(e,t,r,n){return se(e,t,5,v(e,t+1,n))}function Et(e,t,r,n){let o=A(e,t+1,n);if(typeof o=="bigint")throw new Error(`${d} 64-bit integer bytes lengths not supported`);return se(e,t,9,o)}function we(e){return e.encodedBytes===void 0&&(e.encodedBytes=e.type===i.string?ye(e.value):e.value),e.encodedBytes}function K(e,t){let r=we(t);w(e,t.type.majorEncoded,r.length),e.push(r)}K.encodedSize=function(t){let r=we(t);return w.encodedSize(r.length)+r.length};K.compareTokens=function(t,r){return Ir(we(t),we(r))};function Ir(e,t){return e.length<t.length?-1:e.length>t.length?1:ct(e,t)}function ae(e,t,r,n,o){let s=r+n;V(e,t,s);let a=new c(i.string,it(e,t+r,t+s),s);return o.retainStringBytes===!0&&(a.byteValue=J(e,t+r,t+s)),a}function _t(e,t,r,n){return ae(e,t,1,r,n)}function vt(e,t,r,n){return ae(e,t,2,E(e,t+1,n),n)}function At(e,t,r,n){return ae(e,t,3,_(e,t+1,n),n)}function Ut(e,t,r,n){return ae(e,t,5,v(e,t+1,n),n)}function St(e,t,r,n){let o=A(e,t+1,n);if(typeof o=="bigint")throw new Error(`${d} 64-bit integer string lengths not supported`);return ae(e,t,9,o,n)}var Tt=K;function X(e,t,r,n){return new c(i.array,n,r)}function Bt(e,t,r,n){return X(e,t,1,r)}function $t(e,t,r,n){return X(e,t,2,E(e,t+1,n))}function Ct(e,t,r,n){return X(e,t,3,_(e,t+1,n))}function It(e,t,r,n){return X(e,t,5,v(e,t+1,n))}function Nt(e,t,r,n){let o=A(e,t+1,n);if(typeof o=="bigint")throw new Error(`${d} 64-bit integer array lengths not supported`);return X(e,t,9,o)}function Mt(e,t,r,n){if(n.allowIndefinite===!1)throw new Error(`${d} indefinite length items not allowed`);return X(e,t,1,1/0)}function be(e,t){w(e,i.array.majorEncoded,t.value)}be.compareTokens=S.compareTokens;be.encodedSize=function(t){return w.encodedSize(t.value)};function Q(e,t,r,n){return new c(i.map,n,r)}function Dt(e,t,r,n){return Q(e,t,1,r)}function zt(e,t,r,n){return Q(e,t,2,E(e,t+1,n))}function Ft(e,t,r,n){return Q(e,t,3,_(e,t+1,n))}function Ot(e,t,r,n){return Q(e,t,5,v(e,t+1,n))}function Vt(e,t,r,n){let o=A(e,t+1,n);if(typeof o=="bigint")throw new Error(`${d} 64-bit integer map lengths not supported`);return Q(e,t,9,o)}function jt(e,t,r,n){if(n.allowIndefinite===!1)throw new Error(`${d} indefinite length items not allowed`);return Q(e,t,1,1/0)}function ke(e,t){w(e,i.map.majorEncoded,t.value)}ke.compareTokens=S.compareTokens;ke.encodedSize=function(t){return w.encodedSize(t.value)};function Pt(e,t,r,n){return new c(i.tag,r,1)}function Rt(e,t,r,n){return new c(i.tag,E(e,t+1,n),2)}function Lt(e,t,r,n){return new c(i.tag,_(e,t+1,n),3)}function qt(e,t,r,n){return new c(i.tag,v(e,t+1,n),5)}function Wt(e,t,r,n){return new c(i.tag,A(e,t+1,n),9)}function Ee(e,t){w(e,i.tag.majorEncoded,t.value)}Ee.compareTokens=S.compareTokens;Ee.encodedSize=function(t){return w.encodedSize(t.value)};var Or=20,Vr=21,jr=22,Pr=23;function Gt(e,t,r,n){if(n.allowUndefined===!1)throw new Error(`${d} undefined values are not supported`);return n.coerceUndefinedToNull===!0?new c(i.null,null,1):new c(i.undefined,void 0,1)}function Jt(e,t,r,n){if(n.allowIndefinite===!1)throw new Error(`${d} indefinite length items not allowed`);return new c(i.break,void 0,1)}function Ie(e,t,r){if(r){if(r.allowNaN===!1&&Number.isNaN(e))throw new Error(`${d} NaN values are not supported`);if(r.allowInfinity===!1&&(e===1/0||e===-1/0))throw new Error(`${d} Infinity values are not supported`)}return new c(i.float,e,t)}function Kt(e,t,r,n){return Ie(Ne(e,t+1),3,n)}function Xt(e,t,r,n){return Ie(Me(e,t+1),5,n)}function Qt(e,t,r,n){return Ie(er(e,t+1),9,n)}function _e(e,t,r){let n=t.value;if(n===!1)e.push([i.float.majorEncoded|Or]);else if(n===!0)e.push([i.float.majorEncoded|Vr]);else if(n===null)e.push([i.float.majorEncoded|jr]);else if(n===void 0)e.push([i.float.majorEncoded|Pr]);else{let o,s=!1;(!r||r.float64!==!0)&&(Zt(n),o=Ne(C,1),n===o||Number.isNaN(n)?(C[0]=249,e.push(C.slice(0,3)),s=!0):(Yt(n),o=Me(C,1),n===o&&(C[0]=250,e.push(C.slice(0,5)),s=!0))),s||(Rr(n),o=er(C,1),C[0]=251,e.push(C.slice(0,9)))}}_e.encodedSize=function(t,r){let n=t.value;if(n===!1||n===!0||n===null||n===void 0)return 1;if(!r||r.float64!==!0){Zt(n);let o=Ne(C,1);if(n===o||Number.isNaN(n))return 3;if(Yt(n),o=Me(C,1),n===o)return 5}return 9};var Ht=new ArrayBuffer(9),T=new DataView(Ht,1),C=new Uint8Array(Ht,0);function Zt(e){if(e===1/0)T.setUint16(0,31744,!1);else if(e===-1/0)T.setUint16(0,64512,!1);else if(Number.isNaN(e))T.setUint16(0,32256,!1);else{T.setFloat32(0,e);let t=T.getUint32(0),r=(t&2139095040)>>23,n=t&8388607;if(r===255)T.setUint16(0,31744,!1);else if(r===0)T.setUint16(0,(e&2147483648)>>16|n>>13,!1);else{let o=r-127;o<-24?T.setUint16(0,0):o<-14?T.setUint16(0,(t&2147483648)>>16|1<<24+o,!1):T.setUint16(0,(t&2147483648)>>16|o+15<<10|n>>13,!1)}}}function Ne(e,t){if(e.length-t<2)throw new Error(`${d} not enough data for float16`);let r=(e[t]<<8)+e[t+1];if(r===31744)return 1/0;if(r===64512)return-1/0;if(r===32256)return NaN;let n=r>>10&31,o=r&1023,s;return n===0?s=o*2**-24:n!==31?s=(o+1024)*2**(n-25):s=o===0?1/0:NaN,r&32768?-s:s}function Yt(e){T.setFloat32(0,e,!1)}function Me(e,t){if(e.length-t<4)throw new Error(`${d} not enough data for float32`);let r=(e.byteOffset||0)+t;return new DataView(e.buffer,r,4).getFloat32(0,!1)}function Rr(e){T.setFloat64(0,e,!1)}function er(e,t){if(e.length-t<8)throw new Error(`${d} not enough data for float64`);let r=(e.byteOffset||0)+t;return new DataView(e.buffer,r,8).getFloat64(0,!1)}_e.compareTokens=S.compareTokens;function p(e,t,r){throw new Error(`${d} encountered invalid minor (${r}) for major ${e[t]>>>5}`)}function ve(e){return()=>{throw new Error(`${d} ${e}`)}}var f=[];for(let e=0;e<=23;e++)f[e]=p;f[24]=ut;f[25]=ft;f[26]=dt;f[27]=ht;f[28]=p;f[29]=p;f[30]=p;f[31]=p;for(let e=32;e<=55;e++)f[e]=p;f[56]=pt;f[57]=lt;f[58]=mt;f[59]=yt;f[60]=p;f[61]=p;f[62]=p;f[63]=p;for(let e=64;e<=87;e++)f[e]=gt;f[88]=wt;f[89]=bt;f[90]=kt;f[91]=Et;f[92]=p;f[93]=p;f[94]=p;f[95]=ve("indefinite length bytes/strings are not supported");for(let e=96;e<=119;e++)f[e]=_t;f[120]=vt;f[121]=At;f[122]=Ut;f[123]=St;f[124]=p;f[125]=p;f[126]=p;f[127]=ve("indefinite length bytes/strings are not supported");for(let e=128;e<=151;e++)f[e]=Bt;f[152]=$t;f[153]=Ct;f[154]=It;f[155]=Nt;f[156]=p;f[157]=p;f[158]=p;f[159]=Mt;for(let e=160;e<=183;e++)f[e]=Dt;f[184]=zt;f[185]=Ft;f[186]=Ot;f[187]=Vt;f[188]=p;f[189]=p;f[190]=p;f[191]=jt;for(let e=192;e<=215;e++)f[e]=Pt;f[216]=Rt;f[217]=Lt;f[218]=qt;f[219]=Wt;f[220]=p;f[221]=p;f[222]=p;f[223]=p;for(let e=224;e<=243;e++)f[e]=ve("simple values are not supported");f[244]=p;f[245]=p;f[246]=p;f[247]=Gt;f[248]=ve("simple values are not supported");f[249]=Kt;f[250]=Xt;f[251]=Qt;f[252]=p;f[253]=p;f[254]=p;f[255]=Jt;var I=[];for(let e=0;e<24;e++)I[e]=new c(i.uint,e,1);for(let e=-1;e>=-24;e--)I[31-e]=new c(i.negint,e,1);I[64]=new c(i.bytes,new Uint8Array(0),1);I[96]=new c(i.string,"",1);I[128]=new c(i.array,0,1);I[160]=new c(i.map,0,1);I[244]=new c(i.false,!1,1);I[245]=new c(i.true,!0,1);I[246]=new c(i.null,null,1);function qr(){let e=[];return e[i.uint.major]=S,e[i.negint.major]=ge,e[i.bytes.major]=K,e[i.string.major]=Tt,e[i.array.major]=be,e[i.map.major]=ke,e[i.tag.major]=Ee,e[i.float.major]=_e,e}var Mo=qr(),De=new oe,Ue=class e{constructor(t,r){this.obj=t,this.parent=r}includes(t){let r=this;do if(r.obj===t)return!0;while(r=r.parent);return!1}static createCheck(t,r){if(t&&t.includes(r))throw new Error(`${O} object contains circular references`);return new e(r,t)}},R={null:new c(i.null,null),undefined:new c(i.undefined,void 0),true:new c(i.true,!0),false:new c(i.false,!1),emptyArray:new c(i.array,0),emptyMap:new c(i.map,0)},L={number(e,t,r,n){return!Number.isInteger(e)||!Number.isSafeInteger(e)?new c(i.float,e):e>=0?new c(i.uint,e):new c(i.negint,e)},bigint(e,t,r,n){return e>=BigInt(0)?new c(i.uint,e):new c(i.negint,e)},Uint8Array(e,t,r,n){return new c(i.bytes,e)},string(e,t,r,n){return new c(i.string,e)},boolean(e,t,r,n){return e?R.true:R.false},null(e,t,r,n){return R.null},undefined(e,t,r,n){return R.undefined},ArrayBuffer(e,t,r,n){return new c(i.bytes,new Uint8Array(e))},DataView(e,t,r,n){return new c(i.bytes,new Uint8Array(e.buffer,e.byteOffset,e.byteLength))},Array(e,t,r,n){if(!e.length)return r.addBreakTokens===!0?[R.emptyArray,new c(i.break)]:R.emptyArray;n=Ue.createCheck(n,e);let o=[],s=0;for(let a of e)o[s++]=Ae(a,r,n);return r.addBreakTokens?[new c(i.array,e.length),o,new c(i.break)]:[new c(i.array,e.length),o]},Object(e,t,r,n){let o=t!=="Object",s=o?e.keys():Object.keys(e),a=o?e.size:s.length;if(!a)return r.addBreakTokens===!0?[R.emptyMap,new c(i.break)]:R.emptyMap;n=Ue.createCheck(n,e);let u=[],h=0;for(let x of s)u[h++]=[Ae(x,r,n),Ae(o?e.get(x):e[x],r,n)];return Wr(u,r),r.addBreakTokens?[new c(i.map,a),u,new c(i.break)]:[new c(i.map,a),u]}};L.Map=L.Object;L.Buffer=L.Uint8Array;for(let e of"Uint8Clamped Uint16 Uint32 Int8 Int16 Int32 BigUint64 BigInt64 Float32 Float64".split(" "))L[`${e}Array`]=L.DataView;function Ae(e,t={},r){let n=tt(e),o=t&&t.typeEncoders&&t.typeEncoders[n]||L[n];if(typeof o=="function"){let a=o(e,n,t,r);if(a!=null)return a}let s=L[n];if(!s)throw new Error(`${O} unsupported type: ${n}`);return s(e,n,t,r)}function Wr(e,t){t.mapSorter&&e.sort(t.mapSorter)}function tr(e,t,r,n){if(Array.isArray(t))for(let o of t)tr(e,o,r,n);else r[t.type.major](e,t,n)}function rr(e,t,r){let n=Ae(e,r);if(!Array.isArray(n)&&r.quickEncodeToken){let o=r.quickEncodeToken(n);if(o)return o;let s=t[n.type.major];if(s.encodedSize){let a=s.encodedSize(n,r),u=new oe(a);if(s(u,n,r),u.chunks.length!==1)throw new Error(`Unexpected error: pre-calculated length for ${n} was wrong`);return ne(u.chunks[0])}}return De.reset(),tr(De,n,t,r),De.toBytes(!0)}var Gr={strict:!1,allowIndefinite:!0,allowUndefined:!0,allowBigInt:!0},ze=class{constructor(t,r={}){this._pos=0,this.data=t,this.options=r}pos(){return this._pos}done(){return this._pos>=this.data.length}next(){let t=this.data[this._pos],r=I[t];if(r===void 0){let n=f[t];if(!n)throw new Error(`${d} no decoder for major type ${t>>>5} (byte 0x${t.toString(16).padStart(2,"0")})`);let o=t&31;r=n(this.data,this._pos,o,this.options)}return this._pos+=r.encodedLength,r}},ce=Symbol.for("DONE"),Se=Symbol.for("BREAK");function Jr(e,t,r){let n=[];for(let o=0;o<e.value;o++){let s=ue(t,r);if(s===Se){if(e.value===1/0)break;throw new Error(`${d} got unexpected break to lengthed array`)}if(s===ce)throw new Error(`${d} found array but not enough entries (got ${o}, expected ${e.value})`);n[o]=s}return n}function Kr(e,t,r){let n=r.useMaps===!0,o=n?void 0:{},s=n?new Map:void 0;for(let a=0;a<e.value;a++){let u=ue(t,r);if(u===Se){if(e.value===1/0)break;throw new Error(`${d} got unexpected break to lengthed map`)}if(u===ce)throw new Error(`${d} found map but not enough entries (got ${a} [no key], expected ${e.value})`);if(n!==!0&&typeof u!="string")throw new Error(`${d} non-string keys not supported (got ${typeof u})`);if(r.rejectDuplicateMapKeys===!0&&(n&&s.has(u)||!n&&u in o))throw new Error(`${d} found repeat map key "${u}"`);let h=ue(t,r);if(h===ce)throw new Error(`${d} found map but not enough entries (got ${a} [no value], expected ${e.value})`);n?s.set(u,h):o[u]=h}return n?s:o}function ue(e,t){if(e.done())return ce;let r=e.next();if(r.type===i.break)return Se;if(r.type.terminal)return r.value;if(r.type===i.array)return Jr(r,e,t);if(r.type===i.map)return Kr(r,e,t);if(r.type===i.tag){if(t.tags&&typeof t.tags[r.value]=="function"){let n=ue(e,t);return t.tags[r.value](n)}throw new Error(`${d} tag not supported (${r.value})`)}throw new Error("unsupported")}function Fe(e,t){if(!(e instanceof Uint8Array))throw new Error(`${d} data to decode must be a Uint8Array`);t=Object.assign({},Gr,t);let r=t.tokenizer||new ze(e,t),n=ue(r,t);if(n===ce)throw new Error(`${d} did not find any content to decode`);if(n===Se)throw new Error(`${d} got unexpected break`);return[n,e.subarray(r.pos())]}function Oe(e,t){let[r,n]=Fe(e,t);if(n.length>0)throw new Error(`${d} too many terminals, data makes no sense`);return r}var Ve=class extends Array{constructor(){super(),this.inRecursive=[]}prefix(t){let r=this.inRecursive[this.inRecursive.length-1];r&&(r.type===i.array&&(r.elements++,r.elements!==1&&t.push([44])),r.type===i.map&&(r.elements++,r.elements!==1&&(r.elements%2===1?t.push([44]):t.push([58]))))}[i.uint.major](t,r){this.prefix(t);let n=String(r.value),o=[];for(let s=0;s<n.length;s++)o[s]=n.charCodeAt(s);t.push(o)}[i.negint.major](t,r){this[i.uint.major](t,r)}[i.bytes.major](t,r){throw new Error(`${O} unsupported type: Uint8Array`)}[i.string.major](t,r){this.prefix(t);let n=ye(JSON.stringify(r.value));t.push(n.length>32?ne(n):n)}[i.array.major](t,r){this.prefix(t),this.inRecursive.push({type:i.array,elements:0}),t.push([91])}[i.map.major](t,r){this.prefix(t),this.inRecursive.push({type:i.map,elements:0}),t.push([123])}[i.tag.major](t,r){}[i.float.major](t,r){if(r.type.name==="break"){let a=this.inRecursive.pop();if(a){if(a.type===i.array)t.push([93]);else if(a.type===i.map)t.push([125]);else throw new Error("Unexpected recursive type; this should not happen!");return}throw new Error("Unexpected break; this should not happen!")}if(r.value===void 0)throw new Error(`${O} unsupported type: undefined`);if(this.prefix(t),r.type.name==="true"){t.push([116,114,117,101]);return}else if(r.type.name==="false"){t.push([102,97,108,115,101]);return}else if(r.type.name==="null"){t.push([110,117,108,108]);return}let n=String(r.value),o=[],s=!1;for(let a=0;a<n.length;a++)o[a]=n.charCodeAt(a),!s&&(o[a]===46||o[a]===101||o[a]===69)&&(s=!0);s||(o.push(46),o.push(48)),t.push(o)}};function Xr(e,t){if(Array.isArray(e[0])||Array.isArray(t[0]))throw new Error(`${O} complex map keys are not supported`);let r=e[0],n=t[0];if(r.type!==i.string||n.type!==i.string)throw new Error(`${O} non-string map keys are not supported`);if(r<n)return-1;if(r>n)return 1;throw new Error(`${O} unexpected duplicate map keys, this is not supported`)}var Qr={addBreakTokens:!0,mapSorter:Xr};function je(e,t){return t=Object.assign({},Qr,t),rr(e,new Ve,t)}var H=class{constructor(t,r={}){this._pos=0,this.data=t,this.options=r,this.modeStack=["value"],this.lastToken=""}pos(){return this._pos}done(){return this._pos>=this.data.length}ch(){return this.data[this._pos]}currentMode(){return this.modeStack[this.modeStack.length-1]}skipWhitespace(){let t=this.ch();for(;t===32||t===9||t===13||t===10;)t=this.data[++this._pos]}expect(t){if(this.data.length-this._pos<t.length)throw new Error(`${d} unexpected end of input at position ${this._pos}`);for(let r=0;r<t.length;r++)if(this.data[this._pos++]!==t[r])throw new Error(`${d} unexpected token at position ${this._pos}, expected to find '${String.fromCharCode(...t)}'`)}parseNumber(){let t=this._pos,r=!1,n=!1,o=u=>{for(;!this.done();){let h=this.ch();if(u.includes(h))this._pos++;else break}};if(this.ch()===45&&(r=!0,this._pos++),this.ch()===48)if(this._pos++,this.ch()===46)this._pos++,n=!0;else return new c(i.uint,0,this._pos-t);if(o([48,49,50,51,52,53,54,55,56,57]),r&&this._pos===t+1)throw new Error(`${d} unexpected token at position ${this._pos}`);if(!this.done()&&this.ch()===46){if(n)throw new Error(`${d} unexpected token at position ${this._pos}`);n=!0,this._pos++,o([48,49,50,51,52,53,54,55,56,57])}!this.done()&&(this.ch()===101||this.ch()===69)&&(n=!0,this._pos++,!this.done()&&(this.ch()===43||this.ch()===45)&&this._pos++,o([48,49,50,51,52,53,54,55,56,57]));let s=String.fromCharCode.apply(null,this.data.subarray(t,this._pos)),a=parseFloat(s);return n?new c(i.float,a,this._pos-t):this.options.allowBigInt!==!0||Number.isSafeInteger(a)?new c(a>=0?i.uint:i.negint,a,this._pos-t):new c(a>=0?i.uint:i.negint,BigInt(s),this._pos-t)}parseString(){if(this.ch()!==34)throw new Error(`${d} unexpected character at position ${this._pos}; this shouldn't happen`);this._pos++;for(let s=this._pos,a=0;s<this.data.length&&a<65536;s++,a++){let u=this.data[s];if(u===92||u<32||u>=128)break;if(u===34){let h=String.fromCharCode.apply(null,this.data.subarray(this._pos,s));return this._pos=s+1,new c(i.string,h,a)}}let t=this._pos,r=[],n=()=>{if(this._pos+4>=this.data.length)throw new Error(`${d} unexpected end of unicode escape sequence at position ${this._pos}`);let s=0;for(let a=0;a<4;a++){let u=this.ch();if(u>=48&&u<=57)u-=48;else if(u>=97&&u<=102)u=u-97+10;else if(u>=65&&u<=70)u=u-65+10;else throw new Error(`${d} unexpected unicode escape character at position ${this._pos}`);s=s*16+u,this._pos++}return s},o=()=>{let s=this.ch(),a=null,u=s>239?4:s>223?3:s>191?2:1;if(this._pos+u>this.data.length)throw new Error(`${d} unexpected unicode sequence at position ${this._pos}`);let h,x,l,y;switch(u){case 1:s<128&&(a=s);break;case 2:h=this.data[this._pos+1],(h&192)===128&&(y=(s&31)<<6|h&63,y>127&&(a=y));break;case 3:h=this.data[this._pos+1],x=this.data[this._pos+2],(h&192)===128&&(x&192)===128&&(y=(s&15)<<12|(h&63)<<6|x&63,y>2047&&(y<55296||y>57343)&&(a=y));break;case 4:h=this.data[this._pos+1],x=this.data[this._pos+2],l=this.data[this._pos+3],(h&192)===128&&(x&192)===128&&(l&192)===128&&(y=(s&15)<<18|(h&63)<<12|(x&63)<<6|l&63,y>65535&&y<1114112&&(a=y))}a===null?(a=65533,u=1):a>65535&&(a-=65536,r.push(a>>>10&1023|55296),a=56320|a&1023),r.push(a),this._pos+=u};for(;!this.done();){let s=this.ch(),a;switch(s){case 92:if(this._pos++,this.done())throw new Error(`${d} unexpected string termination at position ${this._pos}`);switch(a=this.ch(),this._pos++,a){case 34:case 39:case 92:case 47:r.push(a);break;case 98:r.push(8);break;case 116:r.push(9);break;case 110:r.push(10);break;case 102:r.push(12);break;case 114:r.push(13);break;case 117:r.push(n());break;default:throw new Error(`${d} unexpected string escape character at position ${this._pos}`)}break;case 34:return this._pos++,new c(i.string,$e(r),this._pos-t);default:if(s<32)throw new Error(`${d} invalid control character at position ${this._pos}`);s<128?(r.push(s),this._pos++):o()}}throw new Error(`${d} unexpected end of string at position ${this._pos}`)}parseValue(){switch(this.ch()){case 123:return this.modeStack.push("obj-start"),this._pos++,new c(i.map,1/0,1);case 91:return this.modeStack.push("array-start"),this._pos++,new c(i.array,1/0,1);case 34:return this.parseString();case 110:return this.expect([110,117,108,108]),new c(i.null,null,4);case 102:return this.expect([102,97,108,115,101]),new c(i.false,!1,5);case 116:return this.expect([116,114,117,101]),new c(i.true,!0,4);case 45:case 48:case 49:case 50:case 51:case 52:case 53:case 54:case 55:case 56:case 57:return this.parseNumber();default:throw new Error(`${d} unexpected character at position ${this._pos}`)}}next(){switch(this.skipWhitespace(),this.currentMode()){case"value":return this.modeStack.pop(),this.parseValue();case"array-value":{if(this.modeStack.pop(),this.ch()===93)return this._pos++,this.skipWhitespace(),new c(i.break,void 0,1);if(this.ch()!==44)throw new Error(`${d} unexpected character at position ${this._pos}, was expecting array delimiter but found '${String.fromCharCode(this.ch())}'`);return this._pos++,this.modeStack.push("array-value"),this.skipWhitespace(),this.parseValue()}case"array-start":return this.modeStack.pop(),this.ch()===93?(this._pos++,this.skipWhitespace(),new c(i.break,void 0,1)):(this.modeStack.push("array-value"),this.skipWhitespace(),this.parseValue());case"obj-key":if(this.ch()===125)return this.modeStack.pop(),this._pos++,this.skipWhitespace(),new c(i.break,void 0,1);if(this.ch()!==44)throw new Error(`${d} unexpected character at position ${this._pos}, was expecting object delimiter but found '${String.fromCharCode(this.ch())}'`);this._pos++,this.skipWhitespace();case"obj-start":{if(this.modeStack.pop(),this.ch()===125)return this._pos++,this.skipWhitespace(),new c(i.break,void 0,1);let t=this.parseString();if(this.skipWhitespace(),this.ch()!==58)throw new Error(`${d} unexpected character at position ${this._pos}, was expecting key/value delimiter ':' but found '${String.fromCharCode(this.ch())}'`);return this._pos++,this.modeStack.push("obj-value"),t}case"obj-value":return this.modeStack.pop(),this.modeStack.push("obj-key"),this.skipWhitespace(),this.parseValue();default:throw new Error(`${d} unexpected parse state at position ${this._pos}; this shouldn't happen`)}}};function Pe(e,t){return t=Object.assign({tokenizer:new H(e,t)},t),Oe(e,t)}var oi=new Uint8Array(0);var nr=(e,t)=>{if(e===t)return!0;if(e.byteLength!==t.byteLength)return!1;for(let r=0;r<e.byteLength;r++)if(e[r]!==t[r])return!1;return!0},Z=e=>{if(e instanceof Uint8Array&&e.constructor.name==="Uint8Array")return e;if(e instanceof ArrayBuffer)return new Uint8Array(e);if(ArrayBuffer.isView(e))return new Uint8Array(e.buffer,e.byteOffset,e.byteLength);throw new Error("Unknown type, must be binary type")};function Yr(e,t){if(e.length>=255)throw new TypeError("Alphabet too long");for(var r=new Uint8Array(256),n=0;n<r.length;n++)r[n]=255;for(var o=0;o<e.length;o++){var s=e.charAt(o),a=s.charCodeAt(0);if(r[a]!==255)throw new TypeError(s+" is ambiguous");r[a]=o}var u=e.length,h=e.charAt(0),x=Math.log(u)/Math.log(256),l=Math.log(256)/Math.log(u);function y(m){if(m instanceof Uint8Array||(ArrayBuffer.isView(m)?m=new Uint8Array(m.buffer,m.byteOffset,m.byteLength):Array.isArray(m)&&(m=Uint8Array.from(m))),!(m instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(m.length===0)return"";for(var k=0,q=0,B=0,M=m.length;B!==M&&m[B]===0;)B++,k++;for(var D=(M-B)*l+1>>>0,U=new Uint8Array(D);B!==M;){for(var z=m[B],P=0,$=D-1;(z!==0||P<q)&&$!==-1;$--,P++)z+=256*U[$]>>>0,U[$]=z%u>>>0,z=z/u>>>0;if(z!==0)throw new Error("Non-zero carry");q=P,B++}for(var F=D-q;F!==D&&U[F]===0;)F++;for(var me=h.repeat(k);F<D;++F)me+=e.charAt(U[F]);return me}function le(m){if(typeof m!="string")throw new TypeError("Expected String");if(m.length===0)return new Uint8Array;var k=0;if(m[k]!==" "){for(var q=0,B=0;m[k]===h;)q++,k++;for(var M=(m.length-k)*x+1>>>0,D=new Uint8Array(M);m[k];){var U=r[m.charCodeAt(k)];if(U===255)return;for(var z=0,P=M-1;(U!==0||z<B)&&P!==-1;P--,z++)U+=u*D[P]>>>0,D[P]=U%256>>>0,U=U/256>>>0;if(U!==0)throw new Error("Non-zero carry");B=z,k++}if(m[k]!==" "){for(var $=M-B;$!==M&&D[$]===0;)$++;for(var F=new Uint8Array(q+(M-$)),me=q;$!==M;)F[me++]=D[$++];return F}}}function yr(m){var k=le(m);if(k)return k;throw new Error(`Non-${t} character`)}return{encode:y,decodeUnsafe:le,decode:yr}}var en=Yr,tn=en,or=tn;var Re=class{constructor(t,r,n){this.name=t,this.prefix=r,this.baseEncode=n}encode(t){if(t instanceof Uint8Array)return`${this.prefix}${this.baseEncode(t)}`;throw Error("Unknown type, must be binary type")}},Le=class{constructor(t,r,n){if(this.name=t,this.prefix=r,r.codePointAt(0)===void 0)throw new Error("Invalid prefix character");this.prefixCodePoint=r.codePointAt(0),this.baseDecode=n}decode(t){if(typeof t=="string"){if(t.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(t)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(t.slice(this.prefix.length))}else throw Error("Can only multibase decode strings")}or(t){return ir(this,t)}},qe=class{constructor(t){this.decoders=t}or(t){return ir(this,t)}decode(t){let r=t[0],n=this.decoders[r];if(n)return n.decode(t);throw RangeError(`Unable to decode multibase string ${JSON.stringify(t)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}},ir=(e,t)=>new qe({...e.decoders||{[e.prefix]:e},...t.decoders||{[t.prefix]:t}}),We=class{constructor(t,r,n,o){this.name=t,this.prefix=r,this.baseEncode=n,this.baseDecode=o,this.encoder=new Re(t,r,n),this.decoder=new Le(t,r,o)}encode(t){return this.encoder.encode(t)}decode(t){return this.decoder.decode(t)}},sr=({name:e,prefix:t,encode:r,decode:n})=>new We(e,t,r,n),Ge=({prefix:e,name:t,alphabet:r})=>{let{encode:n,decode:o}=or(r,t);return sr({prefix:e,name:t,encode:n,decode:s=>Z(o(s))})},rn=(e,t,r,n)=>{let o={};for(let l=0;l<t.length;++l)o[t[l]]=l;let s=e.length;for(;e[s-1]==="=";)--s;let a=new Uint8Array(s*r/8|0),u=0,h=0,x=0;for(let l=0;l<s;++l){let y=o[e[l]];if(y===void 0)throw new SyntaxError(`Non-${n} character`);h=h<<r|y,u+=r,u>=8&&(u-=8,a[x++]=255&h>>u)}if(u>=r||255&h<<8-u)throw new SyntaxError("Unexpected end of data");return a},nn=(e,t,r)=>{let n=t[t.length-1]==="=",o=(1<<r)-1,s="",a=0,u=0;for(let h=0;h<e.length;++h)for(u=u<<8|e[h],a+=8;a>r;)a-=r,s+=t[o&u>>a];if(a&&(s+=t[o&u<<r-a]),n)for(;s.length*r&7;)s+="=";return s},b=({name:e,prefix:t,bitsPerChar:r,alphabet:n})=>sr({prefix:t,name:e,encode(o){return nn(o,n,r)},decode(o){return rn(o,n,r,e)}});var fe=b({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),fi=b({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),di=b({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),hi=b({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),pi=b({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),li=b({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),mi=b({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),xi=b({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),yi=b({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5});var j=Ge({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),bi=Ge({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"});var on=ur,ar=128,sn=127,an=~sn,cn=Math.pow(2,31);function ur(e,t,r){t=t||[],r=r||0;for(var n=r;e>=cn;)t[r++]=e&255|ar,e/=128;for(;e&an;)t[r++]=e&255|ar,e>>>=7;return t[r]=e|0,ur.bytes=r-n+1,t}var un=Je,fn=128,cr=127;function Je(e,n){var r=0,n=n||0,o=0,s=n,a,u=e.length;do{if(s>=u)throw Je.bytes=0,new RangeError("Could not decode varint");a=e[s++],r+=o<28?(a&cr)<<o:(a&cr)*Math.pow(2,o),o+=7}while(a>=fn);return Je.bytes=s-n,r}var dn=Math.pow(2,7),hn=Math.pow(2,14),pn=Math.pow(2,21),ln=Math.pow(2,28),mn=Math.pow(2,35),xn=Math.pow(2,42),yn=Math.pow(2,49),gn=Math.pow(2,56),wn=Math.pow(2,63),bn=function(e){return e<dn?1:e<hn?2:e<pn?3:e<ln?4:e<mn?5:e<xn?6:e<yn?7:e<gn?8:e<wn?9:10},kn={encode:on,decode:un,encodingLength:bn},En=kn,de=En;var he=(e,t=0)=>[de.decode(e,t),de.decode.bytes],Y=(e,t,r=0)=>(de.encode(e,t,r),t),ee=e=>de.encodingLength(e);var Xe=(e,t)=>{let r=t.byteLength,n=ee(e),o=n+ee(r),s=new Uint8Array(o+r);return Y(e,s,0),Y(r,s,n),s.set(t,o),new te(e,r,t,s)},fr=e=>{let t=Z(e),[r,n]=he(t),[o,s]=he(t.subarray(n)),a=t.subarray(n+s);if(a.byteLength!==o)throw new Error("Incorrect length");return new te(r,o,a,t)},dr=(e,t)=>{if(e===t)return!0;{let r=t;return e.code===r.code&&e.size===r.size&&r.bytes instanceof Uint8Array&&nr(e.bytes,r.bytes)}},te=class{constructor(t,r,n,o){this.code=t,this.size=r,this.digest=n,this.bytes=o}};var hr=(e,t)=>{let{bytes:r,version:n}=e;switch(n){case 0:return vn(r,He(e),t||j.encoder);default:return An(r,He(e),t||fe.encoder)}};var pr=new WeakMap,He=e=>{let t=pr.get(e);if(t==null){let r=new Map;return pr.set(e,r),r}return t},re=class e{constructor(t,r,n,o){this.code=r,this.version=t,this.multihash=n,this.bytes=o,this["/"]=o}get asCID(){return this}get byteOffset(){return this.bytes.byteOffset}get byteLength(){return this.bytes.byteLength}toV0(){switch(this.version){case 0:return this;case 1:{let{code:t,multihash:r}=this;if(t!==pe)throw new Error("Cannot convert a non dag-pb CID to CIDv0");if(r.code!==Un)throw new Error("Cannot convert non sha2-256 multihash CID to CIDv0");return e.createV0(r)}default:throw Error(`Can not convert CID version ${this.version} to version 0. This is a bug please report`)}}toV1(){switch(this.version){case 0:{let{code:t,digest:r}=this.multihash,n=Xe(t,r);return e.createV1(this.code,n)}case 1:return this;default:throw Error(`Can not convert CID version ${this.version} to version 1. This is a bug please report`)}}equals(t){return e.equals(this,t)}static equals(t,r){let n=r;return n&&t.code===n.code&&t.version===n.version&&dr(t.multihash,n.multihash)}toString(t){return hr(this,t)}toJSON(){return{"/":hr(this)}}link(){return this}get[Symbol.toStringTag](){return"CID"}[Symbol.for("nodejs.util.inspect.custom")](){return`CID(${this.toString()})`}static asCID(t){if(t==null)return null;let r=t;if(r instanceof e)return r;if(r["/"]!=null&&r["/"]===r.bytes||r.asCID===r){let{version:n,code:o,multihash:s,bytes:a}=r;return new e(n,o,s,a||lr(n,o,s.bytes))}else if(r[Sn]===!0){let{version:n,multihash:o,code:s}=r,a=fr(o);return e.create(n,s,a)}else return null}static create(t,r,n){if(typeof r!="number")throw new Error("String codecs are no longer supported");if(!(n.bytes instanceof Uint8Array))throw new Error("Invalid digest");switch(t){case 0:{if(r!==pe)throw new Error(`Version 0 CID must use dag-pb (code: ${pe}) block encoding`);return new e(t,r,n,n.bytes)}case 1:{let o=lr(t,r,n.bytes);return new e(t,r,n,o)}default:throw new Error("Invalid version")}}static createV0(t){return e.create(0,pe,t)}static createV1(t,r){return e.create(1,t,r)}static decode(t){let[r,n]=e.decodeFirst(t);if(n.length)throw new Error("Incorrect length");return r}static decodeFirst(t){let r=e.inspectBytes(t),n=r.size-r.multihashSize,o=Z(t.subarray(n,n+r.multihashSize));if(o.byteLength!==r.multihashSize)throw new Error("Incorrect length");let s=o.subarray(r.multihashSize-r.digestSize),a=new te(r.multihashCode,r.digestSize,s,o);return[r.version===0?e.createV0(a):e.createV1(r.codec,a),t.subarray(r.size)]}static inspectBytes(t){let r=0,n=()=>{let[y,le]=he(t.subarray(r));return r+=le,y},o=n(),s=pe;if(o===18?(o=0,r=0):s=n(),o!==0&&o!==1)throw new RangeError(`Invalid CID version ${o}`);let a=r,u=n(),h=n(),x=r+h,l=x-a;return{version:o,codec:s,multihashCode:u,digestSize:h,multihashSize:l,size:x}}static parse(t,r){let[n,o]=_n(t,r),s=e.decode(o);if(s.version===0&&t[0]!=="Q")throw Error("Version 0 CID string must not include multibase prefix");return He(s).set(n,t),s}},_n=(e,t)=>{switch(e[0]){case"Q":{let r=t||j;return[j.prefix,r.decode(`${j.prefix}${e}`)]}case j.prefix:{let r=t||j;return[j.prefix,r.decode(e)]}case fe.prefix:{let r=t||fe;return[fe.prefix,r.decode(e)]}default:{if(t==null)throw Error("To parse non base32 or base58btc encoded CID multibase decoder must be provided");return[e[0],t.decode(e)]}}},vn=(e,t,r)=>{let{prefix:n}=r;if(n!==j.prefix)throw Error(`Cannot string encode V0 in ${r.name} encoding`);let o=t.get(n);if(o==null){let s=r.encode(e).slice(1);return t.set(n,s),s}else return o},An=(e,t,r)=>{let{prefix:n}=r,o=t.get(n);if(o==null){let s=r.encode(e);return t.set(n,s),s}else return o},pe=112,Un=18,lr=(e,t,r)=>{let n=ee(e),o=n+ee(t),s=new Uint8Array(o+r.byteLength);return Y(e,s,0),Y(t,s,n),s.set(r,o),s},Sn=Symbol.for("@ipld/js-cid/CID");var Ze=b({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),Mi=b({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),Di=b({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),zi=b({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6});function Bn(e){if(e.asCID!==e&&e["/"]!==e.bytes)return null;let t=re.asCID(e);if(!t)return null;let r=t.toString();return[new c(i.map,1/0,1),new c(i.string,"/",1),new c(i.string,r,r.length),new c(i.break,void 0,1)]}function Te(e){let t=Ze.encode(e).slice(1);return[new c(i.map,1/0,1),new c(i.string,"/",1),new c(i.map,1/0,1),new c(i.string,"bytes",5),new c(i.string,t,t.length),new c(i.break,void 0,1),new c(i.break,void 0,1)]}function N(e){return Te(new Uint8Array(e.buffer,e.byteOffset,e.byteLength))}function $n(e){return Te(new Uint8Array(e))}function Cn(){throw new Error("`undefined` is not supported by the IPLD Data Model and cannot be encoded")}function In(e){if(Number.isNaN(e))throw new Error("`NaN` is not supported by the IPLD Data Model and cannot be encoded");if(e===1/0||e===-1/0)throw new Error("`Infinity` and `-Infinity` is not supported by the IPLD Data Model and cannot be encoded");return null}var Nn={typeEncoders:{Object:Bn,Buffer:Te,Uint8Array:Te,Int8Array:N,Uint16Array:N,Int16Array:N,Uint32Array:N,Int32Array:N,Float32Array:N,Float64Array:N,Uint8ClampedArray:N,BigInt64Array:N,BigUint64Array:N,DataView:N,ArrayBuffer:$n,undefined:Cn,number:In}},Ye=class extends H{constructor(t,r){super(t,r),this.tokenBuffer=[]}done(){return this.tokenBuffer.length===0&&super.done()}_next(){return this.tokenBuffer.length>0?this.tokenBuffer.pop():super.next()}next(){let t=this._next();if(t.type===i.map){let r=this._next();if(r.type===i.string&&r.value==="/"){let n=this._next();if(n.type===i.string){if(this._next().type!==i.break)throw new Error("Invalid encoded CID form");return this.tokenBuffer.push(n),new c(i.tag,42,0)}if(n.type===i.map){let o=this._next();if(o.type===i.string&&o.value==="bytes"){let s=this._next();if(s.type===i.string){for(let u=0;u<2;u++)if(this._next().type!==i.break)throw new Error("Invalid encoded Bytes form");let a=Ze.decode(`m${s.value}`);return new c(i.bytes,a,s.value.length)}this.tokenBuffer.push(s)}this.tokenBuffer.push(o)}this.tokenBuffer.push(n)}this.tokenBuffer.push(r)}return t}},et={allowIndefinite:!1,allowUndefined:!1,allowNaN:!1,allowInfinity:!1,allowBigInt:!0,strict:!0,useMaps:!1,rejectDuplicateMapKeys:!0,tags:[]};et.tags[42]=re.parse;var Mn="dag-json",Dn=297,mr=e=>je(e,Nn),xr=e=>{let t=Object.assign(et,{tokenizer:new Ye(e,et)});return Pe(e,t)},zn=e=>Fn.decode(mr(e));var Fn=new TextDecoder,On=e=>xr(Vn.encode(e)),Vn=new TextEncoder;return _r(jn);})();
return IpldDagJson}));
